var NoopLogger=function(){this.log=function(){},this.fatal=function(){},this.error=function(){},this.warn=function(){},this.debug=function(){},this.info=function(){},this.trace=function(){}};window.logger=new NoopLogger;var ConsoleLogger=function(){var t=this;this.log=function(){try{window.console.log.apply(window.console,t.concat(["["+(new Date).toUTCString()+"] "],arguments))}catch(n){}},this.fatal=function(){try{t.log.apply(t,t.concat(["[FATAL] "],arguments))}catch(n){}},this.error=function(){try{t.log.apply(t,t.concat(["[ERROR] "],arguments))}catch(n){}},this.warn=function(){try{t.log.apply(t,t.concat(["[WARN] "],arguments))}catch(n){}},this.debug=function(){try{t.log.apply(t,t.concat(["[DEBUG] "],arguments))}catch(n){}},this.info=function(){try{t.log.apply(t,t.concat(["[INFO] "],arguments))}catch(n){}},this.trace=function(){try{t.log.apply(t,t.concat(["[TRACE] "],arguments))}catch(n){}},this.concat=function(t,n){for(var o=[],e=0;e<t.length;e++)o.push(t[e]);for(var e=0;e<n.length;e++)o.push(n[e]);return o}},debugParameterIsPresent=!1;try{debugParameterIsPresent=location.search&&-1!=location.search.indexOf("debug=true")}catch(e){}var debugCookieIsPresent=!1;try{debugCookieIsPresent=document.cookie&&-1!=document.cookie.indexOf("debug=true")}catch(e){}window.console&&(debugParameterIsPresent||debugCookieIsPresent)&&(window.logger=new ConsoleLogger),logger.info("Logger is running...");
function backendLog(e,t,n){try{var o=getXmlHttp(),r=document.body.getAttribute("data-root-context")||"",a=r+("/"===r.substr(-1)?"frontend/log":"/frontend/log"),c=document.getElementsByName("_csrf_header")[0].getAttribute("content"),s=document.getElementsByName("_csrf")[0].getAttribute("content");if(o.open("POST",a,!0),o.setRequestHeader(c,s),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),"Microsoft Internet Explorer"==navigator.appName){var l="msg="+encodeURIComponent(unescape(e))+"&linenumber="+encodeURIComponent(unescape(n))+"&url="+encodeURIComponent(unescape(t));o.send(l),o.setRequestHeader("Method","POST "+a+" HTTP/1.1"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{var l=new FormData;l.append("msg",e),l.append("linenumber",n),l.append("url",t),o.send(l)}}catch(u){console.log("Failed to log error to backend",u)}}function getXmlHttp(){var e=null;try{e=new XMLHttpRequest}catch(t){for(var n=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP.2.6","Microsoft.XMLHTTP.1.0","Microsoft.XMLHTTP.1","Microsoft.XMLHTTP"],o=0;o<n.length&&null==e;o++)e=CreateXmlHttp(n[o])}return e}function CreateXmlHttp(e){var t=null;try{t=new ActiveXObject(e)}catch(n){}return t}window.onerror=function(e,t,n){return backendLog(e,t,n),!1};
blockFotoramaData=!0;
/*!
 * Fotorama 4.6.2 | http://fotorama.io/license/
 */
fotoramaVersion="4.6.2",function(a,b,c,d,e){"use strict";function f(a){var b="bez_"+d.makeArray(arguments).join("_").replace(".","p");if("function"!=typeof d.easing[b]){var c=function(a,b){var c=[null,null],d=[null,null],e=[null,null],f=function(f,g){return e[g]=3*a[g],d[g]=3*(b[g]-a[g])-e[g],c[g]=1-e[g]-d[g],f*(e[g]+f*(d[g]+f*c[g]))},g=function(a){return e[0]+a*(2*d[0]+3*c[0]*a)},h=function(a){for(var b,c=a,d=0;++d<14&&(b=f(c,0)-a,!(Math.abs(b)<.001));)c-=b/g(c);return c};return function(a){return f(h(a),1)}};d.easing[b]=function(b,d,e,f,g){return f*c([a[0],a[1]],[a[2],a[3]])(d/g)+e}}return b}function g(){}function h(a,b,c){return Math.max(isNaN(b)?-1/0:b,Math.min(isNaN(c)?1/0:c,a))}function i(a){return a.match(/ma/)&&a.match(/-?\d+(?!d)/g)[a.match(/3d/)?12:4]}function j(a){return Ic?+i(a.css("transform")):+a.css("left").replace("px","")}function k(a){var b={};return Ic?b.transform="translate3d("+a+"px,0,0)":b.left=a,b}function l(a){return{"transition-duration":a+"ms"}}function m(a,b){return isNaN(a)?b:a}function n(a,b){return m(+String(a).replace(b||"px",""))}function o(a){return/%$/.test(a)?n(a,"%"):e}function p(a,b){return m(o(a)/100*b,n(a))}function q(a){return(!isNaN(n(a))||!isNaN(n(a,"%")))&&a}function r(a,b,c,d){return(a-(d||0))*(b+(c||0))}function s(a,b,c,d){return-Math.round(a/(b+(c||0))-(d||0))}function t(a){var b=a.data();if(!b.tEnd){var c=a[0],d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};T(c,d[uc.prefixed("transition")],function(a){b.tProp&&a.propertyName.match(b.tProp)&&b.onEndFn()}),b.tEnd=!0}}function u(a,b,c,d){var e,f=a.data();f&&(f.onEndFn=function(){e||(e=!0,clearTimeout(f.tT),c())},f.tProp=b,clearTimeout(f.tT),f.tT=setTimeout(function(){f.onEndFn()},1.5*d),t(a))}function v(a,b){if(a.length){var c=a.data();Ic?(a.css(l(0)),c.onEndFn=g,clearTimeout(c.tT)):a.stop();var d=w(b,function(){return j(a)});return a.css(k(d)),d}}function w(){for(var a,b=0,c=arguments.length;c>b&&(a=b?arguments[b]():arguments[b],"number"!=typeof a);b++);return a}function x(a,b){return Math.round(a+(b-a)/1.5)}function y(){return y.p=y.p||("https:"===c.protocol?"https://":"http://"),y.p}function z(a){var c=b.createElement("a");return c.href=a,c}function A(a,b){if("string"!=typeof a)return a;a=z(a);var c,d;if(a.host.match(/youtube\.com/)&&a.search){if(c=a.search.split("v=")[1]){var e=c.indexOf("&");-1!==e&&(c=c.substring(0,e)),d="youtube"}}else a.host.match(/youtube\.com|youtu\.be/)?(c=a.pathname.replace(/^\/(embed\/|v\/)?/,"").replace(/\/.*/,""),d="youtube"):a.host.match(/vimeo\.com/)&&(d="vimeo",c=a.pathname.replace(/^\/(video\/)?/,"").replace(/\/.*/,""));return c&&d||!b||(c=a.href,d="custom"),c?{id:c,type:d,s:a.search.replace(/^\?/,""),p:y()}:!1}function B(a,b,c){var e,f,g=a.video;return"youtube"===g.type?(f=y()+"img.youtube.com/vi/"+g.id+"/default.jpg",e=f.replace(/\/default.jpg$/,"/hqdefault.jpg"),a.thumbsReady=!0):"vimeo"===g.type?d.ajax({url:y()+"vimeo.com/api/v2/video/"+g.id+".json",dataType:"jsonp",success:function(d){a.thumbsReady=!0,C(b,{img:d[0].thumbnail_large,thumb:d[0].thumbnail_small},a.i,c)}}):a.thumbsReady=!0,{img:e,thumb:f}}function C(a,b,c,e){for(var f=0,g=a.length;g>f;f++){var h=a[f];if(h.i===c&&h.thumbsReady){var i={videoReady:!0};i[Xc]=i[Zc]=i[Yc]=!1,e.splice(f,1,d.extend({},h,i,b));break}}}function D(a){function b(a,b,e){var f=a.children("img").eq(0),g=a.attr("href"),h=a.attr("src"),i=f.attr("src"),j=b.video,k=e?A(g,j===!0):!1;k?g=!1:k=j,c(a,f,d.extend(b,{video:k,img:b.img||g||h||i,thumb:b.thumb||i||h||g}))}function c(a,b,c){var e=c.thumb&&c.img!==c.thumb,f=n(c.width||a.attr("width")),g=n(c.height||a.attr("height"));d.extend(c,{width:f,height:g,thumbratio:S(c.thumbratio||n(c.thumbwidth||b&&b.attr("width")||e||f)/n(c.thumbheight||b&&b.attr("height")||e||g))})}var e=[];return a.children().each(function(){var a=d(this),f=R(d.extend(a.data(),{id:a.attr("id")}));if(a.is("a, img"))b(a,f,!0);else{if(a.is(":empty"))return;c(a,null,d.extend(f,{html:this,_html:a.html()}))}e.push(f)}),e}function E(a){return 0===a.offsetWidth&&0===a.offsetHeight}function F(a){return!d.contains(b.documentElement,a)}function G(a,b,c,d){return G.i||(G.i=1,G.ii=[!0]),d=d||G.i,"undefined"==typeof G.ii[d]&&(G.ii[d]=!0),a()?b():G.ii[d]&&setTimeout(function(){G.ii[d]&&G(a,b,c,d)},c||100),G.i++}function H(a){c.replace(c.protocol+"//"+c.host+c.pathname.replace(/^\/?/,"/")+c.search+"#"+a)}function I(a,b,c,d){var e=a.data(),f=e.measures;if(f&&(!e.l||e.l.W!==f.width||e.l.H!==f.height||e.l.r!==f.ratio||e.l.w!==b.w||e.l.h!==b.h||e.l.m!==c||e.l.p!==d)){var g=f.width,i=f.height,j=b.w/b.h,k=f.ratio>=j,l="scaledown"===c,m="contain"===c,n="cover"===c,o=$(d);k&&(l||m)||!k&&n?(g=h(b.w,0,l?g:1/0),i=g/f.ratio):(k&&n||!k&&(l||m))&&(i=h(b.h,0,l?i:1/0),g=i*f.ratio),a.css({width:Math.ceil(g),height:Math.ceil(i),left:Math.floor(p(o.x,b.w-g)),top:Math.floor(p(o.y,b.h-i))}),e.l={W:f.width,H:f.height,r:f.ratio,w:b.w,h:b.h,m:c,p:d}}return!0}function J(a,b){var c=a[0];c.styleSheet?c.styleSheet.cssText=b:a.html(b)}function K(a,b,c){return b===c?!1:b>=a?"left":a>=c?"right":"left right"}function L(a,b,c,d){if(!c)return!1;if(!isNaN(a))return a-(d?0:1);for(var e,f=0,g=b.length;g>f;f++){var h=b[f];if(h.id===a){e=f;break}}return e}function M(a,b,c){c=c||{},a.each(function(){var a,e=d(this),f=e.data();f.clickOn||(f.clickOn=!0,d.extend(cb(e,{onStart:function(b){a=b,(c.onStart||g).call(this,b)},onMove:c.onMove||g,onTouchEnd:c.onTouchEnd||g,onEnd:function(c){c.moved||b.call(this,a)}}),{noMove:!0}))})}function N(a,b){return'<div class="'+a+'">'+(b||"")+"</div>"}function O(a){for(var b=a.length;b;){var c=Math.floor(Math.random()*b--),d=a[b];a[b]=a[c],a[c]=d}return a}function P(a){return"[object Array]"==Object.prototype.toString.call(a)&&d.map(a,function(a){return d.extend({},a)})}function Q(a,b,c){a.scrollLeft(b||0).scrollTop(c||0)}function R(a){if(a){var b={};return d.each(a,function(a,c){b[a.toLowerCase()]=c}),b}}function S(a){if(a){var b=+a;return isNaN(b)?(b=a.split("/"),+b[0]/+b[1]||e):b}}function T(a,b,c,d){b&&(a.addEventListener?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c))}function U(a){return!!a.getAttribute("disabled")}function V(a){return{tabindex:-1*a+"",disabled:a}}function W(a,b){T(a,"keyup",function(c){U(a)||13==c.keyCode&&b.call(a,c)})}function X(a,b){T(a,"focus",a.onfocusin=function(c){b.call(a,c)},!0)}function Y(a,b){a.preventDefault?a.preventDefault():a.returnValue=!1,b&&a.stopPropagation&&a.stopPropagation()}function Z(a){return a?">":"<"}function $(a){return a=(a+"").split(/\s+/),{x:q(a[0])||bd,y:q(a[1])||bd}}function _(a,b){var c=a.data(),e=Math.round(b.pos),f=function(){c.sliding=!1,(b.onEnd||g)()};"undefined"!=typeof b.overPos&&b.overPos!==b.pos&&(e=b.overPos,f=function(){_(a,d.extend({},b,{overPos:b.pos,time:Math.max(Qc,b.time/2)}))});var h=d.extend(k(e),b.width&&{width:b.width});c.sliding=!0,Ic?(a.css(d.extend(l(b.time),h)),b.time>10?u(a,"transform",f,b.time):f()):a.stop().animate(h,b.time,_c,f)}function ab(a,b,c,e,f,h){var i="undefined"!=typeof h;if(i||(f.push(arguments),Array.prototype.push.call(arguments,f.length),!(f.length>1))){a=a||d(a),b=b||d(b);var j=a[0],k=b[0],l="crossfade"===e.method,m=function(){if(!m.done){m.done=!0;var a=(i||f.shift())&&f.shift();a&&ab.apply(this,a),(e.onEnd||g)(!!a)}},n=e.time/(h||1);c.removeClass(Rb+" "+Qb),a.stop().addClass(Rb),b.stop().addClass(Qb),l&&k&&a.fadeTo(0,0),a.fadeTo(l?n:0,1,l&&m),b.fadeTo(n,0,m),j&&l||k||m()}}function bb(a){var b=(a.touches||[])[0]||a;a._x=b.pageX,a._y=b.clientY,a._now=d.now()}function cb(a,c){function e(a){return m=d(a.target),u.checked=p=q=s=!1,k||u.flow||a.touches&&a.touches.length>1||a.which>1||ed&&ed.type!==a.type&&gd||(p=c.select&&m.is(c.select,t))?p:(o="touchstart"===a.type,q=m.is("a, a *",t),n=u.control,r=u.noMove||u.noSwipe||n?16:u.snap?0:4,bb(a),l=ed=a,fd=a.type.replace(/down|start/,"move").replace(/Down/,"Move"),(c.onStart||g).call(t,a,{control:n,$target:m}),k=u.flow=!0,void((!o||u.go)&&Y(a)))}function f(a){if(a.touches&&a.touches.length>1||Nc&&!a.isPrimary||fd!==a.type||!k)return k&&h(),void(c.onTouchEnd||g)();bb(a);var b=Math.abs(a._x-l._x),d=Math.abs(a._y-l._y),e=b-d,f=(u.go||u.x||e>=0)&&!u.noSwipe,i=0>e;o&&!u.checked?(k=f)&&Y(a):(Y(a),(c.onMove||g).call(t,a,{touch:o})),!s&&Math.sqrt(Math.pow(b,2)+Math.pow(d,2))>r&&(s=!0),u.checked=u.checked||f||i}function h(a){(c.onTouchEnd||g)();var b=k;u.control=k=!1,b&&(u.flow=!1),!b||q&&!u.checked||(a&&Y(a),gd=!0,clearTimeout(hd),hd=setTimeout(function(){gd=!1},1e3),(c.onEnd||g).call(t,{moved:s,$target:m,control:n,touch:o,startEvent:l,aborted:!a||"MSPointerCancel"===a.type}))}function i(){u.flow||setTimeout(function(){u.flow=!0},10)}function j(){u.flow&&setTimeout(function(){u.flow=!1},Pc)}var k,l,m,n,o,p,q,r,s,t=a[0],u={};return Nc?(T(t,"MSPointerDown",e),T(b,"MSPointerMove",f),T(b,"MSPointerCancel",h),T(b,"MSPointerUp",h)):(T(t,"touchstart",e),T(t,"touchmove",f),T(t,"touchend",h),T(b,"touchstart",i),T(b,"touchend",j),T(b,"touchcancel",j),Ec.on("scroll",j),a.on("mousedown",e),Fc.on("mousemove",f).on("mouseup",h)),a.on("click","a",function(a){u.checked&&Y(a)}),u}function db(a,b){function c(c,d){A=!0,j=l=c._x,q=c._now,p=[[q,j]],m=n=D.noMove||d?0:v(a,(b.getPos||g)()),(b.onStart||g).call(B,c)}function e(a,b){s=D.min,t=D.max,u=D.snap,w=a.altKey,A=z=!1,y=b.control,y||C.sliding||c(a)}function f(d,e){D.noSwipe||(A||c(d),l=d._x,p.push([d._now,l]),n=m-(j-l),o=K(n,s,t),s>=n?n=x(n,s):n>=t&&(n=x(n,t)),D.noMove||(a.css(k(n)),z||(z=!0,e.touch||Nc||a.addClass(ec)),(b.onMove||g).call(B,d,{pos:n,edge:o})))}function i(e){if(!D.noSwipe||!e.moved){A||c(e.startEvent,!0),e.touch||Nc||a.removeClass(ec),r=d.now();for(var f,i,j,k,o,q,v,x,y,z=r-Pc,C=null,E=Qc,F=b.friction,G=p.length-1;G>=0;G--){if(f=p[G][0],i=Math.abs(f-z),null===C||j>i)C=f,k=p[G][1];else if(C===z||i>j)break;j=i}v=h(n,s,t);var H=k-l,I=H>=0,J=r-C,K=J>Pc,L=!K&&n!==m&&v===n;u&&(v=h(Math[L?I?"floor":"ceil":"round"](n/u)*u,s,t),s=t=v),L&&(u||v===n)&&(y=-(H/J),E*=h(Math.abs(y),b.timeLow,b.timeHigh),o=Math.round(n+y*E/F),u||(v=o),(!I&&o>t||I&&s>o)&&(q=I?s:t,x=o-q,u||(v=q),x=h(v+.03*x,q-50,q+50),E=Math.abs((n-x)/(y/F)))),E*=w?10:1,(b.onEnd||g).call(B,d.extend(e,{moved:e.moved||K&&u,pos:n,newPos:v,overPos:x,time:E}))}}var j,l,m,n,o,p,q,r,s,t,u,w,y,z,A,B=a[0],C=a.data(),D={};return D=d.extend(cb(b.$wrap,d.extend({},b,{onStart:e,onMove:f,onEnd:i})),D)}function eb(a,b){var c,e,f,h=a[0],i={prevent:{}};return T(h,Oc,function(a){var h=a.wheelDeltaY||-1*a.deltaY||0,j=a.wheelDeltaX||-1*a.deltaX||0,k=Math.abs(j)&&!Math.abs(h),l=Z(0>j),m=e===l,n=d.now(),o=Pc>n-f;e=l,f=n,k&&i.ok&&(!i.prevent[l]||c)&&(Y(a,!0),c&&m&&o||(b.shift&&(c=!0,clearTimeout(i.t),i.t=setTimeout(function(){c=!1},Rc)),(b.onEnd||g)(a,b.shift?l:j)))}),i}function fb(){d.each(d.Fotorama.instances,function(a,b){b.index=a})}function gb(a){d.Fotorama.instances.push(a),fb()}function hb(a){d.Fotorama.instances.splice(a.index,1),fb()}var ib="fotorama",jb="fullscreen",kb=ib+"__wrap",lb=kb+"--css2",mb=kb+"--css3",nb=kb+"--video",ob=kb+"--fade",pb=kb+"--slide",qb=kb+"--no-controls",rb=kb+"--no-shadows",sb=kb+"--pan-y",tb=kb+"--rtl",ub=kb+"--only-active",vb=kb+"--no-captions",wb=kb+"--toggle-arrows",xb=ib+"__stage",yb=xb+"__frame",zb=yb+"--video",Ab=xb+"__shaft",Bb=ib+"__grab",Cb=ib+"__pointer",Db=ib+"__arr",Eb=Db+"--disabled",Fb=Db+"--prev",Gb=Db+"--next",Hb=ib+"__nav",Ib=Hb+"-wrap",Jb=Hb+"__shaft",Kb=Hb+"--dots",Lb=Hb+"--thumbs",Mb=Hb+"__frame",Nb=Mb+"--dot",Ob=Mb+"--thumb",Pb=ib+"__fade",Qb=Pb+"-front",Rb=Pb+"-rear",Sb=ib+"__shadow",Tb=Sb+"s",Ub=Tb+"--left",Vb=Tb+"--right",Wb=ib+"__active",Xb=ib+"__select",Yb=ib+"--hidden",Zb=ib+"--fullscreen",$b=ib+"__fullscreen-icon",_b=ib+"__error",ac=ib+"__loading",bc=ib+"__loaded",cc=bc+"--full",dc=bc+"--img",ec=ib+"__grabbing",fc=ib+"__img",gc=fc+"--full",hc=ib+"__dot",ic=ib+"__thumb",jc=ic+"-border",kc=ib+"__html",lc=ib+"__video",mc=lc+"-play",nc=lc+"-close",oc=ib+"__caption",pc=ib+"__caption__wrap",qc=ib+"__spinner",rc='" tabindex="0" role="button',sc=d&&d.fn.jquery.split(".");if(!sc||sc[0]<1||1==sc[0]&&sc[1]<8)throw"Fotorama requires jQuery 1.8 or later and will not run without it.";var tc={},uc=function(a,b,c){function d(a){r.cssText=a}function e(a,b){return typeof a===b}function f(a,b){return!!~(""+a).indexOf(b)}function g(a,b){for(var d in a){var e=a[d];if(!f(e,"-")&&r[e]!==c)return"pfx"==b?e:!0}return!1}function h(a,b,d){for(var f in a){var g=b[a[f]];if(g!==c)return d===!1?a[f]:e(g,"function")?g.bind(d||b):g}return!1}function i(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),f=(a+" "+u.join(d+" ")+d).split(" ");return e(b,"string")||e(b,"undefined")?g(f,b):(f=(a+" "+v.join(d+" ")+d).split(" "),h(f,b,c))}var j,k,l,m="2.6.2",n={},o=b.documentElement,p="modernizr",q=b.createElement(p),r=q.style,s=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),t="Webkit Moz O ms",u=t.split(" "),v=t.toLowerCase().split(" "),w={},x=[],y=x.slice,z=function(a,c,d,e){var f,g,h,i,j=b.createElement("div"),k=b.body,l=k||b.createElement("body");if(parseInt(d,10))for(;d--;)h=b.createElement("div"),h.id=e?e[d]:p+(d+1),j.appendChild(h);return f=["&#173;",'<style id="s',p,'">',a,"</style>"].join(""),j.id=p,(k?j:l).innerHTML+=f,l.appendChild(j),k||(l.style.background="",l.style.overflow="hidden",i=o.style.overflow,o.style.overflow="hidden",o.appendChild(l)),g=c(j,a),k?j.parentNode.removeChild(j):(l.parentNode.removeChild(l),o.style.overflow=i),!!g},A={}.hasOwnProperty;l=e(A,"undefined")||e(A.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return A.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=y.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(y.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(y.call(arguments)))};return d}),w.csstransforms3d=function(){var a=!!i("perspective");return a};for(var B in w)l(w,B)&&(k=B.toLowerCase(),n[k]=w[B](),x.push((n[k]?"":"no-")+k));return n.addTest=function(a,b){if("object"==typeof a)for(var d in a)l(a,d)&&n.addTest(d,a[d]);else{if(a=a.toLowerCase(),n[a]!==c)return n;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(o.className+=" "+(b?"":"no-")+a),n[a]=b}return n},d(""),q=j=null,n._version=m,n._prefixes=s,n._domPrefixes=v,n._cssomPrefixes=u,n.testProp=function(a){return g([a])},n.testAllProps=i,n.testStyles=z,n.prefixed=function(a,b,c){return b?i(a,b,c):i(a,"pfx")},n}(a,b),vc={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:"",prefix:""},wc="webkit moz o ms khtml".split(" ");if("undefined"!=typeof b.cancelFullScreen)vc.ok=!0;else for(var xc=0,yc=wc.length;yc>xc;xc++)if(vc.prefix=wc[xc],"undefined"!=typeof b[vc.prefix+"CancelFullScreen"]){vc.ok=!0;break}vc.ok&&(vc.event=vc.prefix+"fullscreenchange",vc.is=function(){switch(this.prefix){case"":return b.fullScreen;case"webkit":return b.webkitIsFullScreen;default:return b[this.prefix+"FullScreen"]}},vc.request=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},vc.cancel=function(){return""===this.prefix?b.cancelFullScreen():b[this.prefix+"CancelFullScreen"]()});var zc,Ac={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:"rgba(128, 128, 128, .75)",hwaccel:!0},Bc={top:"auto",left:"auto",className:""};!function(a,b){zc=b()}(this,function(){function a(a,c){var d,e=b.createElement(a||"div");for(d in c)e[d]=c[d];return e}function c(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function d(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=m.substring(0,m.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return o[e]||(p.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",p.cssRules.length),o[e]=1),e}function f(a,b){var c,d,f=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<n.length;d++)if(c=n[d]+b,f[c]!==e)return c;return f[b]!==e?b:void 0}function g(a,b){for(var c in b)a.style[f(a,c)||c]=b[c];return a}function h(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]===e&&(a[d]=c[d])}return a}function i(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function j(a,b){return"string"==typeof a?a:a[b%a.length]}function k(a){return"undefined"==typeof this?new k(a):void(this.opts=h(a||{},k.defaults,q))}function l(){function b(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}p.addRule(".spin-vml","behavior:url(#default#VML)"),k.prototype.lines=function(a,d){function e(){return g(b("group",{coordsize:k+" "+k,coordorigin:-i+" "+-i}),{width:k,height:k})}function f(a,f,h){c(m,c(g(e(),{rotation:360/d.lines*a+"deg",left:~~f}),c(g(b("roundrect",{arcsize:d.corners}),{width:i,height:d.width,left:d.radius,top:-d.width>>1,filter:h}),b("fill",{color:j(d.color,a),opacity:d.opacity}),b("stroke",{opacity:0}))))}var h,i=d.length+d.width,k=2*i,l=2*-(d.width+d.length)+"px",m=g(e(),{position:"absolute",top:l,left:l});if(d.shadow)for(h=1;h<=d.lines;h++)f(h,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(h=1;h<=d.lines;h++)f(h);return c(a,m)},k.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var m,n=["webkit","Moz","ms","O"],o={},p=function(){var d=a("style",{type:"text/css"});return c(b.getElementsByTagName("head")[0],d),d.sheet||d.styleSheet}(),q={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};k.defaults={},h(k.prototype,{spin:function(b){this.stop();var c,d,e=this,f=e.opts,h=e.el=g(a(0,{className:f.className}),{position:f.position,width:0,zIndex:f.zIndex}),j=f.radius+f.length+f.width;if(b&&(b.insertBefore(h,b.firstChild||null),d=i(b),c=i(h),g(h,{left:("auto"==f.left?d.x-c.x+(b.offsetWidth>>1):parseInt(f.left,10)+j)+"px",top:("auto"==f.top?d.y-c.y+(b.offsetHeight>>1):parseInt(f.top,10)+j)+"px"})),h.setAttribute("role","progressbar"),e.lines(h,e.opts),!m){var k,l=0,n=(f.lines-1)*(1-f.direction)/2,o=f.fps,p=o/f.speed,q=(1-f.opacity)/(p*f.trail/100),r=p/f.lines;!function s(){l++;for(var a=0;a<f.lines;a++)k=Math.max(1-(l+(f.lines-a)*r)%p*q,f.opacity),e.opacity(h,a*f.direction+n,k,f);e.timeout=e.el&&setTimeout(s,~~(1e3/o))}()}return e},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=e),this},lines:function(b,e){function f(b,c){return g(a(),{position:"absolute",width:e.length+e.width+"px",height:e.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/e.lines*i+e.rotate)+"deg) translate("+e.radius+"px,0)",borderRadius:(e.corners*e.width>>1)+"px"})}for(var h,i=0,k=(e.lines-1)*(1-e.direction)/2;i<e.lines;i++)h=g(a(),{position:"absolute",top:1+~(e.width/2)+"px",transform:e.hwaccel?"translate3d(0,0,0)":"",opacity:e.opacity,animation:m&&d(e.opacity,e.trail,k+i*e.direction,e.lines)+" "+1/e.speed+"s linear infinite"}),e.shadow&&c(h,g(f("#000","0 0 4px #000"),{top:"2px"})),c(b,c(h,f(j(e.color,i),"0 0 1px rgba(0,0,0,.1)")));return b},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var r=g(a("group"),{behavior:"url(#default#VML)"});return!f(r,"transform")&&r.adj?l():m=f(r,"animation"),k});var Cc,Dc,Ec=d(a),Fc=d(b),Gc="quirks"===c.hash.replace("#",""),Hc=uc.csstransforms3d,Ic=Hc&&!Gc,Jc=Hc||"CSS1Compat"===b.compatMode,Kc=vc.ok,Lc=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),Mc=!Ic||Lc,Nc=navigator.msPointerEnabled,Oc="onwheel"in b.createElement("div")?"wheel":b.onmousewheel!==e?"mousewheel":"DOMMouseScroll",Pc=250,Qc=300,Rc=1400,Sc=5e3,Tc=2,Uc=64,Vc=500,Wc=333,Xc="$stageFrame",Yc="$navDotFrame",Zc="$navThumbFrame",$c="auto",_c=f([.1,0,.25,1]),ad=99999,bd="50%",cd={width:null,minwidth:null,maxwidth:"100%",height:null,minheight:null,maxheight:null,ratio:null,margin:Tc,glimpse:0,fit:"contain",position:bd,thumbposition:bd,nav:"dots",navposition:"bottom",navwidth:null,thumbwidth:Uc,thumbheight:Uc,thumbmargin:Tc,thumbborderwidth:Tc,thumbfit:"cover",allowfullscreen:!1,transition:"slide",clicktransition:null,transitionduration:Qc,captions:!0,hash:!1,startindex:0,loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!0,trackpad:!1,enableifsingleframe:!1,controlsonstart:!0,shuffle:!1,direction:"ltr",shadows:!0,spinner:null},dd={left:!0,right:!0,down:!1,up:!1,space:!1,home:!1,end:!1};G.stop=function(a){G.ii[a]=!1};var ed,fd,gd,hd;jQuery.Fotorama=function(a,e){function f(){d.each(yd,function(a,b){if(!b.i){b.i=me++;var c=A(b.video,!0);if(c){var d={};b.video=c,b.img||b.thumb?b.thumbsReady=!0:d=B(b,yd,ie),C(yd,{img:d.img,thumb:d.thumb},b.i,ie)}}})}function g(a){return Zd[a]||ie.fullScreen}function i(a){var b="keydown."+ib,c=ib+je,d="keydown."+c,f="resize."+c+" orientationchange."+c;a?(Fc.on(d,function(a){var b,c;Cd&&27===a.keyCode?(b=!0,md(Cd,!0,!0)):(ie.fullScreen||e.keyboard&&!ie.index)&&(27===a.keyCode?(b=!0,ie.cancelFullScreen()):a.shiftKey&&32===a.keyCode&&g("space")||37===a.keyCode&&g("left")||38===a.keyCode&&g("up")?c="<":32===a.keyCode&&g("space")||39===a.keyCode&&g("right")||40===a.keyCode&&g("down")?c=">":36===a.keyCode&&g("home")?c="<<":35===a.keyCode&&g("end")&&(c=">>")),(b||c)&&Y(a),c&&ie.show({index:c,slow:a.altKey,user:!0})}),ie.index||Fc.off(b).on(b,"textarea, input, select, [contenteditable]",function(a){!Dc.hasClass(jb)&&a.stopPropagation()}),Ec.on(f,ie.resize)):(Fc.off(d),Ec.off(f))}function j(b){b!==j.f&&(b?(a.html("").addClass(ib+" "+ke).append(qe).before(oe).before(pe),gb(ie)):(qe.detach(),oe.detach(),pe.detach(),a.html(ne.urtext).removeClass(ke),hb(ie)),i(b),j.f=b)}function m(){yd=ie.data=yd||P(e.data)||D(a),zd=ie.size=yd.length,!xd.ok&&e.shuffle&&O(yd),f(),Je=y(Je),zd&&j(!0)}function o(){var a=2>zd&&!e.enableifsingleframe||Cd;Me.noMove=a||Sd,Me.noSwipe=a||!e.swipe,!Wd&&se.toggleClass(Bb,!e.click&&!Me.noMove&&!Me.noSwipe),Nc&&qe.toggleClass(sb,!Me.noSwipe)}function t(a){a===!0&&(a=""),e.autoplay=Math.max(+a||Sc,1.5*Vd)}function u(){function a(a,c){b[a?"add":"remove"].push(c)}ie.options=e=R(e),Sd="crossfade"===e.transition||"dissolve"===e.transition,Md=e.loop&&(zd>2||Sd&&(!Wd||"slide"!==Wd)),Vd=+e.transitionduration||Qc,Yd="rtl"===e.direction,Zd=d.extend({},e.keyboard&&dd,e.keyboard);var b={add:[],remove:[]};zd>1||e.enableifsingleframe?(Nd=e.nav,Pd="top"===e.navposition,b.remove.push(Xb),we.toggle(!!e.arrows)):(Nd=!1,we.hide()),Rb(),Bd=new zc(d.extend(Ac,e.spinner,Bc,{direction:Yd?-1:1})),Gc(),Hc(),e.autoplay&&t(e.autoplay),Td=n(e.thumbwidth)||Uc,Ud=n(e.thumbheight)||Uc,Ne.ok=Pe.ok=e.trackpad&&!Mc,o(),ed(e,[Le]),Od="thumbs"===Nd,Od?(lc(zd,"navThumb"),Ad=Be,he=Zc,J(oe,d.Fotorama.jst.style({w:Td,h:Ud,b:e.thumbborderwidth,m:e.thumbmargin,s:je,q:!Jc})),ye.addClass(Lb).removeClass(Kb)):"dots"===Nd?(lc(zd,"navDot"),Ad=Ae,he=Yc,ye.addClass(Kb).removeClass(Lb)):(Nd=!1,ye.removeClass(Lb+" "+Kb)),Nd&&(Pd?xe.insertBefore(re):xe.insertAfter(re),wc.nav=!1,wc(Ad,ze,"nav")),Qd=e.allowfullscreen,Qd?(De.prependTo(re),Rd=Kc&&"native"===Qd):(De.detach(),Rd=!1),a(Sd,ob),a(!Sd,pb),a(!e.captions,vb),a(Yd,tb),a("always"!==e.arrows,wb),Xd=e.shadows&&!Mc,a(!Xd,rb),qe.addClass(b.add.join(" ")).removeClass(b.remove.join(" ")),Ke=d.extend({},e)}function x(a){return 0>a?(zd+a%zd)%zd:a>=zd?a%zd:a}function y(a){return h(a,0,zd-1)}function z(a){return Md?x(a):y(a)}function E(a){return a>0||Md?a-1:!1}function U(a){return zd-1>a||Md?a+1:!1}function $(){Me.min=Md?-1/0:-r(zd-1,Le.w,e.margin,Fd),Me.max=Md?1/0:-r(0,Le.w,e.margin,Fd),Me.snap=Le.w+e.margin}function bb(){Oe.min=Math.min(0,Le.nw-ze.width()),Oe.max=0,ze.toggleClass(Bb,!(Oe.noMove=Oe.min===Oe.max))}function cb(a,b,c){if("number"==typeof a){a=new Array(a);var e=!0}return d.each(a,function(a,d){if(e&&(d=a),"number"==typeof d){var f=yd[x(d)];if(f){var g="$"+b+"Frame",h=f[g];c.call(this,a,d,f,h,g,h&&h.data())}}})}function fb(a,b,c,d){(!$d||"*"===$d&&d===Ld)&&(a=q(e.width)||q(a)||Vc,b=q(e.height)||q(b)||Wc,ie.resize({width:a,ratio:e.ratio||c||a/b},0,d!==Ld&&"*"))}function Pb(a,b,c,f,g,h){cb(a,b,function(a,i,j,k,l,m){function n(a){var b=x(i);fd(a,{index:b,src:w,frame:yd[b]})}function o(){t.remove(),d.Fotorama.cache[w]="error",j.html&&"stage"===b||!y||y===w?(!w||j.html||r?"stage"===b&&(k.trigger("f:load").removeClass(ac+" "+_b).addClass(bc),n("load"),fb()):(k.trigger("f:error").removeClass(ac).addClass(_b),n("error")),m.state="error",!(zd>1&&yd[i]===j)||j.html||j.deleted||j.video||r||(j.deleted=!0,ie.splice(i,1))):(j[v]=w=y,Pb([i],b,c,f,g,!0))}function p(){d.Fotorama.measures[w]=u.measures=d.Fotorama.measures[w]||{width:s.width,height:s.height,ratio:s.width/s.height},fb(u.measures.width,u.measures.height,u.measures.ratio,i),t.off("load error").addClass(fc+(r?" "+gc:"")).prependTo(k),I(t,(d.isFunction(c)?c():c)||Le,f||j.fit||e.fit,g||j.position||e.position),d.Fotorama.cache[w]=m.state="loaded",setTimeout(function(){k.trigger("f:load").removeClass(ac+" "+_b).addClass(bc+" "+(r?cc:dc)),"stage"===b?n("load"):(j.thumbratio===$c||!j.thumbratio&&e.thumbratio===$c)&&(j.thumbratio=u.measures.ratio,vd())},0)}function q(){var a=10;G(function(){return!fe||!a--&&!Mc},function(){p()})}if(k){var r=ie.fullScreen&&j.full&&j.full!==j.img&&!m.$full&&"stage"===b;if(!m.$img||h||r){var s=new Image,t=d(s),u=t.data();m[r?"$full":"$img"]=t;var v="stage"===b?r?"full":"img":"thumb",w=j[v],y=r?null:j["stage"===b?"thumb":"img"];if("navThumb"===b&&(k=m.$wrap),!w)return void o();d.Fotorama.cache[w]?!function z(){"error"===d.Fotorama.cache[w]?o():"loaded"===d.Fotorama.cache[w]?setTimeout(q,0):setTimeout(z,100)}():(d.Fotorama.cache[w]="*",t.on("load",q).on("error",o)),m.state="",s.src=w}}})}function Qb(a){Ie.append(Bd.spin().el).appendTo(a)}function Rb(){Ie.detach(),Bd&&Bd.stop()}function Sb(){var a=Dd[Xc];a&&!a.data().state&&(Qb(a),a.on("f:load f:error",function(){a.off("f:load f:error"),Rb()}))}function ec(a){W(a,sd),X(a,function(){setTimeout(function(){Q(ye)},0),Rc({time:Vd,guessIndex:d(this).data().eq,minMax:Oe})})}function lc(a,b){cb(a,b,function(a,c,e,f,g,h){if(!f){f=e[g]=qe[g].clone(),h=f.data(),h.data=e;var i=f[0];"stage"===b?(e.html&&d('<div class="'+kc+'"></div>').append(e._html?d(e.html).removeAttr("id").html(e._html):e.html).appendTo(f),e.caption&&d(N(oc,N(pc,e.caption))).appendTo(f),e.video&&f.addClass(zb).append(Fe.clone()),X(i,function(){setTimeout(function(){Q(re)},0),pd({index:h.eq,user:!0})}),te=te.add(f)):"navDot"===b?(ec(i),Ae=Ae.add(f)):"navThumb"===b&&(ec(i),h.$wrap=f.children(":first"),Be=Be.add(f),e.video&&h.$wrap.append(Fe.clone()))}})}function sc(a,b,c,d){return a&&a.length&&I(a,b,c,d)}function tc(a){cb(a,"stage",function(a,b,c,f,g,h){if(f){var i=x(b),j=c.fit||e.fit,k=c.position||e.position;h.eq=i,Re[Xc][i]=f.css(d.extend({left:Sd?0:r(b,Le.w,e.margin,Fd)},Sd&&l(0))),F(f[0])&&(f.appendTo(se),md(c.$video)),sc(h.$img,Le,j,k),sc(h.$full,Le,j,k)}})}function uc(a,b){if("thumbs"===Nd&&!isNaN(a)){var c=-a,f=-a+Le.nw;Be.each(function(){var a=d(this),g=a.data(),h=g.eq,i=function(){return{h:Ud,w:g.w}},j=i(),k=yd[h]||{},l=k.thumbfit||e.thumbfit,m=k.thumbposition||e.thumbposition;j.w=g.w,g.l+g.w<c||g.l>f||sc(g.$img,j,l,m)||b&&Pb([h],"navThumb",i,l,m)})}}function wc(a,b,c){if(!wc[c]){var f="nav"===c&&Od,g=0;b.append(a.filter(function(){for(var a,b=d(this),c=b.data(),e=0,f=yd.length;f>e;e++)if(c.data===yd[e]){a=!0,c.eq=e;break}return a||b.remove()&&!1}).sort(function(a,b){return d(a).data().eq-d(b).data().eq}).each(function(){if(f){var a=d(this),b=a.data(),c=Math.round(Ud*b.data.thumbratio)||Td;b.l=g,b.w=c,a.css({width:c}),g+=c+e.thumbmargin}})),wc[c]=!0}}function xc(a){return a-Se>Le.w/3}function yc(a){return!(Md||Je+a&&Je-zd+a||Cd)}function Gc(){var a=yc(0),b=yc(1);ue.toggleClass(Eb,a).attr(V(a)),ve.toggleClass(Eb,b).attr(V(b))}function Hc(){Ne.ok&&(Ne.prevent={"<":yc(0),">":yc(1)})}function Lc(a){var b,c,d=a.data();return Od?(b=d.l,c=d.w):(b=a.position().left,c=a.width()),{c:b+c/2,min:-b+10*e.thumbmargin,max:-b+Le.w-c-10*e.thumbmargin}}function Oc(a){var b=Dd[he].data();_(Ce,{time:1.2*a,pos:b.l,width:b.w-2*e.thumbborderwidth})}function Rc(a){var b=yd[a.guessIndex][he];if(b){var c=Oe.min!==Oe.max,d=a.minMax||c&&Lc(Dd[he]),e=c&&(a.keep&&Rc.l?Rc.l:h((a.coo||Le.nw/2)-Lc(b).c,d.min,d.max)),f=c&&h(e,Oe.min,Oe.max),g=1.1*a.time;_(ze,{time:g,pos:f||0,onEnd:function(){uc(f,!0)}}),ld(ye,K(f,Oe.min,Oe.max)),Rc.l=e}}function Tc(){_c(he),Qe[he].push(Dd[he].addClass(Wb))}function _c(a){for(var b=Qe[a];b.length;)b.shift().removeClass(Wb)}function bd(a){var b=Re[a];d.each(Ed,function(a,c){delete b[x(c)]}),d.each(b,function(a,c){delete b[a],c.detach()})}function cd(a){Fd=Gd=Je;var b=Dd[Xc];b&&(_c(Xc),Qe[Xc].push(b.addClass(Wb)),a||ie.show.onEnd(!0),v(se,0,!0),bd(Xc),tc(Ed),$(),bb())}function ed(a,b){a&&d.each(b,function(b,c){c&&d.extend(c,{width:a.width||c.width,height:a.height,minwidth:a.minwidth,maxwidth:a.maxwidth,minheight:a.minheight,maxheight:a.maxheight,ratio:S(a.ratio)})})}function fd(b,c){a.trigger(ib+":"+b,[ie,c])}function gd(){clearTimeout(hd.t),fe=1,e.stopautoplayontouch?ie.stopAutoplay():ce=!0}function hd(){e.stopautoplayontouch||(id(),jd()),hd.t=setTimeout(function(){fe=0},Qc+Pc)}function id(){ce=!(!Cd&&!de)}function jd(){if(clearTimeout(jd.t),G.stop(jd.w),!e.autoplay||ce)return void(ie.autoplay&&(ie.autoplay=!1,fd("stopautoplay")));ie.autoplay||(ie.autoplay=!0,fd("startautoplay"));var a=Je,b=Dd[Xc].data();jd.w=G(function(){return b.state||a!==Je},function(){jd.t=setTimeout(function(){if(!ce&&a===Je){var b=Kd,c=yd[b][Xc].data();jd.w=G(function(){return c.state||b!==Kd},function(){ce||b!==Kd||ie.show(Md?Z(!Yd):Kd)})}},e.autoplay)})}function kd(){ie.fullScreen&&(ie.fullScreen=!1,Kc&&vc.cancel(le),Dc.removeClass(jb),Cc.removeClass(jb),a.removeClass(Zb).insertAfter(pe),Le=d.extend({},ee),md(Cd,!0,!0),rd("x",!1),ie.resize(),Pb(Ed,"stage"),Q(Ec,ae,_d),fd("fullscreenexit"))}function ld(a,b){Xd&&(a.removeClass(Ub+" "+Vb),b&&!Cd&&a.addClass(b.replace(/^|\s/g," "+Tb+"--")))}function md(a,b,c){b&&(qe.removeClass(nb),Cd=!1,o()),a&&a!==Cd&&(a.remove(),fd("unloadvideo")),c&&(id(),jd())}function nd(a){qe.toggleClass(qb,a)}function od(a){if(!Me.flow){var b=a?a.pageX:od.x,c=b&&!yc(xc(b))&&e.click;od.p!==c&&re.toggleClass(Cb,c)&&(od.p=c,od.x=b)}}function pd(a){clearTimeout(pd.t),e.clicktransition&&e.clicktransition!==e.transition?setTimeout(function(){var b=e.transition;ie.setOptions({transition:e.clicktransition}),Wd=b,pd.t=setTimeout(function(){ie.show(a)},10)},0):ie.show(a)}function qd(a,b){var c=a.target,f=d(c);f.hasClass(mc)?ie.playVideo():c===Ee?ie.toggleFullScreen():Cd?c===He&&md(Cd,!0,!0):b?nd():e.click&&pd({index:a.shiftKey||Z(xc(a._x)),slow:a.altKey,user:!0})}function rd(a,b){Me[a]=Oe[a]=b}function sd(a){var b=d(this).data().eq;pd({index:b,slow:a.altKey,user:!0,coo:a._x-ye.offset().left})}function td(a){pd({index:we.index(this)?">":"<",slow:a.altKey,user:!0})}function ud(a){X(a,function(){setTimeout(function(){Q(re)},0),nd(!1)})}function vd(){if(m(),u(),!vd.i){vd.i=!0;var a=e.startindex;(a||e.hash&&c.hash)&&(Ld=L(a||c.hash.replace(/^#/,""),yd,0===ie.index||a,a)),Je=Fd=Gd=Hd=Ld=z(Ld)||0}if(zd){if(wd())return;Cd&&md(Cd,!0),Ed=[],bd(Xc),vd.ok=!0,ie.show({index:Je,time:0}),ie.resize()}else ie.destroy()}function wd(){return!wd.f===Yd?(wd.f=Yd,Je=zd-1-Je,ie.reverse(),!0):void 0}function xd(){xd.ok||(xd.ok=!0,fd("ready"))}Cc=d("html"),Dc=d("body");var yd,zd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Jd,Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,Yd,Zd,$d,_d,ae,be,ce,de,ee,fe,ge,he,ie=this,je=d.now(),ke=ib+je,le=a[0],me=1,ne=a.data(),oe=d("<style></style>"),pe=d(N(Yb)),qe=d(N(kb)),re=d(N(xb)).appendTo(qe),se=(re[0],d(N(Ab)).appendTo(re)),te=d(),ue=d(N(Db+" "+Fb+rc)),ve=d(N(Db+" "+Gb+rc)),we=ue.add(ve).appendTo(re),xe=d(N(Ib)),ye=d(N(Hb)).appendTo(xe),ze=d(N(Jb)).appendTo(ye),Ae=d(),Be=d(),Ce=(se.data(),ze.data(),d(N(jc)).appendTo(ze)),De=d(N($b+rc)),Ee=De[0],Fe=d(N(mc)),Ge=d(N(nc)).appendTo(re),He=Ge[0],Ie=d(N(qc)),Je=!1,Ke={},Le={},Me={},Ne={},Oe={},Pe={},Qe={},Re={},Se=0,Te=[];
qe[Xc]=d(N(yb)),qe[Zc]=d(N(Mb+" "+Ob+rc,N(ic))),qe[Yc]=d(N(Mb+" "+Nb+rc,N(hc))),Qe[Xc]=[],Qe[Zc]=[],Qe[Yc]=[],Re[Xc]={},qe.addClass(Ic?mb:lb).toggleClass(qb,!e.controlsonstart),ne.fotorama=this,ie.startAutoplay=function(a){return ie.autoplay?this:(ce=de=!1,t(a||e.autoplay),jd(),this)},ie.stopAutoplay=function(){return ie.autoplay&&(ce=de=!0,jd()),this},ie.show=function(a){var b;"object"!=typeof a?(b=a,a={}):b=a.index,b=">"===b?Gd+1:"<"===b?Gd-1:"<<"===b?0:">>"===b?zd-1:b,b=isNaN(b)?L(b,yd,!0):b,b="undefined"==typeof b?Je||0:b,ie.activeIndex=Je=z(b),Id=E(Je),Jd=U(Je),Kd=x(Je+(Yd?-1:1)),Ed=[Je,Id,Jd],Gd=Md?b:Je;var c=Math.abs(Hd-Gd),d=w(a.time,function(){return Math.min(Vd*(1+(c-1)/12),2*Vd)}),f=a.overPos;a.slow&&(d*=10);var g=Dd;ie.activeFrame=Dd=yd[Je];var i=g===Dd&&!a.user;md(Cd,Dd.i!==yd[x(Fd)].i),lc(Ed,"stage"),tc(Mc?[Gd]:[Gd,E(Gd),U(Gd)]),rd("go",!0),i||fd("show",{user:a.user,time:d}),ce=!0;var j=ie.show.onEnd=function(b){if(!j.ok){if(j.ok=!0,b||cd(!0),i||fd("showend",{user:a.user}),!b&&Wd&&Wd!==e.transition)return ie.setOptions({transition:Wd}),void(Wd=!1);Sb(),Pb(Ed,"stage"),rd("go",!1),Hc(),od(),id(),jd()}};if(Sd){var k=Dd[Xc],l=Je!==Hd?yd[Hd][Xc]:null;ab(k,l,te,{time:d,method:e.transition,onEnd:j},Te)}else _(se,{pos:-r(Gd,Le.w,e.margin,Fd),overPos:f,time:d,onEnd:j});if(Gc(),Nd){Tc();var m=y(Je+h(Gd-Hd,-1,1));Rc({time:d,coo:m!==Je&&a.coo,guessIndex:"undefined"!=typeof a.coo?m:Je,keep:i}),Od&&Oc(d)}return be="undefined"!=typeof Hd&&Hd!==Je,Hd=Je,e.hash&&be&&!ie.eq&&H(Dd.id||Je+1),this},ie.requestFullScreen=function(){return Qd&&!ie.fullScreen&&(_d=Ec.scrollTop(),ae=Ec.scrollLeft(),Q(Ec),rd("x",!0),ee=d.extend({},Le),a.addClass(Zb).appendTo(Dc.addClass(jb)),Cc.addClass(jb),md(Cd,!0,!0),ie.fullScreen=!0,Rd&&vc.request(le),ie.resize(),Pb(Ed,"stage"),Sb(),fd("fullscreenenter")),this},ie.cancelFullScreen=function(){return Rd&&vc.is()?vc.cancel(b):kd(),this},ie.toggleFullScreen=function(){return ie[(ie.fullScreen?"cancel":"request")+"FullScreen"]()},T(b,vc.event,function(){!yd||vc.is()||Cd||kd()}),ie.resize=function(a){if(!yd)return this;var b=arguments[1]||0,c=arguments[2];ed(ie.fullScreen?{width:"100%",maxwidth:null,minwidth:null,height:"100%",maxheight:null,minheight:null}:R(a),[Le,c||ie.fullScreen||e]);var d=Le.width,f=Le.height,g=Le.ratio,i=Ec.height()-(Nd?ye.height():0);return q(d)&&(qe.addClass(ub).css({width:d,minWidth:Le.minwidth||0,maxWidth:Le.maxwidth||ad}),d=Le.W=Le.w=qe.width(),Le.nw=Nd&&p(e.navwidth,d)||d,e.glimpse&&(Le.w-=Math.round(2*(p(e.glimpse,d)||0))),se.css({width:Le.w,marginLeft:(Le.W-Le.w)/2}),f=p(f,i),f=f||g&&d/g,f&&(d=Math.round(d),f=Le.h=Math.round(h(f,p(Le.minheight,i),p(Le.maxheight,i))),re.stop().animate({width:d,height:f},b,function(){qe.removeClass(ub)}),cd(),Nd&&(ye.stop().animate({width:Le.nw},b),Rc({guessIndex:Je,time:b,keep:!0}),Od&&wc.nav&&Oc(b)),$d=c||!0,xd())),Se=re.offset().left,this},ie.setOptions=function(a){return d.extend(e,a),vd(),this},ie.shuffle=function(){return yd&&O(yd)&&vd(),this},ie.destroy=function(){return ie.cancelFullScreen(),ie.stopAutoplay(),yd=ie.data=null,j(),Ed=[],bd(Xc),vd.ok=!1,this},ie.playVideo=function(){var a=Dd,b=a.video,c=Je;return"object"==typeof b&&a.videoReady&&(Rd&&ie.fullScreen&&ie.cancelFullScreen(),G(function(){return!vc.is()||c!==Je},function(){c===Je&&(a.$video=a.$video||d(d.Fotorama.jst.video(b)),a.$video.appendTo(a[Xc]),qe.addClass(nb),Cd=a.$video,o(),we.blur(),De.blur(),fd("loadvideo"))})),this},ie.stopVideo=function(){return md(Cd,!0,!0),this},re.on("mousemove",od),Me=db(se,{onStart:gd,onMove:function(a,b){ld(re,b.edge)},onTouchEnd:hd,onEnd:function(a){ld(re);var b=(Nc&&!ge||a.touch)&&e.arrows&&"always"!==e.arrows;if(a.moved||b&&a.pos!==a.newPos&&!a.control){var c=s(a.newPos,Le.w,e.margin,Fd);ie.show({index:c,time:Sd?Vd:a.time,overPos:a.overPos,user:!0})}else a.aborted||a.control||qd(a.startEvent,b)},timeLow:1,timeHigh:1,friction:2,select:"."+Xb+", ."+Xb+" *",$wrap:re}),Oe=db(ze,{onStart:gd,onMove:function(a,b){ld(ye,b.edge)},onTouchEnd:hd,onEnd:function(a){function b(){Rc.l=a.newPos,id(),jd(),uc(a.newPos,!0)}if(a.moved)a.pos!==a.newPos?(ce=!0,_(ze,{time:a.time,pos:a.newPos,overPos:a.overPos,onEnd:b}),uc(a.newPos),Xd&&ld(ye,K(a.newPos,Oe.min,Oe.max))):b();else{var c=a.$target.closest("."+Mb,ze)[0];c&&sd.call(c,a.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:ye}),Ne=eb(re,{shift:!0,onEnd:function(a,b){gd(),hd(),ie.show({index:b,slow:a.altKey})}}),Pe=eb(ye,{onEnd:function(a,b){gd(),hd();var c=v(ze)+.25*b;ze.css(k(h(c,Oe.min,Oe.max))),Xd&&ld(ye,K(c,Oe.min,Oe.max)),Pe.prevent={"<":c>=Oe.max,">":c<=Oe.min},clearTimeout(Pe.t),Pe.t=setTimeout(function(){Rc.l=c,uc(c,!0)},Pc),uc(c)}}),qe.hover(function(){setTimeout(function(){fe||nd(!(ge=!0))},0)},function(){ge&&nd(!(ge=!1))}),M(we,function(a){Y(a),td.call(this,a)},{onStart:function(){gd(),Me.control=!0},onTouchEnd:hd}),we.each(function(){W(this,function(a){td.call(this,a)}),ud(this)}),W(Ee,ie.toggleFullScreen),ud(Ee),d.each("load push pop shift unshift reverse sort splice".split(" "),function(a,b){ie[b]=function(){return yd=yd||[],"load"!==b?Array.prototype[b].apply(yd,arguments):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].length&&(yd=P(arguments[0])),vd(),ie}}),vd()},d.fn.fotorama=function(b){return this.each(function(){var c=this,e=d(this),f=e.data(),g=f.fotorama;g?g.setOptions(b,!0):G(function(){return!E(c)},function(){f.urtext=e.html(),new d.Fotorama(e,d.extend({},cd,a.fotoramaDefaults,b,f))})})},d.Fotorama.instances=[],d.Fotorama.cache={},d.Fotorama.measures={},d=d||{},d.Fotorama=d.Fotorama||{},d.Fotorama.jst=d.Fotorama.jst||{},d.Fotorama.jst.style=function(a){{var b,c="";tc.escape}return c+=".fotorama"+(null==(b=a.s)?"":b)+" .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:"+(null==(b=a.m)?"":b)+"px;\nheight:"+(null==(b=a.h)?"":b)+"px}\n.fotorama"+(null==(b=a.s)?"":b)+" .fotorama__thumb-border{\nheight:"+(null==(b=a.h-a.b*(a.q?0:2))?"":b)+"px;\nborder-width:"+(null==(b=a.b)?"":b)+"px;\nmargin-top:"+(null==(b=a.m)?"":b)+"px}"},d.Fotorama.jst.video=function(a){function b(){c+=d.call(arguments,"")}var c="",d=(tc.escape,Array.prototype.join);return c+='<div class="fotorama__video"><iframe src="',b(("youtube"==a.type?a.p+"youtube.com/embed/"+a.id+"?autoplay=1":"vimeo"==a.type?a.p+"player.vimeo.com/video/"+a.id+"?autoplay=1&badge=0":a.id)+(a.s&&"custom"!=a.type?"&"+a.s:"")),c+='" frameborder="0" allowfullscreen></iframe></div>\n'},d(function(){d("."+ib+':not([data-auto="false"])').fotorama(),"http://"===y()&&c.host.match(/\./)&&!a.blockFotoramaData&&d("body").append('<iframe src="http://data.fotorama.io/?version='+fotoramaVersion+'" style="display: none;"></iframe>')})}(window,document,location,"undefined"!=typeof jQuery&&jQuery);
!function(){var e=new Date("2011-06-02T09:34:29+02:00");e&&1307000069e3===+e?Date.fromISO=function(e){return new Date(e)}:Date.fromISO=function(e){var t,n,a=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,r=a.exec(e)||[];if(r[1]){t=r[1].split(/\D/);for(var d=0,D=t.length;D>d;d++)t[d]=parseInt(t[d],10)||0;return t[1]-=1,t=new Date(Date.UTC.apply(Date,t)),t.getDate()?(r[5]&&(n=60*parseInt(r[5],10),r[6]&&(n+=parseInt(r[6],10)),"+"==r[4]&&(n*=-1),n&&t.setUTCMinutes(t.getUTCMinutes()+n)),t):NaN}return NaN}}();
window.ParsleyConfig={errorsWrapper:'<div class="error-message secondary-text" data-message=""></div>',errorTemplate:'<div class="error-message secondary-text" data-message=""></div>',errorClass:"error",successClass:"valid",excluded:'input[type=button], input[type=submit], input[type=reset], input[type=hidden], .form-group:has(input[type="password"]) .placeholder, .picker select, #endless, textarea.mention',inputs:"input, textarea, select, .js-uploading-component, .date-range, .js-author-manage, .mention-input",classHandler:function(r){return r.$element.closest(".form-group")},errorsContainer:function(r){return r.$element.closest(".form-group")},utils:{parseDate:function(r){if(r.indexOf("-")>0){var t=Date.fromISO(r);return t.setHours(0,0,0,0),t}var e=/(\d{2})\/(\d{2})\/(\d{4})/.exec(r);return new Date(e[3],e[2]-1,e[1],0,0,0)},parseTime:function(r){var t={},e=r.split(":");return e[0]?t.h=e[0]:t.h=0,e[1]?t.m=e[1]:t.m=0,t},parseDateTime:function(r,t){var e=this.parseTime(t),u=this.parseDate(r);return u.setHours(e.h,e.m,0,0),u}},validators:{maxdate:{fn:function(r,t){var e=window.ParsleyConfig.utils.parseDate(r),u=Date.fromISO(t);return u.setHours(0,0,0,0),u>=e},priority:32},mindate:{fn:function(r,t){var e=window.ParsleyConfig.utils.parseDate(r),u=Date.fromISO(t);return u.setHours(0,0,0,0),e>=u},priority:32},daterange:{fn:function(r,t){var e=window.ParsleyConfig.utils.parseDateTime($(t[0]).val(),$(t[1]).val()),u=window.ParsleyConfig.utils.parseDateTime($(t[2]).val(),$(t[3]).val());return logger.debug("daterange: ",e," - ",u),u>e},priority:32},richtextrequired:{fn:function(r){var t=/<(div|span|p|br|li|ol|ul|h.|blockquote|b|i|u|strong|em)( [^>]*)?>|<\/(div|span|p|br|li|ol|ul|h.|blockquote|b|i|u|strong|em)>|&nbsp;|\s/gi;return r.replace(t,"").length>0},priority:32},uploading:{fn:function(r){return"uploading"!==r},priority:32},hashtag:{fn:function(r){var t=XRegExp("#[\\pL\\pN]*[\\pL][\\pL\\pN]*","gi");return t.test(r)},priority:32},blogcategory:{fn:function(r,t){var e=new RegExp("^("+t.split(",").join("|")+")$","i");return!e.test(r)},priority:32},urlstrict:{fn:function(r){var t=/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;return""!==r?t.test(r):!1},priority:32},menuurl:{fn:function(r){var t=/^\/[-a-zA-Z0-9@:%_\\+.~#?&//=]*$/i;if(""===r)return!0;try{ParsleyValidator.validators.type("url").validate(r)}catch(e){return t.test(r)}return!0},priority:32},requiredwith:{fn:function(r,t){try{ParsleyValidator.validators.required().validate($(t).val())}catch(e){return!0}try{ParsleyValidator.validators.required().validate(r)}catch(e){return!1}return!0},priority:32},innerrequired:{fn:function(r,t){if($(t)[0].checked)try{ParsleyValidator.validators.required().validate(r)}catch(e){return!1}return!0},priority:32},mentionmax:{fn:function(r,t){var e=r.split(/\n/).length-1;return r.length+e<=t},priority:32},ualphanum:{fn:function(r){var t=XRegExp("^[\\pL\\pN]*$","gi");return t.test(r)},priority:32},ulowercase:{fn:function(r){if(!r)return!0;var t=XRegExp("\\p{Lowercase_Letter}");return t.test(r)},priority:29},uuppercase:{fn:function(r){if(!r)return!0;var t=XRegExp("\\p{Uppercase_Letter}");return t.test(r)},priority:29},udigit:{fn:function(r){if(!r)return!0;var t=XRegExp("\\p{Number}");return t.test(r)},priority:29},uspecialchar:{fn:function(r){if(!r)return!0;var t=XRegExp("[^\\pL\\pN]");return t.test(r)},priority:29},uniquecharacters:{fn:function(r){if(!r)return!0;var t=/^(?:(.)(?!\1.*))+$/g;return t.test(r)},priority:31},minlengthifnotempty:{fn:function(r,t){if(!r)return!0;try{ParsleyValidator.validators.minlength(t).validate(r)}catch(e){return!1}return!0},priority:31},unique:{fn:function(r,t){return $(t).filter(function(){return this.value===r}).length>1?!1:!0},priority:32}}};
/*!
* Parsleyjs
* Guillaume Potier - <guillaume@wisembly.com>
* Version 2.0.0 - built Sat Apr 19 2014 17:31:23
* MIT Licensed
*
*/
!function(a){var b={attr:function(a,b,c){var d,e={},f=new RegExp("^"+b,"i");if("undefined"==typeof a||"undefined"==typeof a[0])return{};for(var g in a[0].attributes)if(d=a[0].attributes[g],"undefined"!=typeof d&&null!==d&&d.specified&&f.test(d.name)){if("undefined"!=typeof c&&new RegExp(c+"$","i").test(d.name))return!0;e[this.camelize(d.name.replace(b,""))]=this.deserializeValue(d.value)}return"undefined"==typeof c?e:!1},setAttr:function(a,b,c,d){a[0].setAttribute(this.dasherize(b+c),String(d))},get:function(a,b){for(var c=0,d=(b||"").split(".");this.isObject(a)||this.isArray(a);)if(a=a[d[c++]],c===d.length)return a;return void 0},hash:function(a){return String(Math.random()).substring(2,a?a+2:9)},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isObject:function(a){return a===Object(a)},deserializeValue:function(b){var c;try{return b?"true"==b||("false"==b?!1:"null"==b?null:isNaN(c=Number(b))?/^[\[\{]/.test(b)?a.parseJSON(b):b:c):b}catch(d){return b}},camelize:function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},dasherize:function(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}},c={namespace:"data-parsley-",inputs:"input, textarea, select",excluded:"input[type=button], input[type=submit], input[type=reset], input[type=hidden]",priorityEnabled:!0,uiEnabled:!0,validationThreshold:3,focus:"first",trigger:!1,errorClass:"parsley-error",successClass:"parsley-success",classHandler:function(){},errorsContainer:function(){},errorsWrapper:'<ul class="parsley-errors-list"></ul>',errorTemplate:"<li></li>"},d=function(){};d.prototype={asyncSupport:!1,actualizeOptions:function(){return this.options=this.OptionsFactory.get(this),this},validateThroughValidator:function(a,b,c){return window.ParsleyValidator.validate.apply(window.ParsleyValidator,[a,b,c])},subscribe:function(b,c){return a.listenTo(this,b.toLowerCase(),c),this},unsubscribe:function(b){return a.unsubscribeTo(this,b.toLowerCase()),this},reset:function(){if("ParsleyForm"!==this.__class__)return a.emit("parsley:field:reset",this);for(var b=0;b<this.fields.length;b++)a.emit("parsley:field:reset",this.fields[b]);a.emit("parsley:form:reset",this)},destroy:function(){if("ParsleyForm"!==this.__class__)return this.$element.removeData("Parsley"),this.$element.removeData("ParsleyFieldMultiple"),void a.emit("parsley:field:destroy",this);for(var b=0;b<this.fields.length;b++)this.fields[b].destroy();this.$element.removeData("Parsley"),a.emit("parsley:form:destroy",this)}},function(a){var b=function(a){return this.__class__="Validator",this.__version__="0.5.8",this.options=a||{},this.bindingKey=this.options.bindingKey||"_validatorjsConstraint",this};b.prototype={constructor:b,validate:function(a,b,c){if("string"!=typeof a&&"object"!=typeof a)throw new Error("You must validate an object or a string");return"string"==typeof a||g(a)?this._validateString(a,b,c):this.isBinded(a)?this._validateBindedObject(a,b):this._validateObject(a,b,c)},bind:function(a,b){if("object"!=typeof a)throw new Error("Must bind a Constraint to an object");return a[this.bindingKey]=new c(b),this},unbind:function(a){return"undefined"==typeof a._validatorjsConstraint?this:(delete a[this.bindingKey],this)},isBinded:function(a){return"undefined"!=typeof a[this.bindingKey]},getBinded:function(a){return this.isBinded(a)?a[this.bindingKey]:null},_validateString:function(a,b,c){var f,h=[];g(b)||(b=[b]);for(var i=0;i<b.length;i++){if(!(b[i]instanceof e))throw new Error("You must give an Assert or an Asserts array to validate a string");f=b[i].check(a,c),f instanceof d&&h.push(f)}return h.length?h:!0},_validateObject:function(a,b,d){if("object"!=typeof b)throw new Error("You must give a constraint to validate an object");return b instanceof c?b.check(a,d):new c(b).check(a,d)},_validateBindedObject:function(a,b){return a[this.bindingKey].check(a,b)}},b.errorCode={must_be_a_string:"must_be_a_string",must_be_an_array:"must_be_an_array",must_be_a_number:"must_be_a_number",must_be_a_string_or_array:"must_be_a_string_or_array"};var c=function(a,b){if(this.__class__="Constraint",this.options=b||{},this.nodes={},a)try{this._bootstrap(a)}catch(c){throw new Error("Should give a valid mapping object to Constraint",c,a)}return this};c.prototype={constructor:c,check:function(a,b){var c,d={};for(var h in this.options.strict?this.nodes:a)if(this.options.strict?this.has(h,a):this.has(h))c=this._check(h,a[h],b),(g(c)&&c.length>0||!g(c)&&!f(c))&&(d[h]=c);else if(this.options.strict)try{(new e).HaveProperty(h).validate(a)}catch(i){d[h]=i}return f(d)?!0:d},add:function(a,b){if(b instanceof e||g(b)&&b[0]instanceof e)return this.nodes[a]=b,this;if("object"==typeof b&&!g(b))return this.nodes[a]=b instanceof c?b:new c(b),this;throw new Error("Should give an Assert, an Asserts array, a Constraint",b)},has:function(a,b){return b="undefined"!=typeof b?b:this.nodes,"undefined"!=typeof b[a]},get:function(a,b){return this.has(a)?this.nodes[a]:b||null},remove:function(a){var b=[];for(var c in this.nodes)c!==a&&(b[c]=this.nodes[c]);return this.nodes=b,this},_bootstrap:function(a){if(a instanceof c)return this.nodes=a.nodes;for(var b in a)this.add(b,a[b])},_check:function(a,b,d){if(this.nodes[a]instanceof e)return this._checkAsserts(b,[this.nodes[a]],d);if(g(this.nodes[a]))return this._checkAsserts(b,this.nodes[a],d);if(this.nodes[a]instanceof c)return this.nodes[a].check(b,d);throw new Error("Invalid node",this.nodes[a])},_checkAsserts:function(a,b,c){for(var d,e=[],f=0;f<b.length;f++)d=b[f].check(a,c),"undefined"!=typeof d&&!0!==d&&e.push(d);return e}};var d=function(a,b,c){if(this.__class__="Violation",!(a instanceof e))throw new Error("Should give an assertion implementing the Assert interface");this.assert=a,this.value=b,"undefined"!=typeof c&&(this.violation=c)};d.prototype={show:function(){var a={assert:this.assert.__class__,value:this.value};return this.violation&&(a.violation=this.violation),a},__toString:function(){return"undefined"!=typeof this.violation&&(this.violation='", '+this.getViolation().constraint+" expected was "+this.getViolation().expected),this.assert.__class__+' assert failed for "'+this.value+this.violation||""},getViolation:function(){var a,b;for(a in this.violation)b=this.violation[a];return{constraint:a,expected:b}}};var e=function(a){return this.__class__="Assert",this.__parentClass__=this.__class__,this.groups=[],"undefined"!=typeof a&&this.addGroup(a),this};e.prototype={construct:e,check:function(a,b){if(!(b&&!this.hasGroup(b)||!b&&this.hasGroups()))try{return this.validate(a,b)}catch(c){return c}},hasGroup:function(a){return g(a)?this.hasOneOf(a):"Any"===a?!0:this.hasGroups()?-1!==this.groups.indexOf(a):"Default"===a},hasOneOf:function(a){for(var b=0;b<a.length;b++)if(this.hasGroup(a[b]))return!0;return!1},hasGroups:function(){return this.groups.length>0},addGroup:function(a){return g(a)?this.addGroups(a):(this.hasGroup(a)||this.groups.push(a),this)},removeGroup:function(a){for(var b=[],c=0;c<this.groups.length;c++)a!==this.groups[c]&&b.push(this.groups[c]);return this.groups=b,this},addGroups:function(a){for(var b=0;b<a.length;b++)this.addGroup(a[b]);return this},HaveProperty:function(a){return this.__class__="HaveProperty",this.node=a,this.validate=function(a){if("undefined"==typeof a[this.node])throw new d(this,a,{value:this.node});return!0},this},Blank:function(){return this.__class__="Blank",this.validate=function(a){if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(""!==a.replace(/^\s+/g,"").replace(/\s+$/g,""))throw new d(this,a);return!0},this},Callback:function(a){if(this.__class__="Callback",this.arguments=Array.prototype.slice.call(arguments),1===this.arguments.length?this.arguments=[]:this.arguments.splice(0,1),"function"!=typeof a)throw new Error("Callback must be instanciated with a function");return this.fn=a,this.validate=function(a){var b=this.fn.apply(this,[a].concat(this.arguments));if(!0!==b)throw new d(this,a,{result:b});return!0},this},Choice:function(a){if(this.__class__="Choice",!g(a)&&"function"!=typeof a)throw new Error("Choice must be instanciated with an array or a function");return this.list=a,this.validate=function(a){for(var b="function"==typeof this.list?this.list():this.list,c=0;c<b.length;c++)if(a===b[c])return!0;throw new d(this,a,{choices:b})},this},Collection:function(a){return this.__class__="Collection",this.constraint="undefined"!=typeof a?new c(a):!1,this.validate=function(a,c){var e,h=new b,i=0,j={},k=this.groups.length?this.groups:c;if(!g(a))throw new d(this,array,{value:b.errorCode.must_be_an_array});for(var l=0;l<a.length;l++)e=this.constraint?h.validate(a[l],this.constraint,k):h.validate(a[l],k),f(e)||(j[i]=e),i++;return f(j)?!0:j},this},Count:function(a){return this.__class__="Count",this.count=a,this.validate=function(a){if(!g(a))throw new d(this,a,{value:b.errorCode.must_be_an_array});var c="function"==typeof this.count?this.count(a):this.count;if(isNaN(Number(c)))throw new Error("Count must be a valid interger",c);if(c!==a.length)throw new d(this,a,{count:c});return!0},this},Email:function(){return this.__class__="Email",this.validate=function(a){var c=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(!c.test(a))throw new d(this,a);return!0},this},Eql:function(a){if(this.__class__="Eql","undefined"==typeof a)throw new Error("Equal must be instanciated with an Array or an Object");return this.eql=a,this.validate=function(a){var b="function"==typeof this.eql?this.eql(a):this.eql;if(!h.eql(b,a))throw new d(this,a,{eql:b});return!0},this},EqualTo:function(a){if(this.__class__="EqualTo","undefined"==typeof a)throw new Error("EqualTo must be instanciated with a value or a function");return this.reference=a,this.validate=function(a){var b="function"==typeof this.reference?this.reference(a):this.reference;if(b!==a)throw new d(this,a,{value:b});return!0},this},GreaterThan:function(a){if(this.__class__="GreaterThan","undefined"==typeof a)throw new Error("Should give a threshold value");return this.threshold=a,this.validate=function(a){if(""===a||isNaN(Number(a)))throw new d(this,a,{value:b.errorCode.must_be_a_number});if(this.threshold>=a)throw new d(this,a,{threshold:this.threshold});return!0},this},GreaterThanOrEqual:function(a){if(this.__class__="GreaterThanOrEqual","undefined"==typeof a)throw new Error("Should give a threshold value");return this.threshold=a,this.validate=function(a){if(""===a||isNaN(Number(a)))throw new d(this,a,{value:b.errorCode.must_be_a_number});if(this.threshold>a)throw new d(this,a,{threshold:this.threshold});return!0},this},InstanceOf:function(a){if(this.__class__="InstanceOf","undefined"==typeof a)throw new Error("InstanceOf must be instanciated with a value");return this.classRef=a,this.validate=function(a){if(!0!=a instanceof this.classRef)throw new d(this,a,{classRef:this.classRef});return!0},this},IPv4:function(){return this.__class__="IPv4",this.validate=function(a){var c=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(!c.test(a))throw new d(this,a);return!0},this},Length:function(a){if(this.__class__="Length",!a.min&&!a.max)throw new Error("Lenth assert must be instanciated with a { min: x, max: y } object");return this.min=a.min,this.max=a.max,this.validate=function(a){if("string"!=typeof a&&!g(a))throw new d(this,a,{value:b.errorCode.must_be_a_string_or_array});if("undefined"!=typeof this.min&&this.min===this.max&&a.length!==this.min)throw new d(this,a,{min:this.min,max:this.max});if("undefined"!=typeof this.max&&a.length>this.max)throw new d(this,a,{max:this.max});if("undefined"!=typeof this.min&&a.length<this.min)throw new d(this,a,{min:this.min});return!0},this},LessThan:function(a){if(this.__class__="LessThan","undefined"==typeof a)throw new Error("Should give a threshold value");return this.threshold=a,this.validate=function(a){if(""===a||isNaN(Number(a)))throw new d(this,a,{value:b.errorCode.must_be_a_number});if(this.threshold<=a)throw new d(this,a,{threshold:this.threshold});return!0},this},LessThanOrEqual:function(a){if(this.__class__="LessThanOrEqual","undefined"==typeof a)throw new Error("Should give a threshold value");return this.threshold=a,this.validate=function(a){if(""===a||isNaN(Number(a)))throw new d(this,a,{value:b.errorCode.must_be_a_number});if(this.threshold<a)throw new d(this,a,{threshold:this.threshold});return!0},this},Mac:function(){return this.__class__="Mac",this.validate=function(a){var c=/^(?:[0-9A-F]{2}:){5}[0-9A-F]{2}$/i;if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(!c.test(a))throw new d(this,a);return!0},this},NotNull:function(){return this.__class__="NotNull",this.validate=function(a){if(null===a||"undefined"==typeof a)throw new d(this,a);return!0},this},NotBlank:function(){return this.__class__="NotBlank",this.validate=function(a){if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(""===a.replace(/^\s+/g,"").replace(/\s+$/g,""))throw new d(this,a);return!0},this},Null:function(){return this.__class__="Null",this.validate=function(a){if(null!==a)throw new d(this,a);return!0},this},Range:function(a,b){if(this.__class__="Range","undefined"==typeof a||"undefined"==typeof b)throw new Error("Range assert expects min and max values");return this.min=a,this.max=b,this.validate=function(a){try{return"string"==typeof a&&isNaN(Number(a))||g(a)?(new e).Length({min:this.min,max:this.max}).validate(a):(new e).GreaterThanOrEqual(this.min).validate(a)&&(new e).LessThanOrEqual(this.max).validate(a),!0}catch(b){throw new d(this,a,b.violation)}return!0},this},Regexp:function(a,c){if(this.__class__="Regexp","undefined"==typeof a)throw new Error("You must give a regexp");return this.regexp=a,this.flag=c||"",this.validate=function(a){if("string"!=typeof a)throw new d(this,a,{value:b.errorCode.must_be_a_string});if(!new RegExp(this.regexp,this.flag).test(a))throw new d(this,a,{regexp:this.regexp,flag:this.flag});return!0},this},Required:function(){return this.__class__="Required",this.validate=function(a){if("undefined"==typeof a)throw new d(this,a);try{"string"==typeof a?(new e).NotNull().validate(a)&&(new e).NotBlank().validate(a):!0===g(a)&&(new e).Length({min:1}).validate(a)}catch(b){throw new d(this,a)}return!0},this},Unique:function(a){return this.__class__="Unique","object"==typeof a&&(this.key=a.key),this.validate=function(a){var c,e=[];if(!g(a))throw new d(this,a,{value:b.errorCode.must_be_an_array});for(var f=0;f<a.length;f++)if(c="object"==typeof a[f]?a[f][this.key]:a[f],"undefined"!=typeof c){if(-1!==e.indexOf(c))throw new d(this,a,{value:c});e.push(c)}return!0},this}},a.Assert=e,a.Validator=b,a.Violation=d,a.Constraint=c,Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var f=function(a){for(var b in a)return!1;return!0},g=function(a){return"[object Array]"===Object.prototype.toString.call(a)},h={eql:function(a,b){if(a===b)return!0;if("undefined"!=typeof Buffer&&Buffer.isBuffer(a)&&Buffer.isBuffer(b)){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():"object"!=typeof a&&"object"!=typeof b?a==b:this.objEquiv(a,b)},isUndefinedOrNull:function(a){return null===a||"undefined"==typeof a},isArguments:function(a){return"[object Arguments]"==Object.prototype.toString.call(a)},keys:function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},objEquiv:function(a,b){if(this.isUndefinedOrNull(a)||this.isUndefinedOrNull(b))return!1;if(a.prototype!==b.prototype)return!1;if(this.isArguments(a))return this.isArguments(b)?eql(pSlice.call(a),pSlice.call(b)):!1;try{var c,d,e=this.keys(a),f=this.keys(b);if(e.length!==f.length)return!1;for(e.sort(),f.sort(),d=e.length-1;d>=0;d--)if(e[d]!=f[d])return!1;for(d=e.length-1;d>=0;d--)if(c=e[d],!this.eql(a[c],b[c]))return!1;return!0}catch(g){return!1}}};"function"==typeof define&&define.amd&&define("validator",[],function(){return a})}("undefined"==typeof exports?this["undefined"!=typeof validatorjs_ns?validatorjs_ns:"Validator"]={}:exports);var e=function(a,b){this.__class__="ParsleyValidator",this.Validator=Validator,this.locale="en",this.init(a||{},b||{})};e.prototype={init:function(b,c){this.catalog=c;for(var d in b)this.addValidator(d,b[d].fn,b[d].priority);a.emit("parsley:validator:init")},setLocale:function(a){if("undefined"==typeof this.catalog[a])throw new Error(a+" is not available in the catalog");return this.locale=a,this},addCatalog:function(a,b,c){return"object"==typeof b&&(this.catalog[a]=b),!0===c?this.setLocale(a):this},addMessage:function(a,b,c){return void 0===typeof this.catalog[a]&&(this.catalog[a]={}),this.catalog[a][b.toLowerCase()]=c,this},validate:function(){return(new this.Validator.Validator).validate.apply(new Validator.Validator,arguments)},addValidator:function(b,c,d){return this.validators[b.toLowerCase()]=function(b){return a.extend((new Validator.Assert).Callback(c,b),{priority:d})},this},updateValidator:function(a,b,c){return addValidator(a,b,c)},removeValidator:function(a){return delete this.validators[a],this},getErrorMessage:function(a){var b;return b="type"===a.name?this.catalog[this.locale][a.name][a.requirements]:this.formatMessage(this.catalog[this.locale][a.name],a.requirements),""!==b?b:this.catalog[this.locale].defaultMessage},formatMessage:function(a,b){if("object"==typeof b){for(var c in b)a=this.formatMessage(a,b[c]);return a}return"string"==typeof a?a.replace(new RegExp("%s","i"),b):""},validators:{notblank:function(){return a.extend((new Validator.Assert).NotBlank(),{priority:2})},required:function(){return a.extend((new Validator.Assert).Required(),{priority:512})},type:function(b){var c;switch(b){case"email":c=(new Validator.Assert).Email();break;case"number":c=(new Validator.Assert).Regexp("^-?(?:\\d+|\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$");break;case"integer":c=(new Validator.Assert).Regexp("^-?\\d+$");break;case"digits":c=(new Validator.Assert).Regexp("^\\d+$");break;case"alphanum":c=(new Validator.Assert).Regexp("^\\w+$","i");break;case"url":c=(new Validator.Assert).Regexp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;default:throw new Error("validator type `"+b+"` is not supported")}return a.extend(c,{priority:256})},pattern:function(b){var c="";return/^\/.*\/(?:[gimy]*)$/.test(b)&&(c=b.replace(/.*\/([gimy]*)$/,"$1"),b=b.replace(new RegExp("^/(.*?)/"+c+"$"),"$1")),a.extend((new Validator.Assert).Regexp(b,c),{priority:64})},minlength:function(b){return a.extend((new Validator.Assert).Length({min:b}),{priority:30,requirementsTransformer:function(){return"string"!=typeof b||isNaN(b)?b:parseInt(b,10)}})},maxlength:function(b){return a.extend((new Validator.Assert).Length({max:b}),{priority:30,requirementsTransformer:function(){return"string"!=typeof b||isNaN(b)?b:parseInt(b,10)}})},length:function(b){return a.extend((new Validator.Assert).Length({min:b[0],max:b[1]}),{priority:32})},mincheck:function(a){return this.minlength(a)},maxcheck:function(a){return this.maxlength(a)},check:function(a){return this.length(a)},min:function(b){return a.extend((new Validator.Assert).GreaterThanOrEqual(b),{priority:30,requirementsTransformer:function(){return"string"!=typeof b||isNaN(b)?b:parseInt(b,10)}})},max:function(b){return a.extend((new Validator.Assert).LessThanOrEqual(b),{priority:30,requirementsTransformer:function(){return"string"!=typeof b||isNaN(b)?b:parseInt(b,10)}})},range:function(b){return a.extend((new Validator.Assert).Range(b[0],b[1]),{priority:32,requirementsTransformer:function(){for(var a=0;a<b.length;a++)b[a]="string"!=typeof b[a]||isNaN(b[a])?b[a]:parseInt(b[a],10);return b}})},equalto:function(b){return a.extend((new Validator.Assert).EqualTo(b),{priority:256,requirementsTransformer:function(){return a(b).length?a(b).val():b}})}}};var f=function(){this.__class__="ParsleyUI"};f.prototype={listen:function(){return a.listen("parsley:form:init",this,this.setupForm),a.listen("parsley:field:init",this,this.setupField),a.listen("parsley:field:validated",this,this.reflow),a.listen("parsley:form:validated",this,this.focus),a.listen("parsley:field:reset",this,this.reset),a.listen("parsley:form:destroy",this,this.destroy),a.listen("parsley:field:destroy",this,this.destroy),this},reflow:function(a){if("undefined"!=typeof a._ui&&!1!==a._ui.active){var b=this._diff(a.validationResult,a._ui.lastValidationResult);a._ui.lastValidationResult=a.validationResult,a._ui.validatedOnce=!0,this.manageStatusClass(a),this.manageErrorsMessages(a,b),this.actualizeTriggers(a),(b.kept.length||b.added.length)&&"undefined"==typeof a._ui.failedOnce&&this.manageFailingFieldTrigger(a)}},getErrorsMessages:function(a){if(!0===a.validationResult)return[];for(var b=[],c=0;c<a.validationResult.length;c++)b.push(this._getErrorMessage(a,a.validationResult[c].assert));return b},manageStatusClass:function(a){!0===a.validationResult?this._successClass(a):a.validationResult.length>0?this._errorClass(a):this._resetClass(a)},manageErrorsMessages:function(b,c){if("undefined"==typeof b.options.errorsMessagesDisabled){if("undefined"!=typeof b.options.errorMessage)return c.added.length||c.kept.length?(0===b._ui.$errorsWrapper.find(".parsley-custom-error-message").length&&b._ui.$errorsWrapper.append(a(b.options.errorTemplate).addClass("parsley-custom-error-message")),b._ui.$errorsWrapper.addClass("filled").find(".parsley-custom-error-message").html(b.options.errorMessage)):b._ui.$errorsWrapper.removeClass("filled").find(".parsley-custom-error-message").remove();for(var d=0;d<c.removed.length;d++)this.removeError(b,c.removed[d].assert.name,!0);for(d=0;d<c.added.length;d++)this.addError(b,c.added[d].assert.name,void 0,c.added[d].assert,!0);for(d=0;d<c.kept.length;d++)this.updateError(b,c.kept[d].assert.name,void 0,c.kept[d].assert,!0)}},addError:function(b,c,d,e,f){b._ui.$errorsWrapper.addClass("filled").append(a(b.options.errorTemplate).addClass("parsley-"+c).html(d||this._getErrorMessage(b,e))),!0!==f&&this._errorClass(b)},updateError:function(a,b,c,d,e){a._ui.$errorsWrapper.addClass("filled").find(".parsley-"+b).html(c||this._getErrorMessage(a,d)),!0!==e&&this._errorClass(a)},removeError:function(a,b,c){a._ui.$errorsWrapper.removeClass("filled").find(".parsley-"+b).remove(),!0!==c&&this.manageStatusClass(a)},focus:function(a){if(!0===a.validationResult||"none"===a.options.focus)return a._focusedField=null;a._focusedField=null;for(var b=0;b<a.fields.length;b++)if(!0!==a.fields[b].validationResult&&a.fields[b].validationResult.length>0&&"undefined"==typeof a.fields[b].options.noFocus){if("first"===a.options.focus)return a._focusedField=a.fields[b].$element,a._focusedField.focus();a._focusedField=a.fields[b].$element}return null===a._focusedField?null:a._focusedField.focus()},_getErrorMessage:function(a,b){var c=b.name+"Message";return"undefined"!=typeof a.options[c]?window.ParsleyValidator.formatMessage(a.options[c],b.requirements):window.ParsleyValidator.getErrorMessage(b)},_diff:function(a,b,c){for(var d=[],e=[],f=0;f<a.length;f++){for(var g=!1,h=0;h<b.length;h++)if(a[f].assert.name===b[h].assert.name){g=!0;break}g?e.push(a[f]):d.push(a[f])}return{kept:e,added:d,removed:c?[]:this._diff(b,a,!0).added}},setupForm:function(b){b.$element.on("submit.Parsley",!1,a.proxy(b.onSubmitValidate,b)),!1!==b.options.uiEnabled&&b.$element.attr("novalidate","")},setupField:function(b){var c={active:!1};!1!==b.options.uiEnabled&&(c.active=!0,b.$element.attr(b.options.namespace+"id",b.__id__),c.$errorClassHandler=this._manageClassHandler(b),c.errorsWrapperId="parsley-id-"+("undefined"!=typeof b.options.multiple?"multiple-"+b.options.multiple:b.__id__),c.$errorsWrapper=a(b.options.errorsWrapper).attr("id",c.errorsWrapperId),c.lastValidationResult=[],c.validatedOnce=!1,c.validationInformationVisible=!1,b._ui=c,this._insertErrorWrapper(b),this.actualizeTriggers(b))},_manageClassHandler:function(b){if("string"==typeof b.options.classHandler&&a(b.options.classHandler).length)return a(b.options.classHandler);var c=b.options.classHandler(b);return"undefined"!=typeof c&&c.length?c:"undefined"==typeof b.options.multiple||b.$element.is("select")?b.$element:b.$element.parent()},_insertErrorWrapper:function(b){var c;if("string"==typeof b.options.errorsContainer){if(a(b.options.errorsContainer+"").length)return a(b.options.errorsContainer).append(b._ui.$errorsWrapper);window.console&&window.console.warn&&window.console.warn("The errors container `"+b.options.errorsContainer+"` does not exist in DOM")}return"function"==typeof b.options.errorsContainer&&(c=b.options.errorsContainer(b)),"undefined"!=typeof c&&c.length?c.append(b._ui.$errorsWrapper):"undefined"==typeof b.options.multiple?b.$element.after(b._ui.$errorsWrapper):b.$element.parent().after(b._ui.$errorsWrapper)},actualizeTriggers:function(b){var c=this;if(b.options.multiple?a("["+b.options.namespace+'multiple="'+b.options.multiple+'"]').each(function(){a(this).off(".Parsley")}):b.$element.off(".Parsley"),!1!==b.options.trigger){var d=b.options.trigger.replace(/^\s+/g,"").replace(/\s+$/g,"");""!==d&&(b.options.multiple?a("["+b.options.namespace+'multiple="'+b.options.multiple+'"]').each(function(){a(this).on(d.split(" ").join(".Parsley ")+".Parsley",!1,a.proxy("function"==typeof b.eventValidate?b.eventValidate:c.eventValidate,b))}):b.$element.on(d.split(" ").join(".Parsley ")+".Parsley",!1,a.proxy("function"==typeof b.eventValidate?b.eventValidate:this.eventValidate,b)))}},eventValidate:function(a){new RegExp("key").test(a.type)&&!this._ui.validationInformationVisible&&this.getValue().length<=this.options.validationThreshold||(this._ui.validatedOnce=!0,this.validate())},manageFailingFieldTrigger:function(b){return b._ui.failedOnce=!0,b.options.multiple&&a("["+b.options.namespace+'multiple="'+b.options.multiple+'"]').each(function(){return new RegExp("change","i").test(a(this).parsley().options.trigger||"")?void 0:a(this).on("change.ParsleyFailedOnce",!1,a.proxy(b.validate,b))}),b.$element.is("select")&&!new RegExp("change","i").test(b.options.trigger||"")?b.$element.on("change.ParsleyFailedOnce",!1,a.proxy(b.validate,b)):new RegExp("keyup","i").test(b.options.trigger||"")?void 0:b.$element.on("keyup.ParsleyFailedOnce",!1,a.proxy(b.validate,b))},reset:function(b){b.$element.off(".Parsley"),b.$element.off(".ParsleyFailedOnce"),"undefined"!=typeof b._ui&&"ParsleyForm"!==b.__class__&&(b._ui.$errorsWrapper.children().each(function(){a(this).remove()}),this._resetClass(b),b._ui.validatedOnce=!1,b._ui.lastValidationResult=[],b._ui.validationInformationVisible=!1)},destroy:function(a){this.reset(a),"ParsleyForm"!==a.__class__&&(a._ui.$errorsWrapper.remove(),delete a._ui)},_successClass:function(a){a._ui.validationInformationVisible=!0,a._ui.$errorClassHandler.removeClass(a.options.errorClass).addClass(a.options.successClass)},_errorClass:function(a){a._ui.validationInformationVisible=!0,a._ui.$errorClassHandler.removeClass(a.options.successClass).addClass(a.options.errorClass)},_resetClass:function(a){a._ui.$errorClassHandler.removeClass(a.options.successClass).removeClass(a.options.errorClass)}};var g=function(c,d,e,f){this.__class__="OptionsFactory",this.__id__=b.hash(4),this.formOptions=null,this.fieldOptions=null,this.staticOptions=a.extend(!0,{},c,d,e,{namespace:f})};g.prototype={get:function(a){if("undefined"==typeof a.__class__)throw new Error("Parsley Instance expected");switch(a.__class__){case"Parsley":return this.staticOptions;case"ParsleyForm":return this.getFormOptions(a);case"ParsleyField":case"ParsleyFieldMultiple":return this.getFieldOptions(a);default:throw new Error("Instance "+a.__class__+" is not supported")}},getFormOptions:function(c){return this.formOptions=b.attr(c.$element,this.staticOptions.namespace),a.extend({},this.staticOptions,this.formOptions)},getFieldOptions:function(c){return this.fieldOptions=b.attr(c.$element,this.staticOptions.namespace),null===this.formOptions&&"undefined"!=typeof c.parent&&(this.formOptions=this.getFormOptions(c.parent)),a.extend({},this.staticOptions,this.formOptions,this.fieldOptions)}};var h=function(c,d){if(this.__class__="ParsleyForm",this.__id__=b.hash(4),"OptionsFactory"!==b.get(d,"__class__"))throw new Error("You must give an OptionsFactory instance");this.OptionsFactory=d,this.$element=a(c),this.validationResult=null,this.options=this.OptionsFactory.get(this)};h.prototype={onSubmitValidate:function(b){return this.validate(void 0,void 0,b),!1===this.validationResult&&b instanceof a.Event&&(b.stopImmediatePropagation(),b.preventDefault()),this},validate:function(b,c,d){this.submitEvent=d,this.validationResult=!0;var e=[];this._refreshFields(),a.emit("parsley:form:validate",this);for(var f=0;f<this.fields.length;f++)b&&b!==this.fields[f].options.group||(e=this.fields[f].validate(c),!0!==e&&e.length>0&&this.validationResult&&(this.validationResult=!1));return a.emit("parsley:form:validated",this),this.validationResult},isValid:function(a,b){this._refreshFields();for(var c=0;c<this.fields.length;c++)if((!a||a===this.fields[c].options.group)&&!1===this.fields[c].isValid(b))return!1;return!0},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var a=this;return this.fields=[],this.fieldsMappedById={},this.$element.find(this.options.inputs).each(function(){var b=new window.Parsley(this,{},a);"ParsleyField"!==b.__class__&&"ParsleyFieldMultiple"!==b.__class__||b.$element.is(b.options.excluded)||"undefined"==typeof a.fieldsMappedById[b.__class__+"-"+b.__id__]&&(a.fieldsMappedById[b.__class__+"-"+b.__id__]=b,a.fields.push(b))}),this}};var i=function(c,d,e,f,g){if(!new RegExp("ParsleyField").test(b.get(c,"__class__")))throw new Error("ParsleyField or ParsleyFieldMultiple instance expected");if("function"!=typeof window.ParsleyValidator.validators[d]&&"Assert"!==window.ParsleyValidator.validators[d](e).__parentClass__)throw new Error("Valid validator expected");var h=function(a,c){return"undefined"!=typeof a.options[c+"Priority"]?a.options[c+"Priority"]:b.get(window.ParsleyValidator.validators[c](e),"priority")||2};return f=f||h(c,d),"function"==typeof window.ParsleyValidator.validators[d](e).requirementsTransformer&&(e=window.ParsleyValidator.validators[d](e).requirementsTransformer()),a.extend(window.ParsleyValidator.validators[d](e),{name:d,requirements:e,priority:f,groups:[f],isDomConstraint:g||b.attr(c.$element,c.options.namespace,d)})},j=function(c,d,e){this.__class__="ParsleyField",this.__id__=b.hash(4),this.$element=a(c),"undefined"!=typeof e?(this.parent=e,this.OptionsFactory=this.parent.OptionsFactory,this.options=this.OptionsFactory.get(this)):(this.OptionsFactory=d,this.options=this.OptionsFactory.get(this)),this.constraints=[],this.constraintsByName={},this.validationResult=[],this._bindConstraints()
};j.prototype={validate:function(b){return this.value=this.getValue(),a.emit("parsley:field:validate",this),a.emit("parsley:field:"+(this.isValid(b,this.value)?"success":"error"),this),a.emit("parsley:field:validated",this),this.validationResult},isValid:function(a,b){this.refreshConstraints();var c=this._getConstraintsSortedPriorities();if(b=b||this.getValue(),0===b.length&&!this._isRequired()&&"undefined"==typeof this.options.validateIfEmpty&&!0!==a)return this.validationResult=[];if(!1===this.options.priorityEnabled)return!0===(this.validationResult=this.validateThroughValidator(b,this.constraints,"Any"));for(var d=0;d<c.length;d++)if(!0!==(this.validationResult=this.validateThroughValidator(b,this.constraints,c[d])))return!1;return!0},getValue:function(){var a;return a="undefined"!=typeof this.options.value?this.options.value:this.$element.val(),"undefined"==typeof a||null===a?"":!0===this.options.trimValue?a.replace(/^\s+|\s+$/g,""):a},refreshConstraints:function(){return this.actualizeOptions()._bindConstraints()},addConstraint:function(a,b,c,d){if(a=a.toLowerCase(),"function"==typeof window.ParsleyValidator.validators[a]){var e=new i(this,a,b,c,d);"undefined"!==this.constraintsByName[e.name]&&this.removeConstraint(e.name),this.constraints.push(e),this.constraintsByName[e.name]=e}return this},removeConstraint:function(a){for(var b=0;b<this.constraints.length;b++)if(a===this.constraints[b].name){this.constraints.splice(b,1);break}return this},updateConstraint:function(a,b,c){return this.removeConstraint(a).addConstraint(a,b,c)},_bindConstraints:function(){for(var a=[],b=0;b<this.constraints.length;b++)!1===this.constraints[b].isDomConstraint&&a.push(this.constraints[b]);this.constraints=a;for(var c in this.options)this.addConstraint(c,this.options[c]);return this._bindHtml5Constraints()},_bindHtml5Constraints:function(){(this.$element.hasClass("required")||this.$element.attr("required"))&&this.addConstraint("required",!0,void 0,!0),"string"==typeof this.$element.attr("pattern")&&this.addConstraint("pattern",this.$element.attr("pattern"),void 0,!0),"undefined"!=typeof this.$element.attr("min")&&"undefined"!=typeof this.$element.attr("max")?this.addConstraint("range",[this.$element.attr("min"),this.$element.attr("max")],void 0,!0):"undefined"!=typeof this.$element.attr("min")?this.addConstraint("min",this.$element.attr("min"),void 0,!0):"undefined"!=typeof this.$element.attr("max")&&this.addConstraint("max",this.$element.attr("max"),void 0,!0);var a=this.$element.attr("type");return"undefined"==typeof a?this:"number"===a?this.addConstraint("type","integer",void 0,!0):new RegExp(a,"i").test("email url range")?this.addConstraint("type",a,void 0,!0):this},_isRequired:function(){return"undefined"==typeof this.constraintsByName.required?!1:!1!==this.constraintsByName.required.requirements},_getConstraintsSortedPriorities:function(){for(var a=[],b=0;b<this.constraints.length;b++)-1===a.indexOf(this.constraints[b].priority)&&a.push(this.constraints[b].priority);return a.sort(function(a,b){return b-a}),a}};var k=function(){this.__class__="ParsleyFieldMultiple"};k.prototype={addElement:function(a){return this.$elements.push(a),this},refreshConstraints:function(){var a;if(this.constraints=[],this.$element.is("select"))return this.actualizeOptions()._bindConstraints(),this;for(var b=0;b<this.$elements.length;b++){a=this.$elements[b].data("ParsleyFieldMultiple").refreshConstraints().constraints;for(var c=0;c<a.length;c++)this.addConstraint(a[c].name,a[c].requirements,a[c].priority,a[c].isDomConstraint)}return this},getValue:function(){if("undefined"!=typeof this.options.value)return this.options.value;if(this.$element.is("input[type=radio]"))return a("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').val()||"";if(this.$element.is("input[type=checkbox]")){var b=[];return a("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').each(function(){b.push(a(this).val())}),b.length?b:[]}return this.$element.is("select")&&null===this.$element.val()?[]:this.$element.val()},_init:function(a){return this.$elements=[this.$element],this.options.multiple=a,this}};var l=a({}),m={};a.listen=function(a){if("undefined"==typeof m[a]&&(m[a]=[]),"function"==typeof arguments[1])return m[a].push({fn:arguments[1]});if("object"==typeof arguments[1]&&"function"==typeof arguments[2])return m[a].push({fn:arguments[2],ctxt:arguments[1]});throw new Error("Wrong parameters")},a.listenTo=function(a,b,c){if("undefined"==typeof m[b]&&(m[b]=[]),!(a instanceof j||a instanceof h))throw new Error("Must give Parsley instance");if("string"!=typeof b||"function"!=typeof c)throw new Error("Wrong parameters");m[b].push({instance:a,fn:c})},a.unsubscribe=function(a,b){if("undefined"!=typeof m[a]){if("string"!=typeof a||"function"!=typeof b)throw new Error("Wrong arguments");for(var c=0;c<m[a].length;c++)if(m[a][c].fn===b)return m[a].splice(c,1)}},a.unsubscribeTo=function(a,b){if("undefined"!=typeof m[b]){if(!(a instanceof j||a instanceof h))throw new Error("Must give Parsley instance");for(var c=0;c<m[b].length;c++)if("undefined"!=typeof m[b][c].instance&&m[b][c].instance.__id__===a.__id__)return m[b].splice(c,1)}},a.unsubscribeAll=function(a){"undefined"!=typeof m[a]&&delete m[a]},a.emit=function(a,b){if("undefined"!=typeof m[a])for(var c=0;c<m[a].length;c++)if("undefined"!=typeof m[a][c].instance){if(b instanceof j||b instanceof h)if(m[a][c].instance.__id__!==b.__id__){if(m[a][c].instance instanceof h&&b instanceof j)for(var d=0;d<m[a][c].instance.fields.length;d++)if(m[a][c].instance.fields[d].__id__===b.__id__){m[a][c].fn.apply(l,Array.prototype.slice.call(arguments,1));continue}}else m[a][c].fn.apply(l,Array.prototype.slice.call(arguments,1))}else m[a][c].fn.apply("undefined"!=typeof m[a][c].ctxt?m[a][c].ctxt:l,Array.prototype.slice.call(arguments,1))},a.subscribed=function(){return m},window.ParsleyConfig=window.ParsleyConfig||{},window.ParsleyConfig.i18n=window.ParsleyConfig.i18n||{},window.ParsleyConfig.i18n.en=a.extend(window.ParsleyConfig.i18n.en||{},{defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",number:"This value should be a valid number.",integer:"This value should be a valid integer.",digits:"This value should be digits.",alphanum:"This value should be alphanumeric."},notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or less.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or less.",check:"You must select between %s and %s choices.",equalto:"This value should be the same."}),"undefined"!=typeof window.ParsleyValidator&&window.ParsleyValidator.addCatalog("en",window.ParsleyConfig.i18n.en,!0);var n=function(c,d,e){if(this.__class__="Parsley",this.__version__="2.0.0",this.__id__=b.hash(4),"undefined"==typeof c)throw new Error("You must give an element");if("undefined"!=typeof e&&"ParsleyForm"!==e.__class__)throw new Error("Parent instance must be a ParsleyForm instance");return this.init(a(c),d,e)};n.prototype={init:function(a,d,e){if(!a.length)throw new Error("You must bind Parsley on an existing element.");if(this.$element=a,this.$element.data("Parsley")){var f=this.$element.data("Parsley");return"undefined"!=typeof e&&(f.parent=e),f}return this.OptionsFactory=new g(c,b.get(window,"ParsleyConfig")||{},d,this.getNamespace(d)),this.options=this.OptionsFactory.get(this),this.$element.is("form")||b.attr(this.$element,this.options.namespace,"validate")&&!this.$element.is(this.options.inputs)?this.bind("parsleyForm"):this.$element.is(this.options.inputs)&&!this.$element.is(this.options.excluded)?this.isMultiple()?this.handleMultiple(e):this.bind("parsleyField",e):this},isMultiple:function(){return this.$element.is("input[type=radio], input[type=checkbox]")&&"undefined"==typeof this.options.multiple||this.$element.is("select")&&"undefined"!=typeof this.$element.attr("multiple")},handleMultiple:function(c){var d,e,f,g=this;if(this.options=a.extend(this.options,c?c.OptionsFactory.get(c):{},b.attr(this.$element,this.options.namespace)),this.options.multiple?e=this.options.multiple:"undefined"!=typeof this.$element.attr("name")&&this.$element.attr("name").length?e=d=this.$element.attr("name"):"undefined"!=typeof this.$element.attr("id")&&this.$element.attr("id").length&&(e=this.$element.attr("id")),this.$element.is("select")&&"undefined"!=typeof this.$element.attr("multiple"))return this.bind("parsleyFieldMultiple",c,e||this.__id__);if("undefined"==typeof e)return window.console&&window.console.warn&&window.console.warn("To be binded by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.",this.$element),this;if(e=e.replace(/(:|\.|\[|\]|\$)/g,""),"undefined"!=typeof d&&a('input[name="'+d+'"]').each(function(){a(this).is("input[type=radio], input[type=checkbox]")&&a(this).attr(g.options.namespace+"multiple",e)}),a("["+this.options.namespace+"multiple="+e+"]").length)for(var h=0;h<a("["+this.options.namespace+"multiple="+e+"]").length;h++)if("undefined"!=typeof a(a("["+this.options.namespace+"multiple="+e+"]").get(h)).data("Parsley")){f=a(a("["+this.options.namespace+"multiple="+e+"]").get(h)).data("Parsley"),this.$element.data("ParsleyFieldMultiple")||(f.addElement(this.$element),this.$element.attr(this.options.namespace+"id",f.__id__));break}return this.bind("parsleyField",c,e,!0),f||this.bind("parsleyFieldMultiple",c,e)},getNamespace:function(a){return"undefined"!=typeof this.$element.data("parsleyNamespace")?this.$element.data("parsleyNamespace"):"undefined"!=typeof b.get(a,"namespace")?a.namespace:"undefined"!=typeof b.get(window,"ParsleyConfig.namespace")?window.ParsleyConfig.namespace:c.namespace},bind:function(c,e,f,g){var i;switch(c){case"parsleyForm":i=a.extend(new h(this.$element,this.OptionsFactory),new d,window.ParsleyExtend)._bindFields();break;case"parsleyField":i=a.extend(new j(this.$element,this.OptionsFactory,e),new d,window.ParsleyExtend);break;case"parsleyFieldMultiple":i=a.extend(new j(this.$element,this.OptionsFactory,e),new d,new k,window.ParsleyExtend)._init(f);break;default:throw new Error(c+"is not a supported Parsley type")}return"undefined"!=typeof f&&b.setAttr(this.$element,this.options.namespace,"multiple",f),"undefined"!=typeof g?(this.$element.data("ParsleyFieldMultiple",i),i):(new RegExp("ParsleyF","i").test(i.__class__)&&(this.$element.data("Parsley",i),a.emit("parsley:"+("parsleyForm"===c?"form":"field")+":init",i)),i)}},a.fn.parsley=a.fn.psly=function(b){if(this.length>1){var c=[];return this.each(function(){c.push(a(this).parsley(b))}),c}return a(this).length?new n(this,b):void(window.console&&window.console.warn&&window.console.warn("You must bind Parsley on an existing element."))},window.ParsleyUI="function"==typeof b.get(window,"ParsleyConfig.ParsleyUI")?(new window.ParsleyConfig.ParsleyUI).listen():(new f).listen(),"undefined"==typeof window.ParsleyExtend&&(window.ParsleyExtend={}),"undefined"==typeof window.ParsleyConfig&&(window.ParsleyConfig={}),window.Parsley=window.psly=n,window.ParsleyUtils=b,window.ParsleyValidator=new e(window.ParsleyConfig.validators,window.ParsleyConfig.i18n),!1!==b.get(window,"ParsleyConfig.autoBind")&&a(document).ready(function(){a("[data-parsley-validate]").length&&a("[data-parsley-validate]").parsley()}),"function"==typeof define&&define.amd&&define("parsley",function(){return window.Parsley})}(window.jQuery);
window.ParsleyConfig=window.ParsleyConfig||{},window.ParsleyConfig.i18n=window.ParsleyConfig.i18n||{},window.ParsleyConfig.i18n.ar=$.extend(window.ParsleyConfig.i18n.ar||{},{ualphanum:"       ",unique:"   .",ulowercase:"-     (: a)",uuppercase:"-     (: A)",udigit:"-    (: 3)",uspecialchar:"-     (: $)",uniquecharacters:"-       (: xx)",minlengthifnotempty:"-  %s   ",defaultMessage:"     .",type:{email:"    ",url:"      URL .",number:"      .",integer:"       .",digits:"      ",alphanum:"        "},notblank:"      .",required:"  .",pattern:"     .",min:"         %s.",max:"         %s.",range:"      %s  %s.",minlength:"   .     %s   .",maxlength:"   .     %s   .",length:"    .        %s  %s .",mincheck:"  %s   .",maxcheck:"  %s   .",check:"   %s  %s .",equalto:"     .",maxdate:"         %s.",mindate:"         %s.",richtextrequired:"  .",uploading:"     !",hashtag:"   Twitter ",blogcategory:"     .      'uncategorized' 'uncategorised' 'all'.",urlstrict:"      URL .",menuurl:"      URL .",requiredwith:"  .",mentionmax:"   .     %s   ."}),"undefined"!=typeof window.ParsleyValidator&&window.ParsleyValidator.addCatalog("ar",window.ParsleyConfig.i18n.ar,!0);
window.ParsleyConfig=window.ParsleyConfig||{},window.ParsleyConfig.i18n=window.ParsleyConfig.i18n||{},window.ParsleyConfig.i18n.en=$.extend(window.ParsleyConfig.i18n.en||{},{defaultMessage:"This value seems to be invalid.",type:{email:"This is not a valid email address",url:"This value should be a valid url.",number:"This value should be a valid number.",integer:"This value should be a valid integer.",digits:"This value should be digits.",alphanum:"Use only alphanumerical characters and capital letters"},notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or less.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or less.",check:"You must select between %s and %s choices.",equalto:"This value should be the same.",maxdate:"This value should be less than or equal to %s.",mindate:"This value should be greater than or equal to %s.",richtextrequired:"This value is required.",uploading:"Please wait for the upload to finish!",hashtag:"This is not a valid Twitter hashtag",blogcategory:"This is not an allowed category name. Invalid category names are 'uncategorized', 'uncategorised', 'all'.",urlstrict:"This value should be a valid url.",menuurl:"This value should be a valid url.",requiredwith:"This value is required.",innerrequired:"This value is required.",mentionmax:"This value is too long. It should have %s characters or less.",ualphanum:"Use only alphanumerical characters and capital letters",unique:"This value is not unique.",ulowercase:"- contains a lower case letter (ex: a)",uuppercase:"- contains an uppercase letter (ex: Z)",udigit:"- contains a digit (ex: 3)",uspecialchar:"- contains a special character (ex: $)",uniquecharacters:"- does not contain 2 identical characters in a row (ex: xx)",minlengthifnotempty:"- contains at least %s characters"}),"undefined"!=typeof window.ParsleyValidator&&window.ParsleyValidator.addCatalog("en",window.ParsleyConfig.i18n.en,!0);
window.ParsleyUI.addError=function(r,e,a,s,o){var d=a||this._getErrorMessage(r,s);if(r.options.priorityEnabled)this._addErrorTo(r._ui.$errorsWrapper,e,d);else{var i=$(r.options.errorTemplate);this._addErrorTo(i,e,d),r._ui.$errorsWrapper.removeClass("error-message").addClass("error").append(i)}r._ui.$errorClassHandler.removeClass("backend-error"),!0!==o&&this._errorClass(r)},window.ParsleyUI.updateError=function(r,e,a,s,o){var d=r.options.priorityEnabled?r._ui.$errorsWrapper:r._ui.$errorsWrapper.find(".parsley-"+e);d.addClass("filled").attr("data-message",a||this._getErrorMessage(r,s)),!0!==o&&this._errorClass(r)},window.ParsleyUI.removeError=function(r,e,a){r.options.priorityEnabled?r._ui.$errorsWrapper.removeClass("filled").attr("data","").removeClass("parsley-"+e):r._ui.$errorsWrapper.find(".parsley-"+e).remove(),r._ui.$errorClassHandler.removeClass("backend-error"),!0!==a&&this.manageStatusClass(r)},window.ParsleyUI._addErrorTo=function(r,e,a){r.addClass("filled").addClass("parsley-"+e).attr("data-message",a)},window.ParsleyValidator.setLocale(document.documentElement.lang);
/*! Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 */
!function(){var t=!1,n=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(r){function s(){!t&&this.construct&&this.construct.apply(this,arguments)}var e=this.prototype;t=!0;var o=new this;t=!1;for(var u in r)o[u]="function"==typeof r[u]&&"function"==typeof e[u]&&n.test(r[u])?function(t,n){return function(){var r=this._super;this._super=e[t];var s=n.apply(this,arguments);return this._super=r,s}}(u,r[u]):r[u];return s.prototype=o,s.prototype.constructor=s,s.extend=arguments.callee,s}}();
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(e,t){"object"==typeof exports&&exports?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mustache={})}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return g.call(e,t)}function i(e){return!r(w,e)}function s(e){return String(e).replace(/[&<>"'\/]/g,function(e){return d[e]})}function o(t,r){function s(){if(U&&!m)for(;d.length;)delete w[d.pop()];else d=[];U=!1,m=!1}function o(e){if("string"==typeof e&&(e=e.split(k,2)),!f(e)||2!==e.length)throw new Error("Invalid tags: "+e);h=new RegExp(n(e[0])+"\\s*"),l=new RegExp("\\s*"+n(e[1])),p=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var h,l,p,g=[],w=[],d=[],U=!1,m=!1;o(r||e.tags);for(var E,T,j,C,A,R,S=new u(t);!S.eos();){if(E=S.pos,j=S.scanUntil(h))for(var O=0,$=j.length;$>O;++O)C=j.charAt(O),i(C)?d.push(w.length):m=!0,w.push(["text",C,E,E+1]),E+=1,"\n"===C&&s();if(!S.scan(h))break;if(U=!0,T=S.scan(x)||"name",S.scan(v),"="===T?(j=S.scanUntil(y),S.scan(y),S.scanUntil(l)):"{"===T?(j=S.scanUntil(p),S.scan(b),S.scanUntil(l),T="&"):j=S.scanUntil(l),!S.scan(l))throw new Error("Unclosed tag at "+S.pos);if(A=[T,j,E,S.pos],w.push(A),"#"===T||"^"===T)g.push(A);else if("/"===T){if(R=g.pop(),!R)throw new Error('Unopened section "'+j+'" at '+E);if(R[1]!==j)throw new Error('Unclosed section "'+R[1]+'" at '+E)}else"name"===T||"{"===T||"&"===T?m=!0:"="===T&&o(j)}if(R=g.pop())throw new Error('Unclosed section "'+R[1]+'" at '+S.pos);return c(a(w))}function a(e){for(var t,n,r=[],i=0,s=e.length;s>i;++i)t=e[i],t&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function c(e){for(var t,n,r=[],i=r,s=[],o=0,a=e.length;a>o;++o)switch(t=e[o],t[0]){case"#":case"^":i.push(t),s.push(t),i=t[4]=[];break;case"/":n=s.pop(),n[5]=t[2],i=s.length>0?s[s.length-1][4]:r;break;default:i.push(t)}return r}function u(e){this.string=e,this.tail=e,this.pos=0}function h(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function l(){this.cache={}}var p=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===p.call(e)},g=RegExp.prototype.test,w=/\S/,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,k=/\s+/,y=/\s*=/,b=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},u.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},h.prototype.push=function(e){return new h(e,this)},h.prototype.lookup=function(e){var n,r=this.cache;if(e in r)n=r[e];else{for(var i,s,o=this;o;){if(e.indexOf(".")>0)for(n=o.view,i=e.split("."),s=0;null!=n&&s<i.length;)n=n[i[s++]];else n=o.view[e];if(null!=n)break;o=o.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},l.prototype.clearCache=function(){this.cache={}},l.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=o(e,t)),r},l.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof h?t:new h(t);return this.renderTokens(r,i,n,e)},l.prototype.renderTokens=function(n,r,i,s){function o(e){return h.render(e,r,i)}for(var a,c,u="",h=this,l=0,p=n.length;p>l;++l)switch(a=n[l],a[0]){case"#":if(c=r.lookup(a[1]),!c)continue;if(f(c))for(var g=0,w=c.length;w>g;++g)u+=this.renderTokens(a[4],r.push(c[g]),i,s);else if("object"==typeof c||"string"==typeof c)u+=this.renderTokens(a[4],r.push(c),i,s);else if(t(c)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");c=c.call(r.view,s.slice(a[3],a[5]),o),null!=c&&(u+=c)}else u+=this.renderTokens(a[4],r,i,s);break;case"^":c=r.lookup(a[1]),(!c||f(c)&&0===c.length)&&(u+=this.renderTokens(a[4],r,i,s));break;case">":if(!i)continue;c=t(i)?i(a[1]):i[a[1]],null!=c&&(u+=this.renderTokens(this.parse(c),r,i,c));break;case"&":c=r.lookup(a[1]),null!=c&&(u+=c);break;case"name":c=r.lookup(a[1]),null!=c&&(u+=e.escape(c));break;case"text":u+=a[1]}return u},e.name="mustache.js",e.version="0.8.1",e.tags=["{{","}}"];var U=new l;e.clearCache=function(){return U.clearCache()},e.parse=function(e,t){return U.parse(e,t)},e.render=function(e,t,n){return U.render(e,t,n)},e.to_html=function(n,r,i,s){var o=e.render(n,r,i);return t(s)?void s(o):o},e.escape=s,e.Scanner=u,e.Context=h,e.Writer=l});
/*
 * pickadate.js v3.5.0, 2014/04/13
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
(function(a){if(typeof define==="function"&&define.amd){console.log("define before");define("picker",["jquery"],a);console.log("define after")}else{this.Picker=a(jQuery)}}(function(f){var a=f(window);var d=f(document);var e=f(document.documentElement);function g(w,z,k,p){if(!w){return g}var v=false,u={id:w.id||"P"+Math.abs(~~(Math.random()*new Date()))},s=k?f.extend(true,{},k.defaults,p):p||{},r=f.extend({},g.klasses(),s.klass),m=f(w),l=function(){return this.start()},q=l.prototype={constructor:l,$node:m,start:function(){if(u&&u.start){return q}u.methods={};u.start=true;u.open=false;u.type=w.type;w.autofocus=w==document.activeElement;w.type="text";w.readOnly=!s.editable;w.id=w.id||u.id;q.component=new k(q,s);q.$root=f(g._.node("div",t(),r.picker,'id="'+w.id+'_root"'));o();if(s.formatSubmit){x()}n();if(s.container){f(s.container).append(q.$root)}else{m.after(q.$root)}q.on({start:q.component.onStart,render:q.component.onRender,stop:q.component.onStop,open:q.component.onOpen,close:q.component.onClose,set:q.component.onSet}).on({start:s.onStart,render:s.onRender,stop:s.onStop,open:s.onOpen,close:s.onClose,set:s.onSet});v=i(q.$root.children()[0]);if(w.autofocus){q.open()}return q.trigger("start").trigger("render")},render:function(A){if(A){q.$root.html(t())}else{q.$root.find("."+r.box).html(q.component.nodes(u.open))}return q.trigger("render")},stop:function(){if(!u.start){return q}q.close();if(q._hidden){q._hidden.parentNode.removeChild(q._hidden)}q.$root.remove();m.removeClass(r.input).removeData(z);setTimeout(function(){m.off("."+u.id)},0);w.type=u.type;w.readOnly=false;q.trigger("stop");u.methods={};u.start=false;return q},open:function(A){if(u.open){return q}m.addClass(r.active);h(w,"expanded",true);setTimeout(function(){q.$root.addClass(r.opened);h(q.$root[0],"hidden",false)},0);if(A!==false){u.open=true;if(v){e.css("overflow","hidden").css("padding-right","+="+c())}m.trigger("focus");d.on("click."+u.id+" focusin."+u.id,function(B){var C=B.target;if(C!=w&&C!=document&&B.which!=3){q.close(C===q.$root.children()[0])}}).on("keydown."+u.id,function(C){var B=C.keyCode,D=q.component.key[B],E=C.target;if(B==27){q.close(true)}else{if(E==w&&(D||B==13)){C.preventDefault();if(D){g._.trigger(q.component.key.go,q,[g._.trigger(D)])}else{if(!q.$root.find("."+r.highlighted).hasClass(r.disabled)){q.set("select",q.component.item.highlight).close()}}}else{if(f.contains(q.$root[0],E)&&B==13){C.preventDefault();E.click()}}}})}return q.trigger("open")},close:function(A){if(A){m.off("focus."+u.id).trigger("focus");setTimeout(function(){m.on("focus."+u.id,y)},0)}m.removeClass(r.active);h(w,"expanded",false);setTimeout(function(){q.$root.removeClass(r.opened+" "+r.focused);h(q.$root[0],"hidden",true)},0);if(!u.open){return q}u.open=false;if(v){e.css("overflow","").css("padding-right","-="+c())}d.off("."+u.id);return q.trigger("close")},clear:function(){return q.set("clear")},set:function(C,E,B){var G,F,D=f.isPlainObject(C),A=D?C:{};B=D&&f.isPlainObject(E)?E:B||{};if(C){if(!D){A[C]=E}for(G in A){F=A[G];if(G in q.component.item){if(F===undefined){F=null}q.component.set(G,F,B)}if(G=="select"||G=="clear"){m.val(G=="clear"?"":q.get(G,s.format)).trigger("change")}}q.render()}return B.muted?q:q.trigger("set",A)},get:function(A,C){A=A||"value";if(u[A]!=null){return u[A]}if(A=="value"){return w.value}if(A in q.component.item){if(typeof C=="string"){var B=q.component.get(A);return B?g._.trigger(q.component.formats.toString,q.component,[C,B]):""}return q.component.get(A)}},on:function(B,F){var D,E,C=f.isPlainObject(B),A=C?B:{};if(B){if(!C){A[B]=F}for(D in A){E=A[D];u.methods[D]=u.methods[D]||[];u.methods[D].push(E)}}return q},off:function(){var A,B,C=arguments;for(A=0,namesCount=C.length;A<namesCount;A+=1){B=C[A];if(B in u.methods){delete u.methods[B]}}return q},trigger:function(A,C){var B=u.methods[A];if(B){B.map(function(D){g._.trigger(D,q,[C])})}return q}};function t(){return g._.node("div",g._.node("div",g._.node("div",g._.node("div",q.component.nodes(u.open),r.box),r.wrap),r.frame),r.holder)}function n(){m.data(z,q).addClass(r.input).val(m.data("value")?q.get("select",s.format):w.value).on("focus."+u.id+" click."+u.id,y);if(!s.editable){m.on("keydown."+u.id,function(B){var A=B.keyCode,C=/^(8|46)$/.test(A);if(A==27){q.close();return false}if(A==32||C||!u.open&&q.component.key[A]){B.preventDefault();B.stopPropagation();if(C){q.clear().close()}else{q.open()}}})}h(w,{haspopup:true,expanded:false,readonly:false,owns:w.id+"_root"+(q._hidden?" "+q._hidden.id:"")})}function o(){q.$root.on({focusin:function(A){q.$root.removeClass(r.focused);A.stopPropagation()},"mousedown click":function(A){var B=A.target;if(B!=q.$root.children()[0]){A.stopPropagation();if(A.type=="mousedown"&&!f(B).is(":input")&&B.nodeName!="OPTION"){A.preventDefault();w.focus()}}}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var B=f(this),D=B.data(),A=B.hasClass(r.navDisabled)||B.hasClass(r.disabled),C=document.activeElement;C=C&&(C.type||C.href)&&C;if(A||C&&!f.contains(q.$root[0],C)){w.focus()}if(D.nav&&!A){q.set("highlight",q.component.item.highlight,{nav:D.nav})}else{if(g._.isInteger(D.pick)&&!A){q.set("select",D.pick).close(true)}else{if(D.clear){q.clear().close(true)}}}});h(q.$root[0],"hidden",true)}function x(){var B,A;if(s.hiddenName===true){B=w.name+"_hidden";A=w.name;w.name=""}else{A=[typeof s.hiddenPrefix=="string"?s.hiddenPrefix:"",typeof s.hiddenSuffix=="string"?s.hiddenSuffix:"_submit"];A=B=A[0]+w.name+A[1]}q._hidden=f('<input type=hidden name="'+A+'"id="'+B+'"'+(m.data("value")||w.value?' value="'+q.get("select",s.formatSubmit)+'"':"")+">")[0];m.on("change."+u.id,function(){q._hidden.value=w.value?q.get("select",s.formatSubmit):""}).after(q._hidden)}function y(A){A.stopPropagation();if(A.type=="focus"){q.$root.addClass(r.focused)}q.open()}return new l()}g.klasses=function(k){k=k||"picker";return{picker:k,opened:k+"--opened",focused:k+"--focused",input:k+"__input",active:k+"__input--active",holder:k+"__holder",frame:k+"__frame",wrap:k+"__wrap",box:k+"__box"}};function i(k){var l,m="position";if(k.currentStyle){l=k.currentStyle[m]}else{if(window.getComputedStyle){l=getComputedStyle(k)[m]}}return l=="fixed"}function c(){if(e.height()<=a.height()){return 0}var k=f('<div style="visibility:hidden;width:100px" />').appendTo("body");var m=k[0].offsetWidth;k.css("overflow","scroll");var n=f('<div style="width:100%" />').appendTo(k);var l=n[0].offsetWidth;k.remove();return m-l}g._={group:function(n){var k,m="",l=g._.trigger(n.min,n);for(;l<=g._.trigger(n.max,n,[l]);l+=n.i){k=g._.trigger(n.item,n,[l]);m+=g._.node(n.node,k[0],k[1],k[2])}return m},node:function(n,m,k,l){if(!m){return""}m=f.isArray(m)?m.join(""):m;k=k?' class="'+k+'"':"";l=l?" "+l:"";return"<"+n+k+l+">"+m+"</"+n+">"},lead:function(k){return(k<10?"0":"")+k},trigger:function(m,l,k){return typeof m=="function"?m.apply(l,k||[]):m},digits:function(k){return(/\d/).test(k[1])?2:1},isDate:function(k){return{}.toString.call(k).indexOf("Date")>-1&&this.isInteger(k.getUTCDate())},isInteger:function(k){return{}.toString.call(k).indexOf("Number")>-1&&k%1===0},ariaAttr:b};g.extend=function(l,k){f.fn[l]=function(m,o){var n=this.data(l);if(m=="picker"){return n}if(n&&typeof m=="string"){return g._.trigger(n[m],n,[o])}return this.each(function(){var p=f(this);if(!p.data(l)){new g(this,l,k,m)}})};f.fn[l].defaults=k.defaults};function h(l,m,n){if(f.isPlainObject(m)){for(var k in m){j(l,k,m[k])}}else{j(l,m,n)}}function j(k,l,m){k.setAttribute((l=="role"?"":"aria-")+l,m)}function b(n,o){if(!f.isPlainObject(n)){n={attribute:o}}o="";for(var m in n){var k=(m=="role"?"":"aria-")+m,l=n[m];o+=l==null?"":k+'="'+n[m]+'"'}return o}return g}));
/*
 * Date picker for pickadate.js v3.5.0
 * http://amsul.github.io/pickadate.js/date.htm
 */
(function(a){if(typeof define=="function"&&define.amd){define(["picker","jquery"],a)}else{a(Picker,jQuery)}}(function(c,e){var f=7,a=6,d=c._;function b(j,l){var m=this,n=j.$node[0].value,h=j.$node.data("value"),i=h||n,g=h?l.formatSubmit:l.format,k=function(){return getComputedStyle(j.$root[0]).direction==="rtl"};m.settings=l;m.$node=j.$node;m.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"};m.item={};m.item.clear=null;m.item.disable=(l.disable||[]).slice(0);m.item.enable=-(function(o){return o[0]===true?o.shift():-1})(m.item.disable);m.set("min",l.min).set("max",l.max).set("now");if(i){m.set("select",i,{format:g})}else{m.set("select",null).set("highlight",m.item.now)}m.key={40:7,38:-7,39:function(){return k()?-1:1},37:function(){return k()?1:-1},go:function(o){var q=m.item.highlight,p=new Date(Date.UTC(q.year,q.month,q.date+o));m.set("highlight",[p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()],{interval:o});this.render()}};j.on("render",function(){j.$root.find("."+l.klass.selectMonth).on("change",function(){var o=this.value;if(o){j.set("highlight",[j.get("view").year,o,j.get("highlight").date]);j.$root.find("."+l.klass.selectMonth).trigger("focus")}});j.$root.find("."+l.klass.selectYear).on("change",function(){var o=this.value;if(o){j.set("highlight",[o,j.get("view").month,j.get("highlight").date]);j.$root.find("."+l.klass.selectYear).trigger("focus")}})}).on("open",function(){j.$root.find("button, select").attr("disabled",false)}).on("close",function(){j.$root.find("button, select").attr("disabled",true)})}b.prototype.set=function(h,i,g){var j=this,k=j.item;if(i===null){if(h=="clear"){h="select"}k[h]=i;return j}k[(h=="enable"?"disable":h=="flip"?"enable":h)]=j.queue[h].split(" ").map(function(l){i=j[l](h,i,g);return i}).pop();if(h=="select"){j.set("highlight",k.select,g)}else{if(h=="highlight"){j.set("view",k.highlight,g)}else{if(h.match(/^(flip|min|max|disable|enable)$/)){if(k.select&&j.disabled(k.select)){j.set("select",k.select,g)}if(k.highlight&&j.disabled(k.highlight)){j.set("highlight",k.highlight,g)}}}}return j};b.prototype.get=function(g){return this.item[g]};b.prototype.create=function(h,i,g){var k,j=this;i=i===undefined?h:i;if(i==-Infinity||i==Infinity){k=i}else{if(e.isPlainObject(i)&&d.isInteger(i.pick)){i=i.obj}else{if(e.isArray(i)){i=new Date(Date.UTC(i[0],i[1],i[2]));i=d.isDate(i)?i:j.create().obj}else{if(d.isInteger(i)){i=j.normalize(new Date(i),g)}else{if(d.isDate(i)){i=j.normalize(i,g)}else{i=j.now(h,i,g)}}}}}return{year:k||i.getUTCFullYear(),month:k||i.getUTCMonth(),date:k||i.getUTCDate(),day:k||i.getUTCDay(),obj:k||i,pick:k||i.getTime()}};b.prototype.createRange=function(j,i){var h=this,g=function(k){if(k===true||e.isArray(k)||d.isDate(k)){return h.create(k)}return k};if(!d.isInteger(j)){j=g(j)}if(!d.isInteger(i)){i=g(i)}if(d.isInteger(j)&&e.isPlainObject(i)){j=[i.year,i.month,i.date+j]}else{if(d.isInteger(i)&&e.isPlainObject(j)){i=[j.year,j.month,j.date+i]}}return{from:g(j),to:g(i)}};b.prototype.withinRange=function(g,h){g=this.createRange(g.from,g.to);return h.pick>=g.from.pick&&h.pick<=g.to.pick};b.prototype.overlapRanges=function(h,g){var i=this;h=i.createRange(h.from,h.to);g=i.createRange(g.from,g.to);return i.withinRange(h,g.from)||i.withinRange(h,g.to)||i.withinRange(g,h.from)||i.withinRange(g,h.to)};b.prototype.now=function(h,i,g){i=new Date();if(g&&g.rel){i.setUTCDate(i.getUTCDate()+g.rel)}return this.normalize(i,g)};b.prototype.navigate=function(l,o,p){var m,g,h,k,n=e.isArray(o),i=e.isPlainObject(o),j=this.item.view;if(n||i){if(i){g=o.year;h=o.month;k=o.date}else{g=+o[0];h=+o[1];k=+o[2]}if(p&&p.nav&&j&&j.month!==h){g=j.year;h=j.month}m=new Date(Date.UTC(g,h+(p&&p.nav?p.nav:0),1));g=m.getUTCFullYear();h=m.getUTCMonth();while(new Date(Date.UTC(g,h,k)).getUTCMonth()!==h){k-=1}o=[g,h,k]}return o};b.prototype.normalize=function(g){g.setUTCHours(0,0,0,0);return g};b.prototype.measure=function(g,h){var i=this;if(!h){h=g=="min"?-Infinity:Infinity}else{if(d.isInteger(h)){h=i.now(g,h,{rel:h})}}return h};b.prototype.viewset=function(g,h){return this.create([h.year,h.month,1])};b.prototype.validate=function(q,p,t){var n=this,h=p,g=t&&t.interval?t.interval:1,i=n.item.enable===-1,s,m,l=n.item.min,r=n.item.max,j,o,k=i&&n.item.disable.filter(function(v){if(e.isArray(v)){var u=n.create(v).pick;if(u<p.pick){s=true}else{if(u>p.pick){m=true}}}return d.isInteger(v)}).length;if(!t||!t.nav){if((!i&&n.disabled(p))||(i&&n.disabled(p)&&(k||s||m))||(!i&&(p.pick<=l.pick||p.pick>=r.pick))){if(i&&!k&&((!m&&g>0)||(!s&&g<0))){g*=-1}while(n.disabled(p)){if(Math.abs(g)>1&&(p.month<h.month||p.month>h.month)){p=h;g=g>0?1:-1}if(p.pick<=l.pick){j=true;g=1;p=n.create([l.year,l.month,l.date+(p.pick===l.pick?0:-1)])}else{if(p.pick>=r.pick){o=true;g=-1;p=n.create([r.year,r.month,r.date+(p.pick===r.pick?0:1)])}}if(j&&o){break}p=n.create([p.year,p.month,p.date+g])}}}return p};b.prototype.disabled=function(g){var i=this,h=i.item.disable.filter(function(j){if(d.isInteger(j)){return g.day===(i.settings.firstDay?j:j-1)%7}if(e.isArray(j)||d.isDate(j)){return g.pick===i.create(j).pick}if(e.isPlainObject(j)){return i.withinRange(j,g)}});h=h.length&&!h.filter(function(j){return e.isArray(j)&&j[3]=="inverted"||e.isPlainObject(j)&&j.inverted}).length;return i.item.enable===-1?!h:h||g.pick<i.item.min.pick||g.pick>i.item.max.pick};b.prototype.parse=function(i,j,h){var k=this,g={};if(!j||typeof j!="string"){return j}if(!(h&&h.format)){h=h||{};h.format=k.settings.format}k.formats.toArray(h.format).map(function(m){var n=k.formats[m],l=n?d.trigger(n,k,[j,g]):m.replace(/^!/,"").length;if(n){g[m]=j.substr(0,l)}j=j.substr(l)});return[g.yyyy||g.yy,+(g.mm||g.m)-1,g.dd||g.d]};b.prototype.formats=(function(){function g(i,l,j){var k=i.match(/\w+/)[0];if(!j.mm&&!j.m){j.m=l.indexOf(k)+1}return k.length}function h(i){return i.match(/\w+/)[0].length}return{d:function(i,j){return i?d.digits(i):j.date},dd:function(i,j){return i?2:d.lead(j.date)},ddd:function(i,j){return i?h(i):this.settings.weekdaysShort[j.day]},dddd:function(i,j){return i?h(i):this.settings.weekdaysFull[j.day]},m:function(i,j){return i?d.digits(i):j.month+1},mm:function(i,j){return i?2:d.lead(j.month+1)},mmm:function(i,j){var k=this.settings.monthsShort;return i?g(i,k,j):k[j.month]},mmmm:function(i,j){var k=this.settings.monthsFull;return i?g(i,k,j):k[j.month]},yy:function(i,j){return i?2:(""+j.year).slice(2)},yyyy:function(i,j){return i?4:j.year},toArray:function(i){return i.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(i,j){var k=this;return k.formats.toArray(i).map(function(l){return d.trigger(k.formats[l],k,[0,j])||l.replace(/^!/,"")}).join("")}}})();b.prototype.isDateExact=function(h,g){var i=this;if((d.isInteger(h)&&d.isInteger(g))||(typeof h=="boolean"&&typeof g=="boolean")){return h===g}if((d.isDate(h)||e.isArray(h))&&(d.isDate(g)||e.isArray(g))){return i.create(h).pick===i.create(g).pick}if(e.isPlainObject(h)&&e.isPlainObject(g)){return i.isDateExact(h.from,g.from)&&i.isDateExact(h.to,g.to)}return false};b.prototype.isDateOverlap=function(i,h){var j=this,g=j.settings.firstDay?1:0;if(d.isInteger(i)&&(d.isDate(h)||e.isArray(h))){i=i%7+g;return i===j.create(h).day+1}if(d.isInteger(h)&&(d.isDate(i)||e.isArray(i))){h=h%7+g;return h===j.create(i).day+1}if(e.isPlainObject(i)&&e.isPlainObject(h)){return j.overlapRanges(i,h)}return false};b.prototype.flipEnable=function(h){var g=this.item;g.enable=h||(g.enable==-1?1:-1)};b.prototype.deactivate=function(h,j){var i=this,g=i.item.disable.slice(0);if(j=="flip"){i.flipEnable()}else{if(j===false){i.flipEnable(1);g=[]}else{if(j===true){i.flipEnable(-1);g=[]}else{j.map(function(l){var m;for(var k=0;k<g.length;k+=1){if(i.isDateExact(l,g[k])){m=true;break}}if(!m){if(d.isInteger(l)||d.isDate(l)||e.isArray(l)||(e.isPlainObject(l)&&l.from&&l.to)){g.push(l)}}})}}}return g};b.prototype.activate=function(h,k){var j=this,g=j.item.disable,i=g.length;if(k=="flip"){j.flipEnable()}else{if(k===true){j.flipEnable(1);g=[]}else{if(k===false){j.flipEnable(-1);g=[]}else{k.map(function(o){var n,p,m,l;for(m=0;m<i;m+=1){p=g[m];if(j.isDateExact(p,o)){n=g[m]=null;l=true;break}else{if(j.isDateOverlap(p,o)){if(e.isPlainObject(o)){o.inverted=true;n=o}else{if(e.isArray(o)){n=o;if(!n[3]){n.push("inverted")}}else{if(d.isDate(o)){n=[o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),"inverted"]}}}break}}}if(n){for(m=0;m<i;m+=1){if(j.isDateExact(g[m],o)){g[m]=null;break}}}if(l){for(m=0;m<i;m+=1){if(j.isDateOverlap(g[m],o)){g[m]=null;break}}}if(n){g.push(n)}})}}}return g.filter(function(l){return l!=null})};b.prototype.nodes=function(g){var m=this,k=m.settings,r=m.item,p=r.now,i=r.select,u=r.highlight,o=r.view,h=r.disable,l=r.min,q=r.max,n=(function(w,v){if(k.firstDay){w.push(w.shift());v.push(v.shift())}return d.node("thead",d.node("tr",d.group({min:0,max:f-1,i:1,node:"th",item:function(x){return[w[x],k.klass.weekdays,'scope=col title="'+v[x]+'"']}})))})((k.showWeekdaysFull?k.weekdaysFull:k.weekdaysShort).slice(0),k.weekdaysFull.slice(0)),j=function(v){return d.node("div"," ",k.klass["nav"+(v?"Next":"Prev")]+((v&&o.year>=q.year&&o.month>=q.month)||(!v&&o.year<=l.year&&o.month<=l.month)?" "+k.klass.navDisabled:""),"data-nav="+(v||-1)+" "+d.ariaAttr({role:"button",controls:m.$node[0].id+"_table"})+' title="'+(v?k.labelMonthNext:k.labelMonthPrev)+'"')},t=function(){var v=k.showMonthsShort?k.monthsShort:k.monthsFull;if(k.selectMonths){return d.node("select",d.group({min:0,max:11,i:1,node:"option",item:function(w){return[v[w],0,"value="+w+(o.month==w?" selected":"")+(((o.year==l.year&&w<l.month)||(o.year==q.year&&w>q.month))?" disabled":"")]}}),k.klass.selectMonth,(g?"":"disabled")+" "+d.ariaAttr({controls:m.$node[0].id+"_table"})+' title="'+k.labelMonthSelect+'"')}return d.node("div",v[o.month],k.klass.month)},s=function(){var x=o.year,A=k.selectYears===true?5:~~(k.selectYears/2);if(A){var B=l.year,v=q.year,w=x-A,z=x+A;if(B>w){z+=B-w;w=B}if(v<z){var y=w-B,C=z-v;w-=y>C?C:y;z=v}return d.node("select",d.group({min:w,max:z,i:1,node:"option",item:function(D){return[D,0,"value="+D+(x==D?" selected":"")]}}),k.klass.selectYear,(g?"":"disabled")+" "+d.ariaAttr({controls:m.$node[0].id+"_table"})+' title="'+k.labelYearSelect+'"')}return d.node("div",x,k.klass.year)};return d.node("div",(k.selectYears?s()+t():t()+s())+j()+j(1),k.klass.header)+d.node("table",n+d.node("tbody",d.group({min:0,max:a-1,i:1,node:"tr",item:function(v){var w=k.firstDay&&m.create([o.year,o.month,1]).day===0?-7:0;return[d.group({min:f*v-o.day+w+1,max:function(){return this.min+f-1},i:1,node:"td",item:function(A){A=m.create([o.year,o.month,A+(k.firstDay?1:0)]);var z=i&&i.pick==A.pick,y=u&&u.pick==A.pick,x=h&&m.disabled(A)||A.pick<l.pick||A.pick>q.pick;return[d.node("div",A.date,(function(B){B.push(o.month==A.month?k.klass.infocus:k.klass.outfocus);if(p.pick==A.pick){B.push(k.klass.now)}if(z){B.push(k.klass.selected)}if(y){B.push(k.klass.highlighted)}if(x){B.push(k.klass.disabled)}return B.join(" ")})([k.klass.day]),"data-pick="+A.pick+" "+d.ariaAttr({role:"gridcell",selected:z&&m.$node.val()===d.trigger(m.formats.toString,m,[k.format,A])?true:null,activedescendant:y?true:null,disabled:x?true:null})),"",d.ariaAttr({role:"presentation"})]}})]}})),k.klass.table,'id="'+m.$node[0].id+'_table" '+d.ariaAttr({role:"grid",controls:m.$node[0].id,readonly:true}))+d.node("div",d.node("button",k.today,k.klass.buttonToday,"type=button data-pick="+p.pick+(g?"":" disabled")+" "+d.ariaAttr({controls:m.$node[0].id}))+d.node("button",k.clear,k.klass.buttonClear,"type=button data-clear=1"+(g?"":" disabled")+" "+d.ariaAttr({controls:m.$node[0].id})),k.klass.footer)};b.defaults=(function(g){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",format:"d mmmm, yyyy",klass:{table:g+"table",header:g+"header",navPrev:g+"nav--prev",navNext:g+"nav--next",navDisabled:g+"nav--disabled",month:g+"month",year:g+"year",selectMonth:g+"select--month",selectYear:g+"select--year",weekdays:g+"weekday",day:g+"day",disabled:g+"day--disabled",selected:g+"day--selected",highlighted:g+"day--highlighted",now:g+"day--today",infocus:g+"day--infocus",outfocus:g+"day--outfocus",footer:g+"footer",buttonClear:g+"button--clear",buttonToday:g+"button--today"}}})(c.klasses().picker+"__");c.extend("pickadate",b)}));
/*
 * Time picker for pickadate.js v3.5.0
 * http://amsul.github.io/pickadate.js/time.htm
 */
(function(a){if(typeof define=="function"&&define.amd){define(["picker","jquery"],a)}else{a(Picker,jQuery)}}(function(b,f){var g=24,e=60,d=12,h=g*e,c=b._;function a(l,n){var m=this,o=l.$node[0].value,j=l.$node.data("value"),k=j||o,i=j?n.formatSubmit:n.format;m.settings=n;m.$node=l.$node;m.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"};m.item={};m.item.clear=null;m.item.interval=n.interval||30;m.item.disable=(n.disable||[]).slice(0);m.item.enable=-(function(p){return p[0]===true?p.shift():-1})(m.item.disable);m.set("min",n.min).set("max",n.max).set("now");if(k){m.set("select",k,{format:i,fromValue:!!o})}else{m.set("select",null).set("highlight",m.item.now)}m.key={40:1,38:-1,39:1,37:-1,go:function(p){m.set("highlight",m.item.highlight.pick+p*m.item.interval,{interval:p*m.item.interval});this.render()}};l.on("render",function(){var q=l.$root.children(),p=q.find("."+n.klass.viewset);if(p.length){q[0].scrollTop=~~p.position().top-(p[0].clientHeight*2)}}).on("open",function(){l.$root.find("button").attr("disabled",false)}).on("close",function(){l.$root.find("button").attr("disabled",true)})}a.prototype.set=function(l,m,i){var j=this,k=j.item;if(m===null){if(l=="clear"){l="select"}k[l]=m;return j}k[(l=="enable"?"disable":l=="flip"?"enable":l)]=j.queue[l].split(" ").map(function(n){m=j[n](l,m,i);return m}).pop();if(l=="select"){j.set("highlight",k.select,i)}else{if(l=="highlight"){j.set("view",k.highlight,i)}else{if(l=="interval"){j.set("min",k.min,i).set("max",k.max,i)}else{if(l.match(/^(flip|min|max|disable|enable)$/)){if(l=="min"){j.set("max",k.max,i)}if(k.select&&j.disabled(k.select)){j.set("select",k.select,i)}if(k.highlight&&j.disabled(k.highlight)){j.set("highlight",k.highlight,i)}}}}}return j};a.prototype.get=function(i){return this.item[i]};a.prototype.create=function(k,l,i){var j=this;l=l===undefined?k:l;if(c.isDate(l)){l=[l.getUTCHours(),l.getUTCMinutes()]}if(f.isPlainObject(l)&&c.isInteger(l.pick)){l=l.pick}else{if(f.isArray(l)){l=+l[0]*e+(+l[1])}else{if(!c.isInteger(l)){l=j.now(k,l,i)}}}if(k=="max"&&l<j.item.min.pick){l+=h}if(k!="min"&&k!="max"&&(l-j.item.min.pick)%j.item.interval!==0){l+=j.item.interval}l=j.normalize(k,l,i);return{hour:~~(g+l/e)%g,mins:(e+l%e)%e,time:(h+l)%h,pick:l}};a.prototype.createRange=function(l,k){var i=this,j=function(m){if(m===true||f.isArray(m)||c.isDate(m)){return i.create(m)}return m};if(!c.isInteger(l)){l=j(l)}if(!c.isInteger(k)){k=j(k)}if(c.isInteger(l)&&f.isPlainObject(k)){l=[k.hour,k.mins+(l*i.settings.interval)]}else{if(c.isInteger(k)&&f.isPlainObject(l)){k=[l.hour,l.mins+(k*i.settings.interval)]}}return{from:j(l),to:j(k)}};a.prototype.withinRange=function(i,j){i=this.createRange(i.from,i.to);return j.pick>=i.from.pick&&j.pick<=i.to.pick};a.prototype.overlapRanges=function(k,i){var j=this;k=j.createRange(k.from,k.to);i=j.createRange(i.from,i.to);return j.withinRange(k,i.from)||j.withinRange(k,i.to)||j.withinRange(i,k.from)||j.withinRange(i,k.to)};a.prototype.now=function(l,m){var i=this.item.interval,j=new Date(),k=j.getUTCHours()*e+j.getUTCMinutes(),o=c.isInteger(m),n;k-=k%i;n=m<0&&i*m+k<=-i;k+=l=="min"&&n?0:i;if(o){k+=i*(n&&l!="max"?m+1:m)}return k};a.prototype.normalize=function(k,l){var j=this.item.interval,i=this.item.min&&this.item.min.pick||0;l-=k=="min"?0:(l-i)%j;return l};a.prototype.measure=function(k,l,i){var j=this;if(!l){l=k=="min"?[0,0]:[g-1,e-1]}else{if(l===true||c.isInteger(l)){l=j.now(k,l,i)}else{if(f.isPlainObject(l)&&c.isInteger(l.pick)){l=j.normalize(k,l.pick,i)}}}return l};a.prototype.validate=function(m,l,j){var k=this,i=j&&j.interval?j.interval:k.item.interval;if(k.disabled(l)){l=k.shift(l,i)}l=k.scope(l);if(k.disabled(l)){l=k.shift(l,i*-1)}return l};a.prototype.disabled=function(i){var j=this,k=j.item.disable.filter(function(l){if(c.isInteger(l)){return i.hour==l}if(f.isArray(l)||c.isDate(l)){return i.pick==j.create(l).pick}if(f.isPlainObject(l)){return j.withinRange(l,i)}});k=k.length&&!k.filter(function(l){return f.isArray(l)&&l[2]=="inverted"||f.isPlainObject(l)&&l.inverted}).length;return j.item.enable===-1?!k:k||i.pick<j.item.min.pick||i.pick>j.item.max.pick};a.prototype.shift=function(m,k){var l=this,i=l.item.min.pick,j=l.item.max.pick;k=k||l.item.interval;while(l.disabled(m)){m=l.create(m.pick+=k);if(m.pick<=i||m.pick>=j){break}}return m};a.prototype.scope=function(k){var i=this.item.min.pick,j=this.item.max.pick;return this.create(k.pick>j?j:k.pick<i?i:k)};a.prototype.parse=function(n,o,r){var k,j,l,p,m,i=this,q={};if(!o||typeof o!="string"){return o}if(!(r&&r.format)){r=r||{};r.format=i.settings.format}i.formats.toArray(r.format).map(function(t){var u,v=i.formats[t],s=v?c.trigger(v,i,[o,q]):t.replace(/^!/,"").length;if(v){u=o.substr(0,s);q[t]=u.match(/^\d+$/)?+u:u}o=o.substr(s)});for(p in q){m=q[p];if(c.isInteger(m)){if(p.match(/^(h|hh)$/i)){k=m;if(p=="h"||p=="hh"){k%=12}}else{if(p=="i"){j=m}}}else{if(p.match(/^a$/i)&&m.match(/^p/i)&&("h" in q||"hh" in q)){l=true}}}return(l?k+12:k)*e+j};a.prototype.formats={h:function(i,j){return i?c.digits(i):j.hour%d||d},hh:function(i,j){return i?2:c.lead(j.hour%d||d)},H:function(i,j){return i?c.digits(i):""+(j.hour%24)},HH:function(i,j){return i?c.digits(i):c.lead(j.hour%24)},i:function(i,j){return i?2:c.lead(j.mins)},a:function(i,j){return i?4:h/2>j.time%h?"a.m.":"p.m."},A:function(i,j){return i?2:h/2>j.time%h?"AM":"PM"},toArray:function(i){return i.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(i,j){var k=this;return k.formats.toArray(i).map(function(l){return c.trigger(k.formats[l],k,[0,j])||l.replace(/^!/,"")}).join("")}};a.prototype.isTimeExact=function(k,i){var j=this;if((c.isInteger(k)&&c.isInteger(i))||(typeof k=="boolean"&&typeof i=="boolean")){return k===i}if((c.isDate(k)||f.isArray(k))&&(c.isDate(i)||f.isArray(i))){return j.create(k).pick===j.create(i).pick}if(f.isPlainObject(k)&&f.isPlainObject(i)){return j.isTimeExact(k.from,i.from)&&j.isTimeExact(k.to,i.to)}return false};a.prototype.isTimeOverlap=function(k,i){var j=this;if(c.isInteger(k)&&(c.isDate(i)||f.isArray(i))){return k===j.create(i).hour}if(c.isInteger(i)&&(c.isDate(k)||f.isArray(k))){return i===j.create(k).hour}if(f.isPlainObject(k)&&f.isPlainObject(i)){return j.overlapRanges(k,i)}return false};a.prototype.flipEnable=function(j){var i=this.item;i.enable=j||(i.enable==-1?1:-1)};a.prototype.deactivate=function(l,i){var k=this,j=k.item.disable.slice(0);if(i=="flip"){k.flipEnable()}else{if(i===false){k.flipEnable(1);j=[]}else{if(i===true){k.flipEnable(-1);j=[]}else{i.map(function(n){var o;for(var m=0;m<j.length;m+=1){if(k.isTimeExact(n,j[m])){o=true;break}}if(!o){if(c.isInteger(n)||c.isDate(n)||f.isArray(n)||(f.isPlainObject(n)&&n.from&&n.to)){j.push(n)}}})}}}return j};a.prototype.activate=function(l,k){var j=this,i=j.item.disable,m=i.length;if(k=="flip"){j.flipEnable()}else{if(k===true){j.flipEnable(1);i=[]}else{if(k===false){j.flipEnable(-1);i=[]}else{k.map(function(p){var o,r,n,q;for(n=0;n<m;n+=1){r=i[n];if(j.isTimeExact(r,p)){o=i[n]=null;q=true;break}else{if(j.isTimeOverlap(r,p)){if(f.isPlainObject(p)){p.inverted=true;o=p}else{if(f.isArray(p)){o=p;if(!o[2]){o.push("inverted")}}else{if(c.isDate(p)){o=[p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate(),"inverted"]}}}break}}}if(o){for(n=0;n<m;n+=1){if(j.isTimeExact(i[n],p)){i[n]=null;break}}}if(q){for(n=0;n<m;n+=1){if(j.isTimeOverlap(i[n],p)){i[n]=null;break}}}if(o){i.push(o)}})}}}return i.filter(function(n){return n!=null})};a.prototype.i=function(i,j){return c.isInteger(j)&&j>0?j:this.item.interval};a.prototype.nodes=function(m){var l=this,n=l.settings,j=l.item.select,o=l.item.highlight,i=l.item.view,k=l.item.disable;return c.node("ul",c.group({min:l.item.min.pick,max:l.item.max.pick,i:l.item.interval,node:"li",item:function(r){r=l.create(r);var t=r.pick,s=j&&j.pick==t,q=o&&o.pick==t,p=k&&l.disabled(r);return[c.trigger(l.formats.toString,l,[c.trigger(n.formatLabel,l,[r])||n.format,r]),(function(u){if(s){u.push(n.klass.selected)}if(q){u.push(n.klass.highlighted)}if(i&&i.pick==t){u.push(n.klass.viewset)}if(p){u.push(n.klass.disabled)}return u.join(" ")})([n.klass.listItem]),"data-pick="+r.pick+" "+c.ariaAttr({role:"option",selected:s&&l.$node.val()===c.trigger(l.formats.toString,l,[n.format,r])?true:null,activedescendant:q?true:null,disabled:p?true:null})]}})+c.node("li",c.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(m?"":" disabled")+" "+c.ariaAttr({controls:l.$node[0].id})),"",c.ariaAttr({role:"presentation"})),n.klass.list,c.ariaAttr({role:"listbox",controls:l.$node[0].id}))};a.defaults=(function(i){return{clear:"Clear",format:"h:i A",interval:30,klass:{picker:i+" "+i+"--time",holder:i+"__holder",list:i+"__list",listItem:i+"__list-item",disabled:i+"__list-item--disabled",selected:i+"__list-item--selected",highlighted:i+"__list-item--highlighted",viewset:i+"__list-item--viewset",now:i+"__list-item--now",buttonClear:i+"__button--clear"}}})(b.klasses().picker);b.extend("pickatime",a)}));
/*
 * Legacy browser support
 */
if(![].map){Array.prototype.map=function(f,c){var e=this,b=e.length,a=new Array(b);for(var d=0;d<b;d++){if(d in e){a[d]=f.call(c,e[d],d,e)}}return a}}if(![].filter){Array.prototype.filter=function(g){if(this==null){throw new TypeError()}var e=Object(this),b=e.length>>>0;if(typeof g!="function"){throw new TypeError()}var a=[],d=arguments[1];for(var c=0;c<b;c++){if(c in e){var f=e[c];if(g.call(d,f,c,e)){a.push(f)}}}return a}}if(![].indexOf){Array.prototype.indexOf=function(c){if(this==null){throw new TypeError()}var d=Object(this),a=d.length>>>0;if(a===0){return -1}var e=0;if(arguments.length>1){e=Number(arguments[1]);if(e!=e){e=0}else{if(e!==0&&e!=Infinity&&e!=-Infinity){e=(e>0||-1)*Math.floor(Math.abs(e))}}}if(e>=a){return -1}var b=e>=0?e:Math.max(a-Math.abs(e),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1};
/*
 * Cross-Browser Split 1.1.1
 * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
 * Available under the MIT License
 * http://blog.stevenlevithan.com/archives/cross-browser-split
 */
}var nativeSplit=String.prototype.split,compliantExecNpcg=/()??/.exec("")[1]===undefined;String.prototype.split=function(f,e){var i=this;if(Object.prototype.toString.call(f)!=="[object RegExp]"){return nativeSplit.call(i,f,e)}var c=[],d=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.extended?"x":"")+(f.sticky?"y":""),a=0,b,g,h,j;f=new RegExp(f.source,d+"g");i+="";if(!compliantExecNpcg){b=new RegExp("^"+f.source+"$(?!\\s)",d)}e=e===undefined?-1>>>0:e>>>0;while(g=f.exec(i)){h=g.index+g[0].length;if(h>a){c.push(i.slice(a,g.index));if(!compliantExecNpcg&&g.length>1){g[0].replace(b,function(){for(var k=1;k<arguments.length-2;k++){if(arguments[k]===undefined){g[k]=undefined}}})}if(g.length>1&&g.index<i.length){Array.prototype.push.apply(c,g.slice(1))}j=g[0].length;a=h;if(c.length>=e){break}}if(f.lastIndex===g.index){f.lastIndex++}}if(a===i.length){if(j||!f.test("")){c.push("")}}else{c.push(i.slice(a))}return c.length>e?c.slice(0,e):c};
PickadateI18N="undefined"==typeof PickadateI18NVals?{}:PickadateI18N,$.extend(PickadateI18N,{ar:{pickadate:{monthsFull:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],weekdaysFull:["","","","","","",""],weekdaysShort:["","","","","","",""],today:"",clear:"",format:"yyyy mmmm dd",formatSubmit:"yyyy/mm/dd"},pickatime:{clear:""}}});
/*!
 * jQuery UI Widget 1.10.4+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(o){}s(e)},t.widget=function(e,i,n){var s,o,a,r,u={},d=e.split(".")[0];e=e.split(".")[1],s=d+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[d]=t[d]||{},o=t[d][e],a=t[d][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(n,function(e,n){return t.isFunction(n)?void(u[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(u[e]=n)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||e:e},u,{constructor:a,namespace:d,widgetName:e,widgetFullName:s}),o?(t.each(o._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a)},t.widget.extend=function(i){for(var s,o,a=n.call(arguments,1),r=0,u=a.length;u>r;r++)for(s in a[r])o=a[r][s],a[r].hasOwnProperty(s)&&o!==e&&(i[s]=t.isPlainObject(o)?t.isPlainObject(i[s])?t.widget.extend({},i[s],o):t.widget.extend({},o):o);return i},t.widget.bridge=function(i,s){var o=s.prototype.widgetFullName||i;t.fn[i]=function(a){var r="string"==typeof a,u=n.call(arguments,1),d=this;return a=!r&&u.length?t.widget.extend.apply(null,[a].concat(u)):a,this.each(r?function(){var n,s=t.data(this,o);return s?t.isFunction(s[a])&&"_"!==a.charAt(0)?(n=s[a].apply(s,u),n!==s&&n!==e?(d=n&&n.jquery?d.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+a+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+a+"'")}:function(){var e=t.data(this,o);e?e.option(a||{})._init():t.data(this,o,new s(a,this))}),d}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var s,o,a,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},s=i.split("."),i=s.shift(),s.length){for(o=r[i]=t.widget.extend({},this.options[i]),a=0;a<s.length-1;a++)o[s[a]]=o[s[a]]||{},o=o[s[a]];if(i=s.pop(),1===arguments.length)return o[i]===e?null:o[i];o[i]=n}else{if(1===arguments.length)return this.options[i]===e?null:this.options[i];r[i]=n}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var s,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,function(n,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var u=n.match(/^(\w+)\s*(.*)$/),d=u[1]+o.eventNamespace,h=u[2];h?s.delegate(h,d,r):i.bind(d,r)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,o,a=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,o){"string"==typeof s&&(s={effect:s});var a,r=s?s===!0||"number"==typeof s?i:s.effect||i:e;s=s||{},"number"==typeof s&&(s={duration:s}),a=!t.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),a&&t.effects&&t.effects.effect[r]?n[e](s):r!==e&&n[r]?n[r](s.duration,s.easing,o):n.queue(function(i){t(this)[e](),o&&o.call(n[0]),i()})}})});
/*
 * jQuery Iframe Transport Plugin 1.8.2
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){"use strict";var t=0;e.ajaxTransport("iframe",function(r){if(r.async){var n,a,o,i=r.initialIframeSrc||"javascript:false;";return{send:function(p,m){n=e('<form style="display:none;"></form>'),n.attr("accept-charset",r.formAcceptCharset),o=/\?/.test(r.url)?"&":"?","DELETE"===r.type?(r.url=r.url+o+"_method=DELETE",r.type="POST"):"PUT"===r.type?(r.url=r.url+o+"_method=PUT",r.type="POST"):"PATCH"===r.type&&(r.url=r.url+o+"_method=PATCH",r.type="POST"),t+=1,a=e('<iframe src="'+i+'" name="iframe-transport-'+t+'"></iframe>').bind("load",function(){var t,o=e.isArray(r.paramName)?r.paramName:[r.paramName];a.unbind("load").bind("load",function(){var t;try{if(t=a.contents(),!t.length||!t[0].firstChild)throw new Error}catch(r){t=void 0}m(200,"success",{iframe:t}),e('<iframe src="'+i+'"></iframe>').appendTo(n),window.setTimeout(function(){n.remove()},0)}),n.prop("target",a.prop("name")).prop("action",r.url).prop("method",r.type),r.formData&&e.each(r.formData,function(t,r){e('<input type="hidden"/>').prop("name",r.name).val(r.value).appendTo(n)}),r.fileInput&&r.fileInput.length&&"POST"===r.type&&(t=r.fileInput.clone(),r.fileInput.after(function(e){return t[e]}),r.paramName&&r.fileInput.each(function(t){e(this).prop("name",o[t]||r.paramName)}),n.append(r.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),r.fileInput.removeAttr("form")),n.submit(),t&&t.length&&r.fileInput.each(function(r,n){var a=e(t[r]);e(n).prop("name",a.prop("name")).attr("form",a.attr("form")),a.replaceWith(n)})}),n.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src",i),n&&n.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var r=t&&t[0];return r&&e.isXMLDoc(r)?r:e.parseXML(r.XMLDocument&&r.XMLDocument.xml||e(r.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})});
/*
 * jQuery File Upload Plugin 5.40.3
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){return t.isDefaultPrevented()?!1:void((i.autoUpload||i.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var r=e-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var r,n=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&n-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=n,r=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=r-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=r,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(n,r,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,i._onProgress(e,t)}),t.xhr=function(){return r})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,r=this,n=t.files[0],o=t.multipart||!e.support.xhrFileUpload,s="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:s,value:t.blob}):e.each(t.files,function(r,n){i.push({name:"array"===e.type(t.paramName)&&t.paramName[r]||s,value:n})})):(r._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(s,t.blob,n.name):e.each(t.files,function(n,o){(r._isInstanceOf("File",o)||r._isInstanceOf("Blob",o))&&i.append("array"===e.type(t.paramName)&&t.paramName[n]||s,o,o.uploadName||o.name)})),t.data=i):(t.contentType=n.type||"application/octet-stream",t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)r.push(i),n-=1}),r.length||(r=[i.prop("name")||"files[]"])),r},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,r){var n=e.Deferred(),o=n.promise();return i=i||this.options.context||o,t===!0?n.resolveWith(i,r):t===!1&&n.rejectWith(i,r),o.abort=n.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,i){var r=this,n=function(t){return e.Deferred().resolveWith(r,t).promise()};i.process=function(t,o){return(t||o)&&(i._processQueue=this._processQueue=(this._processQueue||n([this])).pipe(function(){return i.errorThrown?e.Deferred().rejectWith(r,[i]).promise():n(arguments)}).pipe(t,o)),this._processQueue||n([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=r._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},i.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===r._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),r=i&&i.length>1&&parseInt(i[1],10);return r&&r+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var r,n,o=this,s=t.files[0],a=s.size,l=t.uploadedBytes,p=t.maxChunkSize||a,u=this._blobSlice,d=e.Deferred(),h=d.promise();return this._isXHRUpload(t)&&u&&(l||a>p)&&!t.data?i?!0:l>=a?(s.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",s.error])):(n=function(){var i=e.extend({},t),h=i._progress.loaded;i.blob=u.call(s,l,l+p,s.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+a,o._initXHRData(i),o._initProgressListener(i),r=(o._trigger("chunksend",null,i)!==!1&&e.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(r,s,p){l=o._getUploadedBytes(p)||l+i.chunkSize,h+i.chunkSize-i._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=r,i.textStatus=s,i.jqXHR=p,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),a>l?n():d.resolveWith(i.context,[r,s,p])}).fail(function(e,t,r){i.jqXHR=e,i.textStatus=t,i.errorThrown=r,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),d.rejectWith(i.context,[e,t,r])})},this._enhancePromise(h),h.abort=function(){return r.abort()},n(),h):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,r,n){var o=n._progress.total,s=n._response;n._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),n),s.result=n.result=t,s.textStatus=n.textStatus=i,s.jqXHR=n.jqXHR=r,this._trigger("done",null,n)},_onFail:function(e,t,i,r){var n=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),n.jqXHR=r.jqXHR=e,n.textStatus=r.textStatus=t,n.errorThrown=r.errorThrown=i,this._trigger("fail",null,r)},_onAlways:function(e,t,i,r){this._trigger("always",null,r)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r,n,o,s,a=this,l=a._getAJAXSettings(i),p=function(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,r=r||((n||a._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&a._getXHRPromise(!1,l.context,n)||a._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){a._onDone(e,t,i,l)}).fail(function(e,t,i){a._onFail(e,t,i,l)}).always(function(e,t,i){if(a._onAlways(e,t,i,l),a._sending-=1,a._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var r=a._slots.shift();r;){if("pending"===a._getDeferredState(r)){r.resolve();break}r=a._slots.shift()}0===a._active&&a._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),s=o.pipe(p)):(this._sequence=this._sequence.pipe(p,p),s=this._sequence),s.abort=function(){return n=[void 0,"abort","abort"],r?r.abort():(o&&o.rejectWith(l.context,n),p())},this._enhancePromise(s)):p()},_onAdd:function(t,i){var r,n,o,s,a=this,l=!0,p=e.extend({},this.options,i),u=i.files,d=u.length,h=p.limitMultiFileUploads,c=p.limitMultiFileUploadSize,f=p.limitMultiFileUploadSizeOverhead,g=0,_=this._getParamName(p),m=0;if(!c||d&&void 0!==u[0].size||(c=void 0),(p.singleFileUploads||h||c)&&this._isXHRUpload(p))if(p.singleFileUploads||c||!h)if(!p.singleFileUploads&&c)for(o=[],r=[],s=0;d>s;s+=1)g+=u[s].size+f,(s+1===d||g+u[s+1].size+f>c||h&&s+1-m>=h)&&(o.push(u.slice(m,s+1)),n=_.slice(m,s+1),n.length||(n=_),r.push(n),m=s+1,g=0);else r=_;else for(o=[],r=[],s=0;d>s;s+=h)o.push(u.slice(s,s+h)),n=_.slice(s,s+h),n.length||(n=_),r.push(n);else o=[u],r=[_];return i.originalFiles=u,e.each(o||u,function(n,s){var p=e.extend({},i);return p.files=o?s:[s],p.paramName=r[n],a._initResponseObject(p),a._initProgressObject(p),a._addConvenienceMethods(t,p),l=a._trigger("add",e.Event("add",{delegatedEvent:t}),p)}),l},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,r){return r===t[0]?i[0]:r}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var r,n=this,o=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])},a=function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){o.resolve(e)}).fail(s)},l=function(){r.readEntries(function(e){e.length?(p=p.concat(e),l()):a(p)},s)},p=[];return i=i||"",t.isFile?t._file?(t._file.relativePath=i,o.resolve(t._file)):t.file(function(e){e.relativePath=i,o.resolve(e)},s):t.isDirectory?(r=t.createReader(),l()):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,i){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,r,n=t.prop("webkitEntries")||t.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(r=t.prop("value"),!r)return e.Deferred().resolve([]).promise();i=[{name:r.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(n){r.files=n,i.options.replaceFileInput&&i._replaceFileInput(r.fileInput),i._trigger("change",e.Event("change",{delegatedEvent:t}),r)!==!1&&i._onAdd(t,r)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&r.files.push(i)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),r)!==!1&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,r=t.dataTransfer,n={};r&&r.files&&r.files.length&&(t.preventDefault(),this._getDroppedFiles(r).always(function(r){n.files=r,i._trigger("drop",e.Event("drop",{delegatedEvent:t}),n)!==!1&&i._onAdd(t,n)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=t.dataTransfer;i&&-1!==e.inArray("Files",i.types)&&this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))!==!1&&(t.preventDefault(),i.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var r=-1!==e.inArray(t,this._specialOptions);r&&this._destroyEventHandlers(),this._super(t,i),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,r=e(this.element[0].cloneNode(!1));e.each(r.data(),function(e,n){var o="data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();r.attr(o)&&(t._isRegExpOption(e,n)&&(n=t._getRegExp(n)),i[e]=n)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,r,n=this,o=e.Deferred(),s=o.promise();return s.abort=function(){return r=!0,i?i.abort():(o.reject(null,"abort","abort"),s)},this._getFileInputFiles(t.fileInput).always(function(e){if(!r){if(!e.length)return void o.reject();t.files=e,i=n._onSend(null,t),i.then(function(e,t,i){o.resolve(e,t,i)},function(e,t,i){o.reject(e,t,i)})}}),this._enhancePromise(s)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});
/*!
 * jquery.customSelect() - v0.5.1
 * http://adam.co/lab/jquery/customselect/
 * 2014-04-19
 *
 * Copyright 2013 Adam Coulombe
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License 
 */
(function(a){a.fn.extend({customSelect:function(c){if(typeof document.body.style.maxHeight==="undefined"){return this}var e={customClass:"customSelect",mapClass:true,mapStyle:true},c=a.extend(e,c),d=c.customClass,f=function(h,k){var g=h.find(":selected"),j=k.children(":first"),i=g.html()||"&nbsp;";j.html(i);if(g.attr("disabled")){k.addClass(b("DisabledOption"))}else{k.removeClass(b("DisabledOption"))}setTimeout(function(){k.removeClass(b("Open"));a(document).off("mouseup.customSelect")},60)},b=function(g){return d+g};return this.each(function(){var g=a(this),i=a("<span />").addClass(b("Inner")),h=a("<span />");g.after(h.append(i));h.addClass(d);if(c.mapClass){h.addClass(g.attr("class"))}if(c.mapStyle){h.attr("style",g.attr("style"))}g.addClass("hasCustomSelect").on("render.customSelect",function(){f(g,h);g.css("width","");var k=parseInt(g.outerWidth(),10)-(parseInt(h.outerWidth(),10)-parseInt(h.width(),10));h.css({display:"inline-block"});var j=h.outerHeight();if(g.attr("disabled")){h.addClass(b("Disabled"))}else{h.removeClass(b("Disabled"))}i.css({width:k,display:"inline-block"});g.css({"-webkit-appearance":"menulist-button",width:h.outerWidth(),position:"absolute",opacity:0,height:j,fontSize:h.css("font-size")})}).on("change.customSelect",function(){h.addClass(b("Changed"));f(g,h)}).on("keyup.customSelect",function(j){if(!h.hasClass(b("Open"))){g.trigger("blur.customSelect");g.trigger("focus.customSelect")}else{if(j.which==13||j.which==27){f(g,h)}}}).on("mousedown.customSelect",function(){h.removeClass(b("Changed"))}).on("mouseup.customSelect",function(j){if(!h.hasClass(b("Open"))){if(a("."+b("Open")).not(h).length>0&&typeof InstallTrigger!=="undefined"){g.trigger("focus.customSelect")}else{h.addClass(b("Open"));j.stopPropagation();a(document).one("mouseup.customSelect",function(k){if(k.target!=g.get(0)&&a.inArray(k.target,g.find("*").get())<0){g.trigger("blur.customSelect")}else{f(g,h)}})}}}).on("focus.customSelect",function(){h.removeClass(b("Changed")).addClass(b("Focus"))}).on("blur.customSelect",function(){h.removeClass(b("Focus")+" "+b("Open"))}).on("mouseenter.customSelect",function(){h.addClass(b("Hover"))}).on("mouseleave.customSelect",function(){h.removeClass(b("Hover"))}).trigger("render.customSelect")})}})})(jQuery);
/**
* jquery.matchHeight-min.js v0.5.2
* http://brm.io/jquery-match-height/
* License: MIT
*/
(function(b){var f=-1,e=-1,m=function(a){var d=null,c=[];b(a).each(function(){var a=b(this),h=a.offset().top-g(a.css("margin-top")),k=0<c.length?c[c.length-1]:null;null===k?c.push(a):1>=Math.floor(Math.abs(d-h))?c[c.length-1]=k.add(a):c.push(a);d=h});return c},g=function(b){return parseFloat(b)||0};b.fn.matchHeight=function(a){if("remove"===a){var d=this;this.css("height","");b.each(b.fn.matchHeight._groups,function(b,a){a.elements=a.elements.not(d)});return this}if(1>=this.length)return this;a="undefined"!==
typeof a?a:!0;b.fn.matchHeight._groups.push({elements:this,byRow:a});b.fn.matchHeight._apply(this,a);return this};b.fn.matchHeight._groups=[];b.fn.matchHeight._throttle=80;b.fn.matchHeight._maintainScroll=!1;b.fn.matchHeight._apply=function(a,d){var c=b(a),e=[c],h=b(window).scrollTop(),k=b("html").outerHeight(!0),f=c.parents().filter(":hidden");f.css("display","block");d&&(c.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.data("style-cache",a.attr("style"));
a.css({display:c,"padding-top":"0","padding-bottom":"0","margin-top":"0","margin-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px"})}),e=m(c),c.each(function(){var a=b(this);a.attr("style",a.data("style-cache")||"").css("height","")}));b.each(e,function(a,c){var e=b(c),f=0;d&&1>=e.length||(e.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.css({display:c,height:""});a.outerHeight(!1)>f&&(f=a.outerHeight(!1));a.css("display","")}),
e.each(function(){var a=b(this),c=0;"border-box"!==a.css("box-sizing")&&(c+=g(a.css("border-top-width"))+g(a.css("border-bottom-width")),c+=g(a.css("padding-top"))+g(a.css("padding-bottom")));a.css("height",f-c)}))});f.css("display","");b.fn.matchHeight._maintainScroll&&b(window).scrollTop(h/k*b("html").outerHeight(!0));return this};b.fn.matchHeight._applyDataApi=function(){var a={};b("[data-match-height], [data-mh]").each(function(){var d=b(this),c=d.attr("data-match-height")||d.attr("data-mh");
a[c]=c in a?a[c].add(d):d});b.each(a,function(){this.matchHeight(!0)})};var l=function(){b.each(b.fn.matchHeight._groups,function(){b.fn.matchHeight._apply(this.elements,this.byRow)})};b.fn.matchHeight._update=function(a,d){if(d&&"resize"===d.type){var c=b(window).width();if(c===f)return;f=c}a?-1===e&&(e=setTimeout(function(){l();e=-1},b.fn.matchHeight._throttle)):l()};b(b.fn.matchHeight._applyDataApi);b(window).bind("load",function(a){b.fn.matchHeight._update()});b(window).bind("resize orientationchange",
function(a){b.fn.matchHeight._update(!0,a)})})(jQuery);

!function(e){jQuery.fn.putCursorAtEnd=function(){function t(e){var t,n;document.createRange?(t=document.createRange(),t.selectNodeContents(e),t.collapse(!1),n=window.getSelection(),n.removeAllRanges(),n.addRange(t)):document.selection&&(t=document.body.createTextRange(),t.moveToElementText(e),t.collapse(!1),t.select())}return this.each(function(){if(e(this).is("[contenteditable]"))t(this);else if(e(this).focus(),this.setSelectionRange){var n=2*e(this).val().length;this.setSelectionRange(n,n)}else e(this).val(e(this).val());this.scrollTop=999999})}}(jQuery);
!function(e){function t(){var e=document.createElement("input"),t="onpaste";return e.setAttribute(t,""),"function"==typeof e[t]?"paste":"input"}var n,a=t()+".mask",r=navigator.userAgent,i=/iphone/i.test(r),o=/android/i.test(r);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({putcaret:function(e,t){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&(n=this.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,r){var c,u,l,s,f,h;return!t&&this.length>0?(c=e(this[0]),c.data(e.mask.dataName)()):(r=e.extend({placeholder:e.mask.placeholder,completed:null},r),u=e.mask.definitions,l=[],s=h=t.length,f=null,e.each(t.split(""),function(e,t){"?"==t?(h--,s=e):u[t]?(l.push(new RegExp(u[t])),null===f&&(f=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function c(e){for(;++e<h&&!l[e];);return e}function p(e){for(;--e>=0&&!l[e];);return e}function d(e,t){var n,a;if(!(0>e)){for(n=e,a=c(t);h>n;n++)if(l[n]){if(!(h>a&&l[n].test(R[a])))break;R[n]=R[a],R[a]=r.placeholder,a=c(a)}b(),x.putcaret(Math.max(f,e))}}function m(e){var t,n,a,i;for(t=e,n=r.placeholder;h>t;t++)if(l[t]){if(a=c(t),i=R[t],R[t]=n,!(h>a&&l[a].test(i)))break;n=i}}function g(e){var t,n,a,r=e.which;8===r||46===r||i&&127===r?(t=x.putcaret(),n=t.begin,a=t.end,a-n===0&&(n=46!==r?p(n):a=c(n-1),a=46===r?c(a):a),k(n,a),d(n,a-1),e.preventDefault()):27==r&&(x.val(S),x.putcaret(0,y()),e.preventDefault())}function v(t){var n,a,i,u=t.which,s=x.putcaret();t.ctrlKey||t.altKey||t.metaKey||32>u||u&&(s.end-s.begin!==0&&(k(s.begin,s.end),d(s.begin,s.end-1)),n=c(s.begin-1),h>n&&(a=String.fromCharCode(u),l[n].test(a)&&(m(n),R[n]=a,b(),i=c(n),o?setTimeout(e.proxy(e.fn.putcaret,x,i),0):x.putcaret(i),r.completed&&i>=h&&r.completed.call(x))),t.preventDefault())}function k(e,t){var n;for(n=e;t>n&&h>n;n++)l[n]&&(R[n]=r.placeholder)}function b(){x.val(R.join(""))}function y(e){var t,n,a=x.val(),i=-1;for(t=0,pos=0;h>t;t++)if(l[t]){for(R[t]=r.placeholder;pos++<a.length;)if(n=a.charAt(pos-1),l[t].test(n)){R[t]=n,i=t;break}if(pos>a.length)break}else R[t]===a.charAt(pos)&&t!==s&&(pos++,i=t);return e?b():s>i+1?(x.val(""),k(0,h)):(b(),x.val(x.val().substring(0,i+1))),s?t:f}var x=e(this),R=e.map(t.split(""),function(e,t){return"?"!=e?u[e]?r.placeholder:e:void 0}),S=x.val();x.data(e.mask.dataName,function(){return e.map(R,function(e,t){return l[t]&&e!=r.placeholder?e:null}).join("")}),x.attr("readonly")||x.one("unmask",function(){x.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){clearTimeout(n);var e;S=x.val(),e=y(),n=setTimeout(function(){b(),e==t.length?x.putcaret(0,e):x.putcaret(e)},10)}).bind("blur.mask",function(){y(),x.val()!=S&&x.change()}).bind("keydown.mask",g).bind("keypress.mask",v).bind(a,function(){setTimeout(function(){var e=y(!0);x.putcaret(e),r.completed&&e==x.val().length&&r.completed.call(x)},0)}),y()}))}})}(jQuery);
(function(b){function a(h,j){var m=b(h);var g={font:m.css("font-family"),onLoad:"",onFail:"",testFont:"Comic Sans MS",testString:"QW@HhsXJ",delay:50,timeOut:2500,callback:b.noop};var f=b.extend(g,j);var i=b("<span>"+f.testString+"</span>").css("position","absolute").css("top","-9999px").css("left","-9999px").css("visibility","hidden").css("fontFamily",f.testFont).css("fontSize","250px");b("body").append(i);var e=i.outerWidth();i.css("fontFamily",f.font+","+f.testFont);function k(){var n=i.outerWidth();if(e!==n){l()}else{if(f.timeOut<0){d()}else{c()}}}function d(){m.removeClass(f.onLoad);m.addClass(f.onFail);f.callback(new Error("FontSpy timeout"));i.remove()}function l(){f.callback();m.removeClass(f.onLoad);i.remove()}function c(){m.addClass(f.onLoad);setTimeout(k,f.delay);f.timeOut=f.timeOut-f.delay}k()}b.fn.fontSpy=function(c){return this.each(function(){if(undefined==b(this).data("fontSpy")){var d=new a(this,c);b(this).data("fontSpy",d)}})}})(jQuery);
(function($){$.timer=function(func,time,autostart){this.set=function(func,time,autostart){this.init=true;if(typeof func=="object"){var paramList=["autostart","time"];for(var arg in paramList){if(func[paramList[arg]]!=undefined){eval(paramList[arg]+" = func[paramList[arg]]")}}func=func.action}if(typeof func=="function"){this.action=func}if(!isNaN(time)){this.intervalTime=time}if(autostart&&!this.isActive){this.isActive=true;this.setTimer()}return this};this.once=function(time){var timer=this;if(isNaN(time)){time=0}window.setTimeout(function(){timer.action()},time);return this};this.play=function(reset){if(!this.isActive){if(reset){this.setTimer()}else{this.setTimer(this.remaining)}this.isActive=true}return this};this.pause=function(){if(this.isActive){this.isActive=false;this.remaining-=new Date()-this.last;this.clearTimer()}return this};this.stop=function(){this.isActive=false;this.remaining=this.intervalTime;this.clearTimer();return this};this.toggle=function(reset){if(this.isActive){this.pause()}else{if(reset){this.play(true)}else{this.play()}}return this};this.reset=function(){this.isActive=false;this.play(true);return this};this.clearTimer=function(){window.clearTimeout(this.timeoutObject)};this.setTimer=function(time){var timer=this;if(typeof this.action!="function"){return}if(isNaN(time)){time=this.intervalTime}this.remaining=time;this.last=new Date();this.clearTimer();this.timeoutObject=window.setTimeout(function(){timer.go()},time)};this.go=function(){if(this.isActive){this.action();this.setTimer()}};if(this.init){return new $.timer(func,time,autostart)}else{this.set(func,time,autostart);return this}}})(jQuery);
!function(t){jQuery.fn.extPosition=function(){var i=t(this),o=i.position();return o.right=o.left+i.width(),o.bottom=o.top+i.height(),o},jQuery.fn.extOffset=function(){var i=t(this),o=i.offset();return o.right=o.left+i.width(),o.bottom=o.top+i.height(),o}}(jQuery);
!function(n){"use strict";function t(n,t){var r=(65535&n)+(65535&t),e=(n>>16)+(t>>16)+(r>>16);return e<<16|65535&r}function r(n,t){return n<<t|n>>>32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&r|~t&o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&o|r&~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r>>5]|=128<<r%32,n[(r+64>>>9<<4)+14]=r;var e,i,a,h,d,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e<n.length;e+=16)i=l,a=g,h=v,d=m,l=o(l,g,v,m,n[e],7,-680876936),m=o(m,l,g,v,n[e+1],12,-389564586),v=o(v,m,l,g,n[e+2],17,606105819),g=o(g,v,m,l,n[e+3],22,-1044525330),l=o(l,g,v,m,n[e+4],7,-176418897),m=o(m,l,g,v,n[e+5],12,1200080426),v=o(v,m,l,g,n[e+6],17,-1473231341),g=o(g,v,m,l,n[e+7],22,-45705983),l=o(l,g,v,m,n[e+8],7,1770035416),m=o(m,l,g,v,n[e+9],12,-1958414417),v=o(v,m,l,g,n[e+10],17,-42063),g=o(g,v,m,l,n[e+11],22,-1990404162),l=o(l,g,v,m,n[e+12],7,1804603682),m=o(m,l,g,v,n[e+13],12,-40341101),v=o(v,m,l,g,n[e+14],17,-1502002290),g=o(g,v,m,l,n[e+15],22,1236535329),l=u(l,g,v,m,n[e+1],5,-165796510),m=u(m,l,g,v,n[e+6],9,-1069501632),v=u(v,m,l,g,n[e+11],14,643717713),g=u(g,v,m,l,n[e],20,-373897302),l=u(l,g,v,m,n[e+5],5,-701558691),m=u(m,l,g,v,n[e+10],9,38016083),v=u(v,m,l,g,n[e+15],14,-660478335),g=u(g,v,m,l,n[e+4],20,-405537848),l=u(l,g,v,m,n[e+9],5,568446438),m=u(m,l,g,v,n[e+14],9,-1019803690),v=u(v,m,l,g,n[e+3],14,-187363961),g=u(g,v,m,l,n[e+8],20,1163531501),l=u(l,g,v,m,n[e+13],5,-1444681467),m=u(m,l,g,v,n[e+2],9,-51403784),v=u(v,m,l,g,n[e+7],14,1735328473),g=u(g,v,m,l,n[e+12],20,-1926607734),l=c(l,g,v,m,n[e+5],4,-378558),m=c(m,l,g,v,n[e+8],11,-2022574463),v=c(v,m,l,g,n[e+11],16,1839030562),g=c(g,v,m,l,n[e+14],23,-35309556),l=c(l,g,v,m,n[e+1],4,-1530992060),m=c(m,l,g,v,n[e+4],11,1272893353),v=c(v,m,l,g,n[e+7],16,-155497632),g=c(g,v,m,l,n[e+10],23,-1094730640),l=c(l,g,v,m,n[e+13],4,681279174),m=c(m,l,g,v,n[e],11,-358537222),v=c(v,m,l,g,n[e+3],16,-722521979),g=c(g,v,m,l,n[e+6],23,76029189),l=c(l,g,v,m,n[e+9],4,-640364487),m=c(m,l,g,v,n[e+12],11,-421815835),v=c(v,m,l,g,n[e+15],16,530742520),g=c(g,v,m,l,n[e+2],23,-995338651),l=f(l,g,v,m,n[e],6,-198630844),m=f(m,l,g,v,n[e+7],10,1126891415),v=f(v,m,l,g,n[e+14],15,-1416354905),g=f(g,v,m,l,n[e+5],21,-57434055),l=f(l,g,v,m,n[e+12],6,1700485571),m=f(m,l,g,v,n[e+3],10,-1894986606),v=f(v,m,l,g,n[e+10],15,-1051523),g=f(g,v,m,l,n[e+1],21,-2054922799),l=f(l,g,v,m,n[e+8],6,1873313359),m=f(m,l,g,v,n[e+15],10,-30611744),v=f(v,m,l,g,n[e+6],15,-1560198380),g=f(g,v,m,l,n[e+13],21,1309151649),l=f(l,g,v,m,n[e+4],6,-145523070),m=f(m,l,g,v,n[e+11],10,-1120210379),v=f(v,m,l,g,n[e+2],15,718787259),g=f(g,v,m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,h),m=t(m,d);return[l,g,v,m]}function a(n){var t,r="";for(t=0;t<32*n.length;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function h(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;for(t=0;t<8*n.length;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function d(n){return a(i(h(n),8*n.length))}function l(n,t){var r,e,o=h(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length>16&&(o=i(o,8*n.length)),r=0;16>r;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(h(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e="0123456789abcdef",o="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),o+=e.charAt(t>>>4&15)+e.charAt(15&t);return o}function v(n){return unescape(encodeURIComponent(n))}function m(n){return d(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}"function"==typeof define&&define.amd?define(function(){return A}):"object"==typeof module&&module.exports?module.exports=A:n.md5=A}(this);
!function(e,t){"use strict";function i(e,t){for(var i=0,s=e.length,a=[];s>i;i++)a[i]=t(e[i],i);return a}function s(e){return e}function a(e,l){var h=this,c=t;l=l||{},void 0!==e&&("string"==typeof e?(l.selector=e,e=void 0):"undefined"==typeof e.length&&(l=e,e=void 0)),this.imagesOffScreen=[],this.viewportHeight=c.documentElement.clientHeight,this.selector=l.selector||".delayed-image-load",this.className=l.className||"image-replace",this.gif=c.createElement("img"),this.gif.src=l.placeHolderSrc||"data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7",this.gif.className=this.className,this.gif.alt="",this.scrollDelay=l.scrollDelay||250,this.onResize=l.hasOwnProperty("onResize")?l.onResize:!0,this.lazyload=l.hasOwnProperty("lazyload")?l.lazyload:!1,this.scrolled=!1,this.availablePixelRatios=l.availablePixelRatios||[1,2],this.availableWidths=l.availableWidths||n,this.onImagesReplaced=l.onImagesReplaced||function(){},this.widthsMap={},this.refreshPixelRatio(),this.widthInterpolator=l.widthInterpolator||s,this.gif.removeAttribute("height"),this.gif.removeAttribute("width"),"function"!=typeof this.availableWidths&&("number"==typeof this.availableWidths.length?this.widthsMap=a.createWidthsMap(this.availableWidths,this.widthInterpolator):(this.widthsMap=this.availableWidths,this.availableWidths=r(this.availableWidths)),this.availableWidths=this.availableWidths.sort(function(e,t){return e-t})),e?(this.divs=i(e,s),this.selector=null):this.divs=i(c.querySelectorAll(this.selector),s),this.changeDivsToEmptyImages(),o(function(){h.init()})}var n,r,o,l,h;o=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},h=function(){return Object.prototype.hasOwnProperty.call(t.createElement("img"),"naturalWidth")?function(e){return e.naturalWidth}:function(e){var i=t.createElement("img");return i.src=e.src,i.width}}(),l=function(){return t.addEventListener?function(e,t,i){return e.addEventListener(t,i,!1)}:function(e,t,i){return e.attachEvent("on"+t,i)}}(),n=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736],r="function"==typeof Object.keys?Object.keys:function(e){var t,i=[];for(t in e)i.push(t);return i},a.prototype.scrollCheck=function(){this.scrolled&&(this.imagesOffScreen.length||e.clearInterval(this.interval),this.divs=this.imagesOffScreen.slice(0),this.imagesOffScreen.length=0,this.changeDivsToEmptyImages(),this.scrolled=!1)},a.prototype.init=function(){this.initialized=!0,this.checkImagesNeedReplacing(this.divs),this.onResize&&this.registerResizeEvent(),this.lazyload&&this.registerScrollEvent()},a.prototype.createGif=function(e){if(e.className.match(new RegExp("(^| )"+this.className+"( |$)")))return e;var t=e.getAttribute("data-class"),i=e.getAttribute("data-width"),s=this.gif.cloneNode(!1);return i&&(s.width=i,s.setAttribute("data-width",i)),s.className=(t?t+" ":"")+this.className,s.setAttribute("data-src",e.getAttribute("data-src")),s.setAttribute("alt",e.getAttribute("data-alt")||this.gif.alt),e.parentNode.replaceChild(s,e),s},a.prototype.changeDivsToEmptyImages=function(){var e=this;i(this.divs,function(t,i){e.lazyload?e.isThisElementOnScreen(t)?e.divs[i]=e.createGif(t):e.imagesOffScreen.push(t):e.divs[i]=e.createGif(t)}),this.initialized&&this.checkImagesNeedReplacing(this.divs)},a.prototype.isThisElementOnScreen=function(e){var t=a.getPageOffset(),i=0;if(e.offsetParent)do i+=e.offsetTop;while(e=e.offsetParent);return i<this.viewportHeight+t?!0:!1},a.prototype.checkImagesNeedReplacing=function(e){var t=this;this.isResizing||(this.isResizing=!0,this.refreshPixelRatio(),i(e,function(e){t.replaceImagesBasedOnScreenDimensions(e)}),this.isResizing=!1,this.onImagesReplaced(e))},a.prototype.replaceImagesBasedOnScreenDimensions=function(e){var t,i,s;s=h(e),t="function"==typeof this.availableWidths?this.availableWidths(e):this.determineAppropriateResolution(e),e.width=t,e.src!==this.gif.src&&s>=t||(i=this.changeImageSrcToUseNewImageDimensions(e.getAttribute("data-src"),t),this.setNewValue(e,i))},a.prototype.setNewValue=function(e,t){e.src=t},a.prototype.determineAppropriateResolution=function(e){return a.getClosestValue(e.getAttribute("data-width")||e.parentNode.clientWidth,this.availableWidths)},a.prototype.refreshPixelRatio=function(){this.devicePixelRatio=a.getClosestValue(a.getPixelRatio(),this.availablePixelRatios)},a.prototype.changeImageSrcToUseNewImageDimensions=function(e,t){return e.replace(/{width}/g,a.transforms.width(t,this.widthsMap)).replace(/{pixel_ratio}/g,a.transforms.pixelRatio(this.devicePixelRatio))},a.getPixelRatio=function(t){return(t||e).devicePixelRatio||1},a.createWidthsMap=function(e,t){for(var i={},s=e.length;s--;)i[e[s]]=t(e[s]);return i},a.transforms={pixelRatio:function(e){return 1===e?"":"-"+e+"x"},width:function(e,t){return t[e]||e}},a.getClosestValue=function(e,t){var i=t.length,s=t[i-1];for(e=parseFloat(e,10);i--;)e<=t[i]&&(s=t[i]);return s},a.prototype.registerResizeEvent=function(){var t=this;l(e,"resize",function(){t.checkImagesNeedReplacing(t.divs)})},a.prototype.registerScrollEvent=function(){var t=this;this.scrolled=!1,this.interval=e.setInterval(function(){t.scrollCheck()},t.scrollDelay),l(e,"scroll",function(){t.scrolled=!0})},a.getPageOffsetGenerator=function(i){return i?function(){return e.pageYOffset}:function(){return t.documentElement.scrollTop}},a.getPageOffset=a.getPageOffsetGenerator(Object.prototype.hasOwnProperty.call(e,"pageYOffset")),a.applyEach=i,"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=a:"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof e&&(e.Imager=a)}(window,document);
/*!
 * Chart.js
 * http://chartjs.org/
 *
 * Copyright 2014 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */
(function(){"use strict";var t=this,i=t.Chart,e=function(t){this.canvas=t.canvas,this.ctx=t;this.width=t.canvas.width,this.height=t.canvas.height;return this.aspectRatio=this.width/this.height,s.retinaScale(this),this};e.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,showTooltips:!0,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},e.types={};var s=e.helpers={},n=s.each=function(t,i,e){var s=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var n;for(n=0;n<t.length;n++)i.apply(e,[t[n],n].concat(s))}else for(var o in t)i.apply(e,[t[o],o].concat(s))},o=s.clone=function(t){var i={};return n(t,function(e,s){t.hasOwnProperty(s)&&(i[s]=e)}),i},a=s.extend=function(t){return n(Array.prototype.slice.call(arguments,1),function(i){n(i,function(e,s){i.hasOwnProperty(s)&&(t[s]=e)})}),t},h=s.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),a.apply(null,t)},l=s.indexOf=function(t,i){if(Array.prototype.indexOf)return t.indexOf(i);for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1},r=s.inherits=function(t){var i=this,e=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},s=function(){this.constructor=e};return s.prototype=i.prototype,e.prototype=new s,e.extend=r,t&&a(e.prototype,t),e.__super__=i.prototype,e},c=s.noop=function(){},u=s.uid=function(){var t=0;return function(){return"chart-"+t++}}(),d=s.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},p=s.amd="function"==typeof t.define&&t.define.amd,f=s.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g=s.max=function(t){return Math.max.apply(Math,t)},m=s.min=function(t){return Math.min.apply(Math,t)},v=(s.cap=function(t,i,e){if(f(i)){if(t>i)return i}else if(f(e)&&e>t)return e;return t},s.getDecimalPlaces=function(t){return t%1!==0&&f(t)?t.toString().split(".")[1].length:0}),S=s.radians=function(t){return t*(Math.PI/180)},x=(s.getAngleFromPoint=function(t,i){var e=i.x-t.x,s=i.y-t.y,n=Math.sqrt(e*e+s*s),o=2*Math.PI+Math.atan2(s,e);return 0>e&&0>s&&(o+=2*Math.PI),{angle:o,distance:n}},s.aliasPixel=function(t){return t%2===0?0:.5}),C=(s.splineCurve=function(t,i,e,s){var n=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),o=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),a=s*n/(n+o),h=s*o/(n+o);return{inner:{x:i.x-a*(e.x-t.x),y:i.y-a*(e.y-t.y)},outer:{x:i.x+h*(e.x-t.x),y:i.y+h*(e.y-t.y)}}},s.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),y=(s.calculateScaleRange=function(t,i,e,s,n){var o=2,a=Math.floor(i/(1.5*e)),h=o>=a,l=g(t),r=m(t);l===r&&(l+=.5,r>=.5&&!s?r-=.5:l+=.5);for(var c=Math.abs(l-r),u=C(c),d=Math.ceil(l/(1*Math.pow(10,u)))*Math.pow(10,u),p=s?0:Math.floor(r/(1*Math.pow(10,u)))*Math.pow(10,u),f=d-p,v=Math.pow(10,u),S=Math.round(f/v);(S>a||a>2*S)&&!h;)if(S>a)v*=2,S=Math.round(f/v),S%1!==0&&(h=!0);else if(n&&u>=0){if(v/2%1!==0)break;v/=2,S=Math.round(f/v)}else v/=2,S=Math.round(f/v);return h&&(S=o,v=f/S),{steps:S,stepValue:v,min:p,max:p+S*v}},s.template=function(t,i){function e(t,i){var e=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):s[t]=s[t];return i?e(i):e}var s={};return e(t,i)}),b=(s.generateLabels=function(t,i,e,s){var o=new Array(i);return labelTemplateString&&n(o,function(i,n){o[n]=y(t,{value:e+s*(n+1)})}),o},s.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-0.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-0.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:1==(t/=1)?1:(e||(e=.3),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e)))},easeOutElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:1==(t/=1)?1:(e||(e=.3),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),s*Math.pow(2,-10*t)*Math.sin(2*(1*t-i)*Math.PI/e)+1)},easeInOutElastic:function(t){var i=1.70158,e=0,s=1;return 0===t?0:2==(t/=.5)?1:(e||(e=.3*1.5),s<Math.abs(1)?(s=1,i=e/4):i=e/(2*Math.PI)*Math.asin(1/s),1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e):s*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-i)*Math.PI/e)*.5+1)},easeInBack:function(t){var i=1.70158;return 1*(t/=1)*t*((i+1)*t-i)},easeOutBack:function(t){var i=1.70158;return 1*((t=t/1-1)*t*((i+1)*t+i)+1)},easeInOutBack:function(t){var i=1.70158;return(t/=.5)<1?.5*t*t*(((i*=1.525)+1)*t-i):.5*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)},easeInBounce:function(t){return 1-b.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*b.easeInBounce(2*t):.5*b.easeOutBounce(2*t-1)+.5}}),w=s.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),P=(s.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),s.animationLoop=function(t,i,e,s,n,o){var a=0,h=b[e]||b.linear,l=function(){a++;var e=a/i,r=h(e);t.call(o,r,e,a),s.call(o,r,e),i>a?o.animationFrame=w(l):n.apply(o)};w(l)},s.getRelativePosition=function(t){var i,e,s=t.originalEvent||t,n=t.currentTarget||t.srcElement,o=n.getBoundingClientRect();return s.touches?(i=s.touches[0].clientX-o.left,e=s.touches[0].clientY-o.top):(i=s.clientX-o.left,e=s.clientY-o.top),{x:i,y:e}},s.addEvent=function(t,i,e){t.addEventListener?t.addEventListener(i,e):t.attachEvent?t.attachEvent("on"+i,e):t["on"+i]=e}),L=s.removeEvent=function(t,i,e){t.removeEventListener?t.removeEventListener(i,e,!1):t.detachEvent?t.detachEvent("on"+i,e):t["on"+i]=c},k=(s.bindEvents=function(t,i,e){t.events||(t.events={}),n(i,function(i){t.events[i]=function(){e.apply(t,arguments)},P(t.chart.canvas,i,t.events[i])})},s.unbindEvents=function(t,i){n(i,function(i,e){L(t.chart.canvas,e,i)})}),F=s.getMaximumSize=function(t){var i=t.parentNode;return i.clientWidth},R=s.retinaScale=function(t){var i=t.ctx,e=t.canvas.width,s=t.canvas.height;window.devicePixelRatio&&(i.canvas.style.width=e+"px",i.canvas.style.height=s+"px",i.canvas.height=s*window.devicePixelRatio,i.canvas.width=e*window.devicePixelRatio,i.scale(window.devicePixelRatio,window.devicePixelRatio))},A=s.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},T=s.fontString=function(t,i,e){return i+" "+t+"px "+e},M=s.longestText=function(t,i,e){t.font=i;var s=0;return n(e,function(i){var e=t.measureText(i).width;s=e>s?e:s}),s},W=s.drawRoundedRectangle=function(t,i,e,s,n,o){t.beginPath(),t.moveTo(i+o,e),t.lineTo(i+s-o,e),t.quadraticCurveTo(i+s,e,i+s,e+o),t.lineTo(i+s,e+n-o),t.quadraticCurveTo(i+s,e+n,i+s-o,e+n),t.lineTo(i+o,e+n),t.quadraticCurveTo(i,e+n,i,e+n-o),t.lineTo(i,e+o),t.quadraticCurveTo(i,e,i+o,e),t.closePath()};e.instances={},e.Type=function(t,i,s){this.options=i,this.chart=s,this.id=u(),e.instances[this.id]=this,i.responsive&&this.resize(),this.initialize.call(this,t)},a(e.Type.prototype,{initialize:function(){return this},clear:function(){return A(this.chart),this},stop:function(){return s.cancelAnimFrame.call(t,this.animationFrame),this},resize:function(t){this.stop();var i=this.chart.canvas,e=F(this.chart.canvas),s=e/this.chart.aspectRatio;return i.width=this.chart.width=e,i.height=this.chart.height=s,R(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:c,render:function(t){return t&&this.reflow(),this.options.animation&&!t?s.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return y(this.options.legendTemplate,this)},destroy:function(){this.clear(),k(this,this.events),delete e.instances[this.id]},showTooltip:function(t,i){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var o=function(t){var i=!1;return t.length!==this.activeElements.length?i=!0:(n(t,function(t,e){t!==this.activeElements[e]&&(i=!0)},this),i)}.call(this,t);if(o||i){if(this.activeElements=t,this.draw(),t.length>0)if(this.datasets&&this.datasets.length>1){for(var a,h,r=this.datasets.length-1;r>=0&&(a=this.datasets[r].points||this.datasets[r].bars||this.datasets[r].segments,h=l(a,t[0]),-1===h);r--);var c=[],u=[],d=function(){var t,i,e,n,o,a=[],l=[],r=[];return s.each(this.datasets,function(i){t=i.points||i.bars||i.segments,t[h]&&a.push(t[h])}),s.each(a,function(t){l.push(t.x),r.push(t.y),c.push(s.template(this.options.multiTooltipTemplate,t)),u.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),o=m(r),e=g(r),n=m(l),i=g(l),{x:n>this.chart.width/2?n:i,y:(o+e)/2}}.call(this,h);new e.MultiTooltip({x:d.x,y:d.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:u,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx}).draw()}else n(t,function(t){var i=t.tooltipPosition();new e.Tooltip({x:Math.round(i.x),y:Math.round(i.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:y(this.options.tooltipTemplate,t),chart:this.chart}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),e.Type.extend=function(t){var i=this,s=function(){return i.apply(this,arguments)};if(s.prototype=o(i.prototype),a(s.prototype,t),s.extend=e.Type.extend,t.name||i.prototype.name){var n=t.name||i.prototype.name,l=e.defaults[i.prototype.name]?o(e.defaults[i.prototype.name]):{};e.defaults[n]=a(l,t.defaults),e.types[n]=s,e.prototype[n]=function(t,i){var o=h(e.defaults.global,e.defaults[n],i||{});return new s(t,o,this)}}else d("Name not provided for this chart, so it hasn't been registered");return i},e.Element=function(t){a(this,t),this.initialize.apply(this,arguments),this.save()},a(e.Element.prototype,{initialize:function(){},restore:function(t){return t?n(t,function(t){this[t]=this._saved[t]},this):a(this,this._saved),this},save:function(){return this._saved=o(this),delete this._saved._saved,this},update:function(t){return n(t,function(t,i){this._saved[i]=this[i],this[i]=t},this),this},transition:function(t,i){return n(t,function(t,e){this[e]=(t-this._saved[e])*i+this._saved[e]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}}}),e.Element.extend=r,e.Point=e.Element.extend({display:!0,inRange:function(t,i){var e=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(i-this.y,2)<Math.pow(e,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),e.Arc=e.Element.extend({inRange:function(t,i){var e=s.getAngleFromPoint(this,{x:t,y:i}),n=e.angle>=this.startAngle&&e.angle<=this.endAngle,o=e.distance>=this.innerRadius&&e.distance<=this.outerRadius;return n&&o},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,i=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*i,y:this.y+Math.sin(t)*i}},draw:function(t){var i=this.ctx;i.beginPath(),i.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),i.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),i.closePath(),i.strokeStyle=this.strokeColor,i.lineWidth=this.strokeWidth,i.fillStyle=this.fillColor,i.fill(),i.lineJoin="bevel",this.showStroke&&i.stroke()}}),e.Rectangle=e.Element.extend({draw:function(){var t=this.ctx,i=this.width/2,e=this.x-i,s=this.x+i,n=this.base-(this.base-this.y),o=this.strokeWidth/2;this.showStroke&&(e+=o,s-=o,n+=o),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(e,this.base),t.lineTo(e,n),t.lineTo(s,n),t.lineTo(s,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,i){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&i>=this.y&&i<=this.base}}),e.Tooltip=e.Element.extend({draw:function(){var t=this.chart.ctx;t.font=T(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var i=2,e=t.measureText(this.text).width+2*this.xPadding,s=this.fontSize+2*this.yPadding,n=s+this.caretHeight+i;this.x+e/2>this.chart.width?this.xAlign="left":this.x-e/2<0&&(this.xAlign="right"),this.y-n<0&&(this.yAlign="below");var o=this.x-e/2,a=this.y-n;switch(t.fillStyle=this.fillColor,this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-i),t.lineTo(this.x+this.caretHeight,this.y-(i+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(i+this.caretHeight)),t.closePath(),t.fill();break;case"below":a=this.y+i+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+i),t.lineTo(this.x+this.caretHeight,this.y+i+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+i+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":o=this.x-e+(this.cornerRadius+this.caretHeight);break;case"right":o=this.x-(this.cornerRadius+this.caretHeight)}W(t,o,a,e,s,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,o+e/2,a+s/2)}}),e.MultiTooltip=e.Element.extend({initialize:function(){this.font=T(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=T(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,i=M(this.ctx,this.font,this.labels)+this.fontSize+3,e=g([i,t]);this.width=e+2*this.xPadding;var s=this.height/2;this.y-s<0?this.y=s:this.y+s>this.chart.height&&(this.y=this.chart.height-s),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var i=this.y-this.height/2+this.yPadding,e=t-1;return 0===t?i+this.titleFontSize/2:i+(1.5*this.fontSize*e+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){W(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,s.each(this.labels,function(i,e){t.fillStyle=this.textColor,t.fillText(i,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(e+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[e].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}),e.Scale=e.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),i=0;i<=this.steps;i++)this.yLabels.push(y(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?M(this.ctx,this.font,this.yLabels):0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,i=this.endPoint-this.startPoint;for(this.calculateYRange(i),this.buildYLabels(),this.calculateXLabelRotation();i>this.endPoint-this.startPoint;)i=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(i),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,i,e=this.ctx.measureText(this.xLabels[0]).width,s=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=s/2+3,this.xScalePaddingLeft=e/2>this.yLabelWidth+10?e/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){var n,o=M(this.ctx,this.font,this.xLabels);this.xLabelWidth=o;for(var a=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>a&&0===this.xLabelRotation||this.xLabelWidth>a&&this.xLabelRotation<=90&&this.xLabelRotation>0;)n=Math.cos(S(this.xLabelRotation)),t=n*e,i=n*s,t+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=n*o;this.xLabelRotation>0&&(this.endPoint-=Math.sin(S(this.xLabelRotation))*o+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var i=this.drawingArea()/(this.min-this.max);return this.endPoint-i*(t-this.min)},calculateX:function(t){var i=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),e=i/(this.valuesCount-(this.offsetGridLines?0:1)),s=e*t+this.xScalePaddingLeft;return this.offsetGridLines&&(s+=e/2),Math.round(s)},update:function(t){s.extend(this,t),this.fit()},draw:function(){var t=this.ctx,i=(this.endPoint-this.startPoint)/this.steps,e=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,n(this.yLabels,function(n,o){var a=this.endPoint-i*o,h=Math.round(a);t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(n,e-10,a),t.beginPath(),o>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),h+=s.aliasPixel(t.lineWidth),t.moveTo(e,h),t.lineTo(this.width,h),t.stroke(),t.closePath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(e-5,h),t.lineTo(e,h),t.stroke(),t.closePath()},this),n(this.xLabels,function(i,e){var s=this.calculateX(e)+x(this.lineWidth),n=this.calculateX(e-(this.offsetGridLines?.5:0))+x(this.lineWidth),o=this.xLabelRotation>0;t.beginPath(),e>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),t.moveTo(n,this.endPoint),t.lineTo(n,this.startPoint-3),t.stroke(),t.closePath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(n,this.endPoint),t.lineTo(n,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(s,o?this.endPoint+12:this.endPoint+8),t.rotate(-1*S(this.xLabelRotation)),t.font=this.font,t.textAlign=o?"right":"center",t.textBaseline=o?"middle":"top",t.fillText(i,0,0),t.restore()},this))}}),e.RadialScale=e.Element.extend({initialize:function(){this.size=m([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var i=this.drawingArea/(this.max-this.min);return(t-this.min)*i},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),i=0;i<=this.steps;i++)this.yLabels.push(y(this.templateString,{value:(this.min+i*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,i,e,s,n,o,a,h,l,r,c,u,d=m([this.height/2-this.pointLabelFontSize-5,this.width/2]),p=this.width,g=0;for(this.ctx.font=T(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),i=0;i<this.valuesCount;i++)t=this.getPointPosition(i,d),e=this.ctx.measureText(y(this.templateString,{value:this.labels[i]})).width+5,0===i||i===this.valuesCount/2?(s=e/2,t.x+s>p&&(p=t.x+s,n=i),t.x-s<g&&(g=t.x-s,a=i)):i<this.valuesCount/2?t.x+e>p&&(p=t.x+e,n=i):i>this.valuesCount/2&&t.x-e<g&&(g=t.x-e,a=i);l=g,r=Math.ceil(p-this.width),o=this.getIndexAngle(n),h=this.getIndexAngle(a),c=r/Math.sin(o+Math.PI/2),u=l/Math.sin(h+Math.PI/2),c=f(c)?c:0,u=f(u)?u:0,this.drawingArea=d-(u+c)/2,this.setCenterPoint(u,c)},setCenterPoint:function(t,i){var e=this.width-i-this.drawingArea,s=t+this.drawingArea;this.xCenter=(s+e)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var i=2*Math.PI/this.valuesCount;return t*i-Math.PI/2},getPointPosition:function(t,i){var e=this.getIndexAngle(t);return{x:Math.cos(e)*i+this.xCenter,y:Math.sin(e)*i+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(n(this.yLabels,function(i,e){if(e>0){var s,n=e*(this.drawingArea/this.steps),o=this.yCenter-n;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,n,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var a=0;a<this.valuesCount;a++)s=this.getPointPosition(a,this.calculateCenterOffset(this.min+e*this.stepValue)),0===a?t.moveTo(s.x,s.y):t.lineTo(s.x,s.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=T(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var h=t.measureText(i).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-h/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,h+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(i,this.xCenter,o)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var i=this.valuesCount-1;i>=0;i--){if(this.angleLineWidth>0){var e=this.getPointPosition(i,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(e.x,e.y),t.stroke(),t.closePath()}var s=this.getPointPosition(i,this.calculateCenterOffset(this.max)+5);t.font=T(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var o=this.labels.length,a=this.labels.length/2,h=a/2,l=h>i||i>o-h,r=i===h||i===o-h;t.textAlign=0===i?"center":i===a?"center":a>i?"left":"right",t.textBaseline=r?"middle":l?"bottom":"top",t.fillText(this.labels[i],s.x,s.y)}}}}}),s.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){n(e.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),p?define(function(){return e}):"object"==typeof module&&module.exports&&(module.exports=e),t.Chart=e,e.noConflict=function(){return t.Chart=i,e}}).call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Bar",defaults:s,initialize:function(t){var s=this.options;this.ScaleClass=i.Scale.extend({offsetGridLines:!0,calculateBarX:function(t,i,e){var n=this.calculateBaseWidth(),o=this.calculateX(e)-n/2,a=this.calculateBarWidth(t);return o+a*i+i*s.barDatasetSpacing+a/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*s.barValueSpacing},calculateBarWidth:function(t){var i=this.calculateBaseWidth()-(t-1)*s.barDatasetSpacing;return i/t}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),this.BarClass=i.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,bars:[]};this.datasets.push(s),e.each(i.data,function(n,o){e.isNumber(n)&&s.bars.push(new this.BarClass({value:n,label:t.labels[o],datasetLabel:i.label,strokeColor:i.strokeColor,fillColor:i.fillColor,highlightFill:i.highlightFill||i.fillColor,highlightStroke:i.highlightStroke||i.strokeColor}))},this)},this),this.buildScale(t.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(t,i,s){e.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,s,i),y:this.scale.endPoint}),t.save()},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachBars(function(t){t.save()}),this.render()},eachBars:function(t){e.each(this.datasets,function(i,s){e.each(i.bars,t,this,s)},this)},getBarsAtEvent:function(t){for(var i,s=[],n=e.getRelativePosition(t),o=function(t){s.push(t.bars[i])},a=0;a<this.datasets.length;a++)for(i=0;i<this.datasets[a].bars.length;i++)if(this.datasets[a].bars[i].inRange(n.x,n.y))return e.each(this.datasets,o),s;return s},buildScale:function(t){var i=this,s=function(){var t=[];return i.eachBars(function(i){t.push(i.value)}),t},n={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=e.calculateScaleRange(s(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,i)},xLabels:t,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(n,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(n)},addData:function(t,i){e.each(t,function(t,s){e.isNumber(t)&&this.datasets[s].bars.push(new this.BarClass({value:t,label:i,x:this.scale.calculateBarX(this.datasets.length,s,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[s].strokeColor,fillColor:this.datasets[s].fillColor}))},this),this.scale.addXLabel(i),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.bars.shift()},this),this.update()},reflow:function(){e.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var i=t||1;this.clear();this.chart.ctx;this.scale.draw(i),e.each(this.datasets,function(t,s){e.each(t.bars,function(t,e){t.base=this.scale.endPoint,t.transition({x:this.scale.calculateBarX(this.datasets.length,s,e),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},i).draw()},this)},this)}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Doughnut",defaults:s,initialize:function(t){this.segments=[],this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=i.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];
e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(i,function(t){t.fillColor=t.highlightColor}),this.showTooltip(i)}),this.calculateTotal(t),e.each(t,function(t,i){this.addData(t,i,!0)},this),this.render()},getSegmentsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(s.x,s.y)&&i.push(t)},this),i},addData:function(t,i,e){var s=i||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),e||(this.reflow(),this.update())},calculateCircumference:function(t){return 2*Math.PI*(t/this.total)},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=t.value},this)},update:function(){this.calculateTotal(this.segments),e.each(this.activeElements,function(t){t.restore(["fillColor"])}),e.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var i=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1),this.reflow(),this.update()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,e.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var i=t?t:1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},i),t.endAngle=t.startAngle+t.circumference,t.draw(),0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle)},this)}}),i.types.Doughnut.extend({name:"Pie",defaults:e.merge(s,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"Line",defaults:s,initialize:function(t){this.PointClass=i.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,pointColor:i.pointColor,pointStrokeColor:i.pointStrokeColor,points:[]};this.datasets.push(s),e.each(i.data,function(n,o){e.isNumber(n)&&s.points.push(new this.PointClass({value:n,label:t.labels[o],datasetLabel:i.label,strokeColor:i.pointStrokeColor,fillColor:i.pointColor,highlightFill:i.pointHighlightFill||i.pointColor,highlightStroke:i.pointHighlightStroke||i.pointStrokeColor}))},this),this.buildScale(t.labels),this.eachPoints(function(t,i){e.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){e.each(this.datasets,function(i){e.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.datasets,function(t){e.each(t.points,function(t){t.inRange(s.x,s.y)&&i.push(t)})},this),i},buildScale:function(t){var s=this,n=function(){var t=[];return s.eachPoints(function(i){t.push(i.value)}),t},o={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=e.calculateScaleRange(n(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,i)},xLabels:t,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(o,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new i.Scale(o)},addData:function(t,i){e.each(t,function(t,s){e.isNumber(t)&&this.datasets[s].points.push(new this.PointClass({value:t,label:i,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[s].pointStrokeColor,fillColor:this.datasets[s].pointColor}))},this),this.scale.addXLabel(i),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var i=t||1;this.clear();var s=this.chart.ctx;this.scale.draw(i),e.each(this.datasets,function(t){e.each(t.points,function(t,e){t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(e)},i)},this),this.options.bezierCurve&&e.each(t.points,function(i,s){i.controlPoints=0===s?e.splineCurve(i,i,t.points[s+1],0):s>=t.points.length-1?e.splineCurve(t.points[s-1],i,i,0):e.splineCurve(t.points[s-1],i,t.points[s+1],this.options.bezierCurveTension)},this),s.lineWidth=this.options.datasetStrokeWidth,s.strokeStyle=t.strokeColor,s.beginPath(),e.each(t.points,function(i,e){e>0?this.options.bezierCurve?s.bezierCurveTo(t.points[e-1].controlPoints.outer.x,t.points[e-1].controlPoints.outer.y,i.controlPoints.inner.x,i.controlPoints.inner.y,i.x,i.y):s.lineTo(i.x,i.y):s.moveTo(i.x,i.y)},this),s.stroke(),this.options.datasetFill&&(s.lineTo(t.points[t.points.length-1].x,this.scale.endPoint),s.lineTo(this.scale.calculateX(0),this.scale.endPoint),s.fillStyle=t.fillColor,s.closePath(),s.fill()),e.each(t.points,function(t){t.draw()})},this)}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers,s={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};i.Type.extend({name:"PolarArea",defaults:s,initialize:function(t){this.segments=[],this.SegmentArc=i.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length}),this.updateScaleRange(t),this.scale.update(),e.each(t,function(t,i){this.addData(t,i,!0)},this),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(i,function(t){t.fillColor=t.highlightColor}),this.showTooltip(i)}),this.render()},getSegmentsAtEvent:function(t){var i=[],s=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(s.x,s.y)&&i.push(t)},this),i},addData:function(t,i,e){var s=i||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),e||(this.reflow(),this.update())},removeData:function(t){var i=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1),this.reflow(),this.update()},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=t.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var i=[];e.each(t,function(t){i.push(t.value)});var s=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(i,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,s,{size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),e.each(this.segments,function(t){t.save()}),this.render()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),e.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),e.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var i=t||1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},i),t.endAngle=t.startAngle+t.circumference,0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle),t.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var t=this,i=t.Chart,e=i.helpers;i.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(t){this.PointClass=i.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(t),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var i="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(i,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(i)}),e.each(t.datasets,function(i){var s={label:i.label||null,fillColor:i.fillColor,strokeColor:i.strokeColor,pointColor:i.pointColor,pointStrokeColor:i.pointStrokeColor,points:[]};this.datasets.push(s),e.each(i.data,function(n,o){if(e.isNumber(n)){var a;this.scale.animation||(a=this.scale.getPointPosition(o,this.scale.calculateCenterOffset(n))),s.points.push(new this.PointClass({value:n,label:t.labels[o],datasetLabel:i.label,x:this.options.animation?this.scale.xCenter:a.x,y:this.options.animation?this.scale.yCenter:a.y,strokeColor:i.pointStrokeColor,fillColor:i.pointColor,highlightFill:i.pointHighlightFill||i.pointColor,highlightStroke:i.pointHighlightStroke||i.pointStrokeColor}))}},this)},this),this.render()},eachPoints:function(t){e.each(this.datasets,function(i){e.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=e.getRelativePosition(t),s=e.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},i),n=2*Math.PI/this.scale.valuesCount,o=Math.round((s.angle-1.5*Math.PI)/n),a=[];return(o>=this.scale.valuesCount||0>o)&&(o=0),s.distance<=this.scale.drawingArea&&e.each(this.datasets,function(t){a.push(t.points[o])}),a},buildScale:function(t){this.scale=new i.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:t.labels,valuesCount:t.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(t.datasets),this.scale.buildYLabels()},updateScaleRange:function(t){var i=function(){var i=[];return e.each(t,function(t){t.data?i=i.concat(t.data):e.each(t.points,function(t){i.push(t.value)})}),i}(),s=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(i,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,s)},addData:function(t,i){this.scale.valuesCount++,e.each(t,function(t,s){if(e.isNumber(t)){var n=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[s].points.push(new this.PointClass({value:t,label:i,x:n.x,y:n.y,strokeColor:this.datasets[s].pointStrokeColor,fillColor:this.datasets[s].pointColor}))}},this),this.scale.labels.push(i),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),e.each(this.datasets,function(t){t.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(t){t.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(t){var i=t||1,s=this.chart.ctx;this.clear(),this.scale.draw(),e.each(this.datasets,function(t){e.each(t.points,function(t,e){t.transition(this.scale.getPointPosition(e,this.scale.calculateCenterOffset(t.value)),i)},this),s.lineWidth=this.options.datasetStrokeWidth,s.strokeStyle=t.strokeColor,s.beginPath(),e.each(t.points,function(t,i){0===i?s.moveTo(t.x,t.y):s.lineTo(t.x,t.y)},this),s.closePath(),s.stroke(),s.fillStyle=t.fillColor,s.fill(),e.each(t.points,function(t){t.draw()})},this)}})}.call(this);
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(o){return t.returnExportsGlobal=e(o)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){"use strict";var e,o,n,r,i,s,a,p,c,l,f;l="caret",e=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.setPos=function(t){return this.domInputor},e.prototype.getIEPosition=function(){return this.getPosition()},e.prototype.getPosition=function(){var t,e;return e=this.getOffset(),t=this.$inputor.offset(),e.left-=t.left,e.top-=t.top,e},e.prototype.getOldIEPos=function(){var t,e;return e=a.selection.createRange(),t=a.body.createTextRange(),t.moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},e.prototype.getPos=function(){var t,e,o;return(o=this.range())?(t=o.cloneRange(),t.selectNodeContents(this.domInputor),t.setEnd(o.endContainer,o.endOffset),e=t.toString().length,t.detach(),e):a.selection?this.getOldIEPos():void 0},e.prototype.getOldIEOffset=function(){var t,e;return t=a.selection.createRange().duplicate(),t.moveStart("character",-1),e=t.getBoundingClientRect(),{height:e.bottom-e.top,left:e.left,top:e.top}},e.prototype.getOffset=function(e){var o,n,r,i,s;return c.getSelection&&(r=this.range())?(r.endOffset-1>0&&r.endContainer===!this.domInputor&&(o=r.cloneRange(),o.setStart(r.endContainer,r.endOffset-1),o.setEnd(r.endContainer,r.endOffset),i=o.getBoundingClientRect(),n={height:i.height,left:i.left+i.width,top:i.top},o.detach()),n&&0!==(null!=n?n.height:void 0)||(o=r.cloneRange(),s=t(a.createTextNode("|")),o.insertNode(s[0]),o.selectNode(s[0]),i=o.getBoundingClientRect(),n={height:i.height,left:i.left,top:i.top},s.remove(),o.detach())):a.selection&&(n=this.getOldIEOffset()),n&&(n.top+=t(c).scrollTop(),n.left+=t(c).scrollLeft()),n},e.prototype.range=function(){var t;if(c.getSelection)return t=c.getSelection(),t.rangeCount>0?t.getRangeAt(0):null},e}(),o=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.getIEPos=function(){var t,e,o,n,r,i,s;return e=this.domInputor,i=a.selection.createRange(),r=0,i&&i.parentElement()===e&&(n=e.value.replace(/\r\n/g,"\n"),o=n.length,s=e.createTextRange(),s.moveToBookmark(i.getBookmark()),t=e.createTextRange(),t.collapse(!1),r=s.compareEndPoints("StartToEnd",t)>-1?o:-s.moveStart("character",-o)),r},e.prototype.getPos=function(){return a.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,o;return e=this.domInputor,a.selection?(o=e.createTextRange(),o.move("character",t),o.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e,o,n,r;return o=this.domInputor.createTextRange(),t||(t=this.getPos()),o.move("character",t),n=o.boundingLeft,r=o.boundingTop,e=o.boundingHeight,{left:n,top:r,height:e}},e.prototype.getOffset=function(e){var o,n,r;return o=this.$inputor,a.selection?(n=this.getIEOffset(e),n.top+=t(c).scrollTop()+o.scrollTop(),n.left+=t(c).scrollLeft()+o.scrollLeft(),n):(n=o.offset(),r=this.getPosition(e),n={left:n.left+r.left-o.scrollLeft(),top:n.top+r.top-o.scrollTop(),height:r.height})},e.prototype.getPosition=function(t){var e,o,r,i,s,a,p;return e=this.$inputor,i=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(t=t.replace(/\s/g,"&nbsp;")),t},void 0===t&&(t=this.getPos()),p=e.val().slice(0,t),r=e.val().slice(t),s="<span style='position: relative; display: inline;'>"+i(p)+"</span>",s+="<span id='caret' style='position: relative; display: inline;'>|</span>",s+="<span style='position: relative; display: inline;'>"+i(r)+"</span>",a=new n(e),o=a.create(s).rect()},e.prototype.getIEPosition=function(t){var e,o,n,r,i;return n=this.getIEOffset(t),o=this.$inputor.offset(),r=n.left-o.left,i=n.top-o.top,e=n.height,{left:r,top:i,height:e}},e}(),n=function(){function e(t){this.$inputor=t}return e.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],e.prototype.mirrorCss=function(){var e,o=this;return e={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),t.each(this.css_attr,function(t,n){return e[n]=o.$inputor.css(n)}),e},e.prototype.create=function(e){return this.$mirror=t("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(e),this.$inputor.after(this.$mirror),this},e.prototype.rect=function(){var t,e,o;return t=this.$mirror.find("#caret"),e=t.position(),o={left:e.left,top:e.top,height:t.height()},this.$mirror.remove(),o},e}(),r={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},s={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return a.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){var e;return e=this.getOffset(t)}},a=null,c=null,p=null,f=function(t){var e;return(e=null!=t?t.iframe:void 0)?(p=e,c=e.contentWindow,a=e.contentDocument||c.document):(p=void 0,c=window,a=document)},i=function(t){var e;a=t[0].ownerDocument,c=a.defaultView||a.parentWindow;try{return p=c.frameElement}catch(o){e=o}},t.fn.caret=function(n,i,a){var p;return s[n]?(t.isPlainObject(i)?(f(i),i=void 0):f(a),p=r.contentEditable(this)?new e(this):new o(this),s[n].apply(p,[i])):t.error("Method "+n+" does not exist on jQuery.caret")},t.fn.caret.EditableCaret=e,t.fn.caret.InputCaret=o,t.fn.caret.Utils=r,t.fn.caret.apis=s});
/*! jquery.atwho - v1.3.2 %>
* Copyright (c) 2015 chord.luo <chord.luo@gmail.com>;
* homepage: http://ichord.github.com/At.js
* Licensed MIT
*/
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e,i,n,r,o,s,a,h,l,u,c=[].slice,p=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;e=t,n=function(){function t(t){this.currentFlag=null,this.controllers={},this.aliasMaps={},this.$inputor=e(t),this.setupRootElement(),this.listen()}return t.prototype.createContainer=function(t){var i;return null!=(i=this.$el)&&i.remove(),e(t.body).append(this.$el=e("<div class='atwho-container'></div>"))},t.prototype.setupRootElement=function(t,i){var n;if(null==i&&(i=!1),t)this.window=t.contentWindow,this.document=t.contentDocument||this.window.document,this.iframe=t;else{this.document=this.$inputor[0].ownerDocument,this.window=this.document.defaultView||this.document.parentWindow;try{this.iframe=this.window.frameElement}catch(r){if(n=r,this.iframe=null,e.fn.atwho.debug)throw new Error("iframe auto-discovery is failed.\nPlease use `setIframe` to set the target iframe manually.\n"+n)}}return this.createContainer((this.iframeAsRoot=i)?this.document:document)},t.prototype.controller=function(t){var e,i,n,r;if(this.aliasMaps[t])i=this.controllers[this.aliasMaps[t]];else{r=this.controllers;for(n in r)if(e=r[n],n===t){i=e;break}}return i?i:this.controllers[this.currentFlag]},t.prototype.setContextFor=function(t){return this.currentFlag=t,this},t.prototype.reg=function(t,e){var i,n;return n=(i=this.controllers)[t]||(i[t]=this.$inputor.is("[contentEditable]")?new s(this,t):new l(this,t)),e.alias&&(this.aliasMaps[e.alias]=t),n.init(e),this},t.prototype.listen=function(){return this.$inputor.on("compositionstart",function(t){return function(e){var i;return null!=(i=t.controller())&&i.view.hide(),console.log("compositionstart"),t.isComposing=!0,null}}(this)).on("compositionend",function(t){return function(e){return console.log("compositionend"),t.isComposing=!1,null}}(this)).on("keyup.atwhoInner",function(t){return function(e){return t.onKeyup(e)}}(this)).on("keydown.atwhoInner",function(t){return function(e){return t.onKeydown(e)}}(this)).on("blur.atwhoInner",function(t){return function(e){var i;return(i=t.controller())?(i.expectedQueryCBId=null,i.view.hide(e,i.getOpt("displayTimeout"))):void 0}}(this)).on("click.atwhoInner",function(t){return function(e){return t.dispatch(e)}}(this)).on("scroll.atwhoInner",function(t){return function(){var e;return e=t.$inputor.scrollTop(),function(i){var n,r;return n=i.target.scrollTop,e!==n&&null!=(r=t.controller())&&r.view.hide(i),e=n,!0}}}(this)())},t.prototype.shutdown=function(){var t,e,i;i=this.controllers;for(t in i)e=i[t],e.destroy(),delete this.controllers[t];return this.$inputor.off(".atwhoInner"),this.$el.remove()},t.prototype.dispatch=function(t){var e,i,n,r;n=this.controllers,r=[];for(e in n)i=n[e],r.push(i.lookUp(t));return r},t.prototype.onKeyup=function(t){var i;switch(t.keyCode){case a.ESC:t.preventDefault(),null!=(i=this.controller())&&i.view.hide();break;case a.DOWN:case a.UP:case a.CTRL:case a.ENTER:e.noop();break;case a.P:case a.N:t.ctrlKey||this.dispatch(t);break;default:this.dispatch(t)}},t.prototype.onKeydown=function(t){var i,n;if(n=null!=(i=this.controller())?i.view:void 0,n&&n.visible())switch(t.keyCode){case a.ESC:t.preventDefault(),n.hide(t);break;case a.UP:t.preventDefault(),n.prev();break;case a.DOWN:t.preventDefault(),n.next();break;case a.P:if(!t.ctrlKey)return;t.preventDefault(),n.prev();break;case a.N:if(!t.ctrlKey)return;t.preventDefault(),n.next();break;case a.TAB:case a.ENTER:case a.SPACE:if(!n.visible())return;if(!this.controller().getOpt("spaceSelectsMatch")&&t.keyCode===a.SPACE)return;if(!this.controller().getOpt("tabSelectsMatch")&&t.keyCode===a.TAB)return;n.highlighted()?(t.preventDefault(),n.choose(t)):n.hide(t);break;default:e.noop()}},t}(),r=function(){function t(t,i){this.app=t,this.at=i,this.$inputor=this.app.$inputor,this.id=this.$inputor[0].id||this.uid(),this.expectedQueryCBId=null,this.setting=null,this.query=null,this.pos=0,this.range=null,0===(this.$el=e("#atwho-ground-"+this.id,this.app.$el)).length&&this.app.$el.append(this.$el=e("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new h(this),this.view=new u(this)}return t.prototype.uid=function(){return(Math.random().toString(16)+"000000000").substr(2,8)+(new Date).getTime()},t.prototype.init=function(t){return this.setting=e.extend({},this.setting||e.fn.atwho["default"],t),this.view.init(),this.model.reload(this.setting.data)},t.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy(),this.$el.remove()},t.prototype.callDefault=function(){var t,i,n;n=arguments[0],t=2<=arguments.length?c.call(arguments,1):[];try{return o[n].apply(this,t)}catch(r){return i=r,e.error(i+" Or maybe At.js doesn't have function "+n)}},t.prototype.trigger=function(t,e){var i,n;return null==e&&(e=[]),e.push(this),i=this.getOpt("alias"),n=i?t+"-"+i+".atwho":t+".atwho",this.$inputor.trigger(n,e)},t.prototype.callbacks=function(t){return this.getOpt("callbacks")[t]||o[t]},t.prototype.getOpt=function(t,e){var i;try{return this.setting[t]}catch(n){return i=n,null}},t.prototype.insertContentFor=function(t){var i,n;return n=this.getOpt("insertTpl"),i=e.extend({},t.data("item-data"),{"atwho-at":this.at}),this.callbacks("tplEval").call(this,n,i,"onInsert")},t.prototype.renderView=function(t){var e;return e=this.getOpt("searchKey"),t=this.callbacks("sorter").call(this,this.query.text,t.slice(0,1001),e),this.view.render(t.slice(0,this.getOpt("limit")))},t.arrayToDefaultHash=function(t){var i,n,r,o;if(!e.isArray(t))return t;for(o=[],i=0,r=t.length;r>i;i++)n=t[i],e.isPlainObject(n)?o.push(n):o.push({name:n});return o},t.prototype.lookUp=function(t){var e,i;if(!this.getOpt("suspendOnComposing")||!this.app.isComposing)return(e=this.catchQuery(t))?(this.app.setContextFor(this.at),(i=this.getOpt("delay"))?this._delayLookUp(e,i):this._lookUp(e),e):(this.expectedQueryCBId=null,e)},t.prototype._delayLookUp=function(t,e){var i,n;return i=Date.now?Date.now():(new Date).getTime(),this.previousCallTime||(this.previousCallTime=i),n=e-(i-this.previousCallTime),n>0&&e>n?(this.previousCallTime=i,this._stopDelayedCall(),this.delayedCallTimeout=setTimeout(function(e){return function(){return e.previousCallTime=0,e.delayedCallTimeout=null,e._lookUp(t)}}(this),e)):(this._stopDelayedCall(),this.previousCallTime!==i&&(this.previousCallTime=0),this._lookUp(t))},t.prototype._stopDelayedCall=function(){return this.delayedCallTimeout?(clearTimeout(this.delayedCallTimeout),this.delayedCallTimeout=null):void 0},t.prototype._generateQueryCBId=function(){return{}},t.prototype._lookUp=function(t){var i;return i=function(t,e){return t===this.expectedQueryCBId?e&&e.length>0?this.renderView(this.constructor.arrayToDefaultHash(e)):this.view.hide():void 0},this.expectedQueryCBId=this._generateQueryCBId(),this.model.query(t.text,e.proxy(i,this,this.expectedQueryCBId))},t}(),l=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,t),i.prototype.catchQuery=function(){var t,e,i,n,r,o,s;return e=this.$inputor.val(),t=this.$inputor.caret("pos",{iframe:this.app.iframe}),s=e.slice(0,t),r=this.callbacks("matcher").call(this,this.at,s,this.getOpt("startWithSpace")),n="string"==typeof r,n&&r.length<this.getOpt("minLen",0)?void 0:(n&&r.length<=this.getOpt("maxLen",20)?(o=t-r.length,i=o+r.length,this.pos=o,r={text:r,headPos:o,endPos:i},this.trigger("matched",[this.at,r.text])):(r=null,this.view.hide()),this.query=r)},i.prototype.rect=function(){var t,i,n;if(t=this.$inputor.caret("offset",this.pos-1,{iframe:this.app.iframe}))return this.app.iframe&&!this.app.iframeAsRoot&&(i=e(this.app.iframe).offset(),t.left+=i.left,t.top+=i.top),n=this.app.document.selection?0:2,{left:t.left,top:t.top,bottom:t.top+t.height+n}},i.prototype.insert=function(t,e){var i,n,r,o,s;return i=this.$inputor,n=i.val(),r=n.slice(0,Math.max(this.query.headPos-this.at.length,0)),o=""===(o=this.getOpt("suffix"))?o:o||" ",t+=o,s=""+r+t+n.slice(this.query.endPos||0),i.val(s),i.caret("pos",r.length+t.length,{iframe:this.app.iframe}),i.is(":focus")||i.focus(),i.change()},i}(r),s=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,t),i.prototype._getRange=function(){var t;return t=this.app.window.getSelection(),t.rangeCount>0?t.getRangeAt(0):void 0},i.prototype._setRange=function(t,i,n){return null==n&&(n=this._getRange()),n?(i=e(i)[0],"after"===t?(n.setEndAfter(i),n.setStartAfter(i)):(n.setEndBefore(i),n.setStartBefore(i)),n.collapse(!1),this._clearRange(n)):void 0},i.prototype._clearRange=function(t){var e;return null==t&&(t=this._getRange()),e=this.app.window.getSelection(),null==this.ctrl_a_pressed?(e.removeAllRanges(),e.addRange(t)):void 0},i.prototype._movingEvent=function(t){var e;return"click"===t.type||(e=t.which)===a.RIGHT||e===a.LEFT||e===a.UP||e===a.DOWN},i.prototype._unwrap=function(t){var i;return t=e(t).unwrap().get(0),(i=t.nextSibling)&&i.nodeValue&&(t.nodeValue+=i.nodeValue,e(i).remove()),t},i.prototype.catchQuery=function(t){var i,n,r,o,s,h,l,u,c,p,f;if(f=this._getRange()){if(t.which===a.CTRL?this.ctrl_pressed=!0:t.which===a.A?this.ctrl_pressed&&(this.ctrl_a_pressed=!0):(delete this.ctrl_a_pressed,delete this.ctrl_pressed),t.which===a.ENTER)return(n=e(f.startContainer).closest(".atwho-query")).contents().unwrap(),n.is(":empty")&&n.remove(),(n=e(".atwho-query",this.$inputor)).text(n.text()).contents().last().unwrap(),void this._clearRange();if(/firefox/i.test(navigator.userAgent)){if(e(f.startContainer).is(this.$inputor))return void this._clearRange();t.which===a.BACKSPACE&&f.startContainer.nodeType===document.ELEMENT_NODE&&(c=f.startOffset-1)>=0?(r=f.cloneRange(),r.setStart(f.startContainer,c),e(r.cloneContents()).contents().last().is(".atwho-inserted")&&(s=e(f.startContainer).contents().get(c),this._setRange("after",e(s).contents().last()))):t.which===a.LEFT&&f.startContainer.nodeType===document.TEXT_NODE&&(i=e(f.startContainer.previousSibling),i.is(".atwho-inserted")&&0===f.startOffset&&this._setRange("after",i.contents().last()))}if(e(f.startContainer).closest(".atwho-inserted").addClass("atwho-query").siblings().removeClass("atwho-query"),(n=e(".atwho-query",this.$inputor)).length>0&&n.is(":empty")&&0===n.text().length&&n.remove(),this._movingEvent(t)||n.removeClass("atwho-inserted"),r=f.cloneRange(),r.setStart(f.startContainer,0),u=this.callbacks("matcher").call(this,this.at,r.toString(),this.getOpt("startWithSpace")),h="string"==typeof u,0===n.length&&h&&(o=f.startOffset-this.at.length-u.length)>=0&&(f.setStart(f.startContainer,o),n=e("<span/>",this.$inputor).attr(this.getOpt("editableAtwhoQueryAttrs")).addClass("atwho-query"),f.surroundContents(n.get(0)),l=n.contents().last().get(0),/firefox/i.test(navigator.userAgent)?(f.setStart(l,l.length),f.setEnd(l,l.length),this._clearRange(f)):this._setRange("after",l,f)),!(h&&u.length<this.getOpt("minLen",0)))return h&&u.length<=this.getOpt("maxLen",20)?(p={text:u,el:n},this.trigger("matched",[this.at,p.text]),this.query=p):(this.view.hide(),this.query={el:n},n.text().indexOf(this.at)>=0&&(this._movingEvent(t)&&n.hasClass("atwho-inserted")?n.removeClass("atwho-query"):!1!==this.callbacks("afterMatchFailed").call(this,this.at,n)&&this._setRange("after",this._unwrap(n.text(n.text()).contents().first()))),null)}},i.prototype.rect=function(){var t,i,n;return n=this.query.el.offset(),this.app.iframe&&!this.app.iframeAsRoot&&(i=(t=e(this.app.iframe)).offset(),n.left+=i.left-this.$inputor.scrollLeft(),n.top+=i.top-this.$inputor.scrollTop()),n.bottom=n.top+this.query.el.height(),n},i.prototype.insert=function(t,e){var i,n,r;return n=""===(n=this.getOpt("suffix"))?n:n||"",this.query.el.removeClass("atwho-query").addClass("atwho-inserted").html(t),(i=this._getRange())&&(i.setEndAfter(this.query.el[0]),i.collapse(!1),i.insertNode(r=this.app.document.createTextNode(n)),this._setRange("after",r,i)),this.$inputor.is(":focus")||this.$inputor.focus(),this.$inputor.change()},i}(r),h=function(){function t(t){this.context=t,this.at=this.context.at,this.storage=this.context.$inputor}return t.prototype.destroy=function(){return this.storage.data(this.at,null)},t.prototype.saved=function(){return this.fetch()>0},t.prototype.query=function(t,e){var i,n,r;return n=this.fetch(),r=this.context.getOpt("searchKey"),n=this.context.callbacks("filter").call(this.context,t,n,r)||[],i=this.context.callbacks("remoteFilter"),n.length>0||!i&&0===n.length?e(n):i.call(this.context,t,e)},t.prototype.fetch=function(){return this.storage.data(this.at)||[]},t.prototype.save=function(t){return this.storage.data(this.at,this.context.callbacks("beforeSave").call(this.context,t||[]))},t.prototype.load=function(t){return!this.saved()&&t?this._load(t):void 0},t.prototype.reload=function(t){return this._load(t)},t.prototype._load=function(t){return"string"==typeof t?e.ajax(t,{dataType:"json"}).done(function(t){return function(e){return t.save(e)}}(this)):this.save(t)},t}(),u=function(){function t(t){this.context=t,this.$el=e("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.timeoutID=null,this.context.$el.append(this.$el),this.bindEvent()}return t.prototype.init=function(){var t;return t=this.context.getOpt("alias")||this.context.at.charCodeAt(0),this.$el.attr({id:"at-view-"+t})},t.prototype.destroy=function(){return this.$el.remove()},t.prototype.bindEvent=function(){var t;return t=this.$el.find("ul"),t.on("mouseenter.atwho-view","li",function(i){return t.find(".cur").removeClass("cur"),e(i.currentTarget).addClass("cur")}).on("click.atwho-view","li",function(i){return function(n){return t.find(".cur").removeClass("cur"),e(n.currentTarget).addClass("cur"),i.choose(n),n.preventDefault()}}(this))},t.prototype.visible=function(){return this.$el.is(":visible")},t.prototype.highlighted=function(){return this.$el.find(".cur").length>0},t.prototype.choose=function(t){var e,i;return(e=this.$el.find(".cur")).length&&(i=this.context.insertContentFor(e),this.context.insert(this.context.callbacks("beforeInsert").call(this.context,i,e),e),this.context.trigger("inserted",[e,t]),this.hide(t)),this.context.getOpt("hideWithoutSuffix")?this.stopShowing=!0:void 0},t.prototype.reposition=function(t){var i,n,r,o;return i=this.context.app.iframeAsRoot?this.context.app.window:window,t.bottom+this.$el.height()-e(i).scrollTop()>e(i).height()&&(t.bottom=t.top-this.$el.height()),t.left>(r=e(i).width()-this.$el.width()-5)&&(t.left=r),n={left:t.left,top:t.bottom},null!=(o=this.context.callbacks("beforeReposition"))&&o.call(this.context,n),this.$el.offset(n),this.context.trigger("reposition",[n])},t.prototype.next=function(){var t,e;return t=this.$el.find(".cur").removeClass("cur"),e=t.next(),e.length||(e=this.$el.find("li:first")),e.addClass("cur"),this.scrollTop(Math.max(0,t.innerHeight()*(e.index()+2)-this.$el.height()))},t.prototype.prev=function(){var t,e;return t=this.$el.find(".cur").removeClass("cur"),e=t.prev(),e.length||(e=this.$el.find("li:last")),e.addClass("cur"),this.scrollTop(Math.max(0,t.innerHeight()*(e.index()+2)-this.$el.height()))},t.prototype.scrollTop=function(t){var e;return e=this.context.getOpt("scrollDuration"),e?this.$el.animate({scrollTop:t},e):this.$el.scrollTop(t)},t.prototype.show=function(){var t;return this.stopShowing?void(this.stopShowing=!1):(this.visible()||(this.$el.show(),this.$el.scrollTop(0),this.context.trigger("shown")),(t=this.context.rect())?this.reposition(t):void 0)},t.prototype.hide=function(t,e){var i;if(this.visible())return isNaN(e)?(this.$el.hide(),this.context.trigger("hidden",[t])):(i=function(t){return function(){return t.hide()}}(this),clearTimeout(this.timeoutID),this.timeoutID=setTimeout(i,e))},t.prototype.render=function(t){var i,n,r,o,s,a,h;if(!(e.isArray(t)&&t.length>0))return void this.hide();for(this.$el.find("ul").empty(),n=this.$el.find("ul"),h=this.context.getOpt("displayTpl"),r=0,s=t.length;s>r;r++)o=t[r],o=e.extend({},o,{"atwho-at":this.context.at}),a=this.context.callbacks("tplEval").call(this.context,h,o,"onDisplay"),i=e(this.context.callbacks("highlighter").call(this.context,a,this.context.query.text)),i.data("item-data",o),n.append(i);return this.show(),this.context.getOpt("highlightFirst")?n.find("li:first").addClass("cur"):void 0},t}(),a={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13,CTRL:17,A:65,P:80,N:78,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,SPACE:32},o={beforeSave:function(t){return r.arrayToDefaultHash(t)},matcher:function(t,e,i,n){var r,o,s,a,h;return t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),i&&(t="(?:^|\\s)"+t),r=decodeURI("%C3%80"),o=decodeURI("%C3%BF"),h=n?" ":"",a=new RegExp(t+"([A-Za-z"+r+"-"+o+"0-9_"+h+"'.+-]*)$|"+t+"([^\\x00-\\xff]*)$","gi"),s=a.exec(e),s?s[2]||s[1]:null},filter:function(t,e,i){var n,r,o,s;for(n=[],r=0,s=e.length;s>r;r++)o=e[r],~new String(o[i]).toLowerCase().indexOf(t.toLowerCase())&&n.push(o);return n},remoteFilter:null,sorter:function(t,e,i){var n,r,o,s;if(!t)return e;for(n=[],r=0,s=e.length;s>r;r++)o=e[r],o.atwho_order=new String(o[i]).toLowerCase().indexOf(t.toLowerCase()),o.atwho_order>-1&&n.push(o);return n.sort(function(t,e){return t.atwho_order-e.atwho_order})},tplEval:function(t,e){var i,n;n=t;try{return"string"!=typeof t&&(n=t(e)),n.replace(/\$\{([^\}]*)\}/g,function(t,i,n){return e[i]})}catch(r){return i=r,""}},highlighter:function(t,e){var i;return e?(i=new RegExp(">\\s*(\\w*?)("+e.replace("+","\\+")+")(\\w*)\\s*<","ig"),t.replace(i,function(t,e,i,n){return"> "+e+"<strong>"+i+"</strong>"+n+" <"})):t},beforeInsert:function(t,e){return t},beforeReposition:function(t){return t},afterMatchFailed:function(t,e){}},i={load:function(t,e){var i;return(i=this.controller(t))?i.model.load(e):void 0},isSelecting:function(){var t;return!!(null!=(t=this.controller())?t.view.visible():void 0)},hide:function(){var t;return null!=(t=this.controller())?t.view.hide():void 0},reposition:function(){var t;return(t=this.controller())?t.view.reposition(t.rect()):void 0},setIframe:function(t,e){return this.setupRootElement(t,e),null},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},e.fn.atwho=function(t){var r,o;return r=arguments,o=null,this.filter('textarea, input, [contenteditable=""], [contenteditable=true]').each(function(){var s,a;return(a=(s=e(this)).data("atwho"))||s.data("atwho",a=new n(this)),"object"!=typeof t&&t?i[t]&&a?o=i[t].apply(a,Array.prototype.slice.call(r,1)):e.error("Method "+t+" does not exist on jQuery.atwho"):a.reg(t.at,t)}),null!=o?o:this},e.fn.atwho["default"]={at:void 0,alias:void 0,data:null,displayTpl:"<li>${name}</li>",insertTpl:"${atwho-at}${name}",callbacks:o,searchKey:"name",suffix:void 0,hideWithoutSuffix:!1,startWithSpace:!0,highlightFirst:!0,limit:5,maxLen:20,minLen:0,displayTimeout:300,delay:null,spaceSelectsMatch:!1,tabSelectsMatch:!0,editableAtwhoQueryAttrs:{},scrollDuration:150,suspendOnComposing:!0},e.fn.atwho.debug=!1});
/*!
 * XRegExp 3.0.0
 * <http://xregexp.com/>
 * Steven Levithan (c) 2007-2015 MIT License
 */
var XRegExp=function(e){"use strict";function t(e,t,n,r,a){var l;if(e[E]={captureNames:t},a)return e;if(e.__proto__)e.__proto__=m.prototype;else for(l in m.prototype)e[l]=m.prototype[l];return e[E].source=n,e[E].flags=r?r.split("").sort().join(""):r,e}function n(e){return I.replace.call(e,/([\s\S])(?=[\s\S]*\1)/g,"")}function r(r,a){if(!m.isRegExp(r))throw new TypeError("Type RegExp expected");var o=r[E]||{},c=l(r),s="",u="",p=null,f=null;return a=a||{},a.removeG&&(u+="g"),a.removeY&&(u+="y"),u&&(c=I.replace.call(c,new RegExp("["+u+"]+","g"),"")),a.addG&&(s+="g"),a.addY&&(s+="y"),s&&(c=n(c+s)),a.isInternalOnly||(o.source!==e&&(p=o.source),null!=o.flags&&(f=s?n(o.flags+s):o.flags)),r=t(new RegExp(r.source,c),i(r)?o.captureNames.slice(0):null,p,f,a.isInternalOnly)}function a(e){return parseInt(e,16)}function l(e){return Y?e.flags:I.exec.call(/\/([a-z]*)$/i,RegExp.prototype.toString.call(e))[1]}function i(e){return!(!e[E]||!e[E].captureNames)}function o(e){return parseInt(e,10).toString(16)}function c(e,t){var n,r=e.length;for(n=0;r>n;++n)if(e[n]===t)return n;return-1}function s(e,t){return z.call(e)==="[object "+t+"]"}function u(e,t,n){return I.test.call(n.indexOf("x")>-1?/^(?:\s+|#.*|\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/:/^(?:\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/,e.slice(t))}function p(e){for(;e.length<4;)e="0"+e;return e}function f(e,t){var r;if(n(t)!==t)throw new SyntaxError("Invalid duplicate regex flag "+t);for(e=I.replace.call(e,/^\(\?([\w$]+)\)/,function(e,r){if(I.test.call(/[gy]/,r))throw new SyntaxError("Cannot use flag g or y in mode modifier "+e);return t=n(t+r),""}),r=0;r<t.length;++r)if(!T[t.charAt(r)])throw new SyntaxError("Unknown regex flag "+t.charAt(r));return{pattern:e,flags:t}}function g(e){var t={};return s(e,"String")?(m.forEach(e,/[^\s,]+/,function(e){t[e]=!0}),t):e}function h(e){if(!/^[\w$]$/.test(e))throw new Error("Flag must be a single character A-Za-z0-9_$");T[e]=!0}function d(e,t,n,r,a){for(var l,i,o=b.length,c=e.charAt(n),s=null;o--;)if(i=b[o],!(i.leadChar&&i.leadChar!==c||i.scope!==r&&"all"!==i.scope||i.flag&&-1===t.indexOf(i.flag))&&(l=m.exec(e,i.regex,n,"sticky"))){s={matchLength:l[0].length,output:i.handler.call(a,l,r,t),reparse:i.reparse};break}return s}function x(e){S.astral=e}function y(e){RegExp.prototype.exec=(e?R:I).exec,RegExp.prototype.test=(e?R:I).test,String.prototype.match=(e?R:I).match,String.prototype.replace=(e?R:I).replace,String.prototype.split=(e?R:I).split,S.natives=e}function w(e){if(null==e)throw new TypeError("Cannot convert null or undefined to object");return e}var m,v,E="xregexp",S={astral:!1,natives:!1},I={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},R={},C={},N={},b=[],k="default",A="class",F={"default":/\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??|[\s\S]/,"class":/\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|[\s\S]/},$=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,O=I.exec.call(/()??/,"")[1]===e,_=function(){var e=!0;try{new RegExp("","u")}catch(t){e=!1}return e}(),G=function(){var e=!0;try{new RegExp("","y")}catch(t){e=!1}return e}(),Y=/a/.flags!==e,T={g:!0,i:!0,m:!0,u:_,y:G},z={}.toString;return m=function(n,a){var l,i,o,c,s,u={hasNamedCapture:!1,captureNames:[]},p=k,g="",h=0;if(m.isRegExp(n)){if(a!==e)throw new TypeError("Cannot supply flags when copying a RegExp");return r(n)}if(n=n===e?"":String(n),a=a===e?"":String(a),m.isInstalled("astral")&&-1===a.indexOf("A")&&(a+="A"),N[n]||(N[n]={}),!N[n][a]){for(l=f(n,a),c=l.pattern,s=l.flags;h<c.length;){do l=d(c,s,h,p,u),l&&l.reparse&&(c=c.slice(0,h)+l.output+c.slice(h+l.matchLength));while(l&&l.reparse);l?(g+=l.output,h+=l.matchLength||1):(i=m.exec(c,F[p],h,"sticky")[0],g+=i,h+=i.length,"["===i&&p===k?p=A:"]"===i&&p===A&&(p=k))}N[n][a]={pattern:I.replace.call(g,/\(\?:\)(?=\(\?:\))|^\(\?:\)|\(\?:\)$/g,""),flags:I.replace.call(s,/[^gimuy]+/g,""),captures:u.hasNamedCapture?u.captureNames:null}}return o=N[n][a],t(new RegExp(o.pattern,o.flags),o.captures,n,a)},m.prototype=new RegExp,m.version="3.0.0",m.addToken=function(e,t,n){n=n||{};var a,l=n.optionalFlags;if(n.flag&&h(n.flag),l)for(l=I.split.call(l,""),a=0;a<l.length;++a)h(l[a]);b.push({regex:r(e,{addG:!0,addY:G,isInternalOnly:!0}),handler:t,scope:n.scope||k,flag:n.flag,reparse:n.reparse,leadChar:n.leadChar}),m.cache.flush("patterns")},m.cache=function(e,t){return C[e]||(C[e]={}),C[e][t]||(C[e][t]=m(e,t))},m.cache.flush=function(e){"patterns"===e?N={}:C={}},m.escape=function(e){return I.replace.call(w(e),/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},m.exec=function(e,t,n,a){var l,i,o="g",c=!1;return c=G&&!!(a||t.sticky&&a!==!1),c&&(o+="y"),t[E]=t[E]||{},i=t[E][o]||(t[E][o]=r(t,{addG:!0,addY:c,removeY:a===!1,isInternalOnly:!0})),i.lastIndex=n=n||0,l=R.exec.call(i,e),a&&l&&l.index!==n&&(l=null),t.global&&(t.lastIndex=l?i.lastIndex:0),l},m.forEach=function(e,t,n){for(var r,a=0,l=-1;r=m.exec(e,t,a);)n(r,++l,e,t),a=r.index+(r[0].length||1)},m.globalize=function(e){return r(e,{addG:!0})},m.install=function(e){e=g(e),!S.astral&&e.astral&&x(!0),!S.natives&&e.natives&&y(!0)},m.isInstalled=function(e){return!!S[e]},m.isRegExp=function(e){return"[object RegExp]"===z.call(e)},m.match=function(e,t,n){var a,l,i=t.global&&"one"!==n||"all"===n,o=(i?"g":"")+(t.sticky?"y":"")||"noGY";return t[E]=t[E]||{},l=t[E][o]||(t[E][o]=r(t,{addG:!!i,addY:!!t.sticky,removeG:"one"===n,isInternalOnly:!0})),a=I.match.call(w(e),l),t.global&&(t.lastIndex="one"===n&&a?a.index+a[0].length:0),i?a||[]:a&&a[0]},m.matchChain=function(e,t){return function n(e,r){var a,l=t[r].regex?t[r]:{regex:t[r]},i=[],o=function(e){if(l.backref){if(!(e.hasOwnProperty(l.backref)||+l.backref<e.length))throw new ReferenceError("Backreference to undefined group: "+l.backref);i.push(e[l.backref]||"")}else i.push(e[0])};for(a=0;a<e.length;++a)m.forEach(e[a],l.regex,o);return r!==t.length-1&&i.length?n(i,r+1):i}([e],0)},m.replace=function(e,t,n,a){var l,i=m.isRegExp(t),o=t.global&&"one"!==a||"all"===a,c=(o?"g":"")+(t.sticky?"y":"")||"noGY",s=t;return i?(t[E]=t[E]||{},s=t[E][c]||(t[E][c]=r(t,{addG:!!o,addY:!!t.sticky,removeG:"one"===a,isInternalOnly:!0}))):o&&(s=new RegExp(m.escape(String(t)),"g")),l=R.replace.call(w(e),s,n),i&&t.global&&(t.lastIndex=0),l},m.replaceEach=function(e,t){var n,r;for(n=0;n<t.length;++n)r=t[n],e=m.replace(e,r[0],r[1],r[2]);return e},m.split=function(e,t,n){return R.split.call(w(e),t,n)},m.test=function(e,t,n,r){return!!m.exec(e,t,n,r)},m.uninstall=function(e){e=g(e),S.astral&&e.astral&&x(!1),S.natives&&e.natives&&y(!1)},m.union=function(e,t){var n,r,a,l,i=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,o=[],c=0,u=function(e,t,a){var l=r[c-n];if(t){if(++c,l)return"(?<"+l+">"}else if(a)return"\\"+(+a+n);return e};if(!s(e,"Array")||!e.length)throw new TypeError("Must provide a nonempty array of patterns to merge");for(l=0;l<e.length;++l)a=e[l],m.isRegExp(a)?(n=c,r=a[E]&&a[E].captureNames||[],o.push(I.replace.call(m(a.source).source,i,u))):o.push(m.escape(a));return m(o.join("|"),t)},R.exec=function(t){var n,a,l,i=this.lastIndex,o=I.exec.apply(this,arguments);if(o){if(!O&&o.length>1&&c(o,"")>-1&&(a=r(this,{removeG:!0,isInternalOnly:!0}),I.replace.call(String(t).slice(o.index),a,function(){var t,n=arguments.length;for(t=1;n-2>t;++t)arguments[t]===e&&(o[t]=e)})),this[E]&&this[E].captureNames)for(l=1;l<o.length;++l)n=this[E].captureNames[l-1],n&&(o[n]=o[l]);this.global&&!o[0].length&&this.lastIndex>o.index&&(this.lastIndex=o.index)}return this.global||(this.lastIndex=i),o},R.test=function(e){return!!R.exec.call(this,e)},R.match=function(e){var t;if(m.isRegExp(e)){if(e.global)return t=I.match.apply(this,arguments),e.lastIndex=0,t}else e=new RegExp(e);return R.exec.call(e,w(this))},R.replace=function(t,n){var r,a,l,i=m.isRegExp(t);return i?(t[E]&&(a=t[E].captureNames),r=t.lastIndex):t+="",l=s(n,"Function")?I.replace.call(String(this),t,function(){var r,l=arguments;if(a)for(l[0]=new String(l[0]),r=0;r<a.length;++r)a[r]&&(l[0][a[r]]=l[r+1]);return i&&t.global&&(t.lastIndex=l[l.length-2]+l[0].length),n.apply(e,l)}):I.replace.call(null==this?this:String(this),t,function(){var e=arguments;return I.replace.call(String(n),$,function(t,n,r){var l;if(n){if(l=+n,l<=e.length-3)return e[l]||"";if(l=a?c(a,n):-1,0>l)throw new SyntaxError("Backreference to undefined group "+t);return e[l+1]||""}if("$"===r)return"$";if("&"===r||0===+r)return e[0];if("`"===r)return e[e.length-1].slice(0,e[e.length-2]);if("'"===r)return e[e.length-1].slice(e[e.length-2]+e[0].length);if(r=+r,!isNaN(r)){if(r>e.length-3)throw new SyntaxError("Backreference to undefined group "+t);return e[r]||""}throw new SyntaxError("Invalid token "+t)})}),i&&(t.global?t.lastIndex=0:t.lastIndex=r),l},R.split=function(t,n){if(!m.isRegExp(t))return I.split.apply(this,arguments);var r,a=String(this),l=[],i=t.lastIndex,o=0;return n=(n===e?-1:n)>>>0,m.forEach(a,t,function(e){e.index+e[0].length>o&&(l.push(a.slice(o,e.index)),e.length>1&&e.index<a.length&&Array.prototype.push.apply(l,e.slice(1)),r=e[0].length,o=e.index+r)}),o===a.length?(!I.test.call(t,"")||r)&&l.push(""):l.push(a.slice(o)),t.lastIndex=i,l.length>n?l.slice(0,n):l},v=m.addToken,v(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4}|{[\dA-Fa-f]+})|x(?![\dA-Fa-f]{2}))/,function(e,t){if("B"===e[1]&&t===k)return e[0];throw new SyntaxError("Invalid escape "+e[0])},{scope:"all",leadChar:"\\"}),v(/\\u{([\dA-Fa-f]+)}/,function(e,t,n){var r=a(e[1]);if(r>1114111)throw new SyntaxError("Invalid Unicode code point "+e[0]);if(65535>=r)return"\\u"+p(o(r));if(_&&n.indexOf("u")>-1)return e[0];throw new SyntaxError("Cannot use Unicode code point above \\u{FFFF} without flag u")},{scope:"all",leadChar:"\\"}),v(/\[(\^?)]/,function(e){return e[1]?"[\\s\\S]":"\\b\\B"},{leadChar:"["}),v(/\(\?#[^)]*\)/,function(e,t,n){return u(e.input,e.index+e[0].length,n)?"":"(?:)"},{leadChar:"("}),v(/\s+|#.*/,function(e,t,n){return u(e.input,e.index+e[0].length,n)?"":"(?:)"},{flag:"x"}),v(/\./,function(){return"[\\s\\S]"},{flag:"s",leadChar:"."}),v(/\\k<([\w$]+)>/,function(e){var t=isNaN(e[1])?c(this.captureNames,e[1])+1:+e[1],n=e.index+e[0].length;if(!t||t>this.captureNames.length)throw new SyntaxError("Backreference to undefined group "+e[0]);return"\\"+t+(n===e.input.length||isNaN(e.input.charAt(n))?"":"(?:)")},{leadChar:"\\"}),v(/\\(\d+)/,function(e,t){if(!(t===k&&/^[1-9]/.test(e[1])&&+e[1]<=this.captureNames.length)&&"0"!==e[1])throw new SyntaxError("Cannot use octal escape or backreference to undefined group "+e[0]);return e[0]},{scope:"all",leadChar:"\\"}),v(/\(\?P?<([\w$]+)>/,function(e){if(!isNaN(e[1]))throw new SyntaxError("Cannot use integer as capture name "+e[0]);if("length"===e[1]||"__proto__"===e[1])throw new SyntaxError("Cannot use reserved word as capture name "+e[0]);if(c(this.captureNames,e[1])>-1)throw new SyntaxError("Cannot use same name for multiple groups "+e[0]);return this.captureNames.push(e[1]),this.hasNamedCapture=!0,"("},{leadChar:"("}),v(/\((?!\?)/,function(e,t,n){return n.indexOf("n")>-1?"(?:":(this.captureNames.push(null),"(")},{optionalFlags:"n",leadChar:"("}),m}();
/*!
 * XRegExp Unicode Base 3.0.0
 * <http://xregexp.com/>
 * Steven Levithan (c) 2008-2015 MIT License
 */
!function(r){"use strict";function n(r){return r.replace(/[- _]+/g,"").toLowerCase()}function e(r){for(;r.length<4;)r="0"+r;return r}function t(r){return parseInt(r,16)}function a(r){return parseInt(r,10).toString(16)}function o(r){var n=/^\\[xu](.+)/.exec(r);return n?t(n[1]):r.charCodeAt("\\"===r.charAt(0)?1:0)}function i(n){var t,i="",s=-1;return r.forEach(n,/(\\x..|\\u....|\\?[\s\S])(?:-(\\x..|\\u....|\\?[\s\S]))?/,function(r){t=o(r[1]),t>s+1&&(i+="\\u"+e(a(s+1)),t>s+2&&(i+="-\\u"+e(a(t-1)))),s=o(r[2]||r[1])}),65535>s&&(i+="\\u"+e(a(s+1)),65534>s&&(i+="-\\uFFFF")),i}function s(r){var n="b!";return f[r][n]||(f[r][n]=i(f[r].bmp))}function c(r,n){var e=f[r],t="";return e.bmp&&!e.isBmpLast&&(t="["+e.bmp+"]"+(e.astral?"|":"")),e.astral&&(t+=e.astral),e.isBmpLast&&e.bmp&&(t+=(e.astral?"|":"")+"["+e.bmp+"]"),n?"(?:(?!"+t+")(?:[-][-]|[\x00-]))":"(?:"+t+")"}function u(r,n){var e=n?"a!":"a=";return f[r][e]||(f[r][e]=c(r,n))}var f={};r.addToken(/\\([pP])(?:{(\^?)([^}]*)}|([A-Za-z]))/,function(r,e,t){var a="Invalid double negation ",o="Unknown Unicode token ",i="Unicode token missing data ",c="Astral mode required for Unicode token ",l="Astral mode does not support Unicode tokens within character classes",p="P"===r[1]||!!r[2],d=t.indexOf("A")>-1,h=n(r[4]||r[3]),w=f[h];if("P"===r[1]&&r[2])throw new SyntaxError(a+r[0]);if(!f.hasOwnProperty(h))throw new SyntaxError(o+r[0]);if(w.inverseOf){if(h=n(w.inverseOf),!f.hasOwnProperty(h))throw new ReferenceError(i+r[0]+" -> "+w.inverseOf);w=f[h],p=!p}if(!w.bmp&&!d)throw new SyntaxError(c+r[0]);if(d){if("class"===e)throw new SyntaxError(l);return u(h,p)}return"class"===e?p?s(h):w.bmp:(p?"[^":"[")+w.bmp+"]"},{scope:"all",optionalFlags:"A",leadChar:"\\"}),r.addUnicodeData=function(e){var t,a,o="Unicode token requires name",i="Unicode token has no character data ";for(a=0;a<e.length;++a){if(t=e[a],!t.name)throw new Error(o);if(!(t.inverseOf||t.bmp||t.astral))throw new Error(i+t.name);f[n(t.name)]=t,t.alias&&(f[n(t.alias)]=t)}r.cache.flush("patterns")}}(XRegExp);
/*!
 * XRegExp Unicode Categories 3.0.0
 * <http://xregexp.com/>
 * Steven Levithan (c) 2010-2015 MIT License
 * Unicode data provided by Mathias Bynens <http://mathiasbynens.be/>
 */
!function(a){"use strict";if(!a.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");a.addUnicodeData([{name:"C",alias:"Other",isBmpLast:!0,bmp:"\x00---------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"[------]|[--]|[----------]|[-------]|[--]|[----]|[]|[-----]|[-------]|[----------------]|[-]|[------]|[-]|[--]|[----------------]|[-]|[-]|[-]|[--------][-]|[----]|[-----]|[-]|[-----------]|[---------------------]|[-]|[----]|[-]|[-]|[--------]|[-]"},{name:"Cc",alias:"Control",bmp:"\x00--"},{name:"Cf",alias:"Format",bmp:"-----\ufeff-",astral:"[-]|[-]|[-]|"},{name:"Cn",alias:"Unassigned",bmp:"---------------------------------------------------------------------------------------------------------------------------------------------------",astral:"[---]|[-----]|[----------]|[-------]|[--]|[----]|[]|[-----]|[-------]|[----------------]|[-]|[------]|[][]|[-]|[----]|[-]|[-]|[-]|[--------][-]|[----]|[-----]|[-]|[--]|[-----------]|[---------------------]|[-]|[----------------]|[-]|[-]|[--------]|[-]"},{name:"Co",alias:"Private_Use",bmp:"-",astral:"[--][-]|[][-]"},{name:"Cs",alias:"Surrogate",bmp:"-"},{name:"L",alias:"Letter",bmp:"A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"[--]|[--]|[--]|[---]|[-]|[------]|[---------------]|[-]|[-]|[--]|[---][-]|[------]|[-------]|[-]|[--------------------]|[-------------------------]|[-------------------]|[-]|[--------------]|[--]|[-]|[----]|[]|[-]"},{name:"Ll",alias:"Lowercase_Letter",bmp:"a-z------------------------------------------------",astral:"[-]|[--------------------------]|[-]|[-]"},{name:"Lm",alias:"Modifier_Letter",bmp:"------------",astral:"[-]|[-]"},{name:"Lo",alias:"Other_Letter",bmp:"-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"[--]|[--]|[--]|[-]|[-]|[---------------]|[-]|[-]|[-]|[---][-]|[------]|[-]|[-]|[--------------------]|[-------------------]|[-]|[--------------]|[------]|[------]|[-]|[----]|[]|[-]"},{name:"Lt",alias:"Titlecase_Letter",bmp:"---"},{name:"Lu",alias:"Uppercase_Letter",bmp:"A-Z---------------------------------------",astral:"[-]|[-]|[-]|[-----------------------]"},{name:"M",alias:"Mark",bmp:"------------------------------------------------------------------------------------------------------------",astral:"[------]|[------]|[----------------]|[--]|[--]|[]|[-]|[----]|[---]|[-]|[-]"},{name:"Mc",alias:"Spacing_Mark",bmp:"-----------------------------",astral:"[-]|[------]|[-----]|[-]"},{name:"Me",alias:"Enclosing_Mark",bmp:"---"},{name:"Mn",alias:"Nonspacing_Mark",bmp:"-------------------------------------------------------------------------------",astral:"[-------]|[-----]|[--]|[-]|[]|[-]|[----]|[---]|[------------]|[-]|[-]"},{name:"N",alias:"Number",bmp:"0-9------------------------------------------------------------",astral:"[-----]|[-]|[--]|[-]|[-]|[---]|[-]|[------]|[-]|[-]|[-]|[-------------]|[----]"},{name:"Nd",alias:"Decimal_Number",bmp:"0-9------------------------------------",astral:"[-]|[-]|[----]|[-]|[-----]|[--]"},{name:"Nl",alias:"Letter_Number",bmp:"------",astral:"[-]|[--]"},{name:"No",alias:"Other_Number",bmp:"----------------------",astral:"[--]|[--]|[-]|[-]|[-]|[-------------]|[]|[-]|[-]|[----]"},{name:"P",alias:"Punctuation",bmp:"!-#%-\\x2A,-/:;\\x3F@\\x5B-\\x5D_\\x7B}-------------------------------------------------",astral:"[----]|[-]|[---]|[-]|||[------]|[-]|[-]"},{name:"Pc",alias:"Connector_Punctuation",bmp:"_-"},{name:"Pd",alias:"Dash_Punctuation",bmp:"\\x2D-"},{name:"Pe",alias:"Close_Punctuation",bmp:"\\x29\\x5D}"},{name:"Pf",alias:"Final_Punctuation",bmp:""},{name:"Pi",alias:"Initial_Punctuation",bmp:""},{name:"Po",alias:"Other_Punctuation",bmp:"!-#%-'\\x2A,\\x2E/:;\\x3F@\\x5C----------------------------------------------",astral:"[----]|[-]|[---]|[-]|||[------]|[-]|[-]"},{name:"Ps",alias:"Open_Punctuation",bmp:"\\x28\\x5B\\x7B"},{name:"S",alias:"Symbol",bmp:"\\x24\\x2B<->\\x5E`\\x7C~-------------------------------------------------------------------------",astral:"[-------]|[-------------]|[-------]|[]|[----]|||[]|[-]|[----]|[--------]|[]"},{name:"Sc",alias:"Currency_Symbol",bmp:"\\x24--"},{name:"Sk",alias:"Modifier_Symbol",bmp:"\\x5E`----------",astral:"[-]"},{name:"Sm",alias:"Math_Symbol",bmp:"\\x2B<->\\x7C~---------------------",astral:"[]|[]"},{name:"So",alias:"Other_Symbol",bmp:"-----------------------------------------------------------",astral:"[-------]|[-------]|[-------------]|[----]|||[]|[-]|[----]|[--------]"},{name:"Z",alias:"Separator",bmp:" -\u2028\u2029"},{name:"Zl",alias:"Line_Separator",bmp:"\u2028"},{name:"Zp",alias:"Paragraph_Separator",bmp:"\u2029"},{name:"Zs",alias:"Space_Separator",bmp:" -"}])}(XRegExp);
/*!
 * Select2 4.0.3
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t=function(){if(e&&e.fn&&e.fn.select2&&e.fn.select2.amd)var t=e.fn.select2.amd;var t;/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
return function(){if(!t||!t.requirejs){t?n=t:t={};/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var e,n,i;!function(t){function r(e,t){return w.call(e,t)}function o(e,t){var n,i,r,o,s,a,l,c,u,d,p,h=t&&t.split("/"),f=y.map,g=f&&f["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),s=e.length-1,y.nodeIdCompat&&b.test(e[s])&&(e[s]=e[s].replace(b,"")),e=h.slice(0,h.length-1).concat(e),u=0;u<e.length;u+=1)if(p=e[u],"."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||g)&&f){for(n=e.split("/"),u=n.length;u>0;u-=1){if(i=n.slice(0,u).join("/"),h)for(d=h.length;d>0;d-=1)if(r=f[h.slice(0,d).join("/")],r&&(r=r[i])){o=r,a=u;break}if(o)break;!l&&g&&g[i]&&(l=g[i],c=u)}!o&&l&&(o=l,a=c),o&&(n.splice(0,a,o),e=n.join("/"))}return e}function s(e,n){return function(){var i=$.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),h.apply(t,i.concat([e,n]))}}function a(e){return function(t){return o(t,e)}}function l(e){return function(t){m[e]=t}}function c(e){if(r(v,e)){var n=v[e];delete v[e],_[e]=!0,p.apply(t,n)}if(!r(m,e)&&!r(_,e))throw new Error("No "+e);return m[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return function(){return y&&y.config&&y.config[e]||{}}}var p,h,f,g,m={},v={},y={},_={},w=Object.prototype.hasOwnProperty,$=[].slice,b=/\.js$/;f=function(e,t){var n,i=u(e),r=i[0];return e=i[1],r&&(r=o(r,t),n=c(r)),r?e=n&&n.normalize?n.normalize(e,a(t)):o(e,t):(e=o(e,t),i=u(e),r=i[0],e=i[1],r&&(n=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},g={require:function(e){return s(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:d(e)}}},p=function(e,n,i,o){var a,u,d,p,h,y,w=[],$=typeof i;if(o=o||e,"undefined"===$||"function"===$){for(n=!n.length&&i.length?["require","exports","module"]:n,h=0;h<n.length;h+=1)if(p=f(n[h],o),u=p.f,"require"===u)w[h]=g.require(e);else if("exports"===u)w[h]=g.exports(e),y=!0;else if("module"===u)a=w[h]=g.module(e);else if(r(m,u)||r(v,u)||r(_,u))w[h]=c(u);else{if(!p.p)throw new Error(e+" missing "+u);p.p.load(p.n,s(o,!0),l(u),{}),w[h]=m[u]}d=i?i.apply(m[e],w):void 0,e&&(a&&a.exports!==t&&a.exports!==m[e]?m[e]=a.exports:d===t&&y||(m[e]=d))}else e&&(m[e]=i)},e=n=h=function(e,n,i,r,o){if("string"==typeof e)return g[e]?g[e](n):c(f(e,n).f);if(!e.splice){if(y=e,y.deps&&h(y.deps,y.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"==typeof i&&(i=r,r=o),r?p(t,e,n,i):setTimeout(function(){p(t,e,n,i)},4),h},h.config=function(e){return h(e)},e._defined=m,i=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),r(m,e)||r(v,e)||(v[e]=[e,t,n])},i.amd={jQuery:!0}}(),t.requirejs=e,t.require=n,t.define=i}}(),t.define("almond",function(){}),t.define("jquery",[],function(){var t=e||$;return null==t&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t}),t.define("select2/utils",["jquery"],function(e){function t(e){var t=e.prototype,n=[];for(var i in t){var r=t[i];"function"==typeof r&&"constructor"!==i&&n.push(i)}return n}var n={};n.Extend=function(e,t){function n(){this.constructor=e}var i={}.hasOwnProperty;for(var r in t)i.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},n.Decorate=function(e,n){function i(){var t=Array.prototype.unshift,i=n.prototype.constructor.length,r=e.prototype.constructor;i>0&&(t.call(arguments,e.prototype.constructor),r=n.prototype.constructor),r.apply(this,arguments)}function r(){this.constructor=i}var o=t(n),s=t(e);n.displayName=e.displayName,i.prototype=new r;for(var a=0;a<s.length;a++){var l=s[a];i.prototype[l]=e.prototype[l]}for(var c=(function(e){var t=function(){};e in i.prototype&&(t=i.prototype[e]);var r=n.prototype[e];return function(){var e=Array.prototype.unshift;return e.call(arguments,t),r.apply(this,arguments)}}),u=0;u<o.length;u++){var d=o[u];i.prototype[d]=c(d)}return i};var i=function(){this.listeners={}};return i.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},i.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),n[0]._type=e,e in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},i.prototype.invoke=function(e,t){for(var n=0,i=e.length;i>n;n++)e[n].apply(this,t)},n.Observable=i,n.generateChars=function(e){for(var t="",n=0;e>n;n++){var i=Math.floor(36*Math.random());t+=i.toString(36)}return t},n.bind=function(e,t){return function(){e.apply(t,arguments)}},n._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var r=0;r<n.length;r++){var o=n[r];o=o.substring(0,1).toLowerCase()+o.substring(1),o in i||(i[o]={}),r==n.length-1&&(i[o]=e[t]),i=i[o]}delete e[t]}}return e},n.hasScroll=function(t,n){var i=e(n),r=n.style.overflowX,o=n.style.overflowY;return r!==o||"hidden"!==o&&"visible"!==o?"scroll"===r||"scroll"===o?!0:i.innerHeight()<n.scrollHeight||i.innerWidth()<n.scrollWidth:!1},n.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},n.appendMany=function(t,n){if("1.7"===e.fn.jquery.substr(0,3)){var i=e();e.map(n,function(e){i=i.add(e)}),n=i}t.append(n)},n}),t.define("select2/results",["jquery","./utils"],function(e,t){function n(e,t,i){this.$element=e,this.data=i,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},n.prototype.clear=function(){this.$results.empty()},n.prototype.displayMessage=function(t){var n=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var i=e('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),r=this.options.get("translations").get(t.message);i.append(n(r(t.args))),i[0].className+=" select2-results__message",this.$results.append(i)},n.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},n.prototype.append=function(e){this.hideLoading();var t=[];if(null==e.results||0===e.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],r=this.option(i);t.push(r)}this.$results.append(t)},n.prototype.position=function(e,t){var n=t.find(".select2-results");n.append(e)},n.prototype.sort=function(e){var t=this.options.get("sorter");return t(e)},n.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");t.length>0?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},n.prototype.setClasses=function(){var t=this;this.data.current(function(n){var i=e.map(n,function(e){return e.id.toString()}),r=t.$results.find(".select2-results__option[aria-selected]");r.each(function(){var t=e(this),n=e.data(this,"data"),r=""+n.id;null!=n.element&&n.element.selected||null==n.element&&e.inArray(r,i)>-1?t.attr("aria-selected","true"):t.attr("aria-selected","false")})})},n.prototype.showLoading=function(e){this.hideLoading();var t=this.options.get("translations").get("searching"),n={disabled:!0,loading:!0,text:t(e)},i=this.option(n);i.className+=" loading-results",this.$results.prepend(i)},n.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},n.prototype.option=function(t){var n=document.createElement("li");n.className="select2-results__option";var i={role:"treeitem","aria-selected":"false"};t.disabled&&(delete i["aria-selected"],i["aria-disabled"]="true"),null==t.id&&delete i["aria-selected"],null!=t._resultId&&(n.id=t._resultId),t.title&&(n.title=t.title),t.children&&(i.role="group",i["aria-label"]=t.text,delete i["aria-selected"]);for(var r in i){var o=i[r];n.setAttribute(r,o)}if(t.children){var s=e(n),a=document.createElement("strong");a.className="select2-results__group";e(a);this.template(t,a);for(var l=[],c=0;c<t.children.length;c++){var u=t.children[c],d=this.option(u);l.push(d)}var p=e("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});p.append(l),s.append(a),s.append(p)}else this.template(t,n);return e.data(n,"data",t),n},n.prototype.bind=function(t,n){var i=this,r=t.id+"-results";this.$results.attr("id",r),t.on("results:all",function(e){i.clear(),i.append(e.data),t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("results:append",function(e){i.append(e.data),t.isOpen()&&i.setClasses()}),t.on("query",function(e){i.hideMessages(),i.showLoading(e)}),t.on("select",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())}),t.on("open",function(){i.$results.attr("aria-expanded","true"),i.$results.attr("aria-hidden","false"),i.setClasses(),i.ensureHighlightVisible()}),t.on("close",function(){i.$results.attr("aria-expanded","false"),i.$results.attr("aria-hidden","true"),i.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=i.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e=i.getHighlightedResults();if(0!==e.length){var t=e.data("data");"true"==e.attr("aria-selected")?i.trigger("close",{}):i.trigger("select",{data:t})}}),t.on("results:previous",function(){var e=i.getHighlightedResults(),t=i.$results.find("[aria-selected]"),n=t.index(e);if(0!==n){var r=n-1;0===e.length&&(r=0);var o=t.eq(r);o.trigger("mouseenter");var s=i.$results.offset().top,a=o.offset().top,l=i.$results.scrollTop()+(a-s);0===r?i.$results.scrollTop(0):0>a-s&&i.$results.scrollTop(l)}}),t.on("results:next",function(){var e=i.getHighlightedResults(),t=i.$results.find("[aria-selected]"),n=t.index(e),r=n+1;if(!(r>=t.length)){var o=t.eq(r);o.trigger("mouseenter");var s=i.$results.offset().top+i.$results.outerHeight(!1),a=o.offset().top+o.outerHeight(!1),l=i.$results.scrollTop()+a-s;0===r?i.$results.scrollTop(0):a>s&&i.$results.scrollTop(l)}}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){i.displayMessage(e)}),e.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=i.$results.scrollTop(),n=i.$results.get(0).scrollHeight-t+e.deltaY,r=e.deltaY>0&&t-e.deltaY<=0,o=e.deltaY<0&&n<=i.$results.height();r?(i.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):o&&(i.$results.scrollTop(i.$results.get(0).scrollHeight-i.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var n=e(this),r=n.data("data");return"true"===n.attr("aria-selected")?void(i.options.get("multiple")?i.trigger("unselect",{originalEvent:t,data:r}):i.trigger("close",{})):void i.trigger("select",{originalEvent:t,data:r})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(t){var n=e(this).data("data");i.getHighlightedResults().removeClass("select2-results__option--highlighted"),i.trigger("results:focus",{data:n,element:e(this)})})},n.prototype.getHighlightedResults=function(){var e=this.$results.find(".select2-results__option--highlighted");return e},n.prototype.destroy=function(){this.$results.remove()},n.prototype.ensureHighlightVisible=function(){var e=this.getHighlightedResults();if(0!==e.length){var t=this.$results.find("[aria-selected]"),n=t.index(e),i=this.$results.offset().top,r=e.offset().top,o=this.$results.scrollTop()+(r-i),s=r-i;o-=2*e.outerHeight(!1),2>=n?this.$results.scrollTop(0):(s>this.$results.outerHeight()||0>s)&&this.$results.scrollTop(o)}},n.prototype.template=function(t,n){var i=this.options.get("templateResult"),r=this.options.get("escapeMarkup"),o=i(t,n);null==o?n.style.display="none":"string"==typeof o?n.innerHTML=r(o):e(n).append(o)},n}),t.define("select2/keys",[],function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return e}),t.define("select2/selection/base",["jquery","../utils","../keys"],function(e,t,n){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=e('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},i.prototype.bind=function(e,t){var i=this,r=(e.id+"-container",e.id+"-results");this.container=e,this.$selection.on("focus",function(e){i.trigger("focus",e)}),this.$selection.on("blur",function(e){i._handleBlur(e)}),this.$selection.on("keydown",function(e){i.trigger("keypress",e),e.which===n.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){i.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){i.update(e.data)}),e.on("open",function(){i.$selection.attr("aria-expanded","true"),i.$selection.attr("aria-owns",r),i._attachCloseHandler(e)}),e.on("close",function(){i.$selection.attr("aria-expanded","false"),i.$selection.removeAttr("aria-activedescendant"),i.$selection.removeAttr("aria-owns"),i.$selection.focus(),i._detachCloseHandler(e)}),e.on("enable",function(){i.$selection.attr("tabindex",i._tabindex)}),e.on("disable",function(){i.$selection.attr("tabindex","-1")})},i.prototype._handleBlur=function(t){var n=this;window.setTimeout(function(){document.activeElement==n.$selection[0]||e.contains(n.$selection[0],document.activeElement)||n.trigger("blur",t)},1)},i.prototype._attachCloseHandler=function(t){e(document.body).on("mousedown.select2."+t.id,function(t){var n=e(t.target),i=n.closest(".select2"),r=e(".select2.select2-container--open");r.each(function(){var t=e(this);if(this!=i[0]){var n=t.data("element");n.select2("close")}})})},i.prototype._detachCloseHandler=function(t){e(document.body).off("mousedown.select2."+t.id)},i.prototype.position=function(e,t){var n=t.find(".selection");n.append(e)},i.prototype.destroy=function(){this._detachCloseHandler(this.container)},i.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},i}),t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,i){function r(){r.__super__.constructor.apply(this,arguments)}return n.Extend(r,t),r.prototype.render=function(){var e=r.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},r.prototype.bind=function(e,t){var n=this;r.__super__.bind.apply(this,arguments);var i=e.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),e.on("focus",function(t){e.isOpen()||n.$selection.focus()}),e.on("selection:update",function(e){n.update(e.data)})},r.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},r.prototype.display=function(e,t){var n=this.options.get("templateSelection"),i=this.options.get("escapeMarkup");return i(n(e,t))},r.prototype.selectionContainer=function(){return e("<span></span>")},r.prototype.update=function(e){if(0===e.length)return void this.clear();var t=e[0],n=this.$selection.find(".select2-selection__rendered"),i=this.display(t,n);n.empty().append(i),n.prop("title",t.title||t.text)},r}),t.define("select2/selection/multiple",["jquery","./base","../utils"],function(e,t,n){function i(e,t){i.__super__.constructor.apply(this,arguments)}return n.Extend(i,t),i.prototype.render=function(){var e=i.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},i.prototype.bind=function(t,n){var r=this;i.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){r.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(t){if(!r.options.get("disabled")){var n=e(this),i=n.parent(),o=i.data("data");r.trigger("unselect",{originalEvent:t,data:o})}})},i.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},i.prototype.display=function(e,t){var n=this.options.get("templateSelection"),i=this.options.get("escapeMarkup");return i(n(e,t))},i.prototype.selectionContainer=function(){var t=e('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return t},i.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],i=0;i<e.length;i++){var r=e[i],o=this.selectionContainer(),s=this.display(r,o);o.append(s),o.prop("title",r.title||r.text),o.data("data",r),t.push(o)}var a=this.$selection.find(".select2-selection__rendered");n.appendMany(a,t)}},i}),t.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id,i=t.length>1;if(i||n)return e.call(this,t);this.clear();var r=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(r)},t}),t.define("select2/selection/allowClear",["jquery","../keys"],function(e,t){function n(){}return n.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},n.prototype._handleClear=function(e,t){if(!this.options.get("disabled")){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();for(var i=n.data("data"),r=0;r<i.length;r++){var o={data:i[r]};if(this.trigger("unselect",o),o.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},n.prototype._handleKeyboardClear=function(e,n,i){i.isOpen()||(n.which==t.DELETE||n.which==t.BACKSPACE)&&this._handleClear(n)},n.prototype.update=function(t,n){if(t.call(this,n),!(this.$selection.find(".select2-selection__placeholder").length>0||0===n.length)){var i=e('<span class="select2-selection__clear">&times;</span>');i.data("data",n),this.$selection.find(".select2-selection__rendered").prepend(i)}},n}),t.define("select2/selection/search",["jquery","../utils","../keys"],function(e,t,n){function i(e,t,n){e.call(this,t,n)}return i.prototype.render=function(t){var n=e('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=n,this.$search=n.find("input");var i=t.call(this);return this._transferTabIndex(),i},i.prototype.bind=function(e,t,i){var r=this;e.call(this,t,i),t.on("open",function(){r.$search.trigger("focus")}),t.on("close",function(){r.$search.val(""),r.$search.removeAttr("aria-activedescendant"),r.$search.trigger("focus")}),t.on("enable",function(){r.$search.prop("disabled",!1),r._transferTabIndex()}),t.on("disable",function(){r.$search.prop("disabled",!0)}),t.on("focus",function(e){r.$search.trigger("focus")}),t.on("results:focus",function(e){r.$search.attr("aria-activedescendant",e.id)}),this.$selection.on("focusin",".select2-search--inline",function(e){r.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){r._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){e.stopPropagation(),r.trigger("keypress",e),r._keyUpPrevented=e.isDefaultPrevented();var t=e.which;if(t===n.BACKSPACE&&""===r.$search.val()){var i=r.$searchContainer.prev(".select2-selection__choice");if(i.length>0){var o=i.data("data");r.searchRemoveChoice(o),e.preventDefault()}}});var o=document.documentMode,s=o&&11>=o;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){return s?void r.$selection.off("input.search input.searchcheck"):void r.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){if(s&&"input"===e.type)return void r.$selection.off("input.search input.searchcheck");var t=e.which;t!=n.SHIFT&&t!=n.CTRL&&t!=n.ALT&&t!=n.TAB&&r.handleSearch(e)})},i.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},i.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},i.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.focus()},i.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},i.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},i.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";if(""!==this.$search.attr("placeholder"))e=this.$selection.find(".select2-selection__rendered").innerWidth();else{var t=this.$search.val().length+1;e=.75*t+"em"}this.$search.css("width",e)},i}),t.define("select2/selection/eventRelay",["jquery"],function(e){function t(){}return t.prototype.bind=function(t,n,i){var r=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting"],s=["opening","closing","selecting","unselecting"];t.call(this,n,i),n.on("*",function(t,n){if(-1!==e.inArray(t,o)){n=n||{};var i=e.Event("select2:"+t,{params:n});r.$element.trigger(i),-1!==e.inArray(t,s)&&(n.prevented=i.isDefaultPrevented())}})},t}),t.define("select2/translation",["jquery","require"],function(e,t){function n(e){this.dict=e||{}}return n.prototype.all=function(){return this.dict},n.prototype.get=function(e){return this.dict[e]},n.prototype.extend=function(t){this.dict=e.extend({},t.all(),this.dict)},n._cache={},n.loadPath=function(e){if(!(e in n._cache)){var i=t(e);n._cache[e]=i}return new n(n._cache[e])},n}),t.define("select2/diacritics",[],function(){var e={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};return e}),t.define("select2/data/base",["../utils"],function(e){function t(e,n){t.__super__.constructor.call(this)}return e.Extend(t,e.Observable),t.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},t.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},t.prototype.bind=function(e,t){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,n){var i=t.id+"-result-";return i+=e.generateChars(4),i+=null!=n.id?"-"+n.id.toString():"-"+e.generateChars(4)},t}),t.define("select2/data/select",["./base","../utils","jquery"],function(e,t,n){function i(e,t){this.$element=e,this.options=t,i.__super__.constructor.call(this)}return t.Extend(i,e),i.prototype.current=function(e){var t=[],i=this;this.$element.find(":selected").each(function(){var e=n(this),r=i.item(e);t.push(r)}),e(t)},i.prototype.select=function(e){var t=this;if(e.selected=!0,n(e.element).is("option"))return e.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(i){var r=[];e=[e],e.push.apply(e,i);for(var o=0;o<e.length;o++){var s=e[o].id;-1===n.inArray(s,r)&&r.push(s)}t.$element.val(r),t.$element.trigger("change")});else{var i=e.id;this.$element.val(i),this.$element.trigger("change");
}},i.prototype.unselect=function(e){var t=this;if(this.$element.prop("multiple"))return e.selected=!1,n(e.element).is("option")?(e.element.selected=!1,void this.$element.trigger("change")):void this.current(function(i){for(var r=[],o=0;o<i.length;o++){var s=i[o].id;s!==e.id&&-1===n.inArray(s,r)&&r.push(s)}t.$element.val(r),t.$element.trigger("change")})},i.prototype.bind=function(e,t){var n=this;this.container=e,e.on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},i.prototype.destroy=function(){this.$element.find("*").each(function(){n.removeData(this,"data")})},i.prototype.query=function(e,t){var i=[],r=this,o=this.$element.children();o.each(function(){var t=n(this);if(t.is("option")||t.is("optgroup")){var o=r.item(t),s=r.matches(e,o);null!==s&&i.push(s)}}),t({results:i})},i.prototype.addOptions=function(e){t.appendMany(this.$element,e)},i.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup"),t.label=e.text):(t=document.createElement("option"),void 0!==t.textContent?t.textContent=e.text:t.innerText=e.text),e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var i=n(t),r=this._normalizeItem(e);return r.element=t,n.data(t,"data",r),i},i.prototype.item=function(e){var t={};if(t=n.data(e[0],"data"),null!=t)return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var i=e.children("option"),r=[],o=0;o<i.length;o++){var s=n(i[o]),a=this.item(s);r.push(a)}t.children=r}return t=this._normalizeItem(t),t.element=e[0],n.data(e[0],"data",t),t},i.prototype._normalizeItem=function(e){n.isPlainObject(e)||(e={id:e,text:e}),e=n.extend({},{text:""},e);var t={selected:!1,disabled:!1};return null!=e.id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),n.extend({},t,e)},i.prototype.matches=function(e,t){var n=this.options.get("matcher");return n(e,t)},i}),t.define("select2/data/array",["./select","../utils","jquery"],function(e,t,n){function i(e,t){var n=t.get("data")||[];i.__super__.constructor.call(this,e,t),this.addOptions(this.convertToOptions(n))}return t.Extend(i,e),i.prototype.select=function(e){var t=this.$element.find("option").filter(function(t,n){return n.value==e.id.toString()});0===t.length&&(t=this.option(e),this.addOptions(t)),i.__super__.select.call(this,e)},i.prototype.convertToOptions=function(e){function i(e){return function(){return n(this).val()==e.id}}for(var r=this,o=this.$element.find("option"),s=o.map(function(){return r.item(n(this)).id}).get(),a=[],l=0;l<e.length;l++){var c=this._normalizeItem(e[l]);if(n.inArray(c.id,s)>=0){var u=o.filter(i(c)),d=this.item(u),p=n.extend(!0,{},c,d),h=this.option(p);u.replaceWith(h)}else{var f=this.option(c);if(c.children){var g=this.convertToOptions(c.children);t.appendMany(f,g)}a.push(f)}}return a},i}),t.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,n){function i(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),i.__super__.constructor.call(this,e,t)}return t.Extend(i,e),i.prototype._applyDefaults=function(e){var t={data:function(e){return n.extend({},e,{q:e.term})},transport:function(e,t,i){var r=n.ajax(e);return r.then(t),r.fail(i),r}};return n.extend({},t,e,!0)},i.prototype.processResults=function(e){return e},i.prototype.query=function(e,t){function i(){var i=o.transport(o,function(i){var o=r.processResults(i,e);r.options.get("debug")&&window.console&&console.error&&(o&&o.results&&n.isArray(o.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),t(o)},function(){i.status&&"0"===i.status||r.trigger("results:message",{message:"errorLoading"})});r._request=i}var r=this;null!=this._request&&(n.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var o=n.extend({type:"GET"},this.ajaxOptions);"function"==typeof o.url&&(o.url=o.url.call(this.$element,e)),"function"==typeof o.data&&(o.data=o.data.call(this.$element,e)),this.ajaxOptions.delay&&null!=e.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(i,this.ajaxOptions.delay)):i()},i}),t.define("select2/data/tags",["jquery"],function(e){function t(t,n,i){var r=i.get("tags"),o=i.get("createTag");void 0!==o&&(this.createTag=o);var s=i.get("insertTag");if(void 0!==s&&(this.insertTag=s),t.call(this,n,i),e.isArray(r))for(var a=0;a<r.length;a++){var l=r[a],c=this._normalizeItem(l),u=this.option(c);this.$element.append(u)}}return t.prototype.query=function(e,t,n){function i(e,o){for(var s=e.results,a=0;a<s.length;a++){var l=s[a],c=null!=l.children&&!i({results:l.children},!0),u=l.text===t.term;if(u||c)return o?!1:(e.data=s,void n(e))}if(o)return!0;var d=r.createTag(t);if(null!=d){var p=r.option(d);p.attr("data-select2-tag",!0),r.addOptions([p]),r.insertTag(s,d)}e.results=s,n(e)}var r=this;return this._removeOldTags(),null==t.term||null!=t.page?void e.call(this,t,n):void e.call(this,t,i)},t.prototype.createTag=function(t,n){var i=e.trim(n.term);return""===i?null:{id:i,text:i}},t.prototype.insertTag=function(e,t,n){t.unshift(n)},t.prototype._removeOldTags=function(t){var n=(this._lastTag,this.$element.find("option[data-select2-tag]"));n.each(function(){this.selected||e(this).remove()})},t}),t.define("select2/data/tokenizer",["jquery"],function(e){function t(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return t.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},t.prototype.query=function(t,n,i){function r(t){var n=s._normalizeItem(t),i=s.$element.find("option").filter(function(){return e(this).val()===n.id});if(!i.length){var r=s.option(n);r.attr("data-select2-tag",!0),s._removeOldTags(),s.addOptions([r])}o(n)}function o(e){s.trigger("select",{data:e})}var s=this;n.term=n.term||"";var a=this.tokenizer(n,this.options,r);a.term!==n.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.focus()),n.term=a.term),t.call(this,n,i)},t.prototype.tokenizer=function(t,n,i,r){for(var o=i.get("tokenSeparators")||[],s=n.term,a=0,l=this.createTag||function(e){return{id:e.term,text:e.term}};a<s.length;){var c=s[a];if(-1!==e.inArray(c,o)){var u=s.substr(0,a),d=e.extend({},n,{term:u}),p=l(d);null!=p?(r(p),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},t}),t.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",t.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),t.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){return t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):void e.call(this,t,n)},e}),t.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){var i=this;this.current(function(r){var o=null!=r?r.length:0;return i.maximumSelectionLength>0&&o>=i.maximumSelectionLength?void i.trigger("results:message",{message:"maximumSelected",args:{maximum:i.maximumSelectionLength}}):void e.call(i,t,n)})},e}),t.define("select2/dropdown",["jquery","./utils"],function(e,t){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return t.Extend(n,t.Observable),n.prototype.render=function(){var t=e('<span class="select2-dropdown"><span class="select2-results"></span></span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),t.define("select2/dropdown/search",["jquery","../utils"],function(e,t){function n(){}return n.prototype.render=function(t){var n=t.call(this),i=e('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=i,this.$search=i.find("input"),n.prepend(i),n},n.prototype.bind=function(t,n,i){var r=this;t.call(this,n,i),this.$search.on("keydown",function(e){r.trigger("keypress",e),r._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(t){e(this).off("keyup")}),this.$search.on("keyup input",function(e){r.handleSearch(e)}),n.on("open",function(){r.$search.attr("tabindex",0),r.$search.focus(),window.setTimeout(function(){r.$search.focus()},0)}),n.on("close",function(){r.$search.attr("tabindex",-1),r.$search.val("")}),n.on("focus",function(){n.isOpen()&&r.$search.focus()}),n.on("results:all",function(e){if(null==e.query.term||""===e.query.term){var t=r.showSearch(e);t?r.$searchContainer.removeClass("select2-search--hide"):r.$searchContainer.addClass("select2-search--hide")}})},n.prototype.handleSearch=function(e){if(!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.showSearch=function(e,t){return!0},n}),t.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;i>=0;i--){var r=t[i];this.placeholder.id===r.id&&n.splice(i,1)}return n},e}),t.define("select2/dropdown/infiniteScroll",["jquery"],function(e){function t(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return t.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,n,i){var r=this;t.call(this,n,i),n.on("query",function(e){r.lastParams=e,r.loading=!0}),n.on("query:append",function(e){r.lastParams=e,r.loading=!0}),this.$results.on("scroll",function(){var t=e.contains(document.documentElement,r.$loadingMore[0]);if(!r.loading&&t){var n=r.$results.offset().top+r.$results.outerHeight(!1),i=r.$loadingMore.offset().top+r.$loadingMore.outerHeight(!1);n+50>=i&&r.loadMore()}})},t.prototype.loadMore=function(){this.loading=!0;var t=e.extend({},{page:1},this.lastParams);t.page++,this.trigger("query:append",t)},t.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=e('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),n=this.options.get("translations").get("loadingMore");return t.html(n(this.lastParams)),t},t}),t.define("select2/dropdown/attachBody",["jquery","../utils"],function(e,t){function n(t,n,i){this.$dropdownParent=i.get("dropdownParent")||e(document.body),t.call(this,n,i)}return n.prototype.bind=function(e,t,n){var i=this,r=!1;e.call(this,t,n),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),r||(r=!0,t.on("results:all",function(){i._positionDropdown(),i._resizeDropdown()}),t.on("results:append",function(){i._positionDropdown(),i._resizeDropdown()}))}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},n.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},n.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},n.prototype.render=function(t){var n=e("<span></span>"),i=t.call(this);return n.append(i),this.$dropdownContainer=n,n},n.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},n.prototype._attachPositioningHandler=function(n,i){var r=this,o="scroll.select2."+i.id,s="resize.select2."+i.id,a="orientationchange.select2."+i.id,l=this.$container.parents().filter(t.hasScroll);l.each(function(){e(this).data("select2-scroll-position",{x:e(this).scrollLeft(),y:e(this).scrollTop()})}),l.on(o,function(t){var n=e(this).data("select2-scroll-position");e(this).scrollTop(n.y)}),e(window).on(o+" "+s+" "+a,function(e){r._positionDropdown(),r._resizeDropdown()})},n.prototype._detachPositioningHandler=function(n,i){var r="scroll.select2."+i.id,o="resize.select2."+i.id,s="orientationchange.select2."+i.id,a=this.$container.parents().filter(t.hasScroll);a.off(r),e(window).off(r+" "+o+" "+s)},n.prototype._positionDropdown=function(){var t=e(window),n=this.$dropdown.hasClass("select2-dropdown--above"),i=this.$dropdown.hasClass("select2-dropdown--below"),r=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=o.top,s.bottom=o.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},l={top:t.scrollTop(),bottom:t.scrollTop()+t.height()},c=l.top<o.top-a.height,u=l.bottom>o.bottom+a.height,d={left:o.left,top:s.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var h=p.offset();d.top-=h.top,d.left-=h.left,n||i||(r="below"),u||!c||n?!c&&u&&n&&(r="below"):r="above",("above"==r||n&&"below"!==r)&&(d.top=s.top-h.top-a.height),null!=r&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+r),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+r)),this.$dropdownContainer.css(d)},n.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},n.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},n}),t.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(t){for(var n=0,i=0;i<t.length;i++){var r=t[i];r.children?n+=e(r.children):n++}return n}function t(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return t.prototype.showSearch=function(t,n){return e(n.data.results)<this.minimumResultsForSearch?!1:t.call(this,n)},t}),t.define("select2/dropdown/selectOnClose",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var i=this.getHighlightedResults();if(!(i.length<1)){var r=i.data("data");null!=r.element&&r.element.selected||null==r.element&&r.selected||this.trigger("select",{data:r})}},e}),t.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&n.ctrlKey||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){var t=e.minimum-e.input.length,n="Please enter "+t+" or more characters";return n},loadingMore:function(){return"Loading more results"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching"}}}),t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(e,t,n,i,r,o,s,a,l,c,u,d,p,h,f,g,m,v,y,_,w,$,b,x,A,C,S,O,E){function D(){this.reset()}D.prototype.apply=function(d){if(d=e.extend(!0,{},this.defaults,d),null==d.dataAdapter){if(null!=d.ajax?d.dataAdapter=f:null!=d.data?d.dataAdapter=h:d.dataAdapter=p,d.minimumInputLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,v)),d.maximumInputLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,y)),d.maximumSelectionLength>0&&(d.dataAdapter=c.Decorate(d.dataAdapter,_)),d.tags&&(d.dataAdapter=c.Decorate(d.dataAdapter,g)),(null!=d.tokenSeparators||null!=d.tokenizer)&&(d.dataAdapter=c.Decorate(d.dataAdapter,m)),null!=d.query){var E=t(d.amdBase+"compat/query");d.dataAdapter=c.Decorate(d.dataAdapter,E)}if(null!=d.initSelection){var D=t(d.amdBase+"compat/initSelection");d.dataAdapter=c.Decorate(d.dataAdapter,D)}}if(null==d.resultsAdapter&&(d.resultsAdapter=n,null!=d.ajax&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,x)),null!=d.placeholder&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,b)),d.selectOnClose&&(d.resultsAdapter=c.Decorate(d.resultsAdapter,S))),null==d.dropdownAdapter){if(d.multiple)d.dropdownAdapter=w;else{var T=c.Decorate(w,$);d.dropdownAdapter=T}if(0!==d.minimumResultsForSearch&&(d.dropdownAdapter=c.Decorate(d.dropdownAdapter,C)),d.closeOnSelect&&(d.dropdownAdapter=c.Decorate(d.dropdownAdapter,O)),null!=d.dropdownCssClass||null!=d.dropdownCss||null!=d.adaptDropdownCssClass){var q=t(d.amdBase+"compat/dropdownCss");d.dropdownAdapter=c.Decorate(d.dropdownAdapter,q)}d.dropdownAdapter=c.Decorate(d.dropdownAdapter,A)}if(null==d.selectionAdapter){if(d.multiple?d.selectionAdapter=r:d.selectionAdapter=i,null!=d.placeholder&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,o)),d.allowClear&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,s)),d.multiple&&(d.selectionAdapter=c.Decorate(d.selectionAdapter,a)),null!=d.containerCssClass||null!=d.containerCss||null!=d.adaptContainerCssClass){var j=t(d.amdBase+"compat/containerCss");d.selectionAdapter=c.Decorate(d.selectionAdapter,j)}d.selectionAdapter=c.Decorate(d.selectionAdapter,l)}if("string"==typeof d.language)if(d.language.indexOf("-")>0){var L=d.language.split("-"),k=L[0];d.language=[d.language,k]}else d.language=[d.language];if(e.isArray(d.language)){var P=new u;d.language.push("en");for(var I=d.language,M=0;M<I.length;M++){var R=I[M],z={};try{z=u.loadPath(R)}catch(H){try{R=this.defaults.amdLanguageBase+R,z=u.loadPath(R)}catch(U){d.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+R+'" could not be automatically loaded. A fallback will be used instead.');continue}}P.extend(z)}d.translations=P}else{var N=u.loadPath(this.defaults.amdLanguageBase+"en"),B=new u(d.language);B.extend(N),d.translations=B}return d},D.prototype.reset=function(){function t(e){function t(e){return d[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function n(i,r){if(""===e.trim(i.term))return r;if(r.children&&r.children.length>0){for(var o=e.extend(!0,{},r),s=r.children.length-1;s>=0;s--){var a=r.children[s],l=n(i,a);null==l&&o.children.splice(s,1)}return o.children.length>0?o:n(i,o)}var c=t(r.text).toUpperCase(),u=t(i.term).toUpperCase();return c.indexOf(u)>-1?r:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:E,matcher:n,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},D.prototype.set=function(t,n){var i=e.camelCase(t),r={};r[i]=n;var o=c._convertData(r);e.extend(this.defaults,o)};var T=new D;return T}),t.define("select2/options",["require","jquery","./defaults","./utils"],function(e,t,n,i){function r(t,r){if(this.options=t,null!=r&&this.fromElement(r),this.options=n.apply(this.options),r&&r.is("input")){var o=e(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=i.Decorate(this.options.dataAdapter,o)}}return r.prototype.fromElement=function(e){var n=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.language&&(e.prop("lang")?this.options.language=e.prop("lang").toLowerCase():e.closest("[lang]").prop("lang")&&(this.options.language=e.closest("[lang]").prop("lang"))),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),e.data("data",e.data("select2Tags")),e.data("tags",!0)),e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",e.data("ajaxUrl")),e.data("ajax--url",e.data("ajaxUrl")));var r={};r=t.fn.jquery&&"1."==t.fn.jquery.substr(0,2)&&e[0].dataset?t.extend(!0,{},e[0].dataset):e.data();var o=t.extend(!0,{},r);o=i._convertData(o);for(var s in o)t.inArray(s,n)>-1||(t.isPlainObject(this.options[s])?t.extend(this.options[s],o[s]):this.options[s]=o[s]);return this},r.prototype.get=function(e){return this.options[e]},r.prototype.set=function(e,t){this.options[e]=t},r}),t.define("select2/core",["jquery","./options","./utils","./keys"],function(e,t,n,i){var r=function(e,n){null!=e.data("select2")&&e.data("select2").destroy(),this.$element=e,this.id=this._generateId(e),n=n||{},this.options=new t(n,e),r.__super__.constructor.call(this);var i=e.attr("tabindex")||0;e.data("old-tabindex",i),e.attr("tabindex","-1");var o=this.options.get("dataAdapter");this.dataAdapter=new o(e,this.options);var s=this.render();this._placeContainer(s);var a=this.options.get("selectionAdapter");this.selection=new a(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,s);var l=this.options.get("dropdownAdapter");this.dropdown=new l(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,s);var c=this.options.get("resultsAdapter");this.results=new c(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var u=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){u.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),e.data("select2",this)};return n.Extend(r,n.Observable),r.prototype._generateId=function(e){var t="";return t=null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+n.generateChars(2):n.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),t="select2-"+t},r.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},r.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){var r=e.outerWidth(!1);return 0>=r?"auto":r+"px"}if("style"==t){var o=e.attr("style");if("string"!=typeof o)return null;for(var s=o.split(";"),a=0,l=s.length;l>a;a+=1){var c=s[a].replace(/\s/g,""),u=c.match(n);if(null!==u&&u.length>=1)return u[1]}return null}return t},r.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},r.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=n.bind(this._syncAttributes,this),this._syncS=n.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=i?(this._observer=new i(function(n){e.each(n,t._syncA),e.each(n,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},r.prototype._registerDataEvents=function(){var e=this;this.dataAdapter.on("*",function(t,n){e.trigger(t,n)})},r.prototype._registerSelectionEvents=function(){var t=this,n=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()}),this.selection.on("focus",function(e){t.focus(e)}),this.selection.on("*",function(i,r){-1===e.inArray(i,n)&&t.trigger(i,r)})},r.prototype._registerDropdownEvents=function(){var e=this;this.dropdown.on("*",function(t,n){e.trigger(t,n)})},r.prototype._registerResultsEvents=function(){var e=this;this.results.on("*",function(t,n){e.trigger(t,n)})},r.prototype._registerEvents=function(){var e=this;this.on("open",function(){e.$container.addClass("select2-container--open")}),this.on("close",function(){e.$container.removeClass("select2-container--open")}),this.on("enable",function(){e.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){e.$container.addClass("select2-container--disabled")}),this.on("blur",function(){e.$container.removeClass("select2-container--focus")}),this.on("query",function(t){e.isOpen()||e.trigger("open",{}),this.dataAdapter.query(t,function(n){e.trigger("results:all",{data:n,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(n){e.trigger("results:append",{data:n,query:t})})}),this.on("keypress",function(t){var n=t.which;e.isOpen()?n===i.ESC||n===i.TAB||n===i.UP&&t.altKey?(e.close(),t.preventDefault()):n===i.ENTER?(e.trigger("results:select",{}),t.preventDefault()):n===i.SPACE&&t.ctrlKey?(e.trigger("results:toggle",{}),t.preventDefault()):n===i.UP?(e.trigger("results:previous",{}),t.preventDefault()):n===i.DOWN&&(e.trigger("results:next",{}),t.preventDefault()):(n===i.ENTER||n===i.SPACE||n===i.DOWN&&t.altKey)&&(e.open(),t.preventDefault())})},r.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},r.prototype._syncSubtree=function(e,t){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&t.addedNodes.length>0)for(var r=0;r<t.addedNodes.length;r++){var o=t.addedNodes[r];o.selected&&(n=!0)}else t.removedNodes&&t.removedNodes.length>0&&(n=!0);else n=!0;n&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})}},r.prototype.trigger=function(e,t){var n=r.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===t&&(t={}),e in i){var o=i[e],s={prevented:!1,name:e,args:t};if(n.call(this,o,s),s.prevented)return void(t.prevented=!0)}n.call(this,e,t)},r.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},r.prototype.open=function(){this.isOpen()||this.trigger("query",{})},r.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},r.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},r.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},r.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},r.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==e||0===e.length)&&(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},r.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var e=[];return this.dataAdapter.current(function(t){e=t}),e},r.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==t||0===t.length)return this.$element.val();var n=t[0];e.isArray(n)&&(n=e.map(n,function(e){return e.toString()})),this.$element.val(n).trigger("change")},r.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},r.prototype.render=function(){var t=e('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),
t.data("element",this.$element),t},r}),t.define("select2/compat/utils",["jquery"],function(e){function t(t,n,i){var r,o,s=[];r=e.trim(t.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&s.push(this)})),r=e.trim(n.attr("class")),r&&(r=""+r,e(r.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&(o=i(this),null!=o&&s.push(o))})),t.attr("class",s.join(" "))}return{syncCssClasses:t}}),t.define("select2/compat/containerCss",["jquery","./utils"],function(e,t){function n(e){return null}function i(){}return i.prototype.render=function(i){var r=i.call(this),o=this.options.get("containerCssClass")||"";e.isFunction(o)&&(o=o(this.$element));var s=this.options.get("adaptContainerCssClass");if(s=s||n,-1!==o.indexOf(":all:")){o=o.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("containerCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(r,this.$element,s),r.css(l),r.addClass(o),r},i}),t.define("select2/compat/dropdownCss",["jquery","./utils"],function(e,t){function n(e){return null}function i(){}return i.prototype.render=function(i){var r=i.call(this),o=this.options.get("dropdownCssClass")||"";e.isFunction(o)&&(o=o(this.$element));var s=this.options.get("adaptDropdownCssClass");if(s=s||n,-1!==o.indexOf(":all:")){o=o.replace(":all:","");var a=s;s=function(e){var t=a(e);return null!=t?t+" "+e:e}}var l=this.options.get("dropdownCss")||{};return e.isFunction(l)&&(l=l(this.$element)),t.syncCssClasses(r,this.$element,s),r.css(l),r.addClass(o),r},i}),t.define("select2/compat/initSelection",["jquery"],function(e){function t(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=n.get("initSelection"),this._isInitialized=!1,e.call(this,t,n)}return t.prototype.current=function(t,n){var i=this;return this._isInitialized?void t.call(this,n):void this.initSelection.call(null,this.$element,function(t){i._isInitialized=!0,e.isArray(t)||(t=[t]),n(t)})},t}),t.define("select2/compat/inputData",["jquery"],function(e){function t(e,t,n){this._currentData=[],this._valueSeparator=n.get("valueSeparator")||",","hidden"===t.prop("type")&&n.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),e.call(this,t,n)}return t.prototype.current=function(t,n){function i(t,n){var r=[];return t.selected||-1!==e.inArray(t.id,n)?(t.selected=!0,r.push(t)):t.selected=!1,t.children&&r.push.apply(r,i(t.children,n)),r}for(var r=[],o=0;o<this._currentData.length;o++){var s=this._currentData[o];r.push.apply(r,i(s,this.$element.val().split(this._valueSeparator)))}n(r)},t.prototype.select=function(t,n){if(this.options.get("multiple")){var i=this.$element.val();i+=this._valueSeparator+n.id,this.$element.val(i),this.$element.trigger("change")}else this.current(function(t){e.map(t,function(e){e.selected=!1})}),this.$element.val(n.id),this.$element.trigger("change")},t.prototype.unselect=function(e,t){var n=this;t.selected=!1,this.current(function(e){for(var i=[],r=0;r<e.length;r++){var o=e[r];t.id!=o.id&&i.push(o.id)}n.$element.val(i.join(n._valueSeparator)),n.$element.trigger("change")})},t.prototype.query=function(e,t,n){for(var i=[],r=0;r<this._currentData.length;r++){var o=this._currentData[r],s=this.matches(t,o);null!==s&&i.push(s)}n({results:i})},t.prototype.addOptions=function(t,n){var i=e.map(n,function(t){return e.data(t[0],"data")});this._currentData.push.apply(this._currentData,i)},t}),t.define("select2/compat/matcher",["jquery"],function(e){function t(t){function n(n,i){var r=e.extend(!0,{},i);if(null==n.term||""===e.trim(n.term))return r;if(i.children){for(var o=i.children.length-1;o>=0;o--){var s=i.children[o],a=t(n.term,s.text,s);a||r.children.splice(o,1)}if(r.children.length>0)return r}return t(n.term,i.text,i)?r:null}return n}return t}),t.define("select2/compat/query",[],function(){function e(e,t,n){n.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),console.log(e),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.callback=n;var i=this.options.get("query");i.call(null,t)},e}),t.define("select2/dropdown/attachContainer",[],function(){function e(e,t,n){e.call(this,t,n)}return e.prototype.position=function(e,t,n){var i=n.find(".dropdown-wrapper");i.append(t),t.addClass("select2-dropdown--below"),n.addClass("select2-container--below")},e}),t.define("select2/dropdown/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);var i=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$dropdown.on(i.join(" "),function(e){e.stopPropagation()})},e}),t.define("select2/selection/stopPropagation",[],function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n);var i=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$selection.on(i.join(" "),function(e){e.stopPropagation()})},e}),function(n){"function"==typeof t.define&&t.define.amd?t.define("jquery-mousewheel",["jquery"],n):"object"==typeof exports?module.exports=n:n(e)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),c=0,d=0,p=0,h=0,f=0,g=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(p=-1*s.detail),"wheelDelta"in s&&(p=s.wheelDelta),"wheelDeltaY"in s&&(p=s.wheelDeltaY),"wheelDeltaX"in s&&(d=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(d=-1*p,p=0),c=0===p?d:p,"deltaY"in s&&(p=-1*s.deltaY,c=p),"deltaX"in s&&(d=s.deltaX,0===p&&(c=-1*d)),0!==p||0!==d){if(1===s.deltaMode){var m=e.data(this,"mousewheel-line-height");c*=m,p*=m,d*=m}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");c*=v,p*=v,d*=v}if(h=Math.max(Math.abs(p),Math.abs(d)),(!o||o>h)&&(o=h,i(s,h)&&(o/=40)),i(s,h)&&(c/=40,d/=40,p/=40),c=Math[c>=1?"floor":"ceil"](c/o),d=Math[d>=1?"floor":"ceil"](d/o),p=Math[p>=1?"floor":"ceil"](p/o),u.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=t.clientX-y.left,g=t.clientY-y.top}return t.deltaX=d,t.deltaY=p,t.deltaFactor=o,t.offsetX=f,t.offsetY=g,t.deltaMode=0,a.unshift(t,c,d,p),r&&clearTimeout(r),r=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function n(){o=null}function i(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var r,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var c=s.length;c;)e.event.fixHooks[s[--c]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(e,t,n,i){if(null==e.fn.select2){var r=["open","close","destroy"];e.fn.select2=function(t){if(t=t||{},"object"==typeof t)return this.each(function(){var i=e.extend(!0,{},t);new n(e(this),i)}),this;if("string"==typeof t){var i,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=e(this).data("select2");null==n&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),i=n[t].apply(n,o)}),e.inArray(t,r)>-1?this:i}throw new Error("Invalid arguments for Select2: "+t)}}return null==e.fn.select2.defaults&&(e.fn.select2.defaults=i),n}),{define:t.define,require:t.require}}(),n=t.require("jquery.select2");return e.fn.select2.amd=t,n});
/*! Select2 4.0.3 | https://github.com/select2/select2/blob/master/LICENSE.md */
!function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;return n.define("select2/i18n/ar",[],function(){return{errorLoading:function(){return"   "},inputTooLong:function(n){var e=n.input.length-n.maximum,r="  "+e+" ";return r},inputTooShort:function(n){var e=n.minimum-n.input.length,r="  "+e+" ";return r},loadingMore:function(){return"   ..."},maximumSelected:function(n){var e="  "+n.maximum+"  ";return e},noResults:function(){return"     "},searching:function(){return" "}}}),{define:n.define,require:n.require}}();
/*! Select2 4.0.3 | https://github.com/select2/select2/blob/master/LICENSE.md */
!function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;return e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var n=e.input.length-e.maximum,r="Please delete "+n+" character";return 1!=n&&(r+="s"),r},inputTooShort:function(e){var n=e.minimum-e.input.length,r="Please enter "+n+" or more characters";return r},loadingMore:function(){return"Loading more results"},maximumSelected:function(e){var n="You can only select "+e.maximum+" item";return 1!=e.maximum&&(n+="s"),n},noResults:function(){return"No results found"},searching:function(){return"Searching"}}}),{define:e.define,require:e.require}}();
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"function"==typeof require&&require("select2");var t="placecomplete",i={placeholder:"City, State, Country",requestParams:{types:["(cities)"]}};window.initPlacecomplete=function(){n.completeInit()},e.fn.select2.amd.define("select2/data/googleDataAdapter",["select2/data/minimumInputLength","select2/data/array","select2/utils"],function(i,r,a){function s(e,t){requestParams=t.options.requestParams,s.__super__.constructor.call(this,e,t)}return a.Extend(s,r),s.prototype.current=function(e){var t=this.$element.find(":selected");if(0==t.length)return void e([]);var i={id:t.val(),text:t.text()};e([i])},s.prototype.query=function(i,r){var a=e(this.$element);n.getPredictions(i.term,requestParams).done(function(t){var i=e.map(t,function(e){return{id:e.reference,text:e.description}});r({results:i})}).fail(function(e){a.trigger(t+":error",e),r({results:[]})})},a.Decorate(s,i)});var n={deferred:new e.Deferred,initialized:!1,acService:null,pService:null,el:null,init:function(t,i){this.initialized||(this.el=t,window.google&&google.maps&&google.maps.places?this.completeInit():e.ajax({url:"https://maps.googleapis.com/maps/api/js",data:{key:i.apiKey,libraries:"places",sensor:"false",callback:"initPlacecomplete"},dataType:"script",cache:!0}))},completeInit:function(){return 0==e(".js-geolocation-placeholder").length?void this.deferred.reject():(this.acService=new google.maps.places.AutocompleteService,this.pService=new google.maps.places.PlacesService(e(".js-geolocation-placeholder").get(0)),this.initialized=!0,void this.deferred.resolve())},_handlePredictions:function(e,t,i){return i!==google.maps.places.PlacesServiceStatus.OK?void e.reject(i):void e.resolve(t)},_handleDetails:function(e,t,i,n){return n!==google.maps.places.PlacesServiceStatus.OK?void e.reject(n):(i.display_text=t,void e.resolve(i))},getPredictions:function(t,i){return this.deferred.then(e.proxy(function(){var n=new e.Deferred,r=e.extend({},i,{input:t});return this.acService.getPlacePredictions(r,e.proxy(this._handlePredictions,null,n)),n.promise()},this))},getDetails:function(t){return this.deferred.then(e.proxy(function(){var i=new e.Deferred,n=t.description,r=t.reference;return this.pService.getDetails({reference:r},e.proxy(this._handleDetails,null,i,n)),i.promise()},this))}},r=function(r,a){this.element=r,this.options=e.extend({},i,a),n.init(r,this.options),this._defaults=i,this._name=t,this.init()};r.prototype.init=function(){var i=e(this.element),r=e.fn.select2.amd.require("select2/data/googleDataAdapter"),a=e.extend({},{dataAdapter:r,requestParams:this.options.requestParams,minimumInputLength:1,selectOnBlur:!0,allowClear:!0,multiple:!1,placeholder:this.options.placeholder,templateSelection:function(e){return e.text}},this.options);i.select2(a),i.on({"select2:unselect":function(e){i.trigger(t+":cleared")},"select2:select":function(e){e.params.data&&n.getDetails({reference:e.params.data.id,description:e.params.data.text}).done(function(e){i.trigger(t+":selected",e)}).fail(function(e){i.trigger(t+":error",e)})}})},e.fn[t]=function(i){return this.each(function(){e.data(this,"plugin_"+t)||e.data(this,"plugin_"+t,new r(this,i))})}});
/*
 RequireJS 2.1.11 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/
var requirejs,require,define;
(function(ca){function G(b){return"[object Function]"===M.call(b)}function H(b){return"[object Array]"===M.call(b)}function v(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function U(b,c){if(b){var d;for(d=b.length-1;-1<d&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function j(b,c){return s(b,c)&&b[c]}function B(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function V(b,c,d,g){c&&B(c,function(c,h){if(d||!s(b,h))g&&"object"===typeof c&&c&&!H(c)&&!G(c)&&!(c instanceof
RegExp)?(b[h]||(b[h]={}),V(b[h],c,d,g)):b[h]=c});return b}function t(b,c){return function(){return c.apply(b,arguments)}}function da(b){throw b;}function ea(b){if(!b)return b;var c=ca;v(b.split("."),function(b){c=c[b]});return c}function C(b,c,d,g){c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b);c.requireType=b;c.requireModules=g;d&&(c.originalError=d);return c}function ha(b){function c(a,e,b){var f,n,c,d,g,h,i,I=e&&e.split("/");n=I;var m=l.map,k=m&&m["*"];if(a&&"."===a.charAt(0))if(e){n=
I.slice(0,I.length-1);a=a.split("/");e=a.length-1;l.nodeIdCompat&&R.test(a[e])&&(a[e]=a[e].replace(R,""));n=a=n.concat(a);d=n.length;for(e=0;e<d;e++)if(c=n[e],"."===c)n.splice(e,1),e-=1;else if(".."===c)if(1===e&&(".."===n[2]||".."===n[0]))break;else 0<e&&(n.splice(e-1,2),e-=2);a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&m&&(I||k)){n=a.split("/");e=n.length;a:for(;0<e;e-=1){d=n.slice(0,e).join("/");if(I)for(c=I.length;0<c;c-=1)if(b=j(m,I.slice(0,c).join("/")))if(b=j(b,d)){f=b;
g=e;break a}!h&&(k&&j(k,d))&&(h=j(k,d),i=e)}!f&&h&&(f=h,g=i);f&&(n.splice(0,g,f),a=n.join("/"))}return(f=j(l.pkgs,a))?f:a}function d(a){z&&v(document.getElementsByTagName("script"),function(e){if(e.getAttribute("data-requiremodule")===a&&e.getAttribute("data-requirecontext")===i.contextName)return e.parentNode.removeChild(e),!0})}function g(a){var e=j(l.paths,a);if(e&&H(e)&&1<e.length)return e.shift(),i.require.undef(a),i.require([a]),!0}function u(a){var e,b=a?a.indexOf("!"):-1;-1<b&&(e=a.substring(0,
b),a=a.substring(b+1,a.length));return[e,a]}function m(a,e,b,f){var n,d,g=null,h=e?e.name:null,l=a,m=!0,k="";a||(m=!1,a="_@r"+(M+=1));a=u(a);g=a[0];a=a[1];g&&(g=c(g,h,f),d=j(p,g));a&&(g?k=d&&d.normalize?d.normalize(a,function(a){return c(a,h,f)}):c(a,h,f):(k=c(a,h,f),a=u(k),g=a[0],k=a[1],b=!0,n=i.nameToUrl(k)));b=g&&!d&&!b?"_unnormalized"+(Q+=1):"";return{prefix:g,name:k,parentMap:e,unnormalized:!!b,url:n,originalName:l,isDefine:m,id:(g?g+"!"+k:k)+b}}function q(a){var e=a.id,b=j(k,e);b||(b=k[e]=new i.Module(a));
return b}function r(a,e,b){var f=a.id,n=j(k,f);if(s(p,f)&&(!n||n.defineEmitComplete))"defined"===e&&b(p[f]);else if(n=q(a),n.error&&"error"===e)b(n.error);else n.on(e,b)}function w(a,e){var b=a.requireModules,f=!1;if(e)e(a);else if(v(b,function(e){if(e=j(k,e))e.error=a,e.events.error&&(f=!0,e.emit("error",a))}),!f)h.onError(a)}function x(){S.length&&(ia.apply(A,[A.length,0].concat(S)),S=[])}function y(a){delete k[a];delete W[a]}function F(a,e,b){var f=a.map.id;a.error?a.emit("error",a.error):(e[f]=
!0,v(a.depMaps,function(f,c){var d=f.id,g=j(k,d);g&&(!a.depMatched[c]&&!b[d])&&(j(e,d)?(a.defineDep(c,p[d]),a.check()):F(g,e,b))}),b[f]=!0)}function D(){var a,e,b=(a=1E3*l.waitSeconds)&&i.startTime+a<(new Date).getTime(),f=[],c=[],h=!1,k=!0;if(!X){X=!0;B(W,function(a){var i=a.map,m=i.id;if(a.enabled&&(i.isDefine||c.push(a),!a.error))if(!a.inited&&b)g(m)?h=e=!0:(f.push(m),d(m));else if(!a.inited&&(a.fetched&&i.isDefine)&&(h=!0,!i.prefix))return k=!1});if(b&&f.length)return a=C("timeout","Load timeout for modules: "+
f,null,f),a.contextName=i.contextName,w(a);k&&v(c,function(a){F(a,{},{})});if((!b||e)&&h)if((z||fa)&&!Y)Y=setTimeout(function(){Y=0;D()},50);X=!1}}function E(a){s(p,a[0])||q(m(a[0],null,!0)).init(a[1],a[2])}function K(a){var a=a.currentTarget||a.srcElement,e=i.onScriptLoad;a.detachEvent&&!Z?a.detachEvent("onreadystatechange",e):a.removeEventListener("load",e,!1);e=i.onScriptError;(!a.detachEvent||Z)&&a.removeEventListener("error",e,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function L(){var a;
for(x();A.length;){a=A.shift();if(null===a[0])return w(C("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));E(a)}}var X,$,i,N,Y,l={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},k={},W={},aa={},A=[],p={},T={},ba={},M=1,Q=1;N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?p[a.map.id]=a.exports:a.exports=p[a.map.id]={}},module:function(a){return a.module?
a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return j(l.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}};$=function(a){this.events=j(aa,a.id)||{};this.map=a;this.shim=j(l.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};$.prototype={init:function(a,e,b,f){f=f||{};if(!this.inited){this.factory=e;if(b)this.on("error",b);else this.events.error&&(b=t(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=
b;this.inited=!0;this.ignore=f.ignore;f.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,e){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=e)},fetch:function(){if(!this.fetched){this.fetched=!0;i.startTime=(new Date).getTime();var a=this.map;if(this.shim)i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],t(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=
this.map.url;T[a]||(T[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,e,b=this.map.id;e=this.depExports;var f=this.exports,c=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(G(c)){if(this.events.error&&this.map.isDefine||h.onError!==da)try{f=i.execCb(b,c,e,f)}catch(d){a=d}else f=i.execCb(b,c,e,f);this.map.isDefine&&void 0===f&&((e=this.module)?f=e.exports:this.usingExports&&
(f=this.exports));if(a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",w(this.error=a)}else f=c;this.exports=f;if(this.map.isDefine&&!this.ignore&&(p[b]=f,h.onResourceLoad))h.onResourceLoad(i,this.map,this.depMaps);y(b);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=
this.map,b=a.id,d=m(a.prefix);this.depMaps.push(d);r(d,"defined",t(this,function(f){var d,g;g=j(ba,this.map.id);var J=this.map.name,u=this.map.parentMap?this.map.parentMap.name:null,p=i.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(f.normalize&&(J=f.normalize(J,function(a){return c(a,u,!0)})||""),f=m(a.prefix+"!"+J,this.map.parentMap),r(f,"defined",t(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),g=j(k,f.id)){this.depMaps.push(f);
if(this.events.error)g.on("error",t(this,function(a){this.emit("error",a)}));g.enable()}}else g?(this.map.url=i.nameToUrl(g),this.load()):(d=t(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),d.error=t(this,function(a){this.inited=!0;this.error=a;a.requireModules=[b];B(k,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&y(a.map.id)});w(a)}),d.fromText=t(this,function(f,c){var g=a.name,J=m(g),k=O;c&&(f=c);k&&(O=!1);q(J);s(l.config,b)&&(l.config[g]=l.config[b]);try{h.exec(f)}catch(j){return w(C("fromtexteval",
"fromText eval for "+b+" failed: "+j,j,[b]))}k&&(O=!0);this.depMaps.push(J);i.completeLoad(g);p([g],d)}),f.load(a.name,p,d,l))}));i.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){W[this.map.id]=this;this.enabling=this.enabled=!0;v(this.depMaps,t(this,function(a,b){var c,f;if("string"===typeof a){a=m(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(c=j(N,a.id)){this.depExports[b]=c(this);return}this.depCount+=1;r(a,"defined",t(this,function(a){this.defineDep(b,
a);this.check()}));this.errback&&r(a,"error",t(this,this.errback))}c=a.id;f=k[c];!s(N,c)&&(f&&!f.enabled)&&i.enable(a,this)}));B(this.pluginMaps,t(this,function(a){var b=j(k,a.id);b&&!b.enabled&&i.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]);c.push(b)},emit:function(a,b){v(this.events[a],function(a){a(b)});"error"===a&&delete this.events[a]}};i={config:l,contextName:b,registry:k,defined:p,urlFetched:T,defQueue:A,Module:$,makeModuleMap:m,
nextTick:h.nextTick,onError:w,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=l.shim,c={paths:!0,bundles:!0,config:!0,map:!0};B(a,function(a,b){c[b]?(l[b]||(l[b]={}),V(l[b],a,!0,!0)):l[b]=a});a.bundles&&B(a.bundles,function(a,b){v(a,function(a){a!==b&&(ba[a]=b)})});a.shim&&(B(a.shim,function(a,c){H(a)&&(a={deps:a});if((a.exports||a.init)&&!a.exportsFn)a.exportsFn=i.makeShimExports(a);b[c]=a}),l.shim=b);a.packages&&v(a.packages,function(a){var b,
a="string"===typeof a?{name:a}:a;b=a.name;a.location&&(l.paths[b]=a.location);l.pkgs[b]=a.name+"/"+(a.main||"main").replace(ja,"").replace(R,"")});B(k,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=m(b))});if(a.deps||a.callback)i.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(ca,arguments));return b||a.exports&&ea(a.exports)}},makeRequire:function(a,e){function g(f,c,d){var j,l;e.enableBuildCallback&&(c&&G(c))&&(c.__requireJsBuild=
!0);if("string"===typeof f){if(G(c))return w(C("requireargs","Invalid require call"),d);if(a&&s(N,f))return N[f](k[a.id]);if(h.get)return h.get(i,f,a,g);j=m(f,a,!1,!0);j=j.id;return!s(p,j)?w(C("notloaded",'Module name "'+j+'" has not been loaded yet for context: '+b+(a?"":". Use require([])"))):p[j]}L();i.nextTick(function(){L();l=q(m(null,a));l.skipMap=e.skipMap;l.init(f,c,d,{enabled:!0});D()});return g}e=e||{};V(g,{isBrowser:z,toUrl:function(b){var e,d=b.lastIndexOf("."),g=b.split("/")[0];if(-1!==
d&&(!("."===g||".."===g)||1<d))e=b.substring(d,b.length),b=b.substring(0,d);return i.nameToUrl(c(b,a&&a.id,!0),e,!0)},defined:function(b){return s(p,m(b,a,!1,!0).id)},specified:function(b){b=m(b,a,!1,!0).id;return s(p,b)||s(k,b)}});a||(g.undef=function(b){x();var c=m(b,a,!0),e=j(k,b);d(b);delete p[b];delete T[c.url];delete aa[b];U(A,function(a,c){a[0]===b&&A.splice(c,1)});e&&(e.events.defined&&(aa[b]=e.events),y(b))});return g},enable:function(a){j(k,a.id)&&q(a).enable()},completeLoad:function(a){var b,
c,f=j(l.shim,a)||{},d=f.exports;for(x();A.length;){c=A.shift();if(null===c[0]){c[0]=a;if(b)break;b=!0}else c[0]===a&&(b=!0);E(c)}c=j(k,a);if(!b&&!s(p,a)&&c&&!c.inited){if(l.enforceDefine&&(!d||!ea(d)))return g(a)?void 0:w(C("nodefine","No define call for "+a,null,[a]));E([a,f.deps||[],f.exportsFn])}D()},nameToUrl:function(a,b,c){var f,d,g;(f=j(l.pkgs,a))&&(a=f);if(f=j(ba,a))return i.nameToUrl(f,b,c);if(h.jsExtRegExp.test(a))f=a+(b||"");else{f=l.paths;a=a.split("/");for(d=a.length;0<d;d-=1)if(g=a.slice(0,
d).join("/"),g=j(f,g)){H(g)&&(g=g[0]);a.splice(0,d,g);break}f=a.join("/");f+=b||(/^data\:|\?/.test(f)||c?"":".js");f=("/"===f.charAt(0)||f.match(/^[\w\+\.\-]+:/)?"":l.baseUrl)+f}return l.urlArgs?f+((-1===f.indexOf("?")?"?":"&")+l.urlArgs):f},load:function(a,b){h.load(i,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))P=null,a=K(a),i.completeLoad(a.id)},onScriptError:function(a){var b=K(a);if(!g(b.id))return w(C("scripterror",
"Script error for: "+b.id,a,[b.id]))}};i.require=i.makeRequire();return i}var h,x,y,D,K,E,P,L,q,Q,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,R=/\.js$/,ja=/^\.\//;x=Object.prototype;var M=x.toString,ga=x.hasOwnProperty,ia=Array.prototype.splice,z=!!("undefined"!==typeof window&&"undefined"!==typeof navigator&&window.document),fa=!z&&"undefined"!==typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,
Z="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),F={},r={},S=[],O=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(G(requirejs))return;r=requirejs;requirejs=void 0}"undefined"!==typeof require&&!G(require)&&(r=require,require=void 0);h=requirejs=function(b,c,d,g){var u,m="_";!H(b)&&"string"!==typeof b&&(u=b,H(c)?(b=c,c=d,d=g):b=[]);u&&u.context&&(m=u.context);(g=j(F,m))||(g=F[m]=h.s.newContext(m));u&&g.configure(u);return g.require(b,c,d)};h.config=function(b){return h(b)};
h.nextTick="undefined"!==typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()};require||(require=h);h.version="2.1.11";h.jsExtRegExp=/^\/|:|\?|\.js$/;h.isBrowser=z;x=h.s={contexts:F,newContext:ha};h({});v(["toUrl","undef","defined","specified"],function(b){h[b]=function(){var c=F._;return c.require[b].apply(c,arguments)}});if(z&&(y=x.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0]))y=x.head=D.parentNode;h.onError=da;h.createNode=function(b){var c=
b.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");c.type=b.scriptType||"text/javascript";c.charset="utf-8";c.async=!0;return c};h.load=function(b,c,d){var g=b&&b.config||{};if(z)return g=h.createNode(g,c,d),g.setAttribute("data-requirecontext",b.contextName),g.setAttribute("data-requiremodule",c),g.attachEvent&&!(g.attachEvent.toString&&0>g.attachEvent.toString().indexOf("[native code"))&&!Z?(O=!0,g.attachEvent("onreadystatechange",b.onScriptLoad)):
(g.addEventListener("load",b.onScriptLoad,!1),g.addEventListener("error",b.onScriptError,!1)),g.src=d,L=g,D?y.insertBefore(g,D):y.appendChild(g),L=null,g;if(fa)try{importScripts(d),b.completeLoad(c)}catch(j){b.onError(C("importscripts","importScripts failed for "+c+" at "+d,j,[c]))}};z&&!r.skipDataMain&&U(document.getElementsByTagName("script"),function(b){y||(y=b.parentNode);if(K=b.getAttribute("data-main"))return q=K,r.baseUrl||(E=q.split("/"),q=E.pop(),Q=E.length?E.join("/")+"/":"./",r.baseUrl=
Q),q=q.replace(R,""),h.jsExtRegExp.test(q)&&(q=K),r.deps=r.deps?r.deps.concat(q):[q],!0});define=function(b,c,d){var g,h;"string"!==typeof b&&(d=c,c=b,b=null);H(c)||(d=c,c=null);!c&&G(d)&&(c=[],d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c)));if(O){if(!(g=L))P&&"interactive"===P.readyState||U(document.getElementsByTagName("script"),function(b){if("interactive"===b.readyState)return P=b}),g=P;g&&(b||
(b=g.getAttribute("data-requiremodule")),h=F[g.getAttribute("data-requirecontext")])}(h?h.defQueue:S).push([b,c,d])};define.amd={jQuery:!0};h.exec=function(b){return eval(b)};h(r)}})(this);
require.config({paths:{"rwd/common/rich-text-editor":window.RTE_PATH,"rwd/admin/source-editor":window.SOURCE_EDITOR_PATH}}),define("jquery",[],function(){return logger.debug("Load jquery..."),$}),define("inheritance",[],function(){return logger.debug("Load inheritance..."),Class}),define("imager",[],function(){return logger.debug("Load imager..."),Imager}),define("chart",[],function(){return logger.debug("Load chart..."),Chart}),define("mustache",[],function(){return logger.debug("Load mustache..."),Mustache}),define("md5",[],function(){return logger.debug("Load md5..."),md5}),define("rwd/common/i18n",[],function(){return I18N});
define("rwd/accept-challenge-tnc-init",["jquery","rwd/common/base-ui-module","rwd/accept-challenge-tnc","rwd/common/rich-text-editor-util"],function(t,e,n,c){var i=e.extend({baseConfig:{selectors:{button:".js-accept-challenge-tnc:not(form)",form:"form.js-accept-challenge-tnc",input:"form.js-accept-challenge-tnc :input:not(select, :submit), form.js-accept-challenge-tnc [contenteditable=true]",select:"form.js-accept-challenge-tnc select",radioOrCheckbox:"form.js-accept-challenge-tnc :radio, form.js-accept-challenge-tnc :checkbox",file:"form.js-accept-challenge-tnc input[type=file]"},moduleSelector:"body",useModuleAsParent:!0},_handleInputEvents:function(e){var c=t(e.currentTarget),i=c.parents("form"),o=i.find(":input, [contenteditable=true]");e.preventDefault(),new n({targetElement:i}).acceptTNC().always(function(){o.off("focus.tnc").off("mousedown.tnc").off("change.tnc").off("click.tnc"),c.is("select")&&c.removeAttr("disabled"),c.focus()}.bind(this))},_handleRTEFocus:function(t){var e=t.parents("form"),c=e.find(":input, [contenteditable=true]");new n({targetElement:e}).acceptTNC().always(function(){c.off("focus.tnc").off("mousedown.tnc").off("change.tnc").off("click.tnc")}.bind(this))},_bindEvents:function(){this.$.button.on("click.tnc",function(e){var c=t(e.currentTarget);e.preventDefault(),new n({targetElement:c}).acceptTNC().then(function(){c.off("click.tnc")[0].click()})}),this.$.form.each(function(){t(this).parsley().subscribe("parsley:form:validated",function(t){t.validationResult&&(t.submitEvent.preventDefault(),new n({targetElement:t.$element}).acceptTNC().then(function(){t.unsubscribe("parsley:form:validated"),t.$element.submit()}).fail(function(){t.$element.find(":submit").trigger("restore")}))})}),this.$.input.on("focus.tnc",this._handleInputEvents),this.$.radioOrCheckbox.on("change.tnc",this._handleInputEvents),this.$.file.on("click.tnc",this._handleInputEvents),this.$.select.on("mousedown.tnc",function(e){var n=t(e.currentTarget);n.attr("disabled","disabled"),this._handleInputEvents(e)}.bind(this)),this.$.form.find(c.getRTEFieldSelector()).length&&require(["rwd/common/rich-text-editor"],function(t){this.richTextEditor=t.getInstance(),this.richTextEditor.onceFocus(this._handleRTEFocus.bind(this))}.bind(this))}});return i});
define("rwd/accept-challenge-tnc",["jquery","rwd/common/base-ui-module","rwd/modal-notification-template","rwd/common/i18n","rwd/common/utils","rwd/common/loading-indicator"],function(e,t,n,o,c,i){var a="data-challenge-tnc",r="tnc-accepted";return t.extend({baseConfig:{selectors:{body:"body"},targetElement:"",questionTemplate:"#template-t-and-c-question",tncPageUrlFormat:"/challenge/{0}/tnc",acceptTncUrlFormat:"/challenge/{0}/tnc/accept"},_init:function(){return this.config.targetElement.length?(this.challengeTextId=this.config.targetElement.attr(a),this.questionTemplate=new n({selectors:{template:this.config.questionTemplate}}),this.tncPageUrl=c.formatMessage(this.config.tncPageUrlFormat,this.challengeTextId),void(this.acceptTncUrl=c.formatMessage(this.config.acceptTncUrlFormat,this.challengeTextId))):void logger.error("Target element for accpeting challenge terms and conditions was not found")},_addToCache:function(){var e=this.$.body.data(r)||[];e.push(this.challengeTextId),this.$.body.data(r,e)},_isInCache:function(){return c.inArray(this.$.body.data(r)||[],this.challengeTextId)},_showError:function(){window.location="/error/500"},_sendAcceptRequest:function(t,n){e.ajax({type:"POST",url:this.acceptTncUrl,success:function(){this._addToCache(),t.resolve(),n.closeAndRemove()}.bind(this),error:function(e,o,c){logger.error("Accepting challenge terms and conditions failed: ",e,o,c),t.reject(),n.closeAndRemove(),this._showError()}.bind(this)})},_showQuestion:function(t){var n=this;return e(".accept-t-and-c").length?(logger.warn("Failed to open accept challenge terms and conditions question popup, a modal notification was already opened"),void t.reject()):void this.questionTemplate.render({message:o.format("accept-t-and-c-question",this.tncPageUrl)},function(e){e.preventDefault(),this.processing||(this.processing=!0,i.initialize({selectors:{busyButton:this.$.ok.selector}}),this.$.ok.trigger("loading"),n._sendAcceptRequest(t,this))},function(e){e.preventDefault(),this.processing||(t.reject(),this.closeAndRemove())}).open()},acceptTNC:function(){var t=e.Deferred();return this._isInCache()?t.resolve():this._showQuestion(t),t}})});
define("rwd/dummy-accept-challenge-tnc",["jquery","rwd/accept-challenge-tnc"],function(e,n){var c=n.extend({_init:function(){this._super(),this.tncPageUrl=this.config.tncPageUrl},_sendAcceptRequest:function(e,n){e.resolve(),n.closeAndRemove()}});return c});
define("rwd/activity-feed",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/common/centered-imager","rwd/common/slider"],function(e,t,r,i,d){var n=t.extend({baseConfig:{selectors:{feedLoader:".feed-loader",feedContainer:".js-feed-container",feedSelector:"select"},sliderContainerSelector:".js-feed-container.slider-container",imageSelector:".js-feed-container img[data-src]",moduleSelector:".activity-feed"},_init:function(){var t=r.getInstance().getGeneralThumbnailWidths();this.centeredImager=new i({imageWidth:t}),this.feedUrl=this.module.attr("data-feed-url");var n=this.module.attr("data-refresh")||3e5;this.feedUrl&&(this.timer=e.timer(e.proxy(this._updateFeed,this),n,!0)),this.feedSlider=new d({selectors:{sliderContainer:this.config.sliderContainerSelector}}),this.feedSlider.open()},_updateFeed:function(){var t=this;t.$.feedLoader.trigger("loading"),e.ajax({url:t.feedUrl,dataType:"html",success:function(e){setTimeout(function(){t.feedSlider.close(),t.$.feedContainer.html(e),t.centeredImager.initImages(t.config.imageSelector),t.$.feedLoader.trigger("restore"),t.feedSlider.open()},1e3)},error:function(e,r,i){logger.error("Feed update failed: ",e,r,i),t.$.feedLoader.trigger("restore")}})},_bindEvents:function(){this.$.feedSelector.on("change",function(){window.location=this.value})}});return n});
define("rwd/analytics",["jquery","rwd/common/base-ui-module"],function(e,t){var n=t.extend({baseConfig:{selectors:{elements:"[data-analytics-action-type][data-analytics-action][data-analytics-parent][data-analytics-target]"}},construct:function(e){this._super(e),logger.debug("Init Analytics...",e)},trigger:function(t,n,a,i){var r=this,o={actionType:"onaction",action:t&&t.toLowerCase(),target:n&&n.toLowerCase(),parent:a&&a.toLowerCase(),properties:i},s=e.Deferred();return this._loadAnalyticsImpl().done(function(e){r._triggerEvent(o,new e).done(s.resolve).fail(s.resolve)}).fail(s.resolve),s},triggerPageView:function(e,t,n,a){return this.trigger("pageview",t,n,a)},_bindEvents:function(){var t=this;this.config.impl&&require.specified(this.config.impl)&&(logger.debug("Loading Analytics impl...",this.config.impl),this._loadAnalyticsImpl().done(function(n){var a=new n;e.each(t.$.elements,function(n,i){var r=e(i),o=t._getData(r);t._processEvent(o,r,a)})}))},_loadAnalyticsImpl:function(){var t=e.Deferred();return require([this.config.impl],t.resolve,t.reject),t},_processEvent:function(t,n,a){var i=this;if("onload"==t.actionType&&i._triggerEvent(t,a).done(function(e){logger.debug("Event sending is finished:",e)}),"onaction"==t.actionType&&t.eventType)try{logger.debug("bind",t.eventType,"onaction - tigger:",t.action,t.target,t.parent,t.properties),n.on(t.eventType,function(n){var r=e(n.target);return i._triggerEvent(t,a).done(function(e){logger.debug("Event sending is finished:",e),r.off(e.eventType),r.trigger(e.eventType)}).fail(function(e){logger.debug("Event sending is unfinished:",e),r.off(e.eventType),r.trigger(e.eventType)}),n.stopPropagation(),!1})}catch(r){logger.error(r)}},_triggerEvent:function(e,t){return"pageview"==e.action?t.triggerPageView(e):t.trigger(e)},_getData:function(e){var t=e.data("analytics-event-type"),n=e.data("analytics-action-type"),a=e.data("analytics-action"),i=e.data("analytics-target"),r=e.data("analytics-parent"),o=this._readProperties(e);return{actionType:n.toLowerCase(),eventType:t,action:a.toLowerCase(),target:i.toLowerCase(),parent:r&&r.toLowerCase(),properties:o}},_readProperties:function(e){var t=e.data(),n={};for(var a in t)if(0==a.search("analyticsProperty")){var i=a.substr("analyticsProperty".length).toLowerCase();n[i]=t[a].toLowerCase()}return n}}),a=!1;return{getInstance:function(){return a||(a=new n({impl:e("body").data("analytics-impl")})),a}}});
define("rwd/analytics-dummy-impl",["jquery","rwd/common/base-ui-module"],function(e,r){var t=r.extend({construct:function(e){this._super(e),logger.debug("Init Dummy Analytics...",e)},trigger:function(r){return logger.debug("tigger:","action:",r.action,"target:",r.target,"parent:",r.parent,"properties:",r.properties),e.Deferred().resolve(r).promise()},triggerPageView:function(e){return this.trigger(e)}});return t});
define("rwd/analytics-ga-impl",["jquery","rwd/common/base-ui-module"],function(e,r){var t=r.extend({construct:function(e){this._super(e),logger.debug("Init Google Analytics...",e)},trigger:function(r){var t=this;return t._isAnalyticsToolLoaded().then(function(){return t._trigger(r,{hitType:"event",eventCategory:r.parent,eventAction:r.action,eventLabel:r.target})},function(){return e.Deferred().resolve(r).promise()})},triggerPageView:function(r){var t=this;return t._isAnalyticsToolLoaded().then(function(){return t._trigger(r,{hitType:"pageview"})},function(){return e.Deferred().resolve(r).promise()})},_trigger:function(r,t){var n=this;return n._isAnalyticsToolLoaded().then(function(){var i=e.Deferred();return t.hitCallback=function(){i.resolve(r)},logger.debug("tigger:","action:",r.action,"target:",r.target,"parent:",r.parent,"properties:",r.properties),n._send(t),i},function(){return e.Deferred().resolve(r).promise()})},_send:function(e){ga("send",e)},_checkTrackingProtection:function(){return e.ajax({url:"https://www.google-analytics.com/collect"})},_isAnalyticsToolLoaded:function(){var r=new e.Deferred;return this._checkTrackingProtection().then(function(){window.ga?r.resolve():r.reject()}).fail(function(){logger.warn("GA requests are blocked by tracking protection"),r.reject()}),r.promise()}});return t});
define("rwd/analytics-legacy-ga-impl",["jquery","rwd/analytics-ga-impl"],function(e,t){var n=t.extend({construct:function(e){this._super(e),logger.debug("Init Legacy Google Analytics...",e),this.mapping={},this.mapping["comment-saved"]={hitType:"event",eventCategory:"engagement",eventAction:"comment"},this.mapping["reply-saved"]={hitType:"event",eventCategory:"engagement",eventAction:"comment"},this.mapping["applaud-applaud"]={hitType:"event",eventCategory:"engagement",eventAction:"CIapplaud"},this.mapping["applaud-unapplaud"]={hitType:"event",eventCategory:"engagement",eventAction:"CIunapplaud"},this.mapping["contribution-created-as-draft"]={hitType:"pageview",page:"/DRAFTsuccess/",title:"DRAFTsuccess"},this.mapping["contribution-published"]=[{hitType:"event",eventCategory:"engagement",eventAction:"publish"},{hitType:"pageview",page:"/PUBsuccess/",title:"PUBsuccess"}],this.mapping["social-click"]={hitType:"pageview",page:"/socialconnect/",title:"socialconnect"},this.mapping["signup-signup-finished"]={hitType:"pageview",page:"/REGsuccess/",title:"REGsuccess"},this.mapping["signup-signup-email-validated"]={hitType:"pageview",page:"/UAsuccess/",title:"UAsuccess"},this.mapping["social-registered"]=[{hitType:"pageview",page:"/UAsuccess/",title:"UAsuccess"},{hitType:"pageview",page:"/SCsuccess/",title:"SCsuccess"}],this.mapping.evaluated=function(e){return{hitType:"event",eventCategory:"engagement",eventAction:"eval",eventLabel:e.properties.url}},this.mapping["first-contributed"]=function(e){return{hitType:"event",eventCategory:"participation",eventAction:"joining",eventLabel:e.properties.challengetextid}}},_trigger:function(t,n){var i=this;return i._isAnalyticsToolLoaded().then(function(){var a=e.Deferred(),p=i.mapping[n.eventAction]||i.mapping[n.eventCategory+"-"+n.eventAction];if(!p)return a.resolve(t),a;var s=e.isArray(p)?p:[p];return e(s).each(function(n,p){var c=e.isFunction(p)?p(t):p;n==e(s).length-1&&(c.hitCallback=function(){a.resolve(t)}),logger.debug("Legacy:",c),i._send(c)}),a},function(){return e.Deferred().resolve(t).promise()})}});return n});
define("rwd/analytics-legacy-gtm-impl",["jquery","rwd/analytics-legacy-ga-impl"],function(e,t){var n=t.extend({construct:function(e){this._super(e),logger.debug("Init Legacy GTM Analytics...",e)},_send:function(e){var t=void 0;"event"===e.hitType&&(t={event:"gaTriggerEvent",gaEventCategory:e.eventCategory,gaEventAction:e.eventAction,gaEventLabel:e.eventLabel}),"pageview"===e.hitType&&(t={event:"gaPageview",gaPageviewPage:e.page,gaPageviewTitle:e.title}),t&&e.hitCallback&&(t.eventCallback=e.hitCallback),logger.debug("Legacy:",t),t&&dataLayer.push(t)},_isAnalyticsToolLoaded:function(){var t=new e.Deferred,n=function(t){window.dataLayer&&e.each(window.dataLayer,function(){return"gtm.dom"===this.event?(t.resolve(),!1):void 0}),"resolved"!==t.state()&&(logger.warn("gtm.js is not loaded"),t.reject())},a=function(e){this._checkTrackingProtection().then(n.bind(this,e)).fail(function(){logger.warn("GTM requests are blocked by tracking protection"),e.reject()})}.bind(this);return"complete"===document.readyState?a(t):e(window).on("load",function(){a(t)}),t.promise()}});return n});
define("rwd/applaud",["jquery","rwd/common/base-ui-module","rwd/analytics","rwd/common/i18n","rwd/common/feature-detection","rwd/accept-challenge-tnc"],function(a,t,e,n,p,l){var r=t.extend({baseConfig:{selectors:{activeButton:'.applaud:not(".js-unauthenticated")',button:".applaud"},applaudedClass:"applauded",applaudUrl:"/applaud",unapplaudUrl:"/unapplaud",applaudedAttribute:"data-applauded"},_init:function(){logger.debug("Init Applaud..."),this.analytics=e.getInstance(),p.touchEventSupport()||this.$.button.addClass("no-touch")},_getComponentId:function(a){return a.attr("class").match(/\bcomponent-(\d+)\b/)[0]},_applaud:function(t){var e=this,p=!1,l=this.config.applaudedClass,r="."+this._getComponentId(t),u=a(".applaud"+r);t.hasClass(l)&&(p=!0);var d=p?this.config.unapplaudUrl:this.config.applaudUrl,i=t.attr("href"),s=u.data("target-id")||"content";u.toggleClass(l),u.attr("title",n[p?"applaud-title":"unapplaud-title"]),a.ajax({type:"POST",url:i+d,dataType:"json",success:function(t){var n=a(".stats"+r+", .applaud-box"+r),l=p?-1:1,u=a.Deferred().resolve().promise();t.firstContributionUrl&&(u=e.analytics.trigger("first-contributed",s,"challenge",{challengetextid:t.firstContributionUrl})),e.analytics.trigger(p?"unapplaud":"applaud",s,"applaud").then(u),n.trigger("applausesChange",[l]),e.applaudInProgress=!1},error:function(a,t,r){u.toggleClass(l),u.attr("title",n[p?"unapplaud-title":"applaud-title"]),logger.error("Applaud failed: ",a,t,r),e.applaudInProgress=!1}})},_bindEvents:function(){this.$.activeButton.click(a.proxy(function(t){var e=this;if(t.preventDefault(),!e.applaudInProgress){var n=a(t.currentTarget);e.applaudInProgress=!0,n.attr("data-challenge-tnc")?new l({targetElement:n}).acceptTNC().then(e._applaud.bind(this,n)).fail(function(){e.applaudInProgress=!1}):e._applaud(n)}},this))}});return r});
define("rwd/applaud-box",["jquery","rwd/common/base-ui-module","rwd/common/i18n"],function(e,a,o){var u=a.extend({baseConfig:{selectors:{title:".applaud-title"},moduleSelector:".applaud-box",useModuleAsParent:!0},_bindEvents:function(){this.module.on("applausesChange",e.proxy(function(e,a){logger.debug("applauses changed:",a),this.$.title.html(o["applaud-box-"+(0>a?"applaud":"applauded")])},this))}});return u});
define("rwd/auth",["jquery","rwd/common/base-ui-module","rwd/common/utils"],function(e,n,t){var i=n.extend({baseConfig:{selectors:{username:"#auth-username"},moduleSelector:".auth"},_init:function(){logger.trace("Initilaizing auth page"),this.initFormValidation()},initFormValidation:function(){this.$.username.length&&t.removeParsleyConstraints(this.$.username,["type"])}});return i});
define("rwd/centered-image-utils",["jquery","rwd/common/base-ui-module"],function(e,n){"use strict";var t=n.extend({baseConfig:{selectors:{}},construct:function(e){this._super(e)},_init:function(){},_bindEvents:function(){},setImage:function(e,n){e.css("background-image","url('"+n+"')"),e.removeClass("placehold")}});return t});
define("rwd/comment",["jquery","rwd/common/base-ui-module","rwd/modal-notification-template","rwd/common/error-message-template","rwd/common/smooth-scroll","rwd/common/loading-indicator","rwd/common/i18n","rwd/common/utils","rwd/mention-input","rwd/common/template","rwd/common/charlimit-counter","rwd/accept-challenge-tnc","rwd/accept-challenge-tnc-init"],function(e,t,n,o,r,m,i,a,c,l,s,d,u){var p=t.extend({baseConfig:{selectors:{editTemplate:".edit-comment",replyTemplate:".reply-comment",commentCount:"h1 .count",commentCountText:"h1 .text",reply:".reply:not(.js-login)",edit:".edit a",remove:".delete a",report:".report:not(.js-login) a",unflag:".unflag a",addCommentForm:".add-comment"},id:".comments",moduleSelector:"section.comments",commentEditorSelector:"textarea, .mention",addToTeamSelector:".js-add-to-team-link",questionTemplate:"#template-question",ajaxErrorTemplate:"#template-ajax-error",editCommentTemplate:"#edit-comment-template",replyCommentTemplate:"#reply-comment-template"},construct:function(e){this._super(e)},_init:function(){this.questionTemplate=new n({selectors:{template:this.config.questionTemplate}}),this.ajaxErrorTemplate=new o({selectors:{template:this.config.ajaxErrorTemplate}}),this.editCommentTemplate=new l({selectors:{template:this.config.editCommentTemplate}}),this.replyCommentTemplate=new l({selectors:{template:this.config.replyCommentTemplate}}),this.mentionDataUrl=this.module.attr("data-mention-url"),this.teamMentionId=this.module.attr("data-mention-team"),this.commentType=this.module.attr("data-comment-type"),new c({moduleSelector:this.config.selectors.addCommentForm+" .mention-input",dataUrl:this.mentionDataUrl,teamId:this.teamMentionId})},edit:function(t){var n=e(t.currentTarget),o=n.parents(".comment, .comment-reply"),r=this.editCommentTemplate.render({action:n.data("url"),comment:n.data("original-comment"),commentId:n.data("comment-id")});logger.trace("Edit comment: ",o),o.hide(),this.showEditForm(e(r),o,this.cancelEdit),t.preventDefault()},_handleReply:function(t){var n=e(t.currentTarget);n.attr("data-challenge-tnc")?new d({targetElement:n}).acceptTNC().then(this._initReplyForm.bind(this,n)):this._initReplyForm(n),t.preventDefault()},_initReplyForm:function(t){var n=t.parents(".comment, .comment-reply"),o=this.replyCommentTemplate.render({action:t.data("url"),comment:"",commentId:""});logger.trace("Reply comment: ",n),t.hide(),this.showEditForm(e(o),n,this.cancelReply)},remove:function(t){var n=e(t.currentTarget),o=n.parents(".comment, .comment-reply");m.getInstance().isBusy(n)||(logger.trace("Delete comment: ",o),this.confirmAndSend(n,e.proxy(function(){logger.trace("Comment successfully deleted"),this.removeComment(o)},this)),t.preventDefault())},report:function(t){var n=e(t.currentTarget),o=n.parents(".comment, .comment-reply");m.getInstance().isBusy(n)||(logger.trace("Report comment: ",o),this.confirmAndSend(n,e.proxy(function(e){logger.trace("Successfully reported comment: ",e),e.flagged?e.siteAdmin?o.addClass("flagged"):this.removeComment(o):e.siteAdmin||n.parent().remove()},this)),t.preventDefault())},unflag:function(t){var n=e(t.currentTarget),o=n.parents(".comment, .comment-reply");m.getInstance().isBusy(n)||(logger.trace("Unflag comment: ",o),this.sendWithAjax(n,function(){o.removeClass("flagged")}),t.preventDefault())},removeComment:function(e){var t=0;if(e.hasClass("comment")){var n=e.nextUntil(".comment",".comment-reply");t+=n.length,n.remove()}return this.removeReplyForm(e.next(".reply-comment")),e.remove(),t++,logger.debug("Removed ",t," comment(s) from the DOM"),this.decreaseCommentCount(t),t},decreaseCommentCount:function(t){var n=this.$.commentCount.text()-t,o="comments-title-"+this.commentType;this.$.commentCount.text(n),this.$.commentCountText.text(i.resolveByCount(o,n)),e(".stats").not(".widget .stats").trigger("commentsChange",[-t])},confirmAndSend:function(e,t){var n=this,o=this.questionTemplate.render({message:a.htmlEscape(e.data("question"))},function(r){n.sendWithAjax(e,t),this.closeAndRemove(),delete o,r.preventDefault()},function(t){e.trigger("restore"),this.closeAndRemove(),delete o,t.preventDefault()});o.open()},sendWithAjax:function(t,n){e.ajax({url:t.data("url"),type:"POST"}).done(n).fail(e.proxy(function(){logger.warn("AJAX request failed for ",t),this.ajaxErrorTemplate.render(t.data("failure"),function(e){t.closest(".comment, .comment-reply").append(e)})},this)).always(function(){t.trigger("restore")})},showEditForm:function(t,n,o){this.removeEditForm(this.module.find(".edit-comment:visible")),this.removeReplyForm(this.module.find(".reply-comment:visible")),n.after(t),t.show(),t.find(".cancel").click(e.proxy(o,this)),t.submit(this.submitForm),t.parsley(),s.getInstance().initCharlimitInput(t.find("textarea")),e.fn.placeholder&&t.find("textarea").placeholder(),new c({moduleSelector:".mention-input.edit-mention-comment",dataUrl:this.mentionDataUrl,teamId:this.teamMentionId}),this.focus(t)},removeEditForm:function(e){e.prev().show(),e.find(this.config.commentEditorSelector).atwho("destroy"),e.remove()},removeReplyForm:function(e){e.prev().find(".reply").show(),e.find(this.config.commentEditorSelector).atwho("destroy"),e.remove()},cancelEdit:function(t){var n=e(t.currentTarget).parents(".edit-comment");this.removeEditForm(n),t.preventDefault()},cancelReply:function(t){var n=e(t.currentTarget).parents(".reply-comment");this.removeReplyForm(n),t.preventDefault()},focus:function(t){r.scrollTo(t).then(e.proxy(function(){t.find(this.config.commentEditorSelector).focus().putCursorAtEnd()},this))},addToTeam:function(t){var n=e(t.currentTarget),o=n.siblings(".team-title");n.remove(),o.addClass("visible"),e.ajax({url:n.data("url"),type:"POST"}).done(function(e){e.success!==!0&&(o.after(n),o.removeClass("visible"))}).fail(function(){logger.warn("AJAX request failed for ",n),o.after(n),o.removeClass("visible")}),t.preventDefault()},submitForm:function(){var t=e("<input>",{type:"checkbox",name:"human",checked:"true"});e(this).append(t)},_handleScrollReady:function(t,n){0==n.indexOf("#c-")?(this._initReplyForm(e(n+" .reply")),new u({moduleSelector:this.config.moduleSelector})):0==n.indexOf("#comments-section")&&this.focus(this.$.addCommentForm)},_bindEvents:function(){this.$.edit.click(e.proxy(this.edit,this)),this.$.reply.click(e.proxy(this._handleReply,this)),this.$.remove.click(e.proxy(this.remove,this)),this.$.report.click(e.proxy(this.report,this)),this.$.unflag.click(e.proxy(this.unflag,this)),this.$.addCommentForm.submit(this.submitForm),this.module.on("click",this.config.addToTeamSelector,e.proxy(this.addToTeam,this)),e(document).on("oiengineScrollToSectionReady",e.proxy(this._handleScrollReady,this))}});return p});
define("rwd/common/ajax-request-config",["jquery"],function(n){function e(){n.ajaxPrefilter(function(n){n.url=encodeURI(n.url)})}return{initialize:e}});
define("rwd/common/base-ui-module",["jquery","inheritance"],function(i,t){var e=t.extend({baseConfig:{selectors:{},useModuleAsParent:!1,moduleSelector:""},construct:function(t){this.config={},i.extend(!0,this.config,this.baseConfig,t||{}),this._loadModule(),this._existsModule()&&(this.$={},this._loadObjects(this.config.id?!0:!1),this._init(),this._bindEvents())},_init:function(){},_loadModule:function(){this.config.moduleSelector&&(this.module=i(this.config.moduleSelector))},_existsModule:function(){return!this.config.moduleSelector||this.module&&this.module.length},_bindEvents:function(){},_loadObjects:function(t){var e;for(e in this.config.selectors)if(this.config.selectors.hasOwnProperty(e)){t&&(this.config.selectors[e]=this.config.id+" "+this.config.selectors[e]);var o=this.config.selectors[e];this.$[e]=this.config.useModuleAsParent?this.module.find(o):this.$[e]=i(o)}}});return e});
define("rwd/common/clipboard",["jquery","rwd/common/base-ui-module"],function(a,t){var n=t.extend({getClipboardData:function(a){var t=(a.originalEvent||a).clipboardData,n=void 0;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):t&&(n=t.getData("text/plain")),n}});return{instance:void 0,getInstance:function(){return this.instance||(logger.debug("Initializing Clipboard"),this.instance=new n),this.instance}}});
define("rwd/common/csrf",["jquery","rwd/common/base-ui-module"],function(e,t){var a,r=t.extend({baseConfig:{selectors:{metaToken:'meta[name="_csrf"]',metaHeader:'meta[name="_csrf_header"]',metaParam:'meta[name="_csrf_param"]'}},_init:function(){this.token=this.$.metaToken.attr("content"),this.header=this.$.metaHeader.attr("content"),this.param=this.$.metaParam.attr("content"),e.ajaxPrefilter(e.proxy(function(e,t,a){("POST"===e.type||"POST"===t.type)&&a.setRequestHeader(this.header,this.token)},this)),e(document).ajaxError(function(e,t,a,r){412===t.status&&(logger.error("Failed ajax request with error 412, reloading the page..."),window.location.reload())})},getParam:function(){return this.param},getToken:function(){return this.token}});return{getInstance:function(){return a||(a=new r),a}}});
define("rwd/common/direction-util",["jquery"],function(t){"use strict";return{getDirection:function(){var r=t("html").attr("dir");return"ltr"==r||"rtl"==r?r:"ltr"},isLtr:function(){return"ltr"===this.getDirection()},left:function(){return this.isLtr()?"left":"right"},right:function(){return this.isLtr()?"right":"left"}}});
define("rwd/common/feature-detection",["jquery"],function(t){"use strict";var n=document.body||document.documentElement,e=n.style;return{cssTransition:function(){if("string"==typeof e.transition)return!0;for(var t=["Moz","webkit","Webkit","Khtml","O","ms"],n=0;n<t.length;n++)if("string"==typeof e[t[n]+"Transition"])return!0;return!1},touchEventSupport:function(){return"ontouchstart"in document.documentElement}}});
define("rwd/common/form-submit-warning",["jquery","rwd/common/base-ui-module","rwd/modal-notification"],function(i,n,o){var t=n.extend({baseConfig:{moduleSelector:"form:has(#form-submit-warning)",notificationId:"#form-submit-warning"},_onSave:function(n){var t=this;return this._existsNotification()?(this.confirmation=new o({id:t.config.notificationId,onOk:function(n){return logger.debug("Form submit warning confirmed"),t.module.off("submit",i.proxy(this._onSave,this)),t.module.submit(),!0},onCancel:function(i){return logger.debug("Form submit warning cancelled"),t.confirmation.close(),i.preventDefault(),t.module.find(":submit").trigger("restore"),!1}}),this.confirmation.open(),!1):(this.module.off("submit",i.proxy(this._onSave,this)),!0)},_existsNotification:function(){return i(this.config.moduleSelector).length>0},_bindEvents:function(){this.module.on("submit",i.proxy(this._onSave,this))}});return t});
define("rwd/common/image-load",["jquery","rwd/common/base-ui-module"],function(e,t){var i=t.extend({baseConfig:{selectors:{images:"img"}},construct:function(e){this._super(e)},loadImages:function(){var t=new e.Deferred,i=0,n=this.$.images.length,r=function(){i++,i===n&&t.resolve()};return 0===n?t.resolve():(logger.trace("Waiting to load images: ",this.$.images.length),this.$.images.each(function(){1!=e(this).width()&&(this.complete||e(this).height()>0)?r():e(this).on("load",function(){r()})})),t.promise()},naturalWidth:function(t){var i=new e.Deferred,n=this;if(t[0].naturalWidth&&1!=t[0].naturalWidth)i.resolve(t[0].naturalWidth);else{var r=new Image;r.src=t.attr("src"),1!=r.width&&(r.complete||r.height>0)?i.resolve(r.width):t.on("load",function(){i.resolve(n._getDOMWidthOfImage(e(r)))})}return i.promise()},_getDOMWidthOfImage:function(t){t.addClass("offscreen-position"),e("body").append(t);var i=t.width();return t.remove(),i}});return i});
define("rwd/common/keys",[],function(){return{DOWN:40,UP:38,ENTER:13,SPACE:32,DEL:46,BS:8}});
define("rwd/common/scroll-to-section",["jquery","rwd/common/base-ui-module","rwd/common/smooth-scroll","rwd/common/breakpointdetection"],function(o,t,n,e){var i="-ready",c=20;return t.extend({baseConfig:{scrollHashPattern:/^#!/,hash:/([^\&]*)/},_init:function(){this._scrollToSection()},_isExcluded:function(t){var n=!1;return o.each(this.config.exclude,function(){n=n||this.pattern.test(t)&&-1!==o.inArray(e.getInstance().getBreakpoint(),this.breakpoints)}),n},_shouldTriggerReadyEvent:function(o){return o.match(new RegExp(i+"$"))},_scrollToSection:function(){if(window.location.hash.length){var t=window.location.hash.match(this.config.hash)[0],e=this._shouldTriggerReadyEvent(t),r=t.replace(this.config.scrollHashPattern,"#"),s=void 0;e&&(r=r.slice(0,-1*i.length)),this.config.scrollHashPattern.test(t)&&!this._isExcluded(t)&&(s=o(r)),s&&s.length&&(logger.debug("Scrolling to target: ",s),n.scrollTo(s).then(function(){var t=s.offset().top;Math.abs(o(window).scrollTop()-t)>c&&window.location.replace(r),e&&o(document).trigger("oiengineScrollToSectionReady",r)}))}},_bindEvents:function(){o(window).on("hashchange",o.proxy(this._scrollToSection,this))}})});
define("rwd/common/template",["rwd/common/base-ui-module","mustache","jquery"],function(t,e,n){var r=t.extend({baseConfig:{selectors:{template:"#template"}},construct:function(t){this._super(t)},_init:function(){this.template=n.trim(this.$.template.html()),e.parse(this.template)},getTemplate:function(){return this.template},render:function(t,n){return e.render(this.template,t,n)}});return r});
define("rwd/common/zoom",["jquery","rwd/common/base-ui-module","rwd/common/utils"],function(t,e,n){var o,i=e.extend({baseConfig:{selectors:{viewportMeta:'meta[name="viewport"]',document:document,window:window},inputs:'input, select, textarea, [contenteditable="true"]',preventZoom:n.isMobileSafari()},_getJsonContent:function(e){return t.parseJSON('{"'+e.replace(/[\s]*=[\s]*/g,'":"').replace(/[\s]*\,[\s]*/g,'","')+'"}')},_getStringContent:function(t){var e=JSON.stringify(t);return e.replace(/:/g,"=").replace(/[{}"]/g,"")},_disableZoom:function(){var t=this._getJsonContent(this.$.viewportMeta.attr("content"));t["maximum-scale"]=1,t["user-scalable"]="no",this.$.viewportMeta.attr("content",this._getStringContent(t))},_enableZoom:function(){var t=this._getJsonContent(this.$.viewportMeta.attr("content"));t["maximum-scale"]=10,t["user-scalable"]="yes",this.$.viewportMeta.attr("content",this._getStringContent(t))},_bindEvents:function(){this.config.preventZoom&&(this.$.document.on("focus",this.config.inputs,t.proxy(function(t){this._disableZoom()},this)),this.$.document.on("blur",this.config.inputs,t.proxy(function(t){this._enableZoom()},this)))}});return{initialize:function(t){o||(o=new i(t))}}});
define("rwd/design-quotient-chart",["jquery","rwd/common/base-ui-module","chart","rwd/common/utils"],function(t,o,e,r){var n=9999,a=1,i="#fff",s={animation:!1,showScale:!1,segmentShowStroke:!0,segmentStrokeColor:i,segmentStrokeWidth:2,responsive:!1,showTooltips:!1,onAnimationProgress:function(){},onAnimationComplete:function(){}},l=["research","collaboration","evaluation","idea"],c=o.extend({baseConfig:{moduleSelector:".js-design-quotient-chart"},_init:function(){this.colors={research:this.module.attr("data-research-color"),collaboration:this.module.attr("data-collaboration-color"),evaluation:this.module.attr("data-evaluation-color"),idea:this.module.attr("data-idea-color")},this.colorsNoPoints={};for(var t in this.colors)this.colors.hasOwnProperty(t)&&(this.colorsNoPoints[t]=this._convertHexToRgba(this.colors[t]));var o=setInterval(function(){this.module.find("canvas").get(0).getContext&&(this._show(),clearInterval(o))}.bind(this),100)},_show:function(){this.module.each(t.proxy(function(o,r){var n=t(r).find("canvas").get(0),a=t(n).data();try{var i=n.getContext("2d");s.segmentShowStroke=this._countSegments(a)>1?!0:!1,new e(i).Pie(this._buildChartData(a),s)}catch(l){logger.error("design-quotient chart initialization error: ",l)}},this))},_buildChartData:function(o){var e={},r=[];t.isEmptyObject(o)&&(e=this._buildEmptyChartData());for(var n in o)if(o.hasOwnProperty(n)){if(0==o[n]){delete o[n];continue}e[n]={value:o[n],color:this.colors[n]},r.push(n)}return 1===r.length?(this._setFakeDesignQuotientCategoryData(e,n),s.segmentStrokeColor=e[n].color,s.segmentStrokeWidth=1):(s.segmentStrokeColor=i,s.segmentStrokeWidth=2),e},_buildEmptyChartData:function(){for(var t={},o=0;o<l.length;o++){var e=l[o];t[e]={value:1,color:this.colorsNoPoints[e]}}return t},_setFakeDesignQuotientCategoryData:function(t,o){t[o].value=n;var e=this._getFakeDQCategory(o);t[e]={value:a,color:COLORS[e]}},_getFakeDQCategory:function(t){for(var o=0;o<l.length;o++)if(l[o]!=t)return l[o]},_countSegments:function(t){var o=0;for(var e in t)t[e]>0&&o++;return o},_convertHexToRgba:function(t){var o=r.hexToRgb(t);return o?"rgba("+o.r+","+o.g+","+o.b+",.12)":(logger.error("Unable to convert hex color to RGB: ",t),null)}});return c});
define("rwd/design-quotient",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/common/i18n"],function(i,t,e,s){var n="open",a="remove",o="active",h=t.extend({baseConfig:{selectors:{equalHeightColumns:".design-quotient .equal-height-column",viewMore:".design-quotient .view-more",dqForm:".design-quotient form",changeVisibilityLink:".design-quotient .visibility-links a"},moduleSelector:".design-quotient"},_matchHeights:function(){this.$.equalHeightColumns.matchHeight(!0)},_removeMatchHeights:function(){this.matchHeightInited=!1,this.$.equalHeightColumns.matchHeight(a)},_init:function(){this._isheightMatchNecessary()&&(this.breakpointDetection=e.getInstance(),this.breakpointDetection.isDesktopLayout()&&(this.matchHeightInited=!0,this._matchHeights()))},_isheightMatchNecessary:function(){return this.$.equalHeightColumns.length>1},_viewMore:function(i){i.preventDefault(),this.$.viewMore.toggleClass(n),this.$.dqForm.toggle()},_changeVisibility:function(t){var e=i(t.currentTarget);e.hasClass(o)||this.requestInProgress||(this._toggleVisibilityLink(e),this.requestInProgress=!0,i.ajax({url:e.parent().data("url"),type:"POST",data:{"public":"true"===e.parent().attr("data-visibility")}}).done(i.proxy(function(i){},this)).fail(i.proxy(function(){logger.warn("AJAX request failed for ",e),this._toggleVisibilityLink(e.siblings("a"))},this)).always(i.proxy(function(){this.requestInProgress=!1},this)),t.preventDefault())},_toggleVisibilityLink:function(i){var t=i.parent(),e=t.attr("data-visibility");t.attr("data-visibility","false"===e),i.removeAttr("href").addClass(o).siblings("a").removeClass(o).attr("href","#"),"true"===e?i.text(s["dq-visibility-private"]).siblings("a").text(s["dq-visibility-make-public"]):i.text(s["dq-visibility-public"]).siblings("a").text(s["dq-visibility-make-private"])},_bindEvents:function(){this.$.viewMore.click(i.proxy(this._viewMore,this)),this.$.changeVisibilityLink.click(i.proxy(this._changeVisibility,this)),this._isheightMatchNecessary()&&this.breakpointDetection.listenLayoutChange(i.proxy(function(i,t,e,s){"desktop"!==s||this.matchHeightInited||this._matchHeights(),"mobile"===s&&this._removeMatchHeights()},this))}});return h});
define("rwd/dropdown-filter",["jquery","rwd/common/base-ui-module"],function(e,t){var n=t.extend({baseConfig:{selectors:{select:"select"},moduleSelector:".dropdown-filter",useModuleAsParent:!0},_init:function(){this.$.select.customSelect({customClass:"custom-select"})},_bindEvents:function(){this.$.select.change(function(){window.location=this.value})}});return n});
define("rwd/filter",["jquery","rwd/common/base-ui-module","rwd/common/direction-util"],function(t,i,o){var s=i.extend({baseConfig:{selectors:{optionsContainer:".options-container",optionsList:".options-list",options:".options-list span",stepToPrevious:".control-wrapper.previous",stepToNext:".control-wrapper.next"},optionWidth:116,arrowWidth:34,minOptionCountForControls:3,optionActiveClass:"active",controlVisibilityClass:"visible",moduleSelector:".js-filter",useModuleAsParent:!0},construct:function(t){this._super(t)},_init:function(){this.optionCount=this.$.options.length,this.optionsListOffset=0,this._initFilter()},_initFilter:function(){if(!(this.optionCount<this.config.minOptionCountForControls)){var t,i=this.module[0].getBoundingClientRect().width;logger.debug("filter getBoundingClientRect width property: "+i),t=i?Math.floor(i):this.module.width()-1;var o=Math.floor((t-2*this.config.arrowWidth)/this.config.optionWidth);o-1===this.displayableOptionCount&&this._shiftOptionsListIfNecessary(),this.displayableOptionCount=o,this._setContainersWidth(),this._positionToActive(),this._updateControlVisibility()}},_setContainersWidth:function(){this.$.optionsContainer.css({width:Math.min(this.optionCount,this.displayableOptionCount)*this.config.optionWidth}),this.$.optionsList.css({width:this.optionCount*this.config.optionWidth})},_shiftOptionsListIfNecessary:function(){this.optionsListOffset<0&&!this._isMoreFilterOptionsToDisplay()&&(this.optionsListOffset+=this.config.optionWidth,this.$.optionsList.css(o.left(),this.optionsListOffset))},_updateControlVisibility:function(){this.$.stepToNext.removeClass(this.config.controlVisibilityClass),this.$.stepToPrevious.removeClass(this.config.controlVisibilityClass),this.optionCount>this.displayableOptionCount?(this.optionsListOffset<0&&this.$.stepToPrevious.addClass(this.config.controlVisibilityClass),this._isMoreFilterOptionsToDisplay()&&this.$.stepToNext.addClass(this.config.controlVisibilityClass)):(this.$.optionsList.css(o.left(),0),this.optionsListOffset=0)},_isMoreFilterOptionsToDisplay:function(){return Math.abs(this.optionsListOffset)/this.config.optionWidth<this.optionCount-this.displayableOptionCount},_moveOptionsList:function(t){var i=Math.min(this.displayableOptionCount*this.config.optionWidth,(this.optionCount-this.displayableOptionCount)*this.config.optionWidth);this.optionsListOffset+=i*t,this.optionsListOffset=Math.min(this.optionsListOffset,0),this.optionsListOffset=Math.max(this.optionsListOffset,-1*(this.optionCount-this.displayableOptionCount)*this.config.optionWidth),this.$.optionsList.css(o.left(),this.optionsListOffset),this._updateControlVisibility()},_positionToActive:function(){var i=0,o=this;this.optionsListOffset=0,this.$.options.each(function(s){t(this).hasClass(o.config.optionActiveClass)&&(i=s)});var s=Math.floor(i/this.displayableOptionCount);s>=0&&this._moveOptionsList(-s)},_bindEvents:function(){t(window).on("resize orientationchange",t.proxy(this._initFilter,this)),this.$.stepToPrevious.click(t.proxy(function(){this._moveOptionsList(1)},this)),this.$.stepToNext.click(t.proxy(function(){this._moveOptionsList(-1)},this))}});return s});
define("rwd/gallery/data-builder",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection"],function(t,r,e){var a=r.extend({baseConfig:{imageWidth:{},thumbWidth:90},_getSrcFor:function(t,r){return t.replace("{width}",r)},getImageUrl:function(t){if(t.attr("data-src")){var r=e.getInstance().getBreakpoint();return this._getSrcFor(t.attr("data-src"),this.config.imageWidth[r])}return t.attr("src")},_getImageLink:function(t){if(t.is("img")){var r=t.closest("a").clone().html("");return t.closest("a").children().unwrap(),r}},_getThumbUrl:function(t){return t.hasClass("image")?t.attr("data-src")?this._getSrcFor(t.attr("data-src"),this.config.thumbWidth):t.attr("data-thumb"):t.attr("data-img")},_getFullscreenUrl:function(t){return t.attr("data-full")},build:function(r){return t.map(r,t.proxy(function(r){var e=t(r);return{img:this.getImageUrl(e),video:e.attr("href"),thumb:this._getThumbUrl(e),full:this._getFullscreenUrl(e),html:this._getImageLink(e),caption:e.next("span.caption").html(),any:e.attr("data-src")}},this))}});return a});
define("rwd/gallery",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/gallery/data-builder"],function(a,t,e,o){var i=t.extend({baseConfig:{selectors:{media:".image, .video"},moduleSelector:".gallery",useModuleAsParent:!0},construct:function(a,t){this.galleryDataBuilder=t?t:this._createDefaultGalleryDataBuilder(),this._super(a)},createCaption:function(a){return a.find(".caption").length||a.find(".fotorama__stage").after('<div class="caption secondary-text"></div>'),a.find(".caption")},_createDefaultGalleryDataBuilder:function(){var a=e.getInstance().getBreakpointImageSizePairs();return new o({imageWidth:a,thumbWidth:90})},_updateFotoramaCaption:function(t,e){var o=t.activeFrame.$stageFrame.closest(".fotorama__wrap");t.$caption&&(e?t.$caption.hide():t.$caption.show()),e&&t.activeFrame.caption&&a.trim(t.activeFrame.caption).length>0?o.removeClass("fotorama__wrap--no-captions"):o.addClass("fotorama__wrap--no-captions")},getFotorama:function(){return this.module.data("fotorama")},_bindEvents:function(){logger.debug("Binding fotorama events");var t=this.galleryDataBuilder.build(this.$.media);logger.trace("Gallery data:",t),this.module.on("fotorama:load",a.proxy(function(t,e,o){e.$caption=e.$caption||this.createCaption(a(t.currentTarget)),e.$caption.html(e.activeFrame.caption)},this)).on("fotorama:show",function(a,t){if(t.$caption){var e=t.activeFrame.caption||"";t.$caption.html(e)}}).on("fotorama:fullscreenexit",a.proxy(function(a,t){this._updateFotoramaCaption(t,!1)},this)).on("fotorama:fullscreenenter",a.proxy(function(a,t){this._updateFotoramaCaption(t,!0)},this)).fotorama({data:t})}});return i});
define("rwd/geolocation",["jquery","rwd/common/base-ui-module","rwd/common/i18n"],function(e,t,n){return t.extend({baseConfig:{selectors:{geolocation:".js-geolocation"},hiddenFieldsClass:"geodata"},_init:function(){var e=this.$.geolocation.data("key");this.$.geolocation.placecomplete({apiKey:e,placeholder:n["placecomplete-placeholder"],requestParams:{types:["(cities)"]}})},_bindEvents:function(){this.$.geolocation.on("placecomplete:selected",e.proxy(function(e,t){var n=this.getName("country",t.address_components),i=this.getName("locality",t.address_components)||this.getName("administrative_area_level_3",t.address_components),o=this.getName("administrative_area_level_1",t.address_components)||this.getName("administrative_area_level_2",t.address_components);this.removeHiddenFields(),this.$.geolocation.after(this.createHiddenInput("placeId",t.place_id),this.createHiddenInput("latitude",t.geometry.location.lat),this.createHiddenInput("longitude",t.geometry.location.lng),this.createHiddenInput("countryShortName",n.short_name),this.createHiddenInput("countryLongName",n.long_name),this.createHiddenInput("cityShortName",i.short_name),this.createHiddenInput("cityLongName",i.long_name),this.createHiddenInput("stateShortName",o.short_name),this.createHiddenInput("stateLongName",o.long_name))},this)),this.$.geolocation.on("placecomplete:cleared",e.proxy(function(){this.removeHiddenFields()},this))},createHiddenInput:function(t,n){return e("<input>").attr({type:"hidden",name:"geolocationModel."+t,value:n,"class":this.config.hiddenFieldsClass})},getName:function(t,n){for(i=0;i<n.length;i++){var o=n[i];if(-1!==e.inArray(t,o.types))return{short_name:o.short_name,long_name:o.long_name}}},removeHiddenFields:function(){e("."+this.config.hiddenFieldsClass).remove()}})});
define("rwd/notifications-initializer",["jquery","rwd/notification"],function(i,n){var t,o=n.extend({baseConfig:{selectors:{notification:".notification-info"},closeButton:".notification-info .close"},_bindEvents:function(){i(document).on("click",this.config.closeButton,i.proxy(function(n){n.preventDefault(),i(n.currentTarget).parents(this.config.selectors.notification).addClass(this.closedClass)},this))}});return{initialize:function(){t||(t=new o)}}});
define("rwd/notification-template",["rwd/common/template","rwd/notification"],function(i,t){var n=i.extend({idPrefix:"notification-",_init:function(){this._super(),this.idCounter=0},_ensureDataId:function(i){i.id||(i.id=this.idPrefix+this.idCounter,this.idCounter++)},render:function(i,n){return this._ensureDataId(i),n(this._super(i)),new t({selectors:{notification:"#"+i.id}})}});return n});
define("rwd/notification",["jquery","rwd/common/base-ui-module"],function(i,n){var s=n.extend({baseConfig:{selectors:{notification:".notification-info"}},closedClass:"closed",construct:function(i){this._super(i)},_init:function(){},open:function(){this.$.notification.removeClass(this.closedClass)},close:function(){this.$.notification.addClass(this.closedClass)},isOpen:function(){return!this.$.notification.hasClass(this.closedClass)}});return s});
define("rwd/password-indicator",["jquery","rwd/common/base-ui-module","rwd/common/direction-util"],function(s,t,i){var r=t.extend({baseConfig:{selectors:{passwordWithIndicator:'.password-indicator input[type="password"]',errorPreface:".error-preface"},moduleSelector:".password-indicator"},construct:function(s){this._super(s)},_onPasswordInputChange:function(){var s=this.$.passwordWithIndicator.siblings(".password-status");s.removeClass("invalid").text(""),this._checkPasswordStatus(this.$.passwordWithIndicator.val(),s),this._updatePasswordInputPadding(this.$.passwordWithIndicator,s)},_checkPasswordStatus:function(s,t){var i=this.$.passwordWithIndicator.parsley().isValid();s.length>0&&!i?(t.text(t.data("invalid")),t.addClass("invalid"),this.$.errorPreface.show()):this.$.errorPreface.hide()},_updatePasswordInputPadding:function(s,t){s.css("padding-"+i.right(),t.outerWidth(!0))},_bindEvents:function(){this.$.passwordWithIndicator.on("keyup change",s.proxy(this._onPasswordInputChange,this)),this.$.passwordWithIndicator.parsley().subscribe("parsley:field:validated",s.proxy(this._onPasswordInputChange,this))}});return r});
define("rwd/path-utils",["jquery","rwd/common/base-ui-module"],function(t,e){"use strict";var n=e.extend({baseConfig:{selectors:{body:"body"}},construct:function(t){this._super(t)},_init:function(){this.rootContext=this.$.body.data("root-context"),this.resourceContext=this.$.body.data("resource-context"),this.rootMedia=this.$.body.data("root-media")},_bindEvents:function(){},getImagePath:function(t,e){return this._isExternalHostedImage(t)?t:e?this._append(this._append(this.rootContext,e),t):this._append(this._append(this.rootContext,"uploads"),t)},getSmallestSponsorImagePath:function(t){return this._getSmallestImagePath("sponsor",t)},getSmallestImagePath:function(t){return this._getSmallestImagePath("uploads",t)},buildFullMediaPage:function(t){return this._isExternalHostedImage(t)?t:this._append(this.rootMedia,t)},_getSmallestImagePath:function(t,e){if(!e)return null;var n=1e5,i=null;for(var o in e){var r=parseInt(o);n>r&&(n=r,i=o)}if(!i)return null;var s=e[i];return this._isExternalHostedImage(s)?s:this._append(this._append(this.rootContext,t),s)},getProfilePath:function(t,e){return e?this._append(this._append(this._append(this.rootContext,"profiles"),t),"photo?type="+e):this._append(this._append(this._append(this.rootContext,"profiles"),t),"photo")},getResourcePath:function(t){return this._prepend(this.resourceContext,t)},prependContenxtPath:function(t){return this._isExternalHostedImage(t)?t:this._prepend(this.rootContext,t)},getRootContext:function(){return this.rootContext},_prepend:function(t,e){return"/"==t?e:t+""+e},_isExternalHostedImage:function(t){return 0==t.indexOf("http")||0==t.indexOf("//")},_append:function(t,e){return this._endWith(t,"/")&&this._startWith(e,"/")?t+e.substring(1):this._endWith(t,"/")&&!this._startWith(e,"/")?t+e:t+"/"+e},_endWith:function(t,e){return-1!==t.indexOf(e,t.length-e.length)},_startWith:function(t,e){return 0==t.indexOf(e)}});return n});
define("rwd/report-contribution",["jquery","rwd/common/base-ui-module","rwd/modal-notification"],function(o,t,r){var i=t.extend({baseConfig:{selectors:{reportContribution:"a",errorMessage:".report-contribution-error"},notification:"#report-page",moduleSelector:".report-contribution",useModuleAsParent:!0},_init:function(){logger.debug("Init report contribution");var o=this;this.reportConfirmation=new r({id:o.config.notification,onOk:function(t){logger.info("Report contribution confirmed"),o._reportContribution(),t.preventDefault(),this.close()},onCancel:function(t){o.$.reportContribution.trigger("restore"),t.preventDefault(),this.close()}})},_reportContribution:function(){o.ajax({url:this.$.reportContribution.data("url"),type:"POST"}).done(o.proxy(function(){this.module.remove()},this)).fail(o.proxy(function(){logger.warn("AJAX request failed for report contribution"),this.$.errorMessage.addClass("error")},this)).always(o.proxy(function(){this.$.reportContribution.trigger("restore")},this))},_bindEvents:function(){this.$.reportContribution.click(o.proxy(function(o){o.preventDefault(),this.reportConfirmation.open()},this))}});return i});
define("rwd/stats",["jquery","rwd/common/base-ui-module"],function(t,e){var n=e.extend({baseConfig:{moduleSelector:".stats"},viewsClass:".views",applausesClass:".js-has-appluase-count",commentsClass:".comments .comment-link",zeroValueClass:"zero",construct:function(t){this._super(t),logger.trace("Stats initialized")},convertCount:function(t){return 1e3>t?t:1e4>t?Math.floor(t/1e3*10)/10+"k":Math.floor(t/1e3)+"k"},getMicrodataCount:function(t){return t.children("meta").attr("content")},setMicrodataCount:function(t,e){return t.children("meta").attr("content",e)},getCurrentCount:function(t){return Number(this.getMicrodataCount(t).split(":")[1])},formatMicrodataCount:function(t,e){return this.getMicrodataCount(t).split(":")[0]+":"+e},updateAmount:function(t,e){if(t.length){var n=this.getCurrentCount(t)+e;t.find(".stat-count").html(this.convertCount(n)),this.setMicrodataCount(t,this.formatMicrodataCount(t,n)),n>0?t.removeClass(this.zeroValueClass):t.addClass(this.zeroValueClass)}},_bindEvents:function(){this.module.on("viewsChange",t.proxy(function(e,n){logger.debug("views changed: ",n);var s=t(e.currentTarget).find(this.viewsClass);this.updateAmount(s,n)},this)),this.module.on("commentsChange",t.proxy(function(e,n){logger.debug("comments changed: ",n);var s=t(e.currentTarget).find(this.commentsClass);this.updateAmount(s,n)},this)),this.module.on("applausesChange",t.proxy(function(e,n){logger.debug("applauses changed:",n);var s=t(e.currentTarget).find(this.applausesClass);this.updateAmount(s,n)},this))}});return n});
define("rwd/timeline",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/common/direction-util"],function(e,i,t,s){var h=function(e,i){this.start=e,this.end=i,this.size=i-e};h.prototype.equals=function(e){return void 0!==e&&this.start===e.start&&this.end===e.end},h.prototype.shift=function(e){return this.start+=e,this.end+=e,this};var n="first-visible-phase",a="last-visible-phase",o="control-buttons",l=128,d=i.extend({baseConfig:{selectors:{highlightedPhase:".timeline .highlighted-phase",highlightedPhaseName:".timeline .highlighted-phase .phase-name",phaseItems:".timeline>.timeline-row>.phase-item",timelineRows:".timeline>.timeline-row",prevButton:".timeline .previous-button",nextButton:".timeline .next-button"},moduleSelector:".timeline"},_init:function(){this.breakpointDetection=t.getInstance(),this.phaseItemCount=this.$.phaseItems.length,this.focusedPhaseIndex=this._findFocusedPhaseIndex(),this._initLayout(),this.module.addClass("timeline-filled")},_bindEvents:function(){e(window).on("resize orientationchange",e.proxy(function(){this._updateView()},this)),this.breakpointDetection.listenLayoutChange(e.proxy(this._initLayout,this));var i=this;this.$.prevButton.on("click",function(e){e.preventDefault(),i._shiftVisiblePhases(-1)}),this.$.nextButton.on("click",function(e){e.preventDefault(),i._shiftVisiblePhases(1)})},_findFocusedPhaseIndex:function(){var e=this.$.phaseItems.index(this.$.highlightedPhase);return-1===e&&(e=this.$.phaseItems.index(this.$.phaseItems.filter(".active-phase"))),-1===e&&(e=this.$.phaseItems.index(this.$.phaseItems.filter(':not(".active-phase, .finished-phase")'))),-1===e&&(e=this.$.phaseItems.length-1),e},_calculateVisibleRange:function(e){var i=this.focusedPhaseIndex-Math.floor((e-1)/2);0>i&&(i=0);var t=new h(i,i+e);return t.end>this.phaseItemCount&&t.shift(this.phaseItemCount-t.end),t},_getPhaseItem:function(i){return e(this.$.phaseItems.get(i))},_getPhaseNameCenteringBase:function(){var e=Math.min(this.phaseItemCount-1-this.focusedPhaseIndex,this.focusedPhaseIndex);return this.phaseNameCenteringBase||(this.phaseNameCenteringBase={leftSide:this._getPhaseItem(this.focusedPhaseIndex-e),rightSide:this._getPhaseItem(this.focusedPhaseIndex+e)})},_initLayout:function(){this.breakpointDetection.isDesktopLayout()?this._initDesktopLayout():this._initMobileLayout(),this._updateView()},_initDesktopLayout:function(){this.highlightedPhaseNameWrapper&&this.$.highlightedPhaseName.unwrap(),this._updateView=this._updateVisiblePhases,logger.debug("Timeline is initialized in desktop view")},_initMobileLayout:function(){this.$.highlightedPhase.length?(this.highlightedPhaseNameWrapper=this.$.highlightedPhaseName.wrap("<div class='phase-name-wrapper'></div>").parent(),this._updateView=function(){this._positionPhaseName(),this._updateVisiblePhases()}):this._updateView=this._updateVisiblePhases,logger.debug("Timeline is initialized in mobile view")},_positionPhaseName:function(){this.highlightedPhaseNameWrapper.css("margin-"+s.left(),this._getPhaseNameCenteringBase()[s.left()+"Side"].extPosition()[s.left()]-this.$.highlightedPhase.extPosition()[s.left()]+"px").css("margin-"+s.right(),this.$.highlightedPhase.extPosition()[s.left()]+this.$.highlightedPhase.width()-this._getPhaseNameCenteringBase()[s.right()+"Side"].extPosition()[s.left()]-this._getPhaseNameCenteringBase()[s.right()+"Side"].width()+"px"),this.$.highlightedPhaseName.css("max-width",this.module.width()+"px")},_setControlButtonsVisibility:function(e){this.visibleRange&&(this._getPhaseItem(this.visibleRange.start).removeClass(n),this._getPhaseItem(this.visibleRange.end-1).removeClass(a),this.module.removeClass(o)),e.start>0&&(this._getPhaseItem(e.start).addClass(n),this.module.addClass(o)),e.end<this.phaseItemCount&&(this._getPhaseItem(e.end-1).addClass(a),this.module.addClass(o))},_setPhasesVisibility:function(i){if(i=i||new h(0,this.phaseItemCount),this.$.timelineRows.each(function(){var t=e(this).children();t.slice(0,i.start).hide(),t.slice(i.start,i.end).show(),t.slice(i.end,t.size()).hide()}),this._setControlButtonsVisibility(i),this.module.width()!=this.$.timelineRows.width()){var t=this.module.css("display");this.module.css("display","block"),this.module.width(),this.module.css("display",t)}this.visibleRange=i,logger.debug("Timeline visible range is set to",this.visibleRange.start,"-",this.visibleRange.end-1)},_shiftVisiblePhases:function(e){this._setPhasesVisibility(new h(this.visibleRange.start,this.visibleRange.end).shift(e))},_updateVisiblePhases:function(){var e=this.breakpointDetection.isDesktopLayout()?Math.min(Math.floor(this.module.width()/l),this.phaseItemCount):this.phaseItemCount;this.visibleRange&&this.visibleRange.size==e||this._setPhasesVisibility(this._calculateVisibleRange(e))}});return d});
define("rwd/timzone-checker",["jquery","md5","rwd/common/base-ui-module","rwd/common/utils","rwd/common/i18n","rwd/modal-notification-template","rwd/notification","rwd/notification-template"],function(e,t,o,n,i,r,a,c){var s=o.extend({baseConfig:{selectors:{timeZoneDetectionEnabled:'meta[name="_timeZoneDetectionEnabled"]',notificationContainer:"#modal-new-timezone",sessionToken:'meta[name="sessionToken"]',username:'meta[name="user"]'},moduleSelector:"body",modalNewTimezoneTemplate:"#modal-new-timezone-template",timezoneAcceptedNotificationSelector:"#new-timezone-accept-notification",timezoneRejectedNotificationSelector:".js-new-timezone-keep-previous-notification"},_init:function(){var o=this;if(!this._isTurnedOn())return void logger.debug("Timezone detection is turned off");var i=o._getSessionToken()+"_"+o._getUser();if(this._isGeolocationChecked(i)&&!o._forceCheck())return void logger.debug("User has already chosen an option");n.isFirefox()&&this._markAsChecked(i);var r=function(){o._markAsChecked(i)};this._getCurrentTimeZoneData(r).done(function(n){var r=n.data,a=n.cacheKey,c=t(a+"_"+i);return o._isServerCheckNecessary(c)||o._forceCheck()?(o._markAsChecked(i),void(o._isGuestUser()?(logger.debug("Save current timezone for guest user",r),o._saveCurrentTimeZone(r,c).fail(e.proxy(this._fail,o))):(logger.debug("Fetch timezone data for logged in user",r),o._getTimeZoneData(r).done(function(t){if(!t.previousTimeZoneId)return logger.debug("User does not have set timezone yet, we will set it"),r.silent=!0,void o._saveSelectedTimeZone(r,c).fail(e.proxy(this._fail,o));if(t.newTimeZoneId==t.previousTimeZoneId)return logger.debug("Timezone has not changed"),void o._markAsSet(c);if(t.newTimeZoneId==t.selectedTimeZoneId)return logger.debug("Timezone has changed to the selected"),void o._saveCurrentTimeZone(r,c).fail(e.proxy(this._fail,o));var n=e.proxy(function(){logger.debug("We will update the timezone",r),o._saveSelectedTimeZone(r,c).fail(e.proxy(this._fail,o)).done(function(){location.reload()})},o),i=e.proxy(function(){logger.debug("We will keep the selected timezone but save the current one",r),o._saveCurrentTimeZone(r,c).fail(e.proxy(this._fail,o))},o);logger.debug("Timezone has changed, show the confirmation popup"),o._createNewTimezoneModalNotification(t,n,i)})))):void logger.debug("Check is not necessary")}).fail(e.proxy(this._fail,o))},_fail:function(e){logger.error("Timezone cannot be saved:",e)},_saveCurrentTimeZone:function(e,t){var o=this;return o._postTimeZoneData("/timezone/current",e).done(function(){o._markAsSet(t)})},_saveSelectedTimeZone:function(e,t){var o=this;return o._postTimeZoneData("/timezone/selected",e).done(function(){o._markAsSet(t)})},_isGuestUser:function(){return 0==this.$.notificationContainer.length},_forceCheck:function(){return-1!=window.location.href.indexOf("forceTimeZoneDetection")},_isServerCheckNecessary:function(e){return void 0==n.getCookie("timeZoneDetectionData")||n.getCookie("timeZoneDetectionData")!=e},_markAsSet:function(e){n.setCookie("timeZoneDetectionData",e,30)},_markAsChecked:function(e){n.setCookie("timeZoneDetection",t("checked_"+e),30)},_isGeolocationChecked:function(e){return n.getCookie("timeZoneDetection")===t("checked_"+e)},_isTurnedOn:function(){return"true"==this.$.timeZoneDetectionEnabled.attr("content")},_getSessionToken:function(){return this.$.sessionToken.attr("content")},_getUser:function(){return this.$.username.attr("content")},_hasGeolocationApi:function(){try{return void 0!=navigator.geolocation}catch(e){return!1}},_postTimeZoneData:function(t,o){return e.ajax({url:t,data:o,type:"POST"})},_getTimeZoneData:function(t){return e.ajax({url:"/timezone/current",data:t,type:"GET"})},_getCurrentTimeZoneData:function(t){var o=new e.Deferred,i=function(){setTimeout(function(){var e=-1*(new Date).getTimezoneOffset();o.resolve({data:{offset:e},cacheKey:e})},1e3)},r=function(e,t){o.resolve({data:{latitude:e,longitude:t},cacheKey:n.floor(e,2)+","+n.floor(t,2)})};return this._hasGeolocationApi()?navigator.geolocation.getCurrentPosition(function(e){r(e.coords.latitude,e.coords.longitude)},function(e){e.code==e.PERMISSION_DENIED&&t(),i()}):i(),o},_createNewTimezoneModalNotification:function(e,t,o){var n=this;new r({selectors:{template:this.config.modalNewTimezoneTemplate}}).render({message:i.format("modal-new-timezone-message",e.selectedTimeZoneLocalizedName,e.newTimeZoneLocalizedName)},function(){this.close(),t()},function(){o(),this.close(),new a({selectors:{notification:n.config.timezoneRejectedNotificationSelector}}).open()}).open()},_isAuthenticated:function(){return this.$.notificationContainer.data("authenticated")},_getProfileUrl:function(){return this.$.notificationContainer.data("profileUrl")}});return s});
define("rwd/video-resolver",["jquery","rwd/common/base-ui-module","rwd/youtube-video-resolver","rwd/vimeo-video-resolver"],function(e,i,o,t){var r=i.extend({baseConfig:{VIMEO:"VIMEO",YOUTUBE:"YOUTUBE"},construct:function(e){this._super(e)},_init:function(){this.youtubeVideoResolver=new o,this.vimeoVideoResolver=new t},_bindEvents:function(){},getVideoDetails:function(i){var o=new e.Deferred;return this.youtubeVideoResolver._isYoutubeVideo(i)?this.youtubeVideoResolver._getYoutubeVideoId(i).then(e.proxy(function(e){this.getThumbnailImage(e,this.config.YOUTUBE).then(o.resolve).fail(o.reject)},this)).fail(o.reject):this.vimeoVideoResolver._isVimeoVideo(i)?this.vimeoVideoResolver._getVimeoVideoId(i).then(e.proxy(function(e){this.getThumbnailImage(e,this.config.VIMEO).then(o.resolve).fail(o.reject)},this)).fail(o.reject):o.reject(),o.promise()},getThumbnailImage:function(e,i){return this._getThumbnailImageWithSuffix(e,i,"0.jpg")},_getThumbnailImageWithSuffix:function(i,o,t){if(o===this.config.YOUTUBE)return this.youtubeVideoResolver._getThumbnailImageForYoutube(i,t);if(o===this.config.VIMEO)return this.vimeoVideoResolver._getThumbnailImageForVimeo(i);var r=new e.Deferred;return r.reject(),r.promise()}});return r});
define("rwd/vimeo-video-resolver",["jquery","rwd/common/base-ui-module","rwd/centered-image-utils"],function(e,t){var r=t.extend({baseConfig:{VIMEO:"VIMEO"},construct:function(e){this._super(e)},_getVimeoVideoId:function(t){var r=new e.Deferred,o=t.match("video")?t.split(/video\//):t.split(/vimeo\.com\//);return o=o[1],o=o.split(/[?&"]/)[0],o.match(/[^0-9 ]+/)?e.ajax({url:"https://vimeo.com/api/oembed.json?url="+t.split(/[?&"]/)[0],dataType:"jsonp",jsonp:"callback"}).done(function(e){e&&e.video_id?r.resolve(e.video_id):r.reject()}):r.resolve(o),r.promise()},_isVimeoVideo:function(e){return e.match("http(s)?://(player.)?vimeo.com")?!0:!1},_getThumbnailImageForVimeo:function(t){var r=new e.Deferred;if(!t)return r.reject(),r.promise();var o=this;return e.ajax({url:o._getVidemoUrl(t),timeout:2e3}).fail(function(t,i,n){var a=404==t.status?e.support.cors?400:666:t.status;r.reject(o._createErrorObject(a,n))}).done(function(){o._loadData(t).then(function(e){r.resolve(e)})}),r.promise()},_loadData:function(t){var r=new e.Deferred,o=this;return e.ajax({url:this._getVidemoUrl(t),dataType:"jsonp",jsonp:"callback",timeout:2e3}).fail(function(e,t,i){r.reject(o._createErrorObject(500))}).then(function(e){r.resolve({videoId:t,videoProvider:"VIMEO",title:e.title,thumbnail:e.thumbnail_url})}),r.promise()},_getVidemoUrl:function(e){return"//vimeo.com/api/oembed.json?url=https://vimeo.com/"+e},_createErrorObject:function(e,t){return{error:e,message:t}}});return r});
define("rwd/youtube-video-resolver",["jquery","rwd/common/base-ui-module","rwd/centered-image-utils"],function(e,t){var r=t.extend({baseConfig:{YOUTUBE:"YOUTUBE",selectors:{metaYoutubeKey:'meta[name="_yt_key"]'}},construct:function(e){this._super(e)},_init:function(){this.youtubeKey=this.$.metaYoutubeKey.attr("content"),this.youtubeKey||logger.warn("Youtube key must not be empty, video upload will not work without valid Youtube key ")},_getYoutubeVideoId:function(t){var r=new e.Deferred;try{this._isEmbeddedYoutubeVideo(t)?r.resolve(t.split(/embed\//)[1].split('"')[0]):r.resolve(t.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0])}catch(u){r.reject(this._createErrorObject(400))}return r.promise()},_isYoutubeVideo:function(e){return e.match("((http(s)?:)?//)?(www.)?youtube|youtu.be")?!0:!1},_isEmbeddedYoutubeVideo:function(e){return this._isYoutubeVideo(e)&&e.match("embed")&&!e.match("player_embedded")},_getYoutubeKey:function(){return this.youtubeKey},_getThumbnailImageForYoutube:function(t,r){var u=this,o=new e.Deferred;return t&&u._getYoutubeKey()?(e.ajax({url:"https://www.googleapis.com/youtube/v3/videos/",dataType:"jsonp",jsonp:"callback",data:{part:"snippet",id:t,prettyprint:!0,key:u._getYoutubeKey()}}).fail(function(e,t,r){o.reject(u._createErrorObject(500))}).then(function(e){if(e&&e.items)o.resolve({videoId:t,videoProvider:"YOUTUBE",title:e.items[0].snippet.title,thumbnail:u._getThumbnail(e.items[0].snippet,t,r)});else{var i=e.error?u._createErrorObject(e.error.code,e.error.message):u._createErrorObject(500);o.reject(i)}}),o.promise()):(o.reject(),o.promise())},_getThumbnail:function(e,t,r){return e.thumbnails.maxres?e.thumbnails.maxres.url:e.thumbnails.high?e.thumbnails.high.url:e.thumbnails.standard?e.thumbnails.standard.url:"https://img.youtube.com/vi/"+t+"/"+r},_createErrorObject:function(e,t){return{error:e,message:t}}});return r});
define("rwd/video-thumbnail",["jquery","rwd/common/base-ui-module","rwd/centered-image-utils","rwd/video-resolver"],function(e,i,t,n){var o=i.extend({baseConfig:{selectors:{videoThumbnailImages:"img[data-video-provider][data-video-id]"}},construct:function(e){this._super(e)},_init:function(){this.videoResolver=new n,this.centeredImageUtils=new t,this.$.videoThumbnailImages.each(e.proxy(function(i,t){var n=e(t).data("video-id"),o=e(t).data("video-provider"),a=e.proxy(function(i){this._setThumbnailImage(e(t).parent(),i.thumbnail)},this);this.videoResolver.getThumbnailImage(n,o).then(a).fail(e.proxy(function(){logger.warn("Failed to get video thumbnail image for ",o,n)},this))},this))},_bindEvents:function(){},_setThumbnailImage:function(e,i){this.centeredImageUtils.setImage(e,i)}});return o});
define("rwd/common/abstract-detail-item",["jquery","rwd/common/abstract-item","rwd/common/smooth-scroll","rwd/common/charlimit-counter","rwd/common/i18n","rwd/modal-notification-template","rwd/common/utils"],function(t,e,n,i,o,s,r){var c=e.extend({construct:function(e){t.extend(!0,this,e),this.questionTemplate=new s({selectors:{template:"#js-delete-item-question"}})},_getRemoveElement:function(){return this._getElement(".js-action-remove")},_getAddDescriptionButton:function(){return this._getElement(".js-action-add-description")},_getCancelEditingElement:function(){return this._getElement(".js-action-editor-cancel")},_getSaveDescriptionElement:function(){return this._getElement(".js-action-editor-save")},_getEditDescriptionElement:function(){return this._getElement(".js-action-editor-open")},_getShowDescriptionElement:function(){return this._getElement(".js-action-show-description")},_getContentEditorElement:function(){return this._getElement(".js-editor-content")},_bindEditor:function(){this._super();var e=this;this.descriptionPlaceholder=this._container.module.data("description-placeholder"),this._getEditDescriptionElement().bind("click",function(n){n.stopPropagation(),n.preventDefault(),t.proxy(e._editItem,e)()}),this._getSaveDescriptionElement().bind("click",function(i){i.stopPropagation(),e._isEditItemValid(e._getContentEditorElement())?(e._saveItem(),e._setStates(!1,!e._isLastItem(),e._isLastItem()),e._refreshEditorView(),e._refreshDetailView(),n.scrollTo(e._container.module)):e._getContentEditorElement().each(function(){t(this).parsley().validate()})}),this._getCancelEditingElement().bind("click",function(n){n.stopPropagation(),t.proxy(e._cancelEdit,e)()}),this._getContentEditorElement().bind("click",function(t){t.stopPropagation()})},_unBindEditor:function(){this._super(),this._getCancelEditingElement().unbind(),this._getSaveDescriptionElement().unbind(),this._getEditDescriptionElement().unbind(),this._getContentEditorElement().unbind()},_bindDetail:function(){this._super();var t=this;this._getRemoveElement().on("click",function(e){e.stopPropagation();var n=o.format("manage-"+t.type.toLowerCase()+"-delete",r.htmlEscape(t.getItemName())),i=t.questionTemplate.render({message:n},function(e){e.preventDefault(),t._container.removeItem(t),this.closeAndRemove()},function(t){t.preventDefault(),this.closeAndRemove()});i.open()}),this._getAddDescriptionButton().on("click",function(e){e.stopPropagation(),e.preventDefault(),t._editItem()}),this._getShowDescriptionElement().on("click",function(e){e.stopPropagation(),t.edit=!1,t._container.closeEditorsExceptMe(t.componentId)})},_unBindDetail:function(){this._super(),this._getRemoveElement().off(),this._getAddDescriptionButton().off(),this._getShowDescriptionElement().off()},_bind:function(e,n){this._super(e,n);var i=this;return this._element.bind("click",t.proxy(i._onItemClicked,i)),this._element.on("closeEditor",t.proxy(function(e,n){this.componentId&&this.componentId!==parseInt(n.componentId)&&(t.proxy(i._cancelEdit,i)(),i.showRemoveButton=!0,i._updateActiveState(!1)),i._refreshDetailView(),i._refreshEditorView()},this)),this._element.on("fail",t.proxy(function(e,n){if(this.componentId&&this.componentId===parseInt(n.componentId)){var s=t.inArray(parseInt(n.status),[413,415])>-1?n.status:500,r="manage-"+i.type.toLowerCase()+"-error-"+s,c=[];c.push(n.fileName||null),c.push(n.maxFileSize||null);var a=o._formatMessage(o[r],c);i._container.showError(a),i._container.removeItem(i)}},this)),this._element.on("uploaded",t.proxy(function(t,e){i._container.clearError()},this)),this._element},_onItemClicked:function(t,e){this.showRemoveButton=!this.showRemoveButton,this._container._getElementCount()>1&&this._updateActiveState(!this.active),this.edit||this._container.closeEditorsExceptMe(this.componentId),this._refreshDetailView()},_saveItem:function(){this.description=this._getContentEditorElement().val()},_editItem:function(){this._setStates(!0,!0,this._isLastItem()),this._container.closeEditorsExceptMe(this.componentId),this._focusEditItem(this._element),i.getInstance().initCharlimitInput(this._getContentEditorElement())},_cancelEdit:function(){this._setStates(!1,!this._isLastItem(),this._isLastItem()),this._refreshEditorView(),this._refreshDetailView()},_isLastItem:function(){return 1==this.count},_setStates:function(t,e,n){this.edit=t,this._updateActiveState(e),this.showRemoveButton=n},_focusEditItem:function(t){n.scrollTo(t).then(function(){t.find("textarea").focus().putCursorAtEnd()})},_isEditItemValid:function(e){var n=!0;return e.each(function(){n=n&&t(this).parsley().isValid()!==!1}),n},getImagePath:function(){return this._super()},getShowRemoveButton:function(){return(this.showRemoveButton||1==this.count)&&!this.edit},getShowMoveUpButton:function(){return!this.getShowRemoveButton()&&this.order&&this.order>1},getShowMoveDownButton:function(){return!this.getShowRemoveButton()&&this.count&&this.order<this.count},getShowEditor:function(){return this.edit||this.description},getShowAddButton:function(){return this.edit&&!this.description},getShowUpdateButton:function(){return this.edit&&this.description}});return c});
define("rwd/common/abstract-item",["jquery","rwd/common/base-ui-module","rwd/path-utils","rwd/centered-image-utils"],function(t,e,i,n){var s=e.extend({uploading:!1,edit:!1,active:!1,showRemoveButton:!0,construct:function(e){t.extend(!0,this,e)},_getDetailContainer:function(){return this._getElement(".js-item-details-container")},_getEditorContainer:function(){return this._getElement(".js-item-editor-container")},_getImage:function(){return this._getElement(".js-item-thumbnail-image")},_bindEditor:function(){},_unBindEditor:function(){},_bindDetail:function(){},_unBindDetail:function(){},_bind:function(e,i){return this._element=t(e),this._container=i,this._bindDetail(),this._bindEditor(),this._element.on("refreshItem",t.proxy(this._onRefreshItem,this)),this._element},_onRefreshItem:function(t,e){var i=this.order,n=this.count;this.index=this.getRelativeIndex(),this.order=this.getIndex()+1,this.count=e.count,this._refreshActiveState(),(i!=this.order||n!=this.count)&&this._refreshDetailView()},_updateActiveState:function(t){this.active=t,this._toggleActiveClass(t)},_toggleActiveClass:function(t){t?this._element.addClass("active"):this._element.removeClass("active")},_refreshActiveState:function(){1===this._container._getElementCount()&&this._updateActiveState(!1)},_refreshDetailView:function(){this._unBindDetail(),this._refreshView(this._getDetailContainer(),this.itemDetailTemplate),this.uploading||this._setThumbnailImage(),this._bindDetail()},_refreshEditorView:function(){this.itemEditorTemplate&&(this._unBindEditor(),this._refreshView(this._getEditorContainer(),this.itemEditorTemplate),this._bindEditor())},_refreshView:function(e,i){e.html(t.parseHTML(i.render(this)))},_setThumbnailImage:function(){this.image&&"null"!=this.image&&(new n).setImage(this._getImage(),(new i).getImagePath(this.getImagePath()))},_getElement:function(t){return this._element.find(t)},getImagePath:function(){return this.image},getNode:function(e){var i={detail:this.itemDetailTemplate.getTemplate()};this.itemEditorTemplate&&(i.editor=this.itemEditorTemplate.getTemplate());var n=this.itemContainerTemplate.render(this,i);return this._bind(t.parseHTML(n),e)},remove:function(){this._unBindDetail(),this._element.remove()},getRelativeIndex:function(){return this.getElement().parent().find("[data-type='"+this.type+"']").index(this.getElement())},getIndex:function(){return this.getElement().index()},getElement:function(){return this._element},getItemName:function(){return this.title}});return s});
define("rwd/common/abstract-orderable-container",["jquery","rwd/common/base-ui-module","rwd/common/template","rwd/common/form-change-notifier","rwd/common/error-message-template","rwd/common/smooth-scroll"],function(e,t,n,r,i,o){var a=t.extend({superConfig:function(){return{useModuleAsParent:!0,selectors:{itemUploadContainerTitle:".js-item-upload-container-title",itemUploadContainer:".js-item-upload-container",itemRemoveContainer:".js-item-remove-container",errorContainer:".js-error-container"}}},componentId:1,construct:function(t){e.extend(!0,this.baseConfig,this.superConfig()),this._super(t)},_init:function(){this._super(),this.removeUploadedParameterName=this.$.itemRemoveContainer.data("remove-parameter-name"),this.removeTemporaryParameterName=this.$.itemRemoveContainer.data("remove-temporary-parameter-name"),this.errorTemplate=new i({selectors:{template:"#js-error-template"}})},_bindEvents:function(){this._initTemplate(),this._processDOM(),this._isUploadingModule()&&this.module.parsley().subscribe("parsley:field:validate",e.proxy(function(e){this.module.has(".js-uploading").length?(e.value="uploading",this.clearError()):e.value="ready"},this))},_processDOM:function(){var t=new Array;e.each(this._convertElementsToItemList(),function(e,n){t.push(n.item)}),this._append(t),this.$.itemUploadContainer.trigger("containerReady"),r.getInstance().getItemUploadValueValidator().reset()},_convertElementsToItemList:function(){var t=this,n=new Array;return this.$.itemUploadContainer.children("p").each(function(r,i){var o=t._convertElementToObject(e(i),r);void 0!=o&&n.push(o)}),this.$.itemUploadContainer.children().remove(),n.sort(function(e,t){return e.order-t.order}),n},_convertElementToObject:function(e){},closeEditorsExceptMe:function(e){this._closeEditors(e)},_loadTemplate:function(e){return new n({selectors:{template:e}})},_initTemplate:function(){},_append:function(t,n,i){var a=e.isArray(t)?t:[t],s=this._appendToContainer(a,this.$.itemUploadContainer,i);if(this._refreshItem(),e.each(s,function(e,t){r.getInstance().getItemUploadValueValidator().saveValueForElement(t,!0)}),this._isEmptyItemContainer()?this._hideItemContainer():this._showItemContainer(),n){var m=i===!0?this.$.itemUploadContainer.children().last():this.module;o.scrollTo(m)}},_appendToContainer:function(t,n,r){var i=e.isArray(t)?t:[t],o=new Array;return e.each(i,e.proxy(function(e,t){o.push(t.getNode(this))},this)),r===!0?n.append(o):n.prepend(o),o},_isUploadingModule:function(){return this.module.is(".js-uploading-component")},removeItem:function(e){e.remove(),!e.isNew&&this.removeUploadedParameterName&&(e.id?this.$.itemRemoveContainer.append("<input type='hidden' name='"+this.removeUploadedParameterName+"' value='"+e.id+"' />"):e.temporaryKey&&this.$.itemRemoveContainer.append("<input type='hidden' data-type='temporary' name='"+this.removeTemporaryParameterName+"' value='"+e.temporaryKey+"' />")),this._refreshItem(),this._isEmptyItemContainer()?this._hideItemContainer():this._showItemContainer()},_showItemContainer:function(){this.$.itemUploadContainerTitle.show()},_hideItemContainer:function(){this.$.itemUploadContainerTitle.hide()},moveUp:function(e){var t=e.getIndex(),n=this.$.itemUploadContainer.children().get(t-1);n&&(e.getElement().insertBefore(n),this._refreshItem())},moveDown:function(e){var t=e.getIndex(),n=this.$.itemUploadContainer.children().get(t+1);n&&(e.getElement().insertAfter(n),this._refreshItem())},showError:function(t){this.errorTemplate.render(t,e.proxy(function(e){this.$.errorContainer.html(e)},this))},clearError:function(){this.$.errorContainer.children().removeClass("error")},_trigger:function(e,t){this.$.itemUploadContainer.children().trigger(e,t)},_closeEditors:function(e){this._trigger("closeEditor",{componentId:e})},_isEmptyItemContainer:function(){return 0==this.$.itemUploadContainer.children().length},_refreshItem:function(){this._trigger("refreshItem",{count:this._getElementCount()})},_getNextComponentId:function(){return this.componentId++},_getElementCount:function(){return this.$.itemUploadContainer.children().length},getRemoveUploadedParameterName:function(){return logger.warn("Need to be overridden"),null}});return a});
define("rwd/common/abstract-orderable-item",["jquery","rwd/common/abstract-detail-item"],function(e,t){var n=t.extend({_getMoveUpElement:function(){return this._getElement(".js-action-move-up")},_getMoveDownElement:function(){return this._getElement(".js-action-move-down")},_bindDetail:function(){this._super();var e=this;this._getMoveUpElement().on("click",function(t){t.stopPropagation(),e._container.moveUp(e)}),this._getMoveDownElement().on("click",function(t){t.stopPropagation(),e._container.moveDown(e)})},_unBindDetail:function(){this._super(),this._getMoveUpElement().off(),this._getMoveDownElement().off()}});return n});
define("rwd/common/abstract-search-container",["jquery","rwd/common/abstract-orderable-container","rwd/common/paginator","rwd/common/loading-indicator"],function(t,e,i,r){var a=e.extend({removeItem:function(e){this._super(e),this.clearSearchContainer(!0),this.clearSearchPaginatorContainer(!0),this.config.selectedItemIdList=t.grep(this.config.selectedItemIdList,function(t){return t!=e.id})},_getActiveEmptyMessage:function(){return""},clearSearchContainer:function(t){this.$.searchResultContainer[t?"hide":"show"](),this.$.searchResultContainer.empty()},clearSearchPaginatorContainer:function(t){this.$.searchPaginatorContainer[t?"hide":"show"](),this.$.searchPaginatorContainer.empty()},_append:function(e,i,r){var a=t.isArray(e)?e:[e];t.each(a,function(t,e){e.isNew=r}),this._super(e,i)},_renderResultList:function(e,a,n,o,s){var c=this;if(!e.length)return this.$.searchNotification.html(this._getActiveEmptyMessage()),this.$.searchNotification.trigger("restore"),void this.$.searchNotification.show();if(this.$.searchNotification.hide(),this.$.searchNotification.trigger("restore"),this.clearSearchContainer(!1),this.clearSearchPaginatorContainer(!1),t.each(e,function(t,e){var i=c._createItem(e);c._appendToContainer(i,c.$.searchResultContainer,s),i._setThumbnailImage()}),a){c.$.searchPaginatorContainer.append(a);var h=this.config.moduleSelector+" .item-search-result-paginator";new i({moduleSelector:h,pageSelectionListener:function(t){c._loadPage(t,n,o)}}),r.initialize({selectors:{busyButton:h+" .loading-indicator"}})}},_loadPage:function(e,i,r){var a={activePage:e,searchTerm:r,selectedItemIdList:this.config.selectedItemIdList};t.ajax({url:i,data:a,traditional:!0}).then(t.proxy(function(t){this.clearError(),this.clearSearchContainer(!1),this.clearSearchPaginatorContainer(!1),this._loadPaginator(e,t,i,r)},this)).fail(t.proxy(function(){this.showError(),this.$.searchNotification.trigger("restore")},this))},_loadPaginator:function(e,i,r,a){0==i.totalItems||i.totalPages<=1?this._renderResultList(this.getResultList(i)):t.get("/template/manage-list/paginator",{activePage:e,totalItems:i.totalItems}).then(t.proxy(function(e){this._renderResultList(this.getResultList(i),t(e),r,a)},this))},showError:function(){this.$.errorContainer.addClass("error")},clearError:function(){this.$.errorContainer.removeClass("error")},_init:function(){this._super();var e=this.module.data("exclude-id-list");if(e){var i=this,r=String(e).split(",");t.each(r,function(t,e){i.config.selectedItemIdList.push(e)})}}});return a});
define("rwd/common/auto-hiding-input-form",["jquery","rwd/common/base-ui-module"],function(t,i){var n=9,e=i.extend({baseConfig:{selectors:{form:"form",input:":text",submit:":submit"},listeners:{onShow:t.noop,onHide:t.noop},moduleSelector:".auto-hide-container",useModuleAsParent:!0},_isSubmitClicked:function(){return document.activeElement===this.$.submit[0]||document.activeElement===this.$.input[0]},show:function(){this.module.addClass("open"),this.$.input.focus(),this.justOpened=!0,setTimeout(t.proxy(function(){this.justOpened=!1},this),100),this.config.listeners.onShow()},hide:function(){this.$.input.val(""),this.module.removeClass("open"),this.$.input.parent().removeClass("error"),this.config.listeners.onHide()},getForm:function(){return this.$.form},getInput:function(){return this.$.input},_bindEvents:function(){this.$.input.on("keydown",t.proxy(function(t){t.keyCode==n&&(t.preventDefault(),this.hide())},this)),this.$.input.on("blur",t.proxy(function(i){this.justOpened||setTimeout(t.proxy(function(){this._isSubmitClicked()||(this.hide(),document.activeElement=void 0)},this),300)},this)),this.config.listeners.onSubmit&&this.$.form.submit(function(t){this.config.listeners.onSubmit(t,this.$.input.val())}.bind(this))}});return e});
define("rwd/common/autocomplete",["jquery","rwd/common/base-ui-module","rwd/common/template","rwd/common/loading-indicator"],function(t,e,i,s){var o=e.extend({superConfig:{selectors:{showAutocompleteLink:".show-autocomplete",autocompleteInputContainer:".autocomplete-input-container",autocompleteInput:".autocomplete-input",autocompleteList:".autocomplete-list",autocompleteListItems:".autocomplete-list .item",selectedItems:".selected-items",savingMessage:".js-saving-message",errorMessage:".js-error-message"},useModuleAsParent:!0,selectedClass:"selected",removeSelector:".remove",itemSelector:".item"},SPACE:" ",EMPTY_STRING:"",KEYCODES:{DOWN:40,UP:38,ENTER:13,SPACE:32},activeIndex:0,autocompleteOptions:[],currentFetchRequest:void 0,selectedItems:[],_init:function(){this.selectedItemTemplate=this._loadTemplate("#selected-item-template"),this.autocompleteItemTemplate=this._loadTemplate("#autocomplete-item-template"),this.autocompleteCreateNewItemTemplate=this._loadTemplate("#autocomplete-create-new-item-template"),this.inputName=this.module.attr("data-input-name"),this.fetchUrl=this.module.attr("data-fetch-url"),this.addUrl=this.module.attr("data-add-url"),this.removeUrl=this.module.attr("data-remove-url"),this._initSelectedItems(),this.runningOperationCounter=0},_initSelectedItems:function(){var e=this;this.$.selectedItems.find(".item").each(function(){e.selectedItems[e.selectedItems.length]=t(this).attr("data-item")})},_showAutocompleteInput:function(){this.$.showAutocompleteLink.hide(),this.$.autocompleteInputContainer.show(),this.$.autocompleteInput.focus()},_hideAutocompleteInput:function(){this.$.showAutocompleteLink.show(),this.$.autocompleteInputContainer.hide(),this.$.autocompleteInput.val(""),this._setAvailableOptionsVisibility(!1)},_setAvailableOptionsVisibility:function(t){this.$.autocompleteList.toggle(t)},_selectNextElement:function(){var t=this.$.autocompleteList.find(this.config.itemSelector).length;this.activeIndex=(this.activeIndex+1)%(t+1),this._updateFocus()},_selectPreviousElement:function(){var t=this._getCurrentItemCount();this.activeIndex=0===this.activeIndex?t:(this.activeIndex-1)%(t+1),this._updateFocus()},_updateFocus:function(){var t=this.$.autocompleteList.find(this.config.itemSelector);t.removeClass(this.config.selectedClass),0!==this.activeIndex?(t.eq(this.activeIndex-1).addClass(this.config.selectedClass),this.$.autocompleteList.focus()):this.$.autocompleteInput.focus()},_getCurrentItemCount:function(){return this.$.autocompleteList.find(this.config.itemSelector).length},_autocompleteFocused:function(){return this.$.autocompleteInput.is(":focus")||this.$.autocompleteList.is(":focus")},_itemExists:function(t){return-1!=this.selectedItems.indexOf(t)},_saveItemOnServer:function(t){this._manageTagOnServer(this.addUrl,t)},_removeItemFromServer:function(t){this._manageTagOnServer(this.removeUrl,t)},_showSavingMessage:function(){this.$.savingMessage.show()},_hideSavingMessage:function(){this.runningOperationCounter||this.$.savingMessage.hide()},_showErrorMessage:function(){this.$.errorMessage.show()},_hideErrorMessage:function(){this.$.errorMessage.hide()},_findElementByName:function(e){return t(".selected-items div[data-item='"+e+"']")},_manageTagOnServer:function(e,i){this.runningOperationCounter++,this._hideErrorMessage(),this._showSavingMessage(),t.ajax({type:"POST",url:e,data:{tag:i},traditional:!0}).then(t.proxy(function(t){this.runningOperationCounter--,this._hideSavingMessage()},this)).fail(t.proxy(function(){this.runningOperationCounter--;var t=this._findElementByName(i);t.is(":visible")?this._onRemoveItem(this._findElementByName(i),!0):this._addNewItemOnUI(i,this._getItemKey(i)),this._hideSavingMessage(),this._showErrorMessage()},this))},_addNewItem:function(t){this.$.autocompleteInput.val(""),this.$.autocompleteInput.focus(),this.$.autocompleteList.hide();var e=this._getItemKey(t);this.activeIndex=0,e.length>0&&!this._itemExists(e)&&(this._addNewItemOnUI(t,e),this._saveItemOnServer(t))},_addNewItemOnUI:function(t,e){var i=this._renderNewItem(t);this.$.selectedItems.append(i),this.selectedItems.push(e)},_onRemoveItem:function(t,e){var i=t.data("item").toString();t.remove(),this._removeItem(i),!e&&this._removeItemFromServer(i)},_removeItem:function(t){var e=this.selectedItems.indexOf(t);e>-1&&this.selectedItems.splice(e,1)},_loadTemplate:function(t){return new i({selectors:{template:t}})},_fetchAutocompleteOptions:function(e){void 0!==this.currectFetchRequest&&void 0!==this.currectFetchRequest.abort&&this.currectFetchRequest.abort();var i={searchTerm:e,selectedItems:this.selectedItems};this.currectFetchRequest=t.ajax({type:"GET",url:this.fetchUrl,data:i,traditional:!0}).then(t.proxy(function(t){this.autocompleteOptions=t.items,this._showAutocompleteOptions(i.searchTerm),this.$.autocompleteList.trigger("restore"),this.currectFetchRequest=void 0},this)).fail(t.proxy(function(){this.currectFetchRequest=void 0},this))},_showAutocompleteOptions:function(t){var e=this.autocompleteOptions.length;this.$.autocompleteList.html("");for(var i=0;e>i;i++){var s=this._getIdentifierFromAutocompleteOption(this.autocompleteOptions[i]);this._itemExists(s)||(this.autocompleteOptions[i].exists?this.$.autocompleteList.append(this._renderAutocompleteItemTemplate(t,s,this.autocompleteOptions[i])):this.$.autocompleteList.append(this._renderAutocompleteCreateNewItemTemplate(t,s,this.autocompleteOptions[i])))}0==this._getCurrentItemCount()&&this.$.autocompleteList.hide()},_showLoading:function(){s.getInstance().isBusy(this.$.autocompleteList)||this.$.autocompleteList.html("").trigger("loading")},_bindEvents:function(){this.$.showAutocompleteLink.click(t.proxy(function(t){t.preventDefault(),this._showAutocompleteInput()},this)),this.$.autocompleteInput.on("input propertychange paste",t.proxy(function(t){this._onAutocompleteInputChange()},this)),this.$.autocompleteInput.add(this.$.autocompleteList).on("keydown",t.proxy(function(t){switch(t.keyCode){case this.KEYCODES.DOWN:t.preventDefault(),this._selectNextElement();break;case this.KEYCODES.UP:t.preventDefault(),this._selectPreviousElement()}},this)),this.$.autocompleteList.on("keydown",t.proxy(function(t){t.keyCode===this.KEYCODES.ENTER&&(t.preventDefault(),this._addNewItem(this._getIdentifierFromAutocompleteOption(this.autocompleteOptions[this.activeIndex-1])))},this)),this.$.autocompleteInputContainer.on("click",this.config.itemSelector,t.proxy(function(e){e.preventDefault(),this._addNewItem(this._getIdentifierFromAutocompleteOption(this.autocompleteOptions[t(e.currentTarget).index()]))},this)),this.$.autocompleteInput.add(this.$.autocompleteList).on("blur",t.proxy(function(e){setTimeout(t.proxy(function(){this._autocompleteFocused()||this._hideAutocompleteInput()},this),300)},this)),this.$.selectedItems.on("click",this.config.removeSelector,t.proxy(function(e){this._onRemoveItem(t(e.currentTarget).parent())},this))}});return o});
define("rwd/common/breakpointdetection",["jquery","rwd/common/base-ui-module"],function(t,n){var i=n.extend({baseConfig:{selectors:{detectionTag:"#breakpoint"},breakpoints:{largeFont:[3,5,6],smallFont:[1,2,4],mobileLayout:[1,2,3],desktopLayout:[4,5,6],blockImageStyle:[1,2]}},construct:function(t){this._super(t)},_init:function(){this.currentBreakpoint=this.getBreakpoint(),this.eventName="breakpoint-change"},getBreakpoint:function(){return parseInt(this.$.detectionTag.css("top"))},getBreakpointImageSizePairs:function(){var n=this.$.detectionTag.data("breakpoints-image-pairs").split(","),i={};return t.each(n,function(t,n){var e=n.split(":");i[e[0]]=parseInt(e[1])}),i},getGeneralThumbnailWidths:function(){var n=this.$.detectionTag.data("general-thumbnail-widths").split(",");return t.map(n,function(t){return parseInt(t)})},isMobileLayout:function(t){return this.containsBreakpoint(this.config.breakpoints.mobileLayout,t)},isDesktopLayout:function(t){return this.containsBreakpoint(this.config.breakpoints.desktopLayout,t)},isSmallFont:function(t){return this.containsBreakpoint(this.config.breakpoints.smallFont,t)},isLargeFont:function(t){return this.containsBreakpoint(this.config.breakpoints.largeFont,t)},isBlockImageStyle:function(t){return this.containsBreakpoint(this.config.breakpoints.blockImageStyle,t)},containsBreakpoint:function(n,i){var e=i||this.getBreakpoint();return t.inArray(e,n)>-1},listen:function(n){t(document).on(this.eventName,n)},listenLayoutChange:function(n){t(document).on(this.eventName,t.proxy(function(t,i,e){var o=this.isMobileLayout(i),a=this.isDesktopLayout(e);o&&a&&n(t,i,e,"desktop"),o||a||n(t,i,e,"mobile")},this))},listenFontSizeChange:function(n){t(document).on(this.eventName,t.proxy(function(t,i,e){var o=this.isSmallFont(i),a=this.isLargeFont(e);o&&a&&n(t,i,e,"large"),o||a||n(t,i,e,"small")},this))},listenImageStyleChange:function(n){t(document).on(this.eventName,t.proxy(function(t,i,e){var o=this.isBlockImageStyle(i),a=!this.isBlockImageStyle(e);o&&a&&n(t,"inline"),o||a||n(t,"block")},this))},_bindEvents:function(){t(window).on("resize orientationchange",t.proxy(function(){var n=this.getBreakpoint();this.currentBreakpoint!==n&&(t(document).trigger(this.eventName,[this.currentBreakpoint,n]),this.currentBreakpoint=n)},this))}});return{instance:void 0,getInstance:function(){return this.instance||(logger.debug("Initializing BreakpointDetection"),this.instance=new i),this.instance}}});
define("rwd/common/charlimit-counter",["jquery","rwd/common/base-ui-module","rwd/common/template","rwd/common/i18n"],function(e,t,i,a){var r,s=100,n=t.extend({baseConfig:{selectors:{exceededTemplate:"#charlimitExceededTemplate"},errorClass:"error",charlimitClass:"charlimit",charlimitExceededClass:"charlimit-exceeded"},_onInputChange:function(t){var i=e(t.currentTarget),a=this._getCharLimitDiv(i);return this._isLimitExceeded(i)?void this._updateCharlimitExceededMessage(i):("true"===i.attr("data-charlimit-exceeded")&&i.removeAttr("data-charlimit-exceeded").parent().removeClass(this.config.charlimitExceededClass+" "+this.config.errorClass),void(a.length&&this._updateCharlimitMessage(i,a,null,a.attr("data-message-plural"),a.attr("data-message-singular"))))},_isLimitExceeded:function(e){return this._getRealLength(this._getValue(e))>parseInt(this._getMaxLength(e))},_updateCharlimitMessage:function(e,t,i,a,r){var s="",n=this._countRemainingChars(e);this._getInputWrapper(e).addClass(i),s=1!==n?n+" "+a:n+" "+r,t.attr("data-message",s)},_updateCharlimitExceededMessage:function(e){var t=e.siblings(".charlimit-message");if(t.length){var i=e.siblings(".charlimit-exceeded-message");e.attr("data-charlimit-exceeded","true"),this._updateCharlimitMessage(e,t,this.config.charlimitExceededClass+" "+this.config.charlimitClass+" "+this.config.errorClass,i.attr("data-message-plural"),i.attr("data-message-singular"))}},_initExceededTemplate:function(){var e="#"+this.$.exceededTemplate.attr("id");this.charlimitExceededTemplate=new i({selectors:{template:e}})},_appendExceededMessage:function(e){var t=a.format("charlimit-exceeded-message",this._getMaxLength(e));this._getInputWrapper(e).append(this.charlimitExceededTemplate.render({message:t}))},_initCharacterLimitExceeded:function(e){this._appendExceededMessage(e),this._updateCharlimitExceededMessage(e),e.attr("data-charlimit-exceeded","true")},_getRealLength:function(e){var t=e.split("\n").length-1;return e.length+t},_showCharLimit:function(t){setTimeout(e.proxy(function(){var i=e(t.currentTarget),a=this._getCharLimitDiv(i),r=this._getInputWrapper(i);a.length&&!r.hasClass(this.config.charlimitExceededClass)&&this._updateCharlimitMessage(i,a,this.config.charlimitClass,a.attr("data-message-plural"),a.attr("data-message-singular"))},this),s)},_hideCharLimit:function(t){setTimeout(e.proxy(function(){var i=e(t.currentTarget),a=this._getCharLimitDiv(i),r=this._getInputWrapper(i);a.length&&!r.hasClass(this.config.charlimitExceededClass)&&r.removeClass(this.config.charlimitClass)},this),s)},_getInputWrapper:function(e){return e.parents(".form-group")},_getCharLimitDiv:function(e){return this._getInputWrapper(e).find(".charlimit-message")},_getValue:function(e){return e.val()},_getMaxLength:function(e){return e.attr("maxlength")},_countRemainingChars:function(e){return Math.abs(this._getMaxLength(e)-this._getRealLength(this._getValue(e)))},initCharlimitInput:function(t){t.on("change",e.proxy(this._onInputChange,this)),t.on("focus",e.proxy(this._showCharLimit,this)),t.on("blur",e.proxy(this._hideCharLimit,this)),this.$.exceededTemplate.length&&(this._initExceededTemplate(),e.each(t,e.proxy(function(t,i){var a=e(i);this._isLimitExceeded(a)&&(a.data("parsley-id")?this._initCharacterLimitExceeded(a):e.listen("parsley:field:init",e.proxy(function(e){e.$element[0]===a[0]&&this._initCharacterLimitExceeded(a)},this)))},this)))}});return{getClass:function(){return n},getInstance:function(){return r||(r=new n),r}}});
define("rwd/common/contribution-group-selector",["jquery","rwd/common/base-ui-module","rwd/common/auto-hiding-input-form"],function(o,r,e){var t=r.extend({baseConfig:{selectors:{groupsDropdown:".groups-dropdown",selectGroupForm:".select-group-form"},moduleSelector:".contribution-group-selector",useModuleAsParent:!0},_init:function(){this.originalSelectedGroup=this.$.groupsDropdown.val(),this.createGroupForm=new e({listeners:{onHide:o.proxy(this._selectPreviousGroup,this)}})},_selectPreviousGroup:function(){this.$.groupsDropdown.val(this.originalSelectedGroup),this.$.groupsDropdown.trigger("render")},_preformGroupChange:function(){this.$.groupsDropdown.closest("form").submit()},_bindEvents:function(){this.$.groupsDropdown.on("change",o.proxy(function(r){var e=o(r.currentTarget).val();"create"==e?this.createGroupForm.show():parseInt(e)>=0&&this._preformGroupChange()},this))}});return t});
define("rwd/common/delayed-loader",["jquery"],function(e){function n(){var e=[];return{loadWithDelay:function(n,t,i){clearTimeout(e[n]),e[n]=setTimeout(t,i)}}}return{instance:void 0,getInstance:function(){return this.instance||(logger.debug("Initializing DelayedLoader"),this.instance=new n),this.instance}}});
define("rwd/common/expandable-collapsable-section",["jquery","rwd/common/expandable-section"],function(e,n){return n.extend({_collapse:function(e){e.removeClass(this.EXPANDED_CLASS)},_expand:function(n){var s=e(n.currentTarget),t=s.closest(this.config.moduleSelector);t.hasClass(this.EXPANDED_CLASS)?(n.preventDefault(),this._collapse(t)):this._super(n)}})});
define("rwd/common/expandable-section-mobile-only",["jquery","rwd/common/expandable-section","rwd/common/breakpointdetection"],function(n,t,e){return t.extend({customConfig:{moduleSelector:".js-expandable-section-mobile-only"},construct:function(t){this.baseConfig=n.extend(!0,{},this.baseConfig,this.customConfig),this._super(t)},_init:function(){this._super(),this.breakpointDetection=e.getInstance(),this.breakpointDetection.isDesktopLayout()&&this._expandSections()},_expandSections:function(){this.module.each(function(t,e){this._afterExpanded(n(e))}.bind(this))},_bindEvents:function(){this._super();var n=this;this.breakpointDetection.listenLayoutChange(function(t,e,i,o){"desktop"===o&&n._expandSections()})}})});
define("rwd/common/expandable-section",["jquery","rwd/common/base-ui-module","rwd/common/centered-imager","rwd/common/breakpointdetection"],function(e,n,t,a){return n.extend({baseConfig:{selectors:{expand:".expand"},moduleSelector:".js-expandable-section",useModuleAsParent:!0},EXPANDED_CLASS:"expanded",EQUAL_HEIGHTS_CLASS:"equal-heights",EXPANDED_SECTION:".expanded-section",_expand:function(n){logger.debug("Expanding section..."),n.preventDefault();var t=e(n.currentTarget),a=t.closest(this.config.moduleSelector);t.data("url")?this._loadContent(t.data("url"),a):this._afterExpanded(a)},_loadContent:function(n,t){e.ajax(n).done(e.proxy(function(e){t.closest(this.EXPANDED_SECTION).append(e),this._afterExpanded(t)},this))},_afterExpanded:function(n){n.addClass(this.EXPANDED_CLASS),this._reinitCenteredImager(n),n.hasClass(this.EQUAL_HEIGHTS_CLASS)&&e.fn.matchHeight._update()},_reinitCenteredImager:function(e){if(e.find(".center-image .background-size-polyfill").length){var n=a.getInstance().getGeneralThumbnailWidths();new t({imageSelector:".js-expandable-section.expanded .center-image img[data-src]",imageWidth:n})}},_bindEvents:function(){this.$.expand.click(e.proxy(this._expand,this))}})});
define("rwd/common/abstract-item-value-validator",["jquery","rwd/common/generic-validator"],function(e,t){var i=t.extend({construct:function(t){e.extend(!0,this.baseConfig,this.superConfig),this._super(t),logger.debug("Register item upload value validator for form-change-notifier...",t)},takeSnapshot:function(e){var t=this.$.parent.find(this.config.inputSelector),i=this;t.each(function(e,t){i._saveValue(t)})},saveValueForElement:function(e,t){this._saveValue(e.get(0),t)},_saveValue:function(e,t){var i=t?"undefined":this._getValue(e);this._saveOriginal(e,i)},isDirty:function(){var t=!1,i=this,n=this.$.parent.find(this.config.inputSelector);return n.each(function(n,a){var r=i._getOriginal(a);if("undefined"!=typeof r){var r=e.trim(r),o=e.trim(i._getValue(a));if(r!=o)return t=!0,logger.debug("old:",r,"new:",o),!1}}),t},reset:function(){logger.debug("Resetting abstract item value validator"),this.takeSnapshot()}});return i});
define("rwd/common/access-item-value-validator",["jquery","rwd/common/abstract-item-value-validator"],function(e,n){var t=n.extend({baseConfig:{inputSelector:".js-group-label-input"},_getValue:function(n){return e(n).find("input[type='hidden']:not('.js-skip-validation')").map(function(n,t){return e(t).val()}).get().join()}});return t});
define("rwd/common/button-validator",["jquery","rwd/common/base-ui-module","rwd/common/generic-validator"],function(n,t,i){var o=i.extend({construct:function(t){n.extend(!0,this.baseConfig,this.superConfig),this._super(t),logger.debug("Register button validator for form-change-notifier...",t)},isDirty:function(){var t=!1;return this.$.parent.find(".submit-btn.confirmation-for-unpublish").each(function(i,o){n(o).data("button-valid")===!1&&(t=!0)}),t},reset:function(){this.$.parent.find(".submit-btn.confirmation-for-unpublish").each(function(t,i){n(i).data("button-valid",!0)})}});return o});
define("rwd/common/form-change-notifier",["jquery","rwd/common/base-ui-module","rwd/modal-notification","rwd/common/item-remove-value-validator","rwd/common/item-upload-value-validator","rwd/common/form-value-validator","rwd/common/model-value-validator","rwd/common/button-validator","rwd/common/access-item-value-validator"],function(t,i,e,n,o,r,a,s,l){var d=i.extend({baseConfig:{selectors:{form:"form.search-form",parent:".change-notifier"},notification:"#form-change",errorElementStyle:".err-text:not(:hidden)",link:"a:not(.js-allow-nav, [href^='#'], [href^='javascript:'], [target='_blank'])"},construct:function(t){this._super(t),logger.debug("Init form-change-notifier...",t),this.settings=t},isDirty:function(){for(var t in this.validators)if(this.validators.hasOwnProperty(t)&&this.validators[t].isDirty())return!0;return!1},reset:function(){for(var t in this.validators)this.validators.hasOwnProperty(t)&&this.validators[t].reset()},_bindEvents:function(){t(document).on("click",this.config.link,t.proxy(function(i){if(this.isDirty()){logger.debug("Form is changed.");var n=t(i.currentTarget),o=this;return this.confirmation=new e({id:o.config.notification,onOk:function(i){return logger.debug("Navigation confirmed, navigating away to",t(n).attr("href")),o.reset(),window.location.href=t(n).attr("href"),!0},onCancel:function(t){return logger.debug("Navigation cancelled"),o.confirmation.close(),t.preventDefault(),!1}}),this.confirmation.open(),logger.debug("Default action prevented."),i.preventDefault(),!1}return logger.debug("Form is unchanged, navigating away."),!0},this)),this.$.form.submit(t.proxy(function(i){if(this.isDirty()){logger.debug("Form is changed.");var n=t(i.currentTarget),o=this;return this.confirmation=new e({id:o.config.notification,onOk:function(t){return logger.debug("Navigation confirmed"),o.reset(),n.submit(),!0},onCancel:function(t){return logger.debug("Navigation cancelled"),o.confirmation.close(),t.preventDefault(),!1}}),this.confirmation.open(),!1}return!0},this))},getItemUploadValueValidator:function(){return this.validators.itemUploadValueValidator},getAccessItemValueValidator:function(){return this.validators.accessItemValueValidator},_init:function(){this.validators={formValueValidator:new r(this.settings),modelValueValidator:new a(this.settings),buttonValidator:new s(this.settings),itemRemoveValueValidator:new n(this.settings),itemUploadValueValidator:new o(this.settings),accessItemValueValidator:new l(this.settings)},logger.debug("Added change notifier on:","Id/Name:",t(this.$.parent).attr("id")||t(this.$.parent).attr("name"));for(var i in this.validators)this.validators.hasOwnProperty(i)&&(logger.debug("Taking snapshot of",i),this.validators[i].takeSnapshot())}}),c=null;return{getInstance:function(){return c||(c=new d),c}}});
define("rwd/common/form-value-validator",["jquery","rwd/common/abstract-item-value-validator","rwd/common/rich-text-editor-util"],function(t,e,n){var a=e.extend({baseConfig:{inputSelector:"input[type='text']:not([data-bind]):not(.search),input[type='time']:not([data-bind]),input[type='date']:not([data-bind]),input[type='email']:not([data-bind]),input[type='url']:not([data-bind]),input[type='number']:not([data-bind]),input[type='hidden']:not([data-bind]),input[type='file']:not([data-bind]),input[type='password']:not([data-bind]),input[type='checkbox']:not([data-bind]),input[type='radio']:not([data-bind]),textarea:not([data-bind]),select:not([data-bind])"},_getValue:function(e){var n;return n=t(e).hasClass("rte-field")&&null!=this.richTextEditor?this.richTextEditor.getValueOfElementById(t(e).attr("id")):"checkbox"==t(e).attr("type")?t(e).is(":checked")?"checked":"unchecked":"radio"==t(e).attr("type")?t(e).is(":checked")?"checked":"unchecked":"textarea"==t(e).attr("type")?e.value:t(e).val()},takeSnapshot:function(){var e=this.$.parent.find(this.config.inputSelector),a=this;e.each(function(e,n){t(n).hasClass("rte-field")||a._saveOriginal(n,a._getValue(n))});var i=null;n.hasRTEFields()&&require(["rwd/common/rich-text-editor"],function(t){i=t.getInstance(),i.onLoad("form-change-notifier",a.rteLoaded,a)})},rteLoaded:function(t,e){if(e&&null!=e){t.richTextEditor=e;var n=e.getEditors();for(var a in n)n.hasOwnProperty(a)&&t._saveOriginal(n[a],e.getValueOf(n[a]))}}});return a});
define("rwd/common/generic-validator",["jquery","rwd/common/base-ui-module"],function(n,e){var i=e.extend({superConfig:{selectors:{parent:".js-change-notifier"},originalValue:"oi-original-value"},construct:function(n){this._super(n)},_getValue:function(){},_getOriginal:function(e){return n.data(e,this.config.originalValue)},_saveOriginal:function(e,i){logger.debug("Save value '"+i+"' for element:",e),n.data(e,this.config.originalValue,i)},takeSnapshot:function(){},isDirty:function(){},reset:function(){}});return i});
define("rwd/common/invalid-form-validator",["jquery","rwd/common/base-ui-module","rwd/common/generic-validator"],function(e,r,n){var t=n.extend({baseConfig:{errorElementStyle:".err-text:not(:hidden)"},construct:function(r){e.extend(!0,this.baseConfig,this.superConfig),this._super(r),logger.debug("Register invalid form validator for form-change-notifier...",r)},isDirty:function(){return e(this.config.errorElementStyle).length>0},reset:function(){e(this.config.errorElementStyle).remove()}});return t});
define("rwd/common/item-remove-value-validator",["jquery","rwd/common/abstract-item-value-validator"],function(e,t){var n=t.extend({baseConfig:{inputSelector:".js-item-remove-container"},_getValue:function(t){return e(t).find("input[type='hidden']:not([data-type='temporary'])").map(function(t,n){return e(n).val()}).get().join()}});return n});
define("rwd/common/item-upload-value-validator",["jquery","rwd/common/abstract-item-value-validator"],function(t,e){var n=e.extend({baseConfig:{inputSelector:".js-upload-item"},_getValue:function(e){return t(e).find("input[type='hidden']:not('.js-skip-validation')").map(function(e,n){return t(n).val()}).get().join()}});return n});
define("rwd/common/model-value-validator",["jquery","rwd/common/base-ui-module","rwd/common/generic-validator"],function(e,t,n){var r=n.extend({construct:function(t){e.extend(!0,this.baseConfig,this.superConfig),this._super(t),logger.debug("Register model value validator for form-change-notifier...",t)},isDirty:function(){var t=!1,n=this.$.parent.find(".model-change-notifier");return n.each(function(n,r){return e(r).attr("data-changed")&&"true"==e(r).attr("data-changed")?(t=!0,!1):void 0}),t},reset:function(){var t=this.$.parent.find(".model-change-notifier");t.each(function(t,n){e(n).attr("data-changed","false")})}});return r});
define("rwd/common/cut-maxlength",["jquery"],function(t){"use strict";function e(){var e=this;e.cutLastChar=function(){var n=t(this),a=e.getRealLength(n.val()),r=n.attr("maxlength");return a>r&&!e.isInExceededState(n)?(n.val(n.val().slice(0,-1)),!1):!0},e.isInExceededState=function(t){return"true"===t.attr("data-charlimit-exceeded")},e.getRealLength=function(t){var e=t.split("\n").length;return t.length+e-1},e.cutLongText=function(){var n=t(this),a=e.getRealLength(n.val()),r=n.attr("maxlength");if(a>r&&!e.isInExceededState(n)){var i=n.val().split("\n").join("\n\r").slice(0,r),c=i.split("\n\r").join("\n");n.val(c),e.getRealLength(c)>r&&t.proxy(e.cutLastChar,this)()}return n.change(),!0}}function n(){logger.debug("Init cutmaxlength");var n=new e,a='*[maxlength]:not(".rte-field")';t(document).on("keypress",a,n.cutLastChar),t(document).on("keyup",a,n.cutLongText)}return{init:n}});
define("rwd/common/forms",["jquery","rwd/common/base-ui-module","rwd/common/charlimit-counter","rwd/common/cut-maxlength","rwd/common/utils","rwd/common/number-field"],function(t,e,n,i,a,o){var r=e.extend({baseConfig:{selectors:{select:"select:not(.js-ignore)",dateInputs:'input[type="date"]',timeInputs:'input[type="time"]',numberInputs:'input[type="number"]',charlimitInputs:"input[maxlength], textarea[maxlength]"},moduleSelector:"form"},construct:function(t){this._super(t)},_init:function(){this.$.select.customSelect({customClass:"custom-select"});var e=!1;this.checkInputType("date")||(this.initDateInputs(),e=!0),this.checkInputType("time")||(this.initTimeInputs(),e=!0),new o({moduleSelector:this.config.moduleSelector}),!this.checkPlaceholderSupport()&&e&&(this.$.dateInputs.length>0||this.$.timeInputs.length>0)&&t(document).trigger("oienginePickadateReady"),n.getInstance().initCharlimitInput(this.$.charlimitInputs),i.init(),this.removeOriginalMinMaxValidation(),this.scrollToFirstBackendError()},initDateInputs:function(){var e=this;this.$.dateInputs.each(function(){var n=t(this),i=n.attr("min"),a=n.attr("max"),o={hiddenName:!0,onClose:function(){e.dateTimeInputClosed(n)},onOpen:function(){n.blur()},onStart:function(){n.attr("placeholder",n.attr("data-placeholder"))},klass:{input:"picker__input date-input"}};o.selectMonths=n.data("months"),o.selectYears=n.data("years"),o.format=n.data("format"),o.formatSubmit=n.data("format-submit"),i&&(o.min=Date.fromISO(i)),a&&(o.max=Date.fromISO(a)),n.pickadate(o)})},initTimeInputs:function(){var e=this;this.$.timeInputs.each(function(){var n=t(this);n.pickatime({format:"HH:i",onClose:function(){e.dateTimeInputClosed(n)},onOpen:function(){n.blur()},onStart:function(){n.attr("placeholder",n.attr("data-placeholder"))},klass:{input:"picker__input time-input"}})})},dateTimeInputClosed:function(t){t.blur(),t.attr("placeholder")===t.val()&&t.val("")},removeOriginalMinMaxValidation:function(){a.removeParsleyConstraints(this.$.dateInputs,["min","max"])},scrollToFirstBackendError:function(){var t=this.module.find(".backend-error :input")[0];t&&t.focus()},checkInputType:function(e){var n=t("<input></input>").attr("type",e);return"text"!==n.get(0).type},checkPlaceholderSupport:function(){var t=document.createElement("input");return"placeholder"in t},_bindEvents:function(){this.checkInputType("date")&&this.$.dateInputs.on("keydown",function(t){t.preventDefault()}),this.$.dateInputs.on("change",t.proxy(function(){this.$.dateInputs.trigger("keyup")},this))}});return r});
define("rwd/common/validation",["jquery","rwd/common/rich-text-editor-util","rwd/common/utils","rwd/common/smooth-scroll"],function(e,i,o,t){function d(){var o=null;i.hasRTEFields()&&require(["rwd/common/rich-text-editor"],function(e){o=e.getInstance()}),n(),e.listen("parsley:field:success",function(e){e.isValid()&&e.$element.parents(".form-group").removeClass("backend-error")}),e.listen("parsley:form:validate",function(e){e.$element.find(":submit:not(.loading)").trigger("loading"),o&&(o.updateFields(),o.isHtmlEditAllowed()&&o.refreshSourceMode())}),e.listen("parsley:form:validated",function(e){var i=e._focusedField&&e._focusedField.length,d=".rte-field",n="input, textarea";i&&(e._focusedField.is(n)&&t.scrollTo(e._focusedField),e._focusedField.is(d)&&o&&o.setFocus(e._focusedField),e._focusedField.is(".picker__input.time-input")&&e._focusedField.pickatime("close"),e._focusedField.is(".picker__input.date-input")&&e._focusedField.pickadate("close")),!e.isValid()||i&&(e._focusedField.is(".js-uploading-component")||e._focusedField.is(".mention-input"))?e.$element.find(":submit").trigger("restore"):o&&o.fixScripts()})}function n(){var i=e("form .backend-error");i.length&&t.scrollTo(e(i[0]))}return{initialize:d}});
define("rwd/common/generic-reloading-view",["jquery","rwd/common/base-ui-module","rwd/common/delayed-loader","rwd/common/utils","rwd/modal-notification-template"],function(e,t,i,n,o){var s="view-filter-timer",r=500,a=t.extend({viewConfig:function(){return{selectors:{spinner:".loading-spinner"},listeners:{afterLoaded:e.noop,beforePost:e.noop}}},baseActions:{},updateEnabled:!0,construct:function(t){this.baseConfig=e.extend(!0,{},this.viewConfig(),this.baseConfig),this._super(t)},_init:function(){this._initQuestions(),this.actions=e.extend(this.baseActions,this.config.customActions)},_initQuestions:function(){this.questionTemplate=new o({selectors:{template:"#js-risky-action-question"}})},_loadViewWithState:function(e){logger.debug("This method should be overridden")},_reload:function(e,t){this.$.spinner.trigger("loading"),i.getInstance().loadWithDelay(s,t,r)},_viewLoaded:function(e){this.$.spinner.trigger("restore"),this.config.listeners.afterLoaded(e)},_viewLoadFailed:function(){this.$.spinner.trigger("restore")},_getDataForPost:function(e){var t=this._getCommonPostData(e);return this.config.listeners.beforePost(e,t),t},_getCommonPostData:function(e){return{updateActionType:e}},_performAction:function(e,t){this.updateEnabled&&(this.updateEnabled=!1,this.actions[e]&&this.actions[e].handler?this.actions[e].handler.call(this,e):n.postForm(t,this._getDataForPost(e)))},_getQuestionMessage:function(e){console.warn("This method should be overridden")},_getSelectedAction:function(e){console.warn("This method should be overridden")},_getActionUrl:function(){console.warn("This method should be overridden")},_onUpdate:function(t){t.preventDefault();var i=this._getSelectedAction(t),n=this.actions[i]&&(e.isFunction(this.actions[i].risky)?this.actions[i].risky.call(this):this.actions[i].risky),o=this;if(n){var s=this._getQuestionMessage(n),r=this.questionTemplate.render({message:s},function(e){e.preventDefault(),this.closeAndRemove(),o._performAction(i,o._getActionUrl())},function(e){e.preventDefault(),this.closeAndRemove()});r.open()}else this._performAction(i,this._getActionUrl())},show:function(){this.module.show()},hide:function(){this.module.hide()}});return a});
define("rwd/common/breakpoint-imager",["jquery","imager","rwd/common/base-ui-module","rwd/common/breakpointdetection"],function(e,t,r,a){var n=r.extend({baseConfig:{imageWidth:{},selectors:{imageSelector:"img[data-src]"},useModuleAsParent:!0},_init:function(){var t=this;e.each(this.$.imageSelector,function(r,a){e(a).parent()&&!e(a).parent().hasClass("center-image")&&e(a).attr("src",t._getImageUrl(e(a)))})},_getImageUrl:function(e){var t=a.getInstance().getBreakpoint();return this._getSrcFor(e.attr("data-src"),this.config.imageWidth[t])},_getSrcFor:function(e,t){return e.replace("{width}",t)}});return n});
define("rwd/common/centered-imager",["jquery","imager","rwd/common/base-ui-module","rwd/path-utils","rwd/centered-image-utils"],function(e,i,t,n,a){var r=t.extend({baseConfig:{imageWidth:{},imageSelector:".center-image img[data-src]"},_init:function(){this.initImages(this.config.imageSelector)},initImages:function(t){var r=(new n).getResourcePath("rwd-images/1.gif"),g=new a,m=new i(t,{onResize:!1,availableWidths:this.config.imageWidth,placeHolderSrc:r});m.setNewValue=function(i,t){g.setImage(e(i.parentNode),t)}}});return r});
define("rwd/common/error-message-template",["jquery","rwd/common/template","rwd/common/direction-util"],function(e,r,t){var o=r.extend({_triggerReflow:function(e){e.css("float",t.left()),e.width()},render:function(r,t){var o=e(this._super({message:r}));t(o),this._triggerReflow(o),o.addClass("error")}});return o});
define("rwd/common/label",["jquery","rwd/common/base-ui-module"],function(e,o){var n=o.extend({baseConfig:{selectors:{remove:".remove"},onRemove:function(e){e.preventDefault(),this.module.remove()},moduleSelector:".label",useModuleAsParent:!0},_bindEvents:function(){this.$.remove.click(e.proxy(this.config.onRemove,this))}});return n});
define("rwd/common/loading-indicator",["jquery","rwd/common/base-ui-module"],function(t,n){var i,e=".button-group",o="loading",a=".loading-area-inactive",s={LOADING:"loading",RESTORE:"restore"},r=n.extend({baseConfig:{selectors:{busyButton:".loading-indicator"}},_setState:function(t,n,i){t[n](o),t.closest(e).find("input:not(.loading-indicator), button:not(.loading-indicator), a:not(.loading-indicator)")[i]()},_setLoadingState:function(t){logger.trace("Loading state set for",t),this._setState(t,"addClass","hide")},_restoreState:function(t){logger.trace("Restoring button",t),this._setState(t,"removeClass","show")},isBusy:function(t){return t.hasClass(o)},_bindEvents:function(){logger.debug("Initializing loading indicator enabled buttons and links, binding events"),this.$.busyButton.click(t.proxy(function(n){var i=t(n.currentTarget);if(!i.is(a))return this.isBusy(i)?void n.preventDefault():(this._setLoadingState(i),!0)},this)),this.$.busyButton.on(s.RESTORE,t.proxy(function(n){var i=t(n.currentTarget);this._restoreState(i)},this)),this.$.busyButton.on(s.LOADING,t.proxy(function(n){var i=t(n.currentTarget);this._setLoadingState(i)},this))}});return{initialize:function(t){i=new r(t)},getInstance:function(){return i||this.initialize(),i}}});
define("rwd/mention-charlimit-counter",["jquery","rwd/common/charlimit-counter","rwd/common/utils"],function(t,n,e){return n.getClass().extend({construct:function(t,n){this.mentionInput=t,this._super(n)},_getValue:function(t){var n=this.mentionInput.getMentionText().replace(/<br>$/i,"");return e.htmlDecode(n.replace(/<br>/gi,"&lt;br&gt;")).replace(/<br>/gi,"\n")},_getMaxLength:function(t){return this.mentionInput.module.attr("data-parsley-mentionmax")},_countRemainingChars:function(t){var n=this._getMaxLength(t)-this._getRealLength(this._getValue(t));return 0>n?0:n},_isLimitExceeded:function(t){return!1},initCharlimitInput:function(t){logger.warn("Method not supported")},_bindEvents:function(){var n=this.mentionInput.getMentionInput();n.on("change.mention-input",t.proxy(this._onInputChange,this)),n.on("focus",t.proxy(this._showCharLimit,this)),n.on("blur",t.proxy(this._hideCharLimit,this))}})});
define("rwd/mention-input",["jquery","mustache","rwd/common/base-ui-module","rwd/common/utils","rwd/common/i18n","rwd/mention-charlimit-counter","rwd/common/template","rwd/centered-image-utils","rwd/path-utils","rwd/common/keys"],function(t,e,n,a,i,o,r,s,l,d){var c=0,m=n.extend({baseConfig:{selectors:{mention:".mention",input:"input",mentionEditable:"div.mention",mentionInput:"textarea.mention"},dataUrl:null,teamId:null,moduleSelector:".mention-input",useModuleAsParent:!0},_textareaMention:"@$3[$1:$2]",_rawToContentEditableReplacement:'<span class="atwho-inserted"><strong data-id="$1" data-type="$2">@$3</strong></span>',_rawToTextAreaReplacement:'$1<span class="atwho-inserted"><strong data-id="$3" data-type="$4">@$2</strong></span>',_rawToContentEditableRegEx:new RegExp('<a data-id="(.*?)" data-type="(.*?)".*?>(.*?)</a>',"gi"),_rawToTextAreaRegEx:/(^|\s)(?:@((?:.(?!\s@))+))\[(.*?):(.*?)\]/gi,_init:function(){logger.debug("Initializing atwho mentioning for:",this.config.moduleSelector);var n=this,r=new s,d=new l;this.staticData=[],this.config.teamId&&this.staticData.push({id:this.config.teamId,type:"TEAM",name:i["team-mention-name"],description:i["team-mention-description"],iconLetter:i["team-mention-icon-letter"]});var m=this._loadTemplate("#comment-mention-item-template");this.atConfig={at:"@",delay:800,alias:"mention-input-"+c++,data:this.config.dataUrl,displayTpl:m.getTemplate(),insertTpl:'<strong data-id="{{id}}" data-type="{{type}}">{{atwho-at}}{{name}}</strong>',limit:6,callbacks:{highlighter:function(t,e){var n;return e?(n=new RegExp('<span class="name">\\s*('+a.escapeRegExp(e)+")(.*)\\s*</span>","ig"),t.replace(n,function(t,e,n,a){return'<span class="name"> <strong>'+e+"</strong>"+n+"</span>"})):t},filter:function(t,e,n){return[]},remoteFilter:function(e,a){n.currentRequest&&n.currentRequest.abort(),n.currentRequest=t.getJSON(n.config.dataUrl,{query:e},function(o){var s=[];n.staticData.length&&(s=e?n._filter(e,n.staticData,"name"):n.staticData),t.each(o,function(e,n){"USER"===n.type?(n.description=n.username,n.avatar=d.prependContenxtPath(n.avatar)):"CONTRIBUTION"===n.type?(n.description=t.trim(i.format("contribution-mention-author",n.firstname,n.lastname?n.lastname:"")),"IMAGE"===n.mediaType&&(n.avatar=d.buildFullMediaPage(n.avatar))):logger.error(n.type+" type cannot be resolved")}),a(s.concat(o)),t(".mention-item .center-image.js-mention-image").each(function(e,n){r.setImage(t(n),t(n).find("[data-avatar]").data("avatar"))})})},matcher:function(t,e,a,i){var o,r,s=e.replace(String.fromCharCode(160)," ");return r=n._isTextareaMode()?/(?:^|\s)(?:@((?:.(?!.+\[.+:USER\]|.+\[\d+:TEAM\]|.+\[\d+:CONTRIBUTION\]|.+\s@))*))(?:$|\s)/gi:/(?:^|\s)(?:@((?:.(?!\s@))*))(?:$|\s)/gi,o=r.exec(s),o?o[1]:null},tplEval:function(t,n){return e.render(t,n)},beforeInsert:function(e,a){return n.inserting=!0,t.fn.atwho["default"].callbacks.beforeInsert(e,a)}}};var u=this.module.attr("data-raw-value")||"<br>";if(this._isTextareaMode()){this.atConfig.insertTpl="{{atwho-at}}{{name}}[{{id}}:{{type}}]";var p=u.replace(this._rawToContentEditableRegEx,this._textareaMention);this.$.mentionInput.val(a.htmlDecode(p)),this.$.mentionEditable.remove(),this.$.mentionInput.show(),this.$.mentionInput.atwho(this.atConfig)}else this.$.mentionEditable.html(u.replace(this._rawToContentEditableRegEx,this._rawToContentEditableReplacement)),this.$.mentionEditable.atwho(this.atConfig),this.$.mentionEditable.is("[data-placeholder]")&&this._updatePlaceholderState(this.$.mentionEditable[0]);this.charLimitCounter=new o(this)},_isTextareaMode:function(){return this.$.mentionInput.length>0},_loadTemplate:function(t){return new r({selectors:{template:t}})},getMentionText:function(){return this._isTextareaMode()?this.$.mentionInput.val().replace(/\r\n/g,"<br>").replace(this._rawToTextAreaRegEx,this._rawToTextAreaReplacement)+"<br>":this.$.mentionEditable.html()},getMentionInput:function(){return this._isTextareaMode()?this.$.mentionInput:this.$.mentionEditable},_filter:function(t,e,n){var a,i,o,r;for(a=[],i=0,r=e.length;r>i;i++)o=e[i],0===o[n].toLowerCase().indexOf(t.toLowerCase())&&a.push(o);return a},_pasteHtmlAtCaret:function(t){var e,n;if(window.getSelection){if(e=window.getSelection(),e.getRangeAt&&e.rangeCount){n=e.getRangeAt(0),a.isMobileSafari()?n.collapsed||this.document.execCommand("delete"):n.deleteContents();var i=document.createElement("div");i.innerHTML=t;for(var o,r,s=document.createDocumentFragment();o=i.firstChild;)r=s.appendChild(o);n.insertNode(s),r&&(n=n.cloneRange(),n.setStartAfter(r),n.collapse(!0),e.removeAllRanges(),e.addRange(n))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},_updatePlaceholderState:function(t){t.textContent?t.setAttribute("data-div-placeholder-content","true"):t.removeAttribute("data-div-placeholder-content")},_bindEvents:function(){var e=this;this.$.mention.on("change blur",function(){e.$.input.val(e.getMentionText())}),this.module.parsley().subscribe("parsley:field:validate",t.proxy(function(t){t.value=this.charLimitCounter._getValue()||"<br>"},this)),this.$.mentionEditable.on("paste",function(n){n.originalEvent&&(n=n.originalEvent),n.preventDefault();var a;n.clipboardData?a=t("<div></div>").text(n.clipboardData.getData("text/plain")).html():window.clipboardData&&(a=window.clipboardData.getData("Text")),e._pasteHtmlAtCaret(a)}),this.$.mentionEditable.on("keydown",function(t){a.inArray([d.ENTER,d.SPACE,d.BS,d.DEL],a.getKeyCode(t))&&a.repaint(e.$.mentionEditable),a.getKeyCode(t)==d.ENTER&&(e.inserting||(t.preventDefault(),e._pasteHtmlAtCaret("<br>"))),e.inserting=!1}),this.$.mentionEditable.is("[data-placeholder]")&&this.$.mentionEditable.on("change.mention-input",function(){e._updatePlaceholderState(this)}),this.$.mentionEditable.on("focus",function(){var e=t(this);return e.data("before",e.html()),e}).on("blur keyup paste input",function(){var e=t(this);return e.data("before")!==e.html()&&(e.data("before",e.html()),e.trigger("change.mention-input")),e}),this.$.mentionInput.on("keyup paste input blur",function(){t(this).trigger("change.mention-input")}),this.$.mentionEditable.on("focus click",function(t){if(!this.textContent)try{var e=document.createRange();e.selectNodeContents(this),e.collapse(!0);var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}catch(t){logger.warn("Failed to move cursor to start")}})}});return m});
define("rwd/common/number-field",["jquery","rwd/common/base-ui-module","rwd/common/utils","rwd/common/clipboard"],function(e,n,t,i){var r="js-integer-field",s=n.extend({baseConfig:{selectors:{numberInputs:'input[type="number"]'},useModuleAsParent:!0},_init:function(){t.removeParsleyConstraints(this.$.numberInputs,["type"])},_handleNumberFieldKeypress:function(n){var t=window.event?n.keyCode:n.which,i=this._allowFloatingPoint(n);if(48>t||t>57)if(!i||44!==t&&46!==t)0==t||8==t||13==t||n.ctrlKey||n.preventDefault();else{var r=String(e(n.target).val());(this._hasFloatingPoint(r)||0===r.length)&&n.preventDefault()}},_handlePasteEvent:function(n){var t=i.getInstance().getClipboardData(n),r=this._hasFloatingPoint(t),s=e(n.currentTarget).val(),o=this._hasFloatingPoint(s),a=this._allowFloatingPoint(n);(!e.isNumeric(t)||!a&&r||o&&r)&&n.preventDefault()},_allowFloatingPoint:function(n){return!e(n.currentTarget).hasClass(r)},_hasFloatingPoint:function(e){return e&&(e.indexOf(".")>0||e.indexOf(",")>0)},_bindEvents:function(){this.$.numberInputs.on("keypress",e.proxy(this._handleNumberFieldKeypress,this)),this.$.numberInputs.on("paste",e.proxy(this._handlePasteEvent,this))}});return s});
define("rwd/common/overlay",["jquery","rwd/common/base-ui-module","rwd/common/feature-detection"],function(n,s,o){var i=s.extend({baseConfig:{selectors:{body:"body"},onClick:function(n){},additionalClass:""},showOverlayClass:"on",construct:function(n){this._super(n)},_init:function(){this.overlayInstance=n('<div class="overlay"></div>')},open:function(){this.$.body.append(this.overlayInstance),this.overlayInstance.addClass(this.showOverlayClass).addClass(this.config.additionalClass),this.overlayInstance.click(this.config.onClick)},hasTransition:function(){return o.cssTransition()&&parseFloat(this.overlayInstance.css("opacity"))>0},close:function(){this.overlayInstance.removeClass(this.showOverlayClass).removeClass(this.config.additionalClass),this.hasTransition()?this.overlayInstance.one("transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd",n.proxy(function(n){n.currentTarget===this.overlayInstance[0]&&this.overlayInstance.remove()},this)):this.overlayInstance.remove()}});return i});
define("rwd/common/paged-table",["jquery","rwd/common/base-ui-module","rwd/common/paginator","rwd/common/loading-indicator"],function(t,e,a,i){var n=e.extend({baseConfig:{selectors:{tableContainer:".js-table-container",paginatorContainer:".js-paginator-container"},pageSize:50,moduleSelector:".paged-table",useModuleAsParent:!0},search:function(t,e){this._loadTable(e||1,t)},_init:function(){logger.debug("Init table component "),this.paginatorSelector=this.config.moduleSelector+" .item-search-result-paginator",this.loadTableUrl=this.module.attr("data-url")},_loadTable:function(e,a){a.activePage=e,this._loadTableContent(this.loadTableUrl,a).then(t.proxy(function(i){var n=t(i),o=this._getTotalItems(n);this.$.tableContainer.html(n),o>this.config.pageSize?this._loadPaginator(a,o):this.$.paginatorContainer.empty(),this.config.listeners&&this.config.listeners.loaded&&this.config.listeners.loaded(this._getLoadedListenerData(n)||0,e)},this)).fail(t.proxy(function(){this.config.listeners&&this.config.listeners.failed&&this.config.listeners.failed()},this))},_getLoadedListenerData:function(t){return this._getTotalItems(t)},_getTotalItems:function(t){return t.attr("data-total-items")},_loadPaginator:function(e,n){var o=this;this._loadPaginatorContent(e.activePage,n).then(t.proxy(function(t){this.$.paginatorContainer.html(t),new a({moduleSelector:this.paginatorSelector,pageSelectionListener:function(t){o._loadTable(t,e)}}),i.initialize({selectors:{busyButton:this.paginatorSelector+" .loading-indicator"}})},this))},_loadTableContent:function(e,a){var i=new t.Deferred;return t.ajax({url:e,type:"POST",data:a,dataType:"html",traditional:!0,success:function(t){i.resolve(t)},error:function(t,e,a){i.reject([t,e,a])}}),i},_loadPaginatorContent:function(e,a){return t.get("/template/manage-list/paginator",{activePage:e,pageSize:this.config.pageSize,totalItems:a})},empty:function(){this.$.tableContainer.empty(),this.$.paginatorContainer.empty()}});return n});
define("rwd/common/paginator",["jquery","rwd/common/base-ui-module"],function(t,i){var e=i.extend({baseConfig:{PAGINATOR_SIZE_ATTR_NAME:"data-paginator-size",PAGE_PARAMETER_ATTR_NAME:"data-page-parameter",URL_PARAMETER_ATTR_NAME:"data-list-url",URL_ADDITIONAL_PARAMETERS_ATTR_NAME:"data-list-additional-params",DEFAULT_PAGE_PARAMETER:"page",DEFAULT_LIST_URL:"",DEFAULT_PARAMS:"",useModuleAsParent:!0,selectors:{goToFirst:".control-first",stepToPrevious:".control-previous",stepToNext:".control-next",goToLast:".control-last",paginatorBoxes:".boxes"},moduleSelector:".paginator",paginatorSize:6,pageCountClass:".js-page-count",pageActiveIndexClass:".js-page-active-index",pageSelectionListener:void 0},construct:function(t){this._super(t)},getPaginatorSize:function(t){var i=this.findPaginator(t),e=parseInt(i.attr(this.config.PAGINATOR_SIZE_ATTR_NAME));return e||this.config.paginatorSize},getUrlConfig:function(t){var i=this.findPaginator(t),e=i.attr(this.config.PAGE_PARAMETER_ATTR_NAME)||this.config.DEFAULT_PAGE_PARAMETER,a=i.attr(this.config.URL_ADDITIONAL_PARAMETERS_ATTR_NAME)||this.config.DEFAULT_PARAMS,n=i.attr(this.config.URL_PARAMETER_ATTR_NAME)||this.config.DEFAULT_PAGE_PARAMETER,o={param:e,url:n,extraParams:a?"&"+a:""};return o},goToFirst:function(t){var i=this.getUrlConfig(t);this.updatePaginatorBoxes(this.findPaginatorBoxesForEvent(t),1,i),this.updateActive(t)},stepToPrevious:function(t){var i=this.findPaginatorBoxesForEvent(t),e=this.getPaginatorSize(t),a=this.getUrlConfig(t);if(this.getPageNumber(i.first())>e)this.updatePaginatorBoxes(i,this.getPageNumber(i.first())-e,a);else{var n=this.getPageNumber(i.first())-1;this.updatePaginatorBoxes(i,this.getPageNumber(i.first())-n,a)}this.updateActive(t)},stepToNext:function(t){var i=this.findPaginatorBoxesForEvent(t),e=this.getPaginatorSize(t),a=this.getUrlConfig(t);if(this.getPageNumber(i.last())+e<parseInt(this.findPaginatorPageCount(t)))this.updatePaginatorBoxes(i,this.getPageNumber(i.last())+1,a);else{var n=this.findPaginatorPageCount(t)-this.getPageNumber(i.last());this.updatePaginatorBoxes(i,this.getPageNumber(i.first())+n,a)}this.updateActive(t)},goToLast:function(t){var i=this.findPaginatorPageCount(t),e=this.getPaginatorSize(t),a=this.getUrlConfig(t);this.updatePaginatorBoxes(this.findPaginatorBoxesForEvent(t),i-e+1,a),this.updateActive(t)},updatePaginatorBoxes:function(i,e,a){var n=a||{url:this.config.DEFAULT_LIST_URL,param:this.config.DEFAULT_PAGE_PARAMETER};i.each(function(i){$this=t(this);var a=e+i,o=a>9999?Math.max(0,a).toFixed(0).replace(/(?=(?:\d{3})+$)(?!^)/g," "):a;$this.attr("href",n.url+"?"+n.param+"="+a+n.extraParams),$this.find(".page-number").text(o)})},findPaginator:function(i){return t(i.currentTarget).closest(".paginator")},findPaginatorBoxesForEvent:function(t){return this.findPaginator(t).find(".boxes > a")},findPaginatorPageCount:function(t){return parseInt(this.findPaginator(t).find(this.config.pageCountClass).text())},updateActive:function(i){var e=this.findPaginator(i),a=parseInt(e.attr("data-active-index"));e.find(".boxes > a").removeClass("active loading-area-inactive");var n=this;this.findPaginatorBoxesForEvent(i).filter(function(){return n.getPageNumber(t(this))===a}).addClass("active loading-area-inactive")},getIndexForSelectedPage:function(i){var e=t(i.currentTarget);return e.hasClass("active")?void 0:e.find(".page-number").text().replace(/ /g,"")},getPageNumber:function(t){return parseInt(t.find(".page-number").text().replace(/ /g,""))},_bindEvents:function(){if(this.$.goToFirst.click(t.proxy(this.goToFirst,this)),this.$.stepToPrevious.click(t.proxy(this.stepToPrevious,this)),this.$.stepToNext.click(t.proxy(this.stepToNext,this)),this.$.goToLast.click(t.proxy(this.goToLast,this)),this.config.pageSelectionListener){var i=this.config.pageSelectionListener;this.$.paginatorBoxes.on("click","a",t.proxy(function(t){t.stopPropagation(),t.preventDefault();var e=this.getIndexForSelectedPage(t);e&&i(e)},this))}}});return e});
define("rwd/common/pickadate-initializer",["jquery","rwd/common/base-ui-module","rwd/common/utils","rwd/common/direction-util"],function(e,i,t,a){var n=i.extend({_init:function(){if("ar"==t.getLang()){var i=t.getLang();e.extend(e.fn.pickadate.defaults,PickadateI18N[i].pickadate),e.extend(e.fn.pickatime.defaults,PickadateI18N[i].pickatime)}this._super()}});return n});
define("rwd/common/rich-text",["jquery","rwd/common/base-ui-module","rwd/common/image-load","rwd/common/breakpointdetection","rwd/common/rich-text-image","rwd/common/breakpoint-imager"],function(e,i,t,n,a,o){var c=i.extend({baseConfig:{moduleSelector:".js-rich-text",imageSelector:'.js-rich-text img:not([class="image-replace"])',inlineImageSelector:'.js-rich-text img.inline:not([class="image-replace"])'},construct:function(e){this.breakpointDetection=n.getInstance(),this.richTextImage=a.getInstance(),this._super(e)},_init:function(){logger.debug("Initializing rich text..."),this.imageLoader=new t({selectors:{images:this.config.imageSelector}});var e=n.getInstance().getBreakpointImageSizePairs();new o({moduleSelector:this.config.moduleSelector,imageWidth:e}),this._initInlineAndBlockImages()},_initBlockImage:function(e){logger.debug("Found block image",e),this.richTextImage.setImageContainer(e,"block")},_initInlineImage:function(e){logger.debug("Found inline image",e),e.addClass("inline"),this.richTextImage.setImageContainer(e,"inline"),this.breakpointDetection.isBlockImageStyle()||1==e.width()||this.richTextImage.updateImageContainerMaxWidth(e)},_initInlineAndBlockImages:function(){var i=this;this.imageLoader.loadImages().then(function(){e(i.config.imageSelector).each(function(t,n){var a=e(n);a.is(".inline")&&1!=a.width()?i._initInlineImage(a):i.breakpointDetection.isBlockImageStyle()?i._initBlockImage(a):i.imageLoader.naturalWidth(a).then(function(e){e<=i.richTextImage.INLINE_IMAGE_MAX_WIDTH?i._initInlineImage(a):i._initBlockImage(a)})})})},_bindEvents:function(){this.richTextImage.bindImageEvents(e(this.config.imageSelector))}});return c});
define("rwd/common/rich-text-editor-util",["jquery"],function(e){var t=".rte-field";return{getRTEFieldSelector:function(){return t},hasRTEFields:function(){return e(t).length}}});
define("rwd/common/rich-text-image",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/common/image-load","rwd/common/utils"],function(n,t,i,e,a){var o=t.extend({baseConfig:{inlineImageContainerClasses:".inline-image-container, .caption-container",captionContainerClass:".caption-container",inlineImageContainerClass:".inline-image-container",richText:".rich-text"},INLINE_IMAGE_MAX_WIDTH:370,INLINE_IMAGE_MAX_WIDTH_FOR_MOBILE:290,INLINE_IMAGE_CONTAINER_STYLE:"inline-image-container distance-margin-right distance-margin-bottom distance-margin-top",BLOCK_IMAGE_CONTAINER_STYLE:"block-image-container distance-margin-top distance-margin-bottom",_init:function(){this.breakpointDetection=i.getInstance(),this.imageLoader=new e},setImageContainer:function(n,t){var i=this._findCaptionContainer(n);n.closest("p, div").removeAttr("style");var e,o,s,r=n.closest('[class*="-image-container"]');i.length?(e=r.length?r:i.parent(),i.css({"max-width":Math.min(e.width(),n.width())}),o=i,i.removeClass(this.INLINE_IMAGE_CONTAINER_STYLE)):(o=n,e=r.length?r:n.parent());var c="inline"===t?this.INLINE_IMAGE_CONTAINER_STYLE:this.BLOCK_IMAGE_CONTAINER_STYLE;this.isSuitableForImageContainer(e)?(e.is('[class*="-image-container"]')||e.addClass(c),this.setContentEdiatable(e)):(e.removeClass(c),this.clearContentEdiatable(e),e.is("p")&&o.unwrap(),s=o.parents("span.f-img-wrap"),s.length>0&&(o=s),o.wrap('<div class="'+c+'"></div>')),a.repaint(n.closest(this.config.richText))},isSuitableForImageContainer:function(t){return t.is("div")&&1===t.children().length&&0===n.trim(t.contents().text()).length},updateImageContainerMaxWidth:function(n,t){var i=this._findInlineImageContainer(n),e=!t&&this.breakpointDetection.isDesktopLayout();i.removeAttr("style"),("undefined"!=typeof t&&!t||i.is(this.config.captionContainerClass))&&(i.css({"max-width":Math.min(n.width(),e?this.INLINE_IMAGE_MAX_WIDTH:this.INLINE_IMAGE_MAX_WIDTH_FOR_MOBILE)}),logger.debug("Image container max-width set to:",i.css("max-width")))},setContentEdiatable:function(n){},clearContentEdiatable:function(n){},clearMaxWidth:function(n){var t=this._findCaptionContainer(n);if(!t.length){var i=this._findInlineImageContainer(n);i.removeAttr("style")}},_findCaptionContainer:function(n){return n.closest(this.config.captionContainerClass)},_findInlineImageContainer:function(n){return n.closest(this.config.inlineImageContainerClasses)},_bindInlineImageEvents:function(t,i){var e=this;t.filter(".inline").each(function(t,a){n(a).bind("load",function(){e.updateImageContainerMaxWidth(n(a),i)})}),e.breakpointDetection.listenLayoutChange(function(a){t.filter(".inline").each(function(t,a){e.updateImageContainerMaxWidth(n(a),i)})}),e.breakpointDetection.listenImageStyleChange(function(a,o){t.filter(".inline").each(function(t,a){"block"===o?e.clearMaxWidth(n(a)):e.updateImageContainerMaxWidth(n(a),i)})})},_handleBreakpointChange:function(t){var i=this;t.each(function(t,e){var a=n(e),o=i._findCaptionContainer(a);if(o.length){var s=o.parent();i.imageLoader.naturalWidth(a).then(function(n){n>s.width()&&o.css({"max-width":s.width()})})}})},bindImageEvents:function(t,i){this._bindInlineImageEvents(t,i),this.breakpointDetection.listen(n.proxy(function(){this._handleBreakpointChange(t)},this))}});return{instance:void 0,getInstance:function(){return this.instance||(logger.debug("Initializing RichTextImage"),this.instance=new o),this.instance}}});
define("rwd/common/slider",["jquery","rwd/common/base-ui-module"],function(e,s){var t=s.extend({baseConfig:{selectors:{sliderContainer:".slider-container",link:".slide"},aboveOverlay:!1},openedStateClass:"opened",aboveOverlayClass:"above-overlay",construct:function(e){this._super(e)},_init:function(){this.$.sliderContainer.show()},close:function(){this.$.sliderContainer.removeClass(this.openedStateClass),this._toggleAboveOverlay()},open:function(){this.$.sliderContainer.addClass(this.openedStateClass),this._toggleAboveOverlay()},_toggleAboveOverlay:function(){this.config.aboveOverlay===!0&&this.$.sliderContainer.toggleClass(this.aboveOverlayClass)},isOpen:function(){return this.$.sliderContainer.hasClass(this.openedStateClass)},_bindEvents:function(){this.$.link.click(e.proxy(function(e){e.preventDefault(),this.$.sliderContainer.toggleClass(this.openedStateClass),this.config.aboveOverlay===!0&&this.$.sliderContainer.toggleClass(this.aboveOverlayClass)},this))}});return t});
define("rwd/common/smooth-scroll",["jquery","rwd/common/feature-detection"],function(n,o){"use strict";function t(o,t,r){logger.trace("scrolling with transition");var i=n(window).scrollTop()-o;return 0===i?void r.resolve():(n("html").css({"margin-top":i+"px"}).addClass("scrolling"),void n("html").on("transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd",function(i){return i.target===i.currentTarget&&n(this).hasClass("scrolling")===!0?(n(this).removeAttr("style").removeClass("scrolling"),n("html, body").scrollTop(o+t),n("html").off("transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd"),void r.resolve()):void 0}))}function r(o,t){logger.trace("scrolling with jquery animate"),n("html, body").animate({scrollTop:o},175,function(){t.resolve()})}function i(i){var e,s,l=new n.Deferred;if(i.length){var e,s;e=i.offset().top;var a=n(document).height()-n(window).height();e>a?(e=a,s=i.height()):s=0,o.cssTransition()?t(e,s,l):r(e,l)}else l.fail();return l.promise()}return{scrollTo:i}});
define("rwd/common/sticky-toolbar",["jquery","rwd/common/base-ui-module","rwd/common/utils","rwd/common/feature-detection"],function(t,o,s,i){var r=o.extend({baseConfig:{selectors:{toolbar:".toolbar",toolbarContainer:".toolbar-container",toolbarOwner:".toolbar-owner",input:".toolbar input"}},_init:function(){this.$.window=t(window),this.$.toolbarOwner.data("padding-top",parseInt(this.$.toolbarOwner.css("padding-top"),10))},refreshToolbarPosition:function(){this.$.window.scrollTop()>this.$.toolbarContainer.offset().top&&this.$.window.scrollTop()<this._calculateContainerOffset()?(this.$.toolbarOwner.css("padding-top",this._calculatePaddingTop()),this.$.toolbar.addClass("fixed-scroll").removeClass("fixed-scroll-abs").css("bottom","").css("left",this._calculateOffsetLeft()).width(this._calculateWidth()),s.isMobileSafari()&&(this.$.input.is(":focus")?this.$.toolbar.css("top",this.$.window.scrollTop()):this.$.toolbar.css("top",""))):this.$.window.scrollTop()<this.$.toolbarContainer.offset().top?s.isMobileSafari()&&this.$.input.is(":focus")?(this.$.toolbarOwner.css("padding-top",this._calculatePaddingTop()),this.$.toolbar.addClass("fixed-scroll").removeClass("fixed-scroll-abs").css("bottom","").css("left",this._calculateOffsetLeft()).width(this._calculateWidth()),this.$.toolbar.css("top",this.$.toolbarContainer.offset().top)):(this.$.toolbar.removeClass("fixed-scroll fixed-scroll-abs").css("bottom","").css("top","").width(""),this.$.toolbarOwner.css("padding-top","")):this.$.window.scrollTop()>this._calculateContainerOffset()&&!this.$.toolbar.hasClass("fixed-scroll-abs")&&(this.$.toolbarOwner.css("padding-top",this._calculatePaddingTop()),this.$.toolbar.removeClass("fixed-scroll").addClass("fixed-scroll-abs"),this.$.toolbar.css("bottom","").css("top","").css("left",""))},_calculatePaddingTop:function(){return this.$.toolbar.outerHeight()+this.$.toolbarOwner.data("padding-top")},_calculateOffsetLeft:function(){return this.$.toolbarContainer.offset().left+parseFloat(this.$.toolbarContainer.css("padding-left"),10)-this.$.window.scrollLeft()},_calculateWidth:function(){return this.$.toolbarContainer.width()-parseFloat(this.$.toolbar.css("border-left-width"),10)-parseFloat(this.$.toolbar.css("border-right-width"),10)},_calculateContainerOffset:function(){return this.$.toolbarContainer.offset().top+this.$.toolbarContainer.outerHeight()-this.$.toolbar.outerHeight()},_scrollToContainerTop:function(){this.$.toolbarContainer[0].scrollIntoView(!0),setTimeout(t.proxy(function(){this.$.toolbarContainer[0].scrollIntoView(!0),this.refreshToolbarPosition()},this),100)},_bindEvents:function(){this.$.window.on("scroll resize orientationchange",t.proxy(function(){this.refreshToolbarPosition()},this)),i.touchEventSupport()&&this.$.input.on("focus select",t.proxy(function(t){this._scrollToContainerTop()},this)),s.isMobileSafari()&&this.$.input.on("blur",t.proxy(function(t){this.refreshToolbarPosition()},this))}});return r});
define("rwd/common/utils",["jquery","rwd/common/csrf"],function(t,e){"use strict";return{getKeyCode:function(t){return null==t?event.keyCode:t.which},htmlEscape:function(e){return t("<div/>").text(e.toString()).html()},htmlDecode:function(e){return t("<div/>").html(e.toString()).text()},escapeRegExp:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},getUserPhoto:function(e){var n=t("body").data("context-root");return n+"profiles/"+e.username+"/photo?type=SMALL"},getUploadResult:function(e){return"string"==typeof e.result?e.result:t("pre",e.result).text()},repaint:function(t){t.css("float","left"),setTimeout(function(){t.css("float","")},1)},repaintWithClass:function(t){var e="temporary-repaint-class";t.addClass(e),setTimeout(function(){t.removeClass(e)},5)},getCoordinateFor:function(t){var e={x:0,y:0};if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];e.x=n.pageX,e.y=n.pageY}else e.x=t.pageX,e.y=t.pageY;return e},removeParsleyConstraints:function(e,n){e.each(function(){var e=t(this).parsley();t.each(n,function(t,n){e.removeConstraint(n)}),e.refreshConstraints=function(){}})},isMobileSafari:function(){return/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1},postLink:function(n){var r=t("<input>");r.attr("type","hidden"),r.attr("name",e.getInstance().getParam()),r.attr("value",e.getInstance().getToken());var o=t("<form></form>");o.attr("method","POST"),o.attr("action",n),o.append(r),o.appendTo("body").submit()},getISODateFromDateInput:function(t){return this.hasPicker(t)?t.pickadate("picker").get("select","yyyy-mm-dd"):t.val()},hasPicker:function(t){return t.is(".picker__input")},getISODateFromDate:function(t){var e=this._fixDate(t.getDate()),n=this._fixDate(t.getMonth()+1),r=t.getFullYear();return r+"-"+n+"-"+e},_fixDate:function(t){return t>=10?t:"0"+t},isAndroidBrowser:function(){return navigator.userAgent.toLowerCase().indexOf("android")>=0},pushUniqueToArray:function(t,e){this.inArray(t,e)||t.push(e)},inArray:function(e,n){return!(-1===t.inArray(n,e))},splitList:function(t){return t?t.split(","):[]},removeFromArray:function(e,n){return t.grep(e,function(t){return t!==n})},subtractArray:function(e,n){return t.grep(e,function(t){return!this.inArray(n,t)}.bind(this))},containsIgnoreCase:function(t,e){return-1!==this.indexOfIgnoreCase(t,e)},equalsIgnoreCase:function(t,e){return t.toLowerCase()===e.toLowerCase()},indexOfIgnoreCase:function(t,e){if(!t)return-1;for(var n=0;n<t.length;n++)if(this.equalsIgnoreCase(e,t[n]))return n;return-1},accumulate:function(t,e){return t+e},checkCheckbox:function(e,n){e&&(e.checked=n,t(e).change())},createHiddenInputField:function(e,n){var r=t("<input>");return r.attr("type","hidden"),r.attr("name",e),r.attr("value",n),r},createPostForm:function(n){var r=t("<form></form>");r.attr("method","POST"),r.attr("action",n),r.append(this.createHiddenInputField(e.getInstance().getParam(),e.getInstance().getToken()));var o=this;return{append:function(t,e){r.append(o.createHiddenInputField(t,e))},submit:function(){r.appendTo("body").submit()}}},postForm:function(e,n){var r=this.createPostForm(e);t.each(n,function(t,e){r.append(t,e)}),r.submit()},setHashParameters:function(e){var n=this.parseHashParameters();t.each(e,function(t,e){n[e.name]=e.value});var r=[],o=!1;t.each(n,function(t,e){return"admin-section"==t?void(o=!0):void r.push(e?t+"="+e.toLowerCase():t)}),o&&r.unshift("!admin-section"),window.location.hash=r.join("&")},parseHashParameters:function(t){var t=t||window.location.hash,e=t.replace(/(^\#!?)/,"");return e?e.split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]:{}},removeDropdownOptionsExceptFirst:function(t){t.find("option:gt(0)").remove()},convertToCamelCase:function(t){return t.replace("_"," ").replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}).replace(" ","")},convertToCamelCaseLowerStart:function(t){var e=this.convertToCamelCase(t);return e.charAt(0).toLowerCase()+e.substr(1)},getLang:function(){var e=t("html").attr("lang");return void 0!=e&&e.length>0?e:"en"},formatMessage:function(t){if(!t)return logger.warn("Empty message was provided!"),"";var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})},hexToRgb:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,n,r){return e+e+n+n+r+r});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null},setCookie:function(t,e,n){var r=new Date;r.setTime(r.getTime()+60*n*1e3);var o="expires="+r.toUTCString();document.cookie=t+"="+e+"; "+o+"; path=/"},getCookie:function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}},floor:function(t,e){var n=Math.pow(10,e),r=t*n,o=Math.floor(r);return o/n},setUrlHash:function(e){var n="#!admin-section";window.location.hash=n+(n.length?"&":"")+t.param(e)},isOpera:function(){return!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0},isChrome:function(){return!!window.chrome&&!!window.chrome.webstore},isFirefox:function(){return"undefined"!=typeof InstallTrigger},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0},isIE:function(){return!!document.documentMode},isEdge:function(){return!isIE()&&!!window.StyleMedia}}});
define("rwd/unconstrained-result",["jquery","rwd/common/base-ui-module","rwd/common/loading-indicator","rwd/common/paginator","rwd/common/centered-imager","rwd/common/breakpointdetection"],function(t,e,a,n,i,r){var o=e.extend({baseConfig:{selectors:{answerContainer:".answers",paginatorContainer:".answer-paginator",errorContainer:".js-error-container"},pageSize:5,moduleSelector:".unconstrained-result",useModuleAsParent:!0},_init:function(){var t=r.getInstance().getGeneralThumbnailWidths();this.centeredImager=new i({imageWidth:t}),this.loadUrl=this.module.attr("data-load-url"),this.paginatorSelector=this.config.moduleSelector+" .item-search-result-paginator",this.imageSelector=this.config.moduleSelector+" img[data-src]",this._load(1)},_load:function(e){this._loadAnswers(e).then(t.proxy(function(t){var a=this._getTotalItems(t);this.$.errorContainer.removeClass("error"),this.$.answerContainer.html(t.children()),this.centeredImager.initImages(this.imageSelector),a>this.config.pageSize?this._loadPaginator(e,a):this.$.paginatorContainer.empty()},this)).fail(t.proxy(function(){this.$.paginatorContainer.empty(),this.$.answerContainer.empty(),this.$.errorContainer.addClass("error")},this))},_getTotalItems:function(t){return t.attr("data-total-items")},_loadPaginator:function(e,i){t.get("/template/manage-list/paginator",{activePage:e,pageSize:this.config.pageSize,totalItems:i}).then(t.proxy(function(e){var i=this,r=t(e);r.addClass("distance-margin-bottom"),this.$.paginatorContainer.html(r),new n({moduleSelector:this.paginatorSelector,pageSelectionListener:function(t){i._load(t)}}),a.initialize({selectors:{busyButton:this.paginatorSelector+" .loading-indicator"}})},this)).fail(function(){logger.error("Failed to load paginator template")})},_loadAnswers:function(e){var a=new t.Deferred,n={activePage:e};return t.ajax({url:this.loadUrl,data:n,traditional:!0,dataType:"html"}).then(function(e){a.resolve(t(e))}).fail(function(t,e,n){a.reject([t,e,n])}),a}});return o});
define("rwd/filter/abstract-contribution-filter-manager",["jquery","rwd/abstract-filter-manager","rwd/common/i18n","rwd/common/utils","rwd/common/smooth-scroll","rwd/common/template"],function(e,t,i,n,r,o){var d="filter",a="search",s=" ",l="data-level",c="data-type",h=t.extend({_loadTemplate:function(e){return new o({selectors:{template:e}})},_init:function(){this._super(),this.dropdownTemplate=this._loadTemplate("#advanced-dropdown-template"),this.optionTemplate=this._loadTemplate("#advanced-dropdown-option-template"),this.advancedDropdowns=[],this.getAdvancedFilterOptionsUrl=this.module.attr("data-get-advanced-filter-options-url"),this.hashConfig=n.parseHashParameters(),this.hashConfig&&this.hashConfig.action?(logger.debug("Detected filter config in URL: ",this.hashConfig),this.hashConfig.action===d?this._initFilterWithAdvanced(this.hashConfig):this.hashConfig.action===a?(this.$.searchItemInputfield.val(decodeURIComponent(this.hashConfig.text)),this._initFilterWithSearch()):logger.warn("Filter action not recognized: "+this.hashConfig.action)):this._initSelectedFilter()},_showFilterError:function(){this.$.advancedFilterError.addClass("error"),r.scrollTo(this.module)},_hideFilterError:function(){this.$.advancedFilterError.removeClass("error")},_initFilterWithAdvanced:function(e){this._selectFilterOption(this.$.optionAdvancedFilter),this._isQuestionType(e.type)?this._loadAdvancedFilterLevelOne(e.type||s).then(this._loadAdvancedFilterLevelTwo.bind(this,e.question||s)).then(this._loadAdvancedFilterLevelThree.bind(this,e.answer||s)).then(this._filterTableByAdvanced.bind(this,!0)).fail(this._showFilterError.bind(this)):this._loadAdvancedFilterLevelOne(e.type||s).then(this._loadAdvancedFilterLevelTwo.bind(this,e[e.type]||s)).then(this._filterTableByAdvanced.bind(this,!0)).fail(this._showFilterError.bind(this))},_reduceAdvancedFilterTo:function(e){for(var t=this.advancedDropdowns.length;t--;)t>=e&&(this.advancedDropdowns[t].parent().parent().remove(),this.advancedDropdowns.splice(t,1))},_hideAdvancedFilter:function(){this._hideFilterError(),this.$.advancedFilterForm.hide()},_getAdvancedFilterConfigForHash:function(){var t=this.advancedDropdowns[0].find("option:selected").attr("data-type");return e.extend({},{action:d,type:t,question:this._isQuestionType(t)?this.advancedDropdowns[1].val():void 0,answer:this._isQuestionType(t)?this.advancedDropdowns[2].val():void 0,mission:"mission"===t?this.advancedDropdowns[1].val():void 0,group:"group"===t?this.advancedDropdowns[1].val():void 0,tag:"tag"===t?this.advancedDropdowns[1].val():void 0,visibility:"visibility"===t?this.advancedDropdowns[1].val():void 0})},_getSearchFilterConfig:function(){return{action:a,text:encodeURIComponent(this.searchTerm)}},getHashConfig:function(){return this.hashConfig},_clearFilterUrl:function(){this.hashConfig={},this.config.listeners.updateHashConfig()},_updateFilterUrl:function(e){this.hashConfig=e,this.config.listeners.updateHashConfig()},_selectFilterOption:function(e){this._super(e),e.hasClass("js-filter-advanced")||this._hideAdvancedFilter()},_triggerFilterBySearchStringEvent:function(t){this._super(t),e.trim(this.$.searchItemInputfield.val())&&!t&&this._updateFilterUrl(this._getSearchFilterConfig())},_isNoopOptionSelectedInAdvancedFilter:function(){return"undefined"!=typeof this._getCurrentLevelOfAdvancedDropdown()&&this._getCurrentLevelOfAdvancedDropdown().children('option[data-noop-option="true"]').is(":selected")},_renderNextLevelDropdown:function(){var t=e(this.dropdownTemplate.render({level:this.advancedDropdowns.length}));this.$.advancedFilterForm.append(t);var i=t.find("select");i.customSelect({customClass:"custom-select"}),this.advancedDropdowns.push(i)},_addOptionToCurrentDropdown:function(t){var i=this.optionTemplate.render(t),n=this.advancedDropdowns.length-1;this.advancedDropdowns[n].append(i),window.setTimeout(e.proxy(function(){this.advancedDropdowns[n].trigger("render")},this),20)},_getCurrentLevelOfAdvancedDropdown:function(){return this.advancedDropdowns[this.advancedDropdowns.length-1]},_getAdvancedFilterConfig:function(){var t={};return e.each(this.advancedDropdowns,e.proxy(function(e,i){t["advancedFilterOptions["+e+"].type"]=i.find("option:selected").attr(c),t["advancedFilterOptions["+e+"].id"]=i.val()},this)),t},_getLastCompleteAdvancedFilterConfig:function(){return this.lastCompleteAdvancedFilterConfig},_loadAdvancedDropdownOptions:function(t){var i=e.Deferred();return this._hideFilterError(),this._reduceAdvancedFilterTo(t.currentDropdownIndex),this._isNoopOptionSelectedInAdvancedFilter()?void 0:(this.$.advancedSpinner.trigger("loading"),e.ajax({type:"GET",url:this.getAdvancedFilterOptionsUrl,data:this._getAdvancedFilterConfig(),success:e.proxy(function(n){this._renderNextLevelDropdown();var r=!t.selectedOption;e.each(n.body.optionItems,e.proxy(function(e,i){var n=t.selectedOption===t.getIdentifiyingAttribute(i),o=n||!t.selectedOption&&1==i.defaultSelected;r=r||n,this._renderAdvancedOption(i,o)},this)),r?i.resolve():i.reject()},this),error:function(e,t,n){logger.error("Failed to load advanced options dropdown options."),i.reject()},complete:e.proxy(function(){this.$.advancedSpinner.trigger("restore")},this)}),i)},_renderAdvancedOption:function(e,t){this._addOptionToCurrentDropdown({value:e.value,text:e.text,selected:t,type:e.type,noopOption:e.noop})},_loadAdvancedFilterLevelOne:function(e){return this.selectedFilterOption=this.filters.ADVANCED,this.$.advancedFilterForm.show(),this._loadAdvancedDropdownOptions({currentDropdownIndex:0,selectedOption:e,getIdentifiyingAttribute:function(e){return e.type}})},_loadAdvancedFilterLevelTwo:function(e){return this._loadAdvancedDropdownOptions({currentDropdownIndex:1,selectedOption:e,getIdentifiyingAttribute:function(e){return e.value}})},_loadAdvancedFilterLevelThree:function(e){return this._loadAdvancedDropdownOptions({currentDropdownIndex:2,selectedOption:e,getIdentifiyingAttribute:function(e){return e.value}})},_filterTableByAdvanced:function(e){this._hideFilterError(),this._isNoopOptionSelectedInAdvancedFilter()?this._clearFilterUrl():(!e&&this._updateFilterUrl(this._getAdvancedFilterConfigForHash()),this.activeFilterOption=this.filters.ADVANCED,this.lastCompleteAdvancedFilterConfig=this._getAdvancedFilterConfig(),this.config.listeners.filterByAdvanced(this._getAdvancedFilterConfig(),e))},_onOptionClicked:function(e){this._super(e),this._clearFilterUrl()},_getAdvancedFilterFirstLevelSelectedType:function(){return this.advancedDropdowns[0].find("option:selected").attr(c)},_isQuestionType:function(t){return-1!==e.inArray(t,["community","reviewer","section"])},_onAdvancedFilterChange:function(t){var i=e(t.currentTarget).attr(l);switch(this._clearFilterUrl(),parseInt(i)){case 0:var n=this._getAdvancedFilterFirstLevelSelectedType();this._isQuestionType(n)||!n?this._loadAdvancedFilterLevelTwo():this._loadAdvancedFilterLevelTwo().then(this._filterTableByAdvanced.bind(this));break;case 1:this._isQuestionType(this._getAdvancedFilterFirstLevelSelectedType())?this._loadAdvancedFilterLevelThree():this._filterTableByAdvanced();break;case 2:this._filterTableByAdvanced()}},_bindEvents:function(){this._super(),this.$.optionAdvancedFilter.on("click",e.proxy(function(e){e.preventDefault(),this._loadAdvancedFilterLevelOne()},this)),this.$.advancedFilterForm.on("change","select",e.proxy(function(e){e.preventDefault(),this._onAdvancedFilterChange(e)},this))}});return h});
define("rwd/abstract-filter-manager",["jquery","rwd/common/base-ui-module","rwd/common/utils"],function(t,e,i){var r="data-content-template",n="{0}",o=e.extend({baseConfig:{selectors:{options:"a",optionFilterAll:".js-filter-all",optionFilterAllLabel:".js-filter-all .option"},filters:{ALL:"ALL"},onOptionsClick:function(t){t.preventDefault()},onOptionFilterClick:function(t,e){t.preventDefault()},moduleSelector:".view-filter",useModuleAsParent:!0},getOptionFor:function(t){return this.$["optionFilter"+i.convertToCamelCase(t)]},getOptionLabelFor:function(t){return this.$["optionFilter"+i.convertToCamelCase(t)+"Label"]},_bindEvents:function(){this.$.options.click(this.config.onOptionsClick),t.each(this.config.filters,t.proxy(function(e,i){var r=this.getOptionFor(i);r?r.click(t.proxy(function(t){this.config.onOptionFilterClick(t,i)},this)):logger.info("No selector found for filter: ",i)},this))}}),s=e.extend({superConfig:function(){return{selectors:{searchForm:".search-form",searchItemButton:".search-form .button",searchItemInputfield:'.search-form input[type="search"]',searchButtonForm:".js-search-button-form",searchFreeTextButton:".js-free-text-search-button"},useModuleAsParent:!0}},basicFilters:{ALL:"ALL",SEARCH:"SEARCH"},construct:function(e){this.baseConfig=t.extend(!0,{},this.superConfig(),this.baseConfig),this._super(e)},_init:function(){t.extend(this.filters,this.basicFilters)},_initSelectedFilter:function(){var e=this.module.attr("data-selected-filter-option");return e?(t.each(this.filters,t.proxy(function(t,i){i!==this.filters.SEARCH&&e===i&&(logger.debug("Init filter for: "+i),this._selectFilterOption(this.options.getOptionFor(i)),this._triggerFilterEvent(!0,i))},this)),void(e===this.filters.SEARCH&&(logger.debug("Init filter for search"),this._initFilterWithSearch()))):(logger.debug("Init filter for default all"),this._selectFilterOption(this.$.optionFilterAll),void this._triggerFilterEvent(!0,this.filters.ALL))},_initFilterWithSearch:function(){this._selectFilterOption(this.$.searchFreeTextButton),this._clearAndShowSearchForm(),this._triggerFilterBySearchStringEvent(!0)},_initFilterOptions:function(t){this.options=new o(t)},getSelectedFilterOption:function(){return this.selectedFilterOption},getActiveFilterOption:function(){return this.activeFilterOption},getSearchTerm:function(){return this.searchTerm},_clearAndShowSearchForm:function(){this.$.searchForm.show()},_closeSearchForm:function(){this.$.searchForm.hide()},_getReplacedContentTemplate:function(t,e){return t.attr(r).replace(n,e)},_selectFilterOption:function(t){this.options.$.options.removeClass("active"),t.addClass("active"),t.hasClass("search-button")||this._closeSearchForm()},_triggerFilterEvent:function(t,e){this.searchTerm=void 0,this.selectedFilterOption!==e&&(this.selectedFilterOption=e,this.activeFilterOption=e,this.config.listeners.filter(t,e))},_triggerFilterBySearchStringEvent:function(e){t.trim(this.$.searchItemInputfield.val())&&(this.searchTerm=this.$.searchItemInputfield.val(),this.selectedFilterOption=this.filters.SEARCH,this.activeFilterOption=this.filters.SEARCH,this.config.listeners.filterBySearchString(this.searchTerm,e))},updateCounts:function(e){t.each(this.filters,t.proxy(function(t,r){var n=this.options.getOptionLabelFor(r);n?n.html(this._getReplacedContentTemplate(this.options.getOptionFor(r),e[i.convertToCamelCaseLowerStart(r)])):logger.info("Filter count won't be updated, no label found for: ",r)},this))},_onOptionClicked:function(e){e.preventDefault(),this._selectFilterOption(t(e.currentTarget))},_onOptionFilterClicked:function(t,e){t.preventDefault(),this._triggerFilterEvent(!1,e)},_bindEvents:function(){this.$.searchFreeTextButton.on("click",t.proxy(function(t){t.preventDefault(),this._clearAndShowSearchForm()},this)),this.$.searchItemButton.on("click",t.proxy(function(t){t.preventDefault(),this._triggerFilterBySearchStringEvent()},this)),this.$.searchItemInputfield.bind("keypress",t.proxy(function(t){var e=t.keyCode||t.which;13===e&&(t.preventDefault(),this.$.searchItemButton.click())},this))}});return s});
define("rwd/view-chooser",["jquery","rwd/common/base-ui-module","rwd/common/utils"],function(e,i,t){var s="active",o=i.extend({baseConfig:{selectors:{views:"a",tableView:".table-view",tileView:".tile-view"},listeners:{showTableView:e.noop,showTilesView:e.noop},moduleSelector:".view-chooser",useModuleAsParent:!0},_init:function(){this.views={table:{$:this.$.tableView,HASH_PARAM:"table",onShow:this.config.listeners.showTableView},tile:{$:this.$.tileView,HASH_PARAM:"tile",onShow:this.config.listeners.showTilesView}};var e=t.parseHashParameters().viewType||this.module.attr("data-active");this.hashConfig={viewType:e},this._showView(this.views[e],!0)},getHashConfig:function(){return this.hashConfig},getViewConfig:function(){return{viewType:this.hashConfig.viewType.toUpperCase()}},_updateHash:function(e){this.hashConfig={viewType:e},this.config.listeners.updateHashConfig()},_setActiveState:function(e){this.$.views.removeClass(s),e.addClass(s)},_showView:function(e,i){return e?(this._setActiveState(e.$),!i&&this._updateHash(e.HASH_PARAM),void e.onShow()):void logger.error("Choosen view shouldn't be empty")},_bindEvents:function(){e.each(this.views,e.proxy(function(i,t){t.$.click(e.proxy(function(e){e.preventDefault(),this._showView(t)},this))},this))}});return o});
define("rwd/active-challenges",["jquery","rwd/common/base-ui-module"],function(e,t){var a=t.extend({baseConfig:{selectors:{featuredChallenge:".featured-challenge",fotorama:".fotorama",playVideo:".fotorama__video-play"},moduleSelector:".active-challenges"},construct:function(e,t){this.gallery=e,this._super(t)},_bindEvents:function(){logger.debug("Binding active challenges events");var t=this.gallery.getFotorama();this.$.featuredChallenge.on("click",this.$.playVideo.selector,e.proxy(function(){t.requestFullScreen().playVideo()},this))}});return a});
define("rwd/contribution-list",["jquery","rwd/common/base-ui-module","rwd/common/breakpointdetection"],function(t,i,n){var o=i.extend({baseConfig:{selectors:{contributionText:".contribution-list .listing-text-content",contributionAuthorBox:".contribution-list .author-box-small",contributionAdditionalInfoBox:".contribution-list .additional-info",contributionListItem:".contribution-list .js-contribution-list-item"},moduleSelector:".contribution-list"},construct:function(t){this._super(t)},matchHeights:function(){this.$.contributionText.matchHeight(!0),this.$.contributionAuthorBox.matchHeight(!0),this.$.contributionAdditionalInfoBox.matchHeight(!0),this.$.contributionListItem.matchHeight(!0)},_init:function(){this.breakpointDetection=n.getInstance(),this.breakpointDetection.isDesktopLayout()&&(this.matchHeightInited=!0,this.matchHeights())},_bindEvents:function(){this.breakpointDetection.listenLayoutChange(t.proxy(function(t,i,n,o){"desktop"!==o||this.matchHeightInited||this.matchHeights()},this))}});return o});
define("rwd/top-navigation",["jquery","rwd/common/base-ui-module","rwd/common/slider","rwd/common/breakpointdetection","rwd/common/image-load","rwd/common/rich-text-editor-util","rwd/common/utils","rwd/common/direction-util"],function(t,i,e,s,o,n,h,r){var a=i.extend({baseConfig:{selectors:{menuItems:".header .main-nav>a",more:".header .nav-dropdown>a",logo:".header .logo-container",accountBox:".header .signup,.header .profile",searchBox:".header .search",adminDashboardBox:".header .dashboard",mainMenu:".header .main-nav",subMenu:".header .sub-nav",body:"body",page:".page-container"},moduleSelector:".header",mainSliderContainer:".slider-container.main-container",subSliderContainer:".slider-container.sub-container",openedStateClass:"open"},construct:function(t){this._super(t)},_init:function(){logger.debug("Initializing top navigation"),this.widths={items:[],logo:0,more:0,search:0,account:0,adminDashboard:0,extraPixels:20,window:t(window).width()},this.mainSlider=new e({selectors:{link:this.config.selectors.more,sliderContainer:this.config.mainSliderContainer}}),this.subSlider=new e({selectors:{link:this.config.selectors.more,sliderContainer:this.config.subSliderContainer}}),this.imageLoad=new o({selectors:{images:".logo-container img"}}),this.breakpointDetection=s.getInstance();var i=this;this.breakpointDetection.isDesktopLayout()?(logger.debug("Initializing FontSpy."),this.module.fontSpy({callback:function(e){void 0!=e&&logger.error("FontSpy failed to load font.",e),logger.debug("FontSpy says that font is loaded. Header menu can be rendered now."),i.$.mainMenu.removeClass("offscreen-position"),i.initializeDesktopMenu().always(t.proxy(i.showMenu,i))}})):(this.$.mainMenu.removeClass("offscreen-position"),this.showMenu())},initializeDesktopMenu:function(){logger.debug("Initializing top navigation for desktop mode");var i=t.Deferred();return this.imageLoad.loadImages().then(t.proxy(function(){this.calculateItemWidths(t.proxy(function(){logger.trace("widths:",this.widths),this.doItemSeparation(),this.resizeDropdown(),i.resolve()},this))},this)),i.promise()},calculateItemWidths:function(i){this.$.menuItems.length>0&&this.widths.window===t(this.$.menuItems[0]).outerWidth(!0)?setTimeout(t.proxy(function(){this.calculateItemWidths(i)},this),500):(this.widths.items=[],t.each(this.$.menuItems,t.proxy(function(i,e){this.widths.items.push(t(e).outerWidth(!0))},this)),this.widths.logo=this.$.logo.outerWidth(!0)||0,this.widths.more=this.$.more.outerWidth(!0),this.widths.search=this.$.searchBox.outerWidth(!0),this.widths.account=this.$.accountBox.outerWidth(!0),this.widths.adminDashboard=this.$.adminDashboardBox.outerWidth(!0),i())},itemsToDisplay:function(){var t,i,e,s=this.widths.window-(this.widths.logo+this.widths.search+this.widths.account+this.widths.adminDashboard+this.widths.extraPixels);for(logger.debug("remaining width for the menu:",s),logger.debug("the widths: ",this.widths),e=0;e<this.widths.items.length&&(i=this.widths.items[e],s-i>0);e++)s-=i,t=e,logger.trace("item ",e,":",s);for(;t<this.widths.items.length-1&&s-this.widths.more-1<0;)s+=this.widths.items[t],t--;return logger.debug("last menu item to display: ",t),t},moveItemsFrom:function(i){var e=this.$.menuItems.slice(i).toArray().reverse();this.$.menuItems=this.$.menuItems.slice(0,i),t.each(e,t.proxy(function(i,e){this.$.subMenu.prepend("<li>"+e.outerHTML+"</li>"),t(e).remove()},this))},moveBackItems:function(i){t.each(this.$.subMenu.find("a").slice(0,i),t.proxy(function(i,e){this.$.mainMenu.append(e.outerHTML),t(e).parent().remove()},this)),this.$.menuItems=t(this.config.selectors.menuItems)},doItemSeparation:function(){var t,i=this.$.menuItems.length-1,e=this.widths.items.length;t=this.itemsToDisplay(),(t===e-1||void 0===t)&&this.$.more.hide(),t!==i&&(i>t?(this.moveItemsFrom(t+1),this.$.more.show()):(this.moveBackItems(t-i),e-1===t&&this.$.more.hide()))},resizeDropdown:function(){var i,e=t("li",this.$.subMenu);e.length&&(i=r.isLtr()?this.widths.window-t(e.get(0)).offset().left:t(e.get(0)).extOffset().right,t.each(e,function(s,o){180>i?t(e.get(s)).width(180):i>300?t(e.get(s)).width(300):t(e.get(s)).width(i)}),this.repaint())},closeSlidingMenues:function(){this.breakpointDetection.isDesktopLayout()?(this.mainSlider.close(),this.setHidden(this.$.subMenu),this.subSlider.close()):(this.subSlider.close(),this.setHidden(this.$.mainMenu),this.mainSlider.close()),this.$.more.removeClass(this.config.openedStateClass),this.$.page.off("click touchstart",this.closeOnOutsideClick)},setVisible:function(t){t.removeClass("hidden")},setHidden:function(t){t.addClass("hidden")},showMenu:function(){this.setVisible(this.$.more),this.setVisible(this.$.mainMenu)},repaint:function(){this.$.body.css("float","left"),setTimeout(t.proxy(function(){this.$.body.css("float","")},this),1)},closeOnOutsideClick:function(i){var e=t(i.target),s=e.closest(this.config.moduleSelector).length>0;!(h.getCoordinateFor(i).y>this.module.height())||s&&e.is("a")||(this.$.more.removeClass(this.config.openedStateClass),this.mainSlider.close(),this.subSlider.close(),this.$.page.off("click touchstart",this.closeOnOutsideClick))},registerIframeBodies:function(){var i=this;t("iframe").each(function(){try{i.$.page=i.$.page.add(t(this.contentWindow.document.body))}catch(e){logger.warn("Failed to register iframe body: "+e)}})},_bindEvents:function(){this.breakpointDetection.listenLayoutChange(t.proxy(function(t,i,e,s){logger.trace("Layout changed: ",i,e,s),this.closeSlidingMenues(),"mobile"===s?(this.moveBackItems(this.widths.items.length),this.$.more.show()):(this.initializeDesktopMenu(),this.setVisible(this.$.mainMenu))},this)),this.breakpointDetection.listenFontSizeChange(t.proxy(function(t,i,e,s){logger.trace("Font changed: ",i,e,s),this.breakpointDetection.isDesktopLayout(e)&&(this.moveBackItems(this.widths.items.length),this.initializeDesktopMenu())},this)),t(window).on("resize orientationchange",t.proxy(function(i){this.widths.window=t(window).width(),this.breakpointDetection.isDesktopLayout()&&(this.doItemSeparation(),this.resizeDropdown())},this)),this.$.more.click(t.proxy(function(i){i.preventDefault(),this.setVisible(this.$.subMenu),this.setVisible(this.$.mainMenu),this.$.more.hasClass(this.config.openedStateClass)||this.$.page.on("click touchstart",t.proxy(this.closeOnOutsideClick,this)),this.$.more.toggleClass(this.config.openedStateClass),this.$.more.blur()},this)),n.hasRTEFields()&&require(["rwd/common/rich-text-editor"],t.proxy(function(i){var e=i.getInstance();e.onLoad("top-navigation",t.proxy(this.registerIframeBodies,this))},this))}});return a});
define("rwd/modal-notification-template",["jquery","rwd/notification-template","rwd/modal-notification"],function(n,i,t){var e=i.extend({baseConfig:{selectors:{body:"body"}},idPrefix:"modal-notification-",render:function(i,e,o){this._ensureDataId(i),this._super(i,n.proxy(function(n){this.$.body.append(n)},this));var d={id:"#"+i.id};return e&&(d.onOk=e),o&&(d.onCancel=o),new t(d)}});return e});
define("rwd/modal-notification",["jquery","rwd/notification","rwd/common/overlay"],function(o,n,i){var t=n.extend({baseConfig:{selectors:{notification:".notification-modal",ok:".notification-modal .ok",cancel:".notification-modal .cancel"},onCancel:function(o){o.preventDefault(),this.close()},onOk:function(o){}},overlayClass:"notification-overlay",_init:function(){this.overlay=new i({additionalClass:this.overlayClass}),this.isOpen()&&this.overlay.open()},open:function(){this._super(),this.overlay.open(),this.$.cancel.focus(),o(document).on("keydown",o.proxy(this._handleKeyDown,this))},close:function(){this._super(),this.overlay.close(),o(document).off("keydown",o.proxy(this._handleKeyDown,this))},closeAndRemove:function(){this.close(),this.$.notification.closest(".grid").remove()},_handleKeyDown:function(o){var n=o.keyCode||o.which,i=!!o.shiftKey;9==n&&(o.target!==this.$.cancel[0]?(this.$.cancel.focus(),o.preventDefault()):i&&(this.$.ok.focus(),o.preventDefault())),27==n&&this.close()},_bindEvents:function(){this.$.ok.click(o.proxy(this.config.onOk,this)),this.$.cancel.click(o.proxy(this.config.onCancel,this))}});return t});
define("rwd/showcase/notifications",["jquery","rwd/common/base-ui-module","rwd/notification","rwd/modal-notification"],function(i,o,n,t){var e=o.extend({baseConfig:{selectors:{showInfo:".showcase .info-hidden>a",showError:".showcase .error-hidden>a",showModalNav:".showcase .modal-nav",showModalAlert:".showcase .modal-alert"},moduleSelector:".showcase-notifications-page"},construct:function(i){this._super(i)},_init:function(){this.notifications={},this.notifications.info1=new n({selectors:{notification:".info-visible .notification-info"}}),this.notifications.info2=new n({selectors:{notification:".info-hidden .notification-info"}}),this.notifications.error1=new n({selectors:{notification:".error-visible .notification-error"}}),this.notifications.error2=new n({selectors:{notification:".error-hidden .notification-error"}}),this.notifications.modal=new t({id:"#default",onOk:function(i){logger.info("Default modal notification - ok clicked"),i.preventDefault(),this.close()}}),this.notifications.modalNav=new t({id:"#navigate-away",onCancel:function(i){logger.info("Navigate away modal notification - cancel clicked")},onOk:function(i){logger.info("Navigate away modal notification - ok clicked")}}),this.notifications.modalAlert=new t({id:"#alert",onCancel:function(i){logger.info("Alert modal notification - cancel clicked"),alert("Cancel clicked"),i.preventDefault(),this.close()},onOk:function(i){logger.info("Alert modal notification - ok clicked"),alert("Save clicked"),i.preventDefault(),this.close()}})},_bindEvents:function(){this.$.showInfo.click(i.proxy(function(i){i.preventDefault(),this.notifications.info2.open()},this)),this.$.showError.click(i.proxy(function(i){i.preventDefault(),this.notifications.error2.open()},this)),this.$.showModalNav.click(i.proxy(function(i){i.preventDefault(),this.notifications.modalNav.open()},this)),this.$.showModalAlert.click(i.proxy(function(i){i.preventDefault(),this.notifications.modalAlert.open()},this))}});return e});
define("rwd/showcase/template",["jquery","rwd/common/base-ui-module","mustache"],function(t,e,i){var s=e.extend({baseConfig:{selectors:{template:"#template",form:"#template-form",input:"#template-form #text",container:"#container"},data:{lines:[]}},construct:function(t){this._super(t)},_init:function(){this.template=this.$.template.html(),i.parse(this.template),this.config.data.lines.push({value:'"/><script type="text/javascript">alert(42);</script>'}),this.config.data.lines.push({value:'<script>alert("XSS alert!")</script>'}),this.config.data.lines.push({value:'\'/><script type="text/javascript">alert(42);</script>'}),this.config.data.lines.push({value:"<script>alert('XSS alert!')</script>"}),this._render()},_render:function(){this.$.container.html(i.render(this.template,this.config.data))},_bindEvents:function(){this.$.form.on("submit",t.proxy(function(){return this.config.data.lines.push({value:this.$.input.val()}),this._render(),!1},this))}});return s});
define("rwd/common/attachment-upload",["jquery","rwd/common/abstract-orderable-container","rwd/common/upload/attachment","rwd/common/utils"],function(t,e,a,i){var o=e.extend({baseConfig:{moduleSelector:".js-attachment-upload",selectors:{addAttachmentButton:".js-add-attachment-button"},uploadUrl:"/ajax/upload/attachment",paramName:"attachment"},construct:function(e){t.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_convertElementToObject:function(t){var e=t.data("id"),a=t.data("title"),i=t.data("description"),o=t.data("order"),n=t.data("temporary-key"),r=t.data("type");return"ATTACHMENT"===r?{order:o,item:this._createAttachment(this._getNextComponentId(),!1,e,a,i,n)}:void logger.warn("Type is not supported:",r)},_createAttachment:function(t,e,i,o,n,r){return new a({id:i,componentId:t,title:o,description:n,temporaryKey:r,uploading:e,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.attachmentDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},_initTemplate:function(){this.attachmentDetailTemplate=this._loadTemplate("#attachment-details-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_triggerFail:function(t,e,a,i){this._trigger("fail",{componentId:t,status:e,fileName:a,maxFileSize:i})},_triggerDone:function(t,e){this._trigger("uploaded",{componentId:t,data:e})},_bindEvents:function(){this._super(),this.upload=this.$.addAttachmentButton.fileupload({paramName:this.config.paramName,url:this.config.uploadUrl,pasteZone:null}),this.upload.bind("fileuploadsubmit",t.proxy(function(t,e){logger.debug("Sending...");var a=this._getNextComponentId();e.formData={uploaderId:a},logger.debug("Create image. Uploader id is ",a),this._append(this._createAttachment(a,!0,null,e.files[0].name),!0)},this)),this.upload.bind("fileuploaddone",t.proxy(function(e,a){var o=t.parseJSON(i.getUploadResult(a));logger.debug("Upload done for uploader: ",o.uploaderId),o.status?this._triggerFail(o.uploaderId,o.status,o.fileName,o.maxFileSize):this._triggerDone(o.uploaderId,o.media)},this)),this.upload.bind("fileuploadfail",t.proxy(function(e,a){var i=t.parseJSON(a._response.jqXHR.responseText);logger.debug("upload failed:",i),this._triggerFail(i.uploaderId,i.status,i.fileName,i.maxFileSize)},this)),this.$.addAttachmentButton.bind("click",t.proxy(function(t,e){return this._closeEditors(),!0},this))}});return o});
define("rwd/common/upload/attachment",["jquery","rwd/common/abstract-orderable-item"],function(t,e){var n=e.extend({type:"ATTACHMENT",container:"attachmentList",_bind:function(e,n){var a=this._super(e,n);return a.on("uploaded",t.proxy(function(t,e){this.componentId===parseInt(e.componentId)&&(this.uploading=!1,this.title=e.data.name,this.temporaryKey=e.data.id,this._refreshDetailView())},this)),a}});return n});
define("rwd/common/upload/generic-item",["jquery","rwd/common/abstract-orderable-item"],function(e,t){var n=t.extend({_onItemClicked:function(e,t){this._getEditDescriptionElement()[0]!==e.target&&this._super()},_bindEditor:function(){}});return n});
define("rwd/common/generic-orderable-container",["jquery","rwd/common/abstract-orderable-container"],function(e,t){var i=t.extend({_convertElementToObject:function(e){var t=e.data("id"),i=e.data("title"),o=e.data("order");return{order:o,item:this._createItem(this._getNextComponentId(),t,i)}},_initTemplate:function(){this.detailTemplate=this._loadTemplate(this.config.moduleSelector+" "+this.config.itemDetailsTemplateSelector),this.editorTemplate=this._loadTemplate(this.config.moduleSelector+" "+this.config.itemEditorTemplateSelector),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_hideItemContainer:function(){this.$.itemUploadContainer.hide()}});return i});
define("rwd/common/abtract-manage-contribution-list",["jquery","rwd/common/abstract-search-container"],function(t,e){var i=e.extend({superConfig:function(){return t.extend(!0,this._super(),{selectors:{searchForm:".search-form",searchItemButton:".search-form .button",searchItemInputfield:'.search-form input[type="search"]',searchContainer:".js-item-search-container",searchNotification:".js-item-search-notification",searchResultContainer:".js-item-search-result-container",searchPaginatorContainer:".js-item-search-paginator-container"},selectedItemIdList:new Array})},_initTemplate:function(){logger.error("Override this method!")},_convertElementToObject:function(t){logger.error("Override this method!")},getResultList:function(t){return t.contributionInfoList},removeItem:function(t){this._super(t),this._showManageContributionButton()},addContribution:function(t){t.remove(),this.config.selectedItemIdList.push(t.id),this.clearSearchContainer(!0),this.clearSearchPaginatorContainer(!0),this._showManageContributionButton(),this._append(this._createDetailedContribution(t.id,t.draft,t.title,t.image,t.videoId,t.videoProvider),!0,!0)},_createDetailedContribution:function(t,e,i,r,n,o){return this._createContribution(t,e,i,r,n,o,this.itemContainerTemplate,this.itemDetailTemplate,this.itemEditorTemplate)},_createItem:function(t){logger.error("Override this method!")},_createContribution:function(t,e,i,r,n,o,s,a,h){logger.error("Override this method!")},closeEditorsExceptMe:function(t){this._super(t),this._showManageContributionButton(),this.clearSearchContainer(!1),this.clearSearchPaginatorContainer(!1)},_clearAndShowSearchForm:function(){this.$.searchForm.show(),this.$.searchContainer.show(),this.$.searchNotification.html(this.searchMessage),this.$.searchNotification.show(),this._hideResultContainer()},_clearAndHideSearchForm:function(){this.$.searchForm.hide(),this.$.searchNotification.hide(),this._hideResultContainer()},_showResultContainer:function(){this.$.searchResultContainer.show(),this.$.searchPaginatorContainer.show()},_hideResultContainer:function(){this.$.searchResultContainer.hide(),this.$.searchPaginatorContainer.hide()},_showSearchButtonForm:function(){this.$.manageContributionContainer.hide(),this._clearAndShowSearchForm()},_showManageContributionButton:function(){this.$.manageContributionContainer.show(),this.$.searchForm.hide(),this.$.searchContainer.hide(),this.$.searchResultContainer.empty(),this.$.searchPaginatorContainer.empty()},_bindEvents:function(){this._super(),this.$.manageContributionButton.bind("click",t.proxy(function(t,e){return this._closeEditors(),this._showSearchButtonForm(),!0},this)),this.$.searchItemButton.bind("click",t.proxy(function(e,i){return e.preventDefault(),t.trim(this.$.searchItemInputfield.val())?(this._closeEditors(),this.$.searchNotification.trigger("loading"),this._loadPage(1,this.searchFreeTextUrl,this.$.searchItemInputfield.val()),!0):!0},this)),this.$.searchItemInputfield.bind("keypress",t.proxy(function(t){var e=t.keyCode||t.which;13===e&&(t.preventDefault(),this.$.searchItemButton.click())},this))}});return i});
define("rwd/common/manage-contribution-sections-factory",["jquery","rwd/common/base-ui-module","rwd/common/manage-contribution-sections"],function(n,o,e){var t=o.extend({baseConfig:{moduleSelector:".js-manage-contribution-sections"},_init:function(){this._super(),this.module.each(function(o,t){new e({moduleSelector:"#"+n(t).attr("id")})})}});return t});
define("rwd/common/manage-contribution-sections",["jquery","rwd/common/abstract-orderable-container","rwd/common/upload/section-item","rwd/common/upload/separator-item"],function(t,e,i,o){var n=e.extend({baseConfig:{selectors:{}},_convertElementToObject:function(t){var e=t.data("id"),i=t.data("title"),o=t.data("order"),n=t.data("type");return"SEPARATOR-ITEM"===n?{order:o,item:this._createSeparatorItem(this._getNextComponentId(),i)}:"SECTION-ITEM"===n?{order:o,item:this._createSectionItem(this._getNextComponentId(),e,i,t.data("location"))}:void logger.warn("Type is not supported:",n)},_createSectionItem:function(t,e,o,n){return new i({id:e,componentId:t,title:o,location:n,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.sectionDetailTemplate,itemEditorTemplate:this.sectionEditorTemplate})},_createSeparatorItem:function(t,e){return new o({componentId:t,title:e,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.sectionDetailTemplate,itemEditorTemplate:this.sectionEditorTemplate})},_initTemplate:function(){this.sectionDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .section-item-details-template"),this.sectionEditorTemplate=this._loadTemplate("#section-item-editor-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_isEmptyItemContainer:function(){return 1===this.$.itemUploadContainer.children().length},_hideItemContainer:function(){this.$.itemUploadContainer.hide()}});return n});
define("rwd/common/upload/section-item",["jquery","rwd/common/abstract-orderable-item"],function(t,e){var i=e.extend({type:"SECTION-ITEM",container:"contributionSections",isEditable:function(){return!0},_bind:function(e,i){var r=this._super(e,i);return r.on("refreshLocation",t.proxy(function(t,e){this.order==e.separatorOrder?this.location="UP"===e.direction?"BOTTOM":"TOP":this.location=this.order>e.separatorOrder?"BOTTOM":"TOP",this._refreshDetailView()},this)),r},_onItemClicked:function(t,e){this._getEditDescriptionElement()[0]!==t.target&&this._super()},_bindEditor:function(){}});return i});
define("rwd/common/upload/separator-item",["jquery","rwd/common/abstract-orderable-item"],function(r,e){var t=e.extend({type:"SEPARATOR-ITEM",container:"contributionSections",isEditable:function(){return!1},_onRefreshItem:function(r,e){var t=this.order;this._super(r,e),t&&t!=this.order&&this._container._trigger("refreshLocation",{separatorOrder:this.order,direction:t<this.order?"DOWN":"UP"})},getShowRemoveButton:function(){return!1}});return t});
define("rwd/common/upload/abstract-menu-item",["jquery","rwd/common/abstract-orderable-item","rwd/common/smooth-scroll"],function(t,e,i){var n=e.extend({_bind:function(e,i){var n=this._super(e,i);return this._updateErrorState(),this._element.on("edit",t.proxy(function(t,e){this.componentId&&this.componentId===parseInt(e.componentId)&&(t.stopPropagation(),t.preventDefault(),this._editItem())},this)),n},_onItemClicked:function(t,e){return this.backendError?(t.stopPropagation(),void this._editItem()):(this.showRemoveButton=!this.showRemoveButton,this._updateActiveState(!this.active),this._refreshDetailView(),void(this.edit||(this._container.closeEditorsExceptMe(this.componentId),this._refreshEditorView())))},_refreshActiveState:function(){},_focusEditItem:function(t){i.scrollTo(t).then(function(){t.find(".js-editor-title").focus().putCursorAtEnd()})},_cancelEdit:function(){this.isNew?this._container.removeItem(this):this._super()},_updateErrorState:function(){this.backendError?this._element.addClass("invalid"):this._element.removeClass("invalid")},_isEditItemValid:function(t){var e=this._super(t);return this.backendError&&e&&(this.backendError=!1,this._updateErrorState()),e},_editItem:function(){if(this._super(),this.backendError)if(this._isEditItemValid(this._getContentEditorElement()))this.backendError=!1,this._updateErrorState();else{var e=!1;this._getContentEditorElement().each(function(){t(this).parsley().validate().length>0&&!e&&(e=!0,t(this).focus())})}},_getTitleElement:function(){return this._getElement(".js-editor-title")},_getDescriptionElement:function(){return this._getElement(".js-editor-description")},getShowAddButton:function(){return this.edit&&this.isNew},getShowUpdateButton:function(){return this.edit&&!this.isNew},getShowCompactView:function(){return!this.active||this.edit},getShowOrdering:function(){return this.active&&1!==this.count}});return n});
define("rwd/common/upload/link-item",["jquery","rwd/common/upload/abstract-menu-item","rwd/common/utils"],function(t,e,i){var n=e.extend({type:"LINK_ITEM",container:"linkMenuItemList",_saveItem:function(){this.isNew=!1,this.title=this._getTitleElement().val(),this.description=this._getDescriptionElement().val(),this.url=this._getUrlElement().val()},_getUrlElement:function(){return this._getElement(".js-editor-url")},_isEditItemValid:function(t){return i.removeParsleyConstraints(this._getUrlElement(),["type"]),this._super(t)}});return n});
define("rwd/common/manage-menu",["jquery","rwd/common/abstract-orderable-container","rwd/common/upload/static-page-item","rwd/common/upload/link-item"],function(t,e,i,a){var n="disabled",r=e.extend({baseConfig:{moduleSelector:".js-manage-menu",selectors:{addStaticPageItemButton:".js-add-static-page-button",addLinkItemButton:".js-add-link-item-button",containerHeader:".js-container-header",staticPageContainer:".js-static-page-container",disabled:".js-is-disabled"}},_init:function(){this._super()},_processDOM:function(){this.staticPages=this._convertStaticPageElements(),this._super()},_convertStaticPageElements:function(){var e=new Array;return this.$.staticPageContainer.children("p").each(t.proxy(function(i,a){var n=this._convertElementToObject(t(a));void 0!==n&&e.push(n)},this)),this.$.staticPageContainer.children().remove(),e},_convertElementToObject:function(t){var e=t.data("id"),i=t.data("title"),a=t.data("description"),n=t.data("order"),r=t.data("type"),s=t.data("backenderror");switch(r){case"STATIC_PAGE":var o=t.data("url");return this._createStaticPage(e,i,a,o);case"STATIC_PAGE_ITEM":var d=t.data("static-page"),c=t.data("query-param");return{order:n,item:this._createStaticPageItem(this._getNextComponentId(),!1,e,i,a,d,c,s)};case"LINK_ITEM":var o=t.data("url");return{order:n,item:this._createLink(this._getNextComponentId(),!1,e,i,a,o,s)};default:logger.warn("Type is not supported:",r)}},_createLink:function(t,e,i,n,r,s,o){return new a({componentId:t,isNew:e,id:i,title:n,description:r,url:s,backendError:o,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.linkDetailTemplate,itemEditorTemplate:this.linkItemEditorTemplate})},_createStaticPageItem:function(t,e,a,n,r,s,o,d){return new i({componentId:t,isNew:e,id:a,title:n,description:r,staticPageId:s,queryParam:o,backendError:d,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.staticPageDetailTemplate,itemEditorTemplate:this.staticPageItemEditorTemplate,staticPages:this.staticPages})},_createStaticPage:function(t,e,i,a){return{id:t,title:e,description:i,url:a}},_initTemplate:function(){this.linkDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .link-item-details-container-template"),this.staticPageDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .static-page-item-details-container-template"),this.linkItemEditorTemplate=this._loadTemplate("#link-item-editor-container-template"),this.staticPageItemEditorTemplate=this._loadTemplate("#static-page-item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_isDisabled:function(){return this.$.disabled.is(":checked")},_bindEvents:function(){this._super(),this.$.addStaticPageItemButton.bind("click",t.proxy(function(t){if(t.preventDefault(),!this._isDisabled()){this._closeEditors();var e=this._getNextComponentId();this._append(this._createStaticPageItem(e,!0),!1),this._trigger("edit",{componentId:e})}},this)),this.$.addLinkItemButton.bind("click",t.proxy(function(t){if(t.preventDefault(),!this._isDisabled()){this._closeEditors();var e=this._getNextComponentId();this._append(this._createLink(e,!0),!1),this._trigger("edit",{componentId:e})}},this)),this.$.disabled.change(t.proxy(function(e){t(e.currentTarget).is(":checked")?this.module.addClass(n):this.module.removeClass(n)},this))}});return r});
define("rwd/common/upload/static-page-item",["jquery","rwd/common/upload/abstract-menu-item","rwd/common/smooth-scroll"],function(t,e,i){var a=e.extend({type:"STATIC_PAGE_ITEM",container:"staticPageMenuItemList",construct:function(t){this._super(t),this.staticPage=this._findStaticPage(this.staticPageId),this._setSelectedStaticPage(this.staticPageId)},_bindEditor:function(){var e=this;this._super(),this._getStaticPageElement().change(function(){var i=e._findStaticPage(parseInt(t(this).val())),a=e._getTitleElement(),s=e._getDescriptionElement();e._getStaticPageUrlElement().html(i.url),""===t.trim(a.val())&&""===t.trim(s.val())&&(a.val(i.title),s.val(i.description),a.trigger("keyup"),s.trigger("keyup"))})},_refreshEditorView:function(){this._super(),this._getStaticPageElement().customSelect({customClass:"custom-select",mapClass:!1})},_saveItem:function(){this.isNew=!1,this.title=this._getTitleElement().val(),this.description=this._getDescriptionElement().val(),this.queryParam=this._getQueryParamElement().val();var t=parseInt(this._getStaticPageElement().val());this.staticPage=this._findStaticPage(t),this._setSelectedStaticPage(t)},_findStaticPage:function(e){var i=t.grep(this.staticPages,function(t){return t.id===e});return i.length>0?i[0]:void logger.error("The provided static page id ("+e+") cannot be found in the list of static pages")},_setSelectedStaticPage:function(e){t.each(this.staticPages,function(t,i){i.selected=i.id===e})},_getStaticPageElement:function(){return this._getElement(".js-editor-staticpage")},_getStaticPageUrlElement:function(){return this._getElement(".js-editor-staticpage-url")},_getQueryParamElement:function(){return this._getElement(".js-editor-queryparam")}});return a});
define("rwd/common/manage-promoted-challenges",["jquery","rwd/common/abstract-orderable-container","rwd/common/upload/promoted-challenge-item"],function(e,t,l){var o=t.extend({baseConfig:{moduleSelector:".js-manage-promoted-challenges",selectors:{allChallengeContainer:".js-all-challenge-container",addPromotedChallengeLink:".js-add-promoted-challenge"}},_processDOM:function(){this.promotedChallengeIds=new Array,this.allChallenges=this._convertAllChallengeElements(),this._super()},_convertAllChallengeElements:function(){var t=new Array;return this.$.allChallengeContainer.children("p").each(e.proxy(function(l,o){var n=this._convertElementToObject(e(o));void 0!==n&&t.push(n)},this)),this.$.allChallengeContainer.children().remove(),t},_convertElementToObject:function(e){var t=e.data("id"),l=e.data("title"),o=e.data("order"),n=e.data("type"),a=e.data("label-text"),i=e.data("label-description"),r=e.data("visibility");return"ALL-CHALLENGE"===n?{id:t,title:l,labelText:a,labelDescription:i,visibility:r}:"PROMOTED-CHALLENGE-ITEM"===n?(this.addPromotedChallengeId(t),{order:o,item:this._createPromotedItem(this._getNextComponentId(),!1,t,l)}):void logger.warn("Type is not supported:",n)},_createPromotedItem:function(e,t,o,n){return new l({id:o,isNew:t,edit:t,componentId:e,title:n,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.promotedChallengeDetailTemplate,itemEditorTemplate:this.promotedChallengeEditorTemplate,allChallenges:this.allChallenges})},addPromotedChallengeId:function(t){e.inArray(t,this.promotedChallengeIds)<0&&this.promotedChallengeIds.push(t)},removePromotedChallengeId:function(t){this.promotedChallengeIds=e.grep(this.promotedChallengeIds,function(e){return e!==t})},removeItem:function(e){this._super(e),this.removePromotedChallengeId(e.id)},_initTemplate:function(){this.promotedChallengeDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .promoted-challenge-details-template"),this.promotedChallengeEditorTemplate=this._loadTemplate("#promoted-challenge-editor-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},getAvailableChallenges:function(){var t=this,l=e.grep(t.allChallenges,function(l){return-1===e.inArray(l.id,t.promotedChallengeIds)});return l},_bindEvents:function(){this._super(),this.$.addPromotedChallengeLink.on("click",e.proxy(function(e){e.preventDefault(),this._closeEditors();var t=this._getNextComponentId(),l=this._createPromotedItem(t,!0);this._append(l,!0,!0),l._refreshEditorView()},this));var t=this;t.module.on("hide",function(){t._closeEditors(),t.module.hide()})}});return o});
define("rwd/common/upload/promoted-challenge-item",["jquery","rwd/common/abstract-orderable-item","rwd/common/smooth-scroll"],function(e,t,n){var l=t.extend({type:"PROMOTED-CHALLENGE-ITEM",container:"promotedChallenges",construct:function(e){this._super(e),this.challenge=this._findChallenge(this.id)},_refreshEditorView:function(){this._super(),this._getChallengeElement().customSelect({customClass:"custom-select",mapClass:!1})},_saveItem:function(){this.isNew=!1;var e=parseInt(this._getChallengeElement().val());this.challenge&&this.challenge.id===e||this._updateChallenge(e)},_cancelEdit:function(){this.isNew?this._container.removeItem(this):(this.edit=!1,this._refreshEditorView(),this._refreshDetailView())},_getChallengeElement:function(){return this._getElement(".js-editor-challenge")},_updateChallenge:function(e){this.challenge&&this._container.removePromotedChallengeId(this.challenge.id),this._container.addPromotedChallengeId(e),this.challenge=this._findChallenge(e)},_findChallenge:function(t){var n=e.grep(this.allChallenges,function(e){return e.id===t});return n.length>0?n[0]:void logger.error("The provided challenge id ("+t+") cannot be found in the list of all challenges")},getAvailableChallenges:function(){if(!this._container)return new Array;var e=this._container.getAvailableChallenges();return this.challenge&&e.unshift({id:this.challenge.id,title:this.challenge.title,selected:!0}),e},getShowFeatured:function(){return 1===this.order}});return l});
define("rwd/common/abstract-user-list",["jquery","rwd/common/abstract-search-container","rwd/common/smooth-scroll","rwd/common/i18n","rwd/common/utils"],function(t,e,r,s,i){var n=e.extend({superConfig:function(){return t.extend(!0,this._super(),{selectors:{searchForm:".search-form",searchFormButton:".search-form .button",searchFormInputfield:'.search-form input[type="search"]',searchContainer:".js-item-search-container",searchNotification:".js-item-search-notification",searchResultContainer:".js-item-search-result-container",searchPaginatorContainer:".js-item-search-paginator-container"},selectedItemIdList:new Array})},_initTemplate:function(){logger.error("Override this method!")},_convertElementToObject:function(t){logger.error("Override this method!")},_showItemContainer:function(){this._super(),this.notEmptyText&&this.$.manageUsersButton.val(this.notEmptyText)},_hideItemContainer:function(){this._super(),this.emptyText&&this.$.manageUsersButton.val(this.emptyText)},removeItem:function(t){this._super(t),this._showManageUsersButton()},addNewUser:function(t){t.remove(),this.config.selectedItemIdList.push(t.id),this._showManageUsersButton(),this.clearSearchContainer(!0),this.clearSearchPaginatorContainer(!0),this._append(this._createUser(t),!0,!0)},getResultList:function(t){return t.userList},_renderResultList:function(t,e,r,s){this._super(t,e,r,s,!0)},_createItem:function(t){return this.createAddUser(t.id,t.username,t.firstname,t.lastname)},createAddUser:function(t,e,r,s){logger.error("Override this method!")},_createUser:function(t,e,r,s,i){logger.error("Override this method!")},_getActiveEmptyMessage:function(){return s["manage-empty-results"]},closeEditorsExceptMe:function(t){this._super(t),this._showManageUsersButton(),this.clearSearchContainer(!1),this.clearSearchPaginatorContainer(!1)},_showSearchForm:function(){this.$.searchForm.show(),this.$.searchContainer.show(),this.$.searchNotification.html(this.searchMessage),this.$.searchNotification.show(),this.$.searchResultContainer.hide(),this.$.manageUsersContainer.hide(),i.isMobileSafari()?this.$.searchFormInputfield.focus():r.scrollTo(this.$.searchFormInputfield).then(t.proxy(function(){this.$.searchFormInputfield.focus()},this))},_showManageUsersButton:function(){this.$.searchForm.hide(),this.$.searchContainer.hide(),this.$.manageUsersContainer.show()},_bindEvents:function(){this._super(),this.$.manageUsersButton.bind("click",t.proxy(function(t,e){return t.preventDefault(),this.clearSearchContainer(!1),this.clearSearchPaginatorContainer(!1),this._closeEditors(),this._showSearchForm(),!0},this)),this.$.searchFormButton.bind("click",t.proxy(function(e,r){if(e.preventDefault(),!t.trim(this.$.searchFormInputfield.val()))return!0;this._closeEditors(),this.$.searchNotification.trigger("loading");var s=this.$.searchFormInputfield.val();return this._loadPage(1,this.serviceUrl,s),!0},this)),this.$.searchFormInputfield.bind("keypress",t.proxy(function(t){var e=t.keyCode||t.which;13===e&&(t.preventDefault(),this.$.searchFormButton.click())},this))},_init:function(){this._super(),this.emptyText=this.$.manageUsersButton.data("empty-text"),this.notEmptyText=this.$.manageUsersButton.data("not-empty-text"),this.serviceUrl=this.module.data("service-url")}});return n});
define("rwd/common/upload/abstract-user",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/common/abstract-detail-item"],function(t,e,i,s){var n=s.extend({construct:function(i){t.extend(!0,this.baseConfig,this.superConfig),this._super(i),this.profileImage=(new e).getProfilePath(this.username)},_setThumbnailImage:function(){(new i).setImage(this._getImage(),this.profileImage)},getItemName:function(){return this.firstname+(this.lastname?" "+this.lastname:"")},_updateActiveState:function(t){this.showRemoveButton=!0,this._toggleActiveClass(t&&this.edit)},_setStates:function(t,e,i){this._super(t,e,!0)}});return n});
define("rwd/common/upload/image",["jquery","rwd/common/abstract-orderable-item"],function(t,e){var i=e.extend({type:"IMAGE",container:"imageMediaList",_bind:function(e,i){var a=this._super(e,i);return a.on("uploaded",t.proxy(function(t,e){this.componentId===parseInt(e.componentId)&&(this.uploading=!1,this.title=e.data.name,this.image=e.data.filePath,this.temporaryKey=e.data.id,this._refreshDetailView())},this)),a}});return i});
define("rwd/common/media-upload",["jquery","rwd/common/abstract-orderable-container","rwd/common/upload/image","rwd/common/upload/video","rwd/common/utils"],function(e,t,i,d,o){var a=t.extend({baseConfig:{moduleSelector:".js-media-upload",selectors:{mediaAddForm:".js-media-upload-add-form",addVideoButton:".js-add-video-button",addImageButton:".js-add-image-button",addUploadButton:".js-add-upload-button",cancelUploadButton:".js-cancel-upload-button",uploadedVideoUrlInput:".js-media-uploaded-video-url",containerHeader:".js-container-header"},paramName:"image"},construct:function(t){e.extend(!0,this.baseConfig,this.superConfig),this._super(t),logger.debug("Media upload initialized for module: ",this.config.moduleSelector)},closeEditorsExceptMe:function(e){this._hideAndClearAddVideoForm(),this._super(e)},_convertElementToObject:function(e){var t=e.data("id"),i=e.data("title"),d=e.data("description"),o=e.data("url"),a=e.data("order"),r=e.data("type");if("VIDEO"===r){var n=e.data("video-id"),l=e.data("video-url"),s=e.data("video-provider");return{order:a,item:this._createVideo(this._getNextComponentId(),0==o.length||0==i.length,t,o,i,d,{videoId:n,videoUrl:l,videoProvider:s})}}if("IMAGE"===r){var p=e.data("temporary-key");return{order:a,item:this._createImage(this._getNextComponentId(),!1,t,o,i,d,p)}}logger.warn("Type is not supported:",r)},_showAddVideoForm:function(){this.$.mediaAddForm.show(),o.repaint(this.module),this.$.uploadedVideoUrlInput.focus(),this.$.uploadedVideoUrlInput.attr("data-parsley-required",!0),this.$.containerHeader.hide()},_hideAndClearAddVideoForm:function(){this.$.uploadedVideoUrlInput.val(""),this.$.uploadedVideoUrlInput.attr("data-parsley-required",!1),this.$.uploadedVideoUrlInput.parsley().reset(),this.$.mediaAddForm.hide(),this.$.containerHeader.show()},_getVideoUrl:function(){return this.$.uploadedVideoUrlInput.val()},_createImage:function(e,t,d,o,a,r,n){return new i({id:d,componentId:e,image:o,title:a,description:r,temporaryKey:n,uploading:t,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.imageDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},_createVideo:function(e,t,i,o,a,r,n){var l=n||{};return new d({id:i,componentId:e,image:o,videoId:l.videoId,videoUrl:l.videoUrl||this._getVideoUrl(),videoProvider:l.videoProvider,title:a,description:r,uploading:t,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.videoDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},_initTemplate:function(){this.imageDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .image-details-container-template"),this.videoDetailTemplate=this._loadTemplate(this.config.moduleSelector+" .video-details-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_triggerFail:function(e,t,i,d){this._trigger("fail",{componentId:e,status:t,fileName:i,maxFileSize:d})},_triggerDone:function(e,t){this._trigger("uploaded",{componentId:e,data:t})},_bindEvents:function(){this._super(),this.upload=this.$.addImageButton.fileupload({paramName:this.config.paramName,url:this.config.uploadUrl,pasteZone:null}),this.upload.bind("fileuploadsubmit",e.proxy(function(e,t){logger.debug("Sending...");var i=this._getNextComponentId();t.formData={uploaderId:i},logger.debug("Create image. Uploader id is ",i),this._append(this._createImage(i,!0,null,null,t.files[0].name),!0)},this)),this.upload.bind("fileuploaddone",e.proxy(function(t,i){var d=e.parseJSON(o.getUploadResult(i));logger.debug("Upload done for uploader: ",d.uploaderId),d.status?this._triggerFail(d.uploaderId,d.status,d.fileName,d.maxFileSize):this._triggerDone(d.uploaderId,d.media)},this)),this.upload.bind("fileuploadfail",e.proxy(function(t,i){var d=e.parseJSON(i._response.jqXHR.responseText);logger.debug("upload failed:",d),this._triggerFail(d.uploaderId,d.status,d.fileName,d.maxFileSize)},this)),this.$.addUploadButton.bind("click",e.proxy(function(e,t){var i=this.$.uploadedVideoUrlInput.parsley();if(i.isValid()){var d=this._getNextComponentId();logger.debug("Create image. Uploader id is ",d),this._append(this._createVideo(d,!0),!0),this._hideAndClearAddVideoForm()}else i.validate();e.preventDefault()},this)),this.$.addImageButton.bind("click",e.proxy(function(e,t){return this._hideAndClearAddVideoForm(),this._closeEditors(),!0},this)),this.$.cancelUploadButton.bind("click",e.proxy(function(e,t){this._hideAndClearAddVideoForm(),e.preventDefault()},this)),this.$.addVideoButton.bind("click",e.proxy(function(e,t){this._showAddVideoForm(),this._closeEditors(),e.preventDefault()},this)),this.$.uploadedVideoUrlInput.bind("keypress",e.proxy(function(e){var t=e.keyCode||e.which;13===t&&(e.preventDefault(),this.$.addUploadButton.click())},this))}});return a});
define("rwd/common/upload/video",["jquery","rwd/centered-image-utils","rwd/video-resolver","rwd/common/abstract-orderable-item","rwd/common/i18n"],function(i,e,r,t,o){var n=t.extend({type:"VIDEO",container:"videoMediaList",videoError:!1,_bind:function(i,e){var r=this._super(i,e),t=!this.id;return this._resolveThumbnailImage(this.videoUrl,t),r},_resolveThumbnailImage:function(e,t){this.uploading=!0,(new r).getVideoDetails(e).then(i.proxy(function(i){this.uploading=!1,this.title=i.title,this.videoId=i.videoId,this.videoUrl=e,this.videoProvider=i.videoProvider,this.image=i.thumbnail,this._container.clearError(),this._refreshDetailView()},this)).fail(i.proxy(function(e){var r=e&&i.inArray(parseInt(e.error),[400,403,500])>-1?e.error:500;t?setTimeout(i.proxy(function(){this._container.showError(o["manage-video-error-"+r]),this._container.removeItem(this)},this),200):(this.uploading=!1,this.videoError=o["manage-video-error-"+r],this._refreshDetailView(),this._refreshEditorView())},this))},_setThumbnailImage:function(){this.image&&"null"!=this.image&&(new e).setImage(this._getImage(),this.image)},getShowAddDescriptionButton:function(){return!this.videoError&&!this.getShowEditor()}});return n});
define("rwd/common/contribution-tag-autocomplete",["jquery","rwd/common/delayed-loader","rwd/common/autocomplete","rwd/common/utils"],function(t,e,s,i){var n=s.extend({baseConfig:{moduleSelector:".contribution-tag-autocomplete",selectors:{suggestionContainer:".suggestion-container"}},INPUT_FIELD_CHARACTER_LIMIT:25,AUTOCOMPLETE_DELAY:500,suggestedTags:[],usedSuggestedTags:[],construct:function(e){t.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_init:function(){this._super(),this.tagSuggestionsUrl=this.module.attr("data-tag-suggestions-url"),this.suggestedTagsTemplate=this._loadTemplate("#suggested-tags-template"),this._loadTagSuggestions()},_renderNewItem:function(t){return this.selectedItemTemplate.render({itemName:t})},_getItemKey:function(t){return t},_getIdentifierFromAutocompleteOption:function(t){return t.name},_renderAutocompleteItemTemplate:function(t,e,s){var i=this.matchItem(t,e);return this.autocompleteItemTemplate.render({matchingPart:i.matchingPart,nonMatchingPart:i.nonMatchingPart,count:s.count})},_renderAutocompleteCreateNewItemTemplate:function(t,e,s){return this.autocompleteCreateNewItemTemplate.render({itemName:e})},_addNewItemIfNecessary:function(e){e=e.substring(0,this.INPUT_FIELD_CHARACTER_LIMIT);var s=e.indexOf(this.SPACE)>=0;if(s){var i=e.split(this.SPACE);t.each(i,t.proxy(function(e,s){s=t.trim(s),s.length>0&&this._addNewItem(s)},this)),this.$.autocompleteInput.val(this.EMPTY_STRING)}},_onAutocompleteInputChange:function(){this._addNewItemIfNecessary(this.$.autocompleteInput.val());var s=this.$.autocompleteInput.val();s.length>0?(this.$.autocompleteList.html(this.EMPTY_STRING).trigger("loading"),this._setAvailableOptionsVisibility(!0),e.getInstance().loadWithDelay("autocomplete",t.proxy(function(){this._fetchAutocompleteOptions(s)},this),this.AUTOCOMPLETE_DELAY)):this._setAvailableOptionsVisibility(!1)},_bindEvents:function(){this._super(),this.$.autocompleteInput.on("keydown",t.proxy(function(t){t.keyCode===this.KEYCODES.ENTER&&(t.preventDefault(),this._addNewItem(this.$.autocompleteInput.val())),t.keyCode===this.KEYCODES.SPACE&&(t.preventDefault(),this._addNewItem(this.$.autocompleteInput.val()))},this)),this.$.autocompleteList.on("keydown",t.proxy(function(t){t.keyCode===this.KEYCODES.SPACE&&(t.preventDefault(),this._addNewItem(this._getIdentifierFromAutocompleteOption(this.autocompleteOptions[this.activeIndex-1])))},this)),this.$.suggestionContainer.on("click",t.proxy(this._onSuggestionClick,this))},_loadTagSuggestions:function(){if(""!==this.tagSuggestionsUrl){var e=this;t.ajax({type:"GET",url:this.tagSuggestionsUrl,success:function(t){e.setSuggestedTags(t),e._showTagSuggestions()}})}},_showTagSuggestions:function(){if(this.suggestedTags&&!(this.suggestedTags.length<1)){var t=this.suggestedTagsTemplate.render(this.getSuggestedTags());this.$.suggestionContainer.html(t)}},_onSuggestionClick:function(e){var s=t(e.target);s.hasClass("suggestion-item")&&(this._addNewItem(s.text()),this._showTagSuggestions(),s.parent().remove())},_addNewItem:function(t){this._super(t),this.tagSuggestionsUrl&&this.moveItem(t,this.suggestedTags,this.usedSuggestedTags)&&this._showTagSuggestions()},_removeItem:function(t){this._super(t),this.tagSuggestionsUrl&&this.moveItem(t,this.usedSuggestedTags,this.suggestedTags)&&this._showTagSuggestions()},_itemExists:function(t){return i.containsIgnoreCase(this.selectedItems,t)},_manageTagOnServer:function(t,e){this._super(t,e.toLowerCase())},_fetchAutocompleteOptions:function(t){this._super(t.toLowerCase())},moveItem:function(t,e,s){var n=i.indexOfIgnoreCase(e,t);if(n>-1){var o=e.splice(n,1)[0];return s.push(o),!0}return!1},setSuggestedTags:function(e){var s=this;t.each(e,function(t,e){i.containsIgnoreCase(s.selectedItems,e)||s.suggestedTags.push(e)})},getSuggestedTags:function(){var e=[];return t.each(this.suggestedTags,function(t,s){e.push({tag:s})}),e[e.length-1].last=!0,e},matchItem:function(t,e){var s="",i="";if(t&&e){var n=e.length-e.toLowerCase().replace(t.toLowerCase(),this.EMPTY_STRING).length;s=e.substring(0,n),i=e.substring(n)}return{nonMatchingPart:i,matchingPart:s}}});return n});
define("rwd/common/toolbar-powered-table",["jquery","rwd/common/generic-reloading-view","rwd/common/utils","rwd/common/i18n","rwd/common/form-change-notifier","rwd/common/sticky-toolbar"],function(e,t,i,n,c,o){var l="hide-toolbar",s=t.extend({superConfig:function(){return{CONTENT_TEMPLATE_ATTRIBUTE_NAME:"data-content-template",CONTENT_TEMPLATE_PLACEHOLDER:"{0}",selectors:{toolbarContainer:".js-toolbar-container",selectText:".js-selected-count",deselectButton:".js-deselect-button",selectAllButton:".js-select-all-button",actionBarSelect:".js-action-bar-container select",updateButton:".js-update-button"}}},construct:function(t){this.baseConfig=e.extend(!0,{},this.superConfig(),this.baseConfig),this._super(t)},_init:function(){this._super(),this.formChangeNotifier=c.getInstance(),this.stickyToolbar=this._createStickyToolbar()},_createStickyToolbar:function(){return new o},_loadViewWithState:function(t){this._super(t),this.table.search(e.extend({},t),this.initialActivePage||1),this.initialActivePage=void 0},_viewLoaded:function(t,n){this._super(t),this.formChangeNotifier.reset(),this.activePage=n,this.totalItems=t.selected,this._updateSelectedText(),this._updateSelectAllButtonText(),this._updateActionBarVisibility(),this.table.getRowCheckboxes().each(e.proxy(function(t,n){var c=e(n).val();i.checkCheckbox(n,this.selection.allSelected&&!i.inArray(this.selection.excluded,c)||i.inArray(this.selection.included,c))},this)),this._updatePageCheckedState(),this.stickyToolbar.refreshToolbarPosition()},hide:function(){this.table.empty(),this._updateSelectionState(),this._updateActionBarVisibility(),this._super()},_updateActionBarVisibility:function(){0===this._getSelectionCount()?this.$.toolbarContainer.addClass(l):(this.$.toolbarContainer.removeClass(l),this.$.actionBarSelect.trigger("render"))},_updateSelectAllButtonText:function(){this._updateText(this.$.selectAllButton,this.totalItems)},_updateSelectedText:function(){this._updateText(this.$.selectText,this._getSelectionCount())},_getSelectionCount:function(){return this.selection.allSelected?this.totalItems-this._getExcludedListLength():this._getIncludedListLength()},_getIncludedListLength:function(){return this.selection.included?this.selection.included.length:0},_getExcludedListLength:function(){return this.selection.excluded?this.selection.excluded.length:0},_updateText:function(t,i){var n=e(t);n.length&&n.html(n.attr(this.config.CONTENT_TEMPLATE_ATTRIBUTE_NAME).replace(this.config.CONTENT_TEMPLATE_PLACEHOLDER,i))},_updateSelection:function(e,t){e?this.selection.allSelected?this.selection.excluded=i.removeFromArray(this.selection.excluded,t.val()):i.pushUniqueToArray(this.selection.included,t.val()):this.selection.allSelected?i.pushUniqueToArray(this.selection.excluded,t.val()):this.selection.included=i.removeFromArray(this.selection.included,t.val()),this._updateSelectedText(),this._updateActionBarVisibility()},_updateSelectionState:function(e,t,i){this.selection={allSelected:e,excluded:i||[],included:t||[]}},_updateAllSelected:function(e){this.table.getAllCheckboxes().each(function(t,n){i.checkCheckbox(n,e)}),i.repaintWithClass(this.table.$.tableContainer.find("table")),this._updateSelectionState(e),this._updateSelectedText(),this._updateActionBarVisibility()},_updatePageCheckedState:function(){var t=!0;this.table.getRowCheckboxes().each(e.proxy(function(e,i){return t=t&&i.checked,t?void 0:!1},this)),i.checkCheckbox(this.table.getCheckAllPage()[0],t)},_reload:function(e,t){!e&&this._updateSelectionState(!1),this._super(e,t)},_getCommonPostData:function(t){return e.extend(!0,{activePage:this.activePage,excludedItems:this.selection.excluded,includedItems:this.selection.included,selectedAll:this.selection.allSelected},this._super(t))},_onDeselectButtonClick:function(t){t.preventDefault(),this._updateAllSelected(!1),e(t.currentTarget).blur(),this.stickyToolbar.refreshToolbarPosition()},_onSelectAllButtonClick:function(t){t.preventDefault(),this._updateAllSelected(!0),e(t.currentTarget).blur()},_onRowCheckSelectorClick:function(t){var i=e(t.currentTarget);this._updateSelection(i.prop("checked"),i),this._updatePageCheckedState()},_onCheckAllPageSelectorClick:function(t){var i=e(t.currentTarget);this.table.getRowCheckboxes().each(e.proxy(function(t,n){n.checked=i.prop("checked"),this._updateSelection(i.prop("checked"),e(n)),e(n).change()},this))},_getQuestionMessage:function(e){return n.resolveByCount("table-risky-action-"+e,this._getSelectionCount())},_getSelectedAction:function(e){return this.$.updateActionSelector.val()},_bindEvents:function(){this._super(),this.$.deselectButton.on("click",e.proxy(this._onDeselectButtonClick,this)),this.$.selectAllButton.on("click",e.proxy(this._onSelectAllButtonClick,this)),this.$.updateButton.on("click",e.proxy(this._onUpdate,this)),this.module.on("click",this.table.config.rowCheckSelector,e.proxy(this._onRowCheckSelectorClick,this)),this.module.on("click",this.table.config.checkAllPageSelector,e.proxy(this._onCheckAllPageSelectorClick,this))}});return s});
define("rwd/common/checkable-paged-table",["jquery","rwd/common/paged-table"],function(e,t){var c=t.extend({superConfig:function(){return{rowCheckSelector:"td input",checkAllPageSelector:"#select-page",checkboxSelector:"input"}},construct:function(t){e.extend(!0,this.baseConfig,this.superConfig()),this._super(t)},getRowCheckboxes:function(){return this.module.find(this.config.rowCheckSelector)},getCheckAllPage:function(){return this.module.find(this.config.checkAllPageSelector)},getAllCheckboxes:function(){return this.module.find(this.config.checkboxSelector)}});return c});
define("rwd/common/checkable-sortable-table",["jquery","rwd/common/checkable-paged-table"],function(e,t){var o=t.extend({sortableConfig:function(){return{sortable:"thead th.sortable"}},construct:function(t){e.extend(!0,this.baseConfig,this.sortableConfig()),this._super(t)},getActiveSortable:function(e,t){var o="."+t.toLowerCase(),n='[data-sort-by="'+e+'"]';return this.module.find(this.config.sortable+o+n)}});return o});
define("rwd/common/file-upload",["jquery","rwd/common/base-ui-module"],function(e,t){var n=t.extend({baseConfig:{useModuleAsParent:!0,selectors:{fileInput:'input[type="file"]'},moduleSelector:".file-upload"},_updateSelectedField:function(e,t){e.text(t)},_getSelectedElement:function(e){return e.siblings(".selected-file")},_onFileInputChange:function(t){var n=e(t.currentTarget);this._updateSelectedField(this._getSelectedElement(n),n.val().replace(/C:\\fakepath\\/i,""))},_bindEvents:function(){this.$.fileInput.on("change",e.proxy(this._onFileInputChange,this))}});return n});
define("rwd/common/image-upload",["jquery","rwd/common/base-ui-module","rwd/path-utils","rwd/centered-image-utils","rwd/common/error-message-template","rwd/common/utils","rwd/common/i18n"],function(e,r,t,i,a,o,n){var s=r.extend({superConfig:function(){return{useModuleAsParent:!0,selectors:{fileInput:'input[type="file"]',linkContainer:".link-container",imageContainer:".current",hiddenField:"input[type='hidden']"},paramName:"image",ajaxErrorTemplate:"#template-ajax-error"}},construct:function(r){e.extend(!0,this.baseConfig,this.superConfig()),this._super(r)},_init:function(){this.pathUtils=new t,this.centeredImageUtils=new i;var r=null;this.$.fileInput&&this.$.fileInput.length>0&&(r=e(this.$.fileInput[0]).attr("data-url")),logger.trace("Image upload initialized:",r),this.upload=this.$.fileInput.fileupload({paramName:this.config.paramName,url:r,dropZone:this.module}),this.ajaxErrorTemplate=new a({selectors:{template:this.config.ajaxErrorTemplate}})},updatePhoto:function(e,r){logger.error("this function ('updatePhoto') should be overridden")},_updateHiddenField:function(e,r){e.val(r)},_onError:function(r,t,i,a){var o,s="manage-image-error-500";e.inArray(parseInt(t),[415,413])>-1&&(s="manage-image-error-"+t);var l=[];l.push(i||null),l.push(a||null),o=n._formatMessage(n[s],l),this.errorElement?this._updateError(o):this.ajaxErrorTemplate.render(o,e.proxy(function(e){this.$.linkContainer.append(e),this.errorElement=e},this)),this.$.imageContainer.removeClass("uploading"),this.module.parsley().validate()},_clearErrors:function(){this.errorElement&&this.errorElement.removeClass("error")},_updateError:function(e){this.errorElement.find(".error-message").attr("data-message",e),this.errorElement.addClass("error")},getImagePath:function(e){logger.error("this function ('getImagePath') should be overridden")},isUploading:function(){return this.module.has(".uploading").length},_bindEvents:function(){this.upload.bind("fileuploadstart",e.proxy(function(e,r){logger.debug("Uploading..."),this.$.imageContainer.addClass("uploading")},this)),this.upload.bind("fileuploaddone",e.proxy(function(r,t){var i=e.parseJSON(o.getUploadResult(t));i.status?(logger.debug("Upload failed",i),this._onError(r,i.status,i.fileName,i.maxFileSize)):(logger.debug("Upload done",i),this.updatePhoto(this.$.imageContainer,this.getImagePath(i.thumbnails,i.temporaryName)),this._updateHiddenField(this.$.hiddenField,i.id),this._clearErrors(),this.module.trigger("img-uploaded"))},this)),this.upload.bind("fileuploadfail",e.proxy(function(r,t){var i=e.parseJSON(t._response.jqXHR.responseText);logger.debug("Upload failed",i),this._onError(r,i.status,i.fileName,i.maxFileSize)},this)),this.upload.bind("fileuploadprogress",function(e,r){var t=parseInt(r.loaded/r.total*100,10);logger.debug("Upload progress",t)}),this.upload.bind("fileuploadalways",e.proxy(function(e){this.$.imageContainer.removeClass("uploading")},this)),this.module.parsley().subscribe("parsley:field:validate",e.proxy(function(e){this.isUploading()?(e.value="uploading",this._clearErrors()):e.value="ready"},this))}});return s});
define("rwd/filter/assign-contributions-to-reviewers-filter",["jquery","rwd/filter/abstract-contribution-filter-manager","rwd/common/i18n","rwd/common/utils","rwd/common/smooth-scroll","rwd/common/template"],function(i,t,e,n,r,o){var s=t.extend({baseConfig:{selectors:{optionAdvancedFilter:".options-list a.js-filter-advanced",advancedFilterForm:".js-advanced-filter-form",advancedSpinner:".loading-indicator",advancedFilterError:".js-filter-error"},moduleSelector:".assign-contributions-to-reviewers .filter-with-search"},filters:{ADVANCED:"ADVANCED",ASSIGNED:"ASSIGNED",UNASSIGNED:"UNASSIGNED"},_init:function(){this._initFilterOptions({selectors:{optionFilterAssigned:".js-filter-assigned",optionFilterUnassigned:".js-filter-unassigned",optionFilterAssignedLabel:".js-filter-assigned .option",optionFilterUnassignedLabel:".js-filter-unassigned .option"},filters:this.filters,onOptionsClick:this._onOptionClicked.bind(this),onOptionFilterClick:this._onOptionFilterClicked.bind(this)}),this._super()}});return s});
define("rwd/filter/challenge-users-filter",["jquery","rwd/abstract-filter-manager"],function(e,i){var t=i.extend({baseConfig:{moduleSelector:".challenge-users .filter-with-search"},filters:{NOT_REGISTERED:"NOT_REGISTERED",FOLLOWER:"FOLLOWER"},_init:function(){this._super(),this._initFilterOptions({selectors:{optionFilterNotRegistered:".js-filter-not-registered",optionFilterFollower:".js-filter-follower",optionFilterNotRegisteredLabel:".js-filter-not-registered .option",optionFilterFollowerLabel:".js-filter-follower .option"},filters:this.filters,onOptionsClick:this._onOptionClicked.bind(this),onOptionFilterClick:this._onOptionFilterClicked.bind(this)}),this._initSelectedFilter()}});return t});
define("rwd/filter/contribution-overview-filter",["jquery","rwd/filter/abstract-contribution-filter-manager","rwd/common/i18n","rwd/common/utils","rwd/common/smooth-scroll","rwd/common/template"],function(i,t,r,e,n,o){var l=t.extend({baseConfig:{selectors:{optionAdvancedFilter:".options-list a.js-filter-advanced",advancedFilterForm:".js-advanced-filter-form",advancedSpinner:".loading-indicator",advancedFilterError:".js-filter-error"},moduleSelector:".js-contribution-overview .filter-with-search"},filters:{ADVANCED:"ADVANCED"},_init:function(){this._initFilterOptions({filters:this.filters,onOptionsClick:this._onOptionClicked.bind(this),onOptionFilterClick:this._onOptionFilterClicked.bind(this)}),this._super()}});return l});
define("rwd/team-membership-list",["jquery","rwd/common/base-ui-module","rwd/modal-notification","rwd/common/utils"],function(e,i,n,t){var o=i.extend({baseConfig:{selectors:{declineMembership:".contribution-list .decline-membership a"},moduleSelector:".team-membership-list",declineMembershipConfirmationModalId:"#decline-team-membership-notification"},construct:function(e){this._super(e)},_init:function(){this.$.declineMembership.length&&this._initDeclineMembershipConfirmation()},_initDeclineMembershipConfirmation:function(){var e=this;this.declineMembershipConfirmation=new n({id:e.config.declineMembershipConfirmationModalId,onOk:function(e){logger.info("Decline membership confirmed."),e.preventDefault(),this.close(),t.postLink(this.targetLink.attr("href"))}})},_bindEvents:function(){this.$.declineMembership.click(e.proxy(function(i){i.preventDefault(),this.declineMembershipConfirmation.targetLink=e(i.currentTarget),this.declineMembershipConfirmation.open()},this))}});return o});
define("rwd/search",["jquery","rwd/common/slider","rwd/common/overlay","rwd/common/base-ui-module","rwd/common/breakpointdetection","rwd/common/feature-detection"],function(t,i,s,e,n,o){var a=e.extend({baseConfig:{selectors:{searchBox:".search",searchInput:'.search-container .search-form input[type="search"]',searchButton:".search-container .search-form .button",searchCancel:".search-cancel"},moduleSelector:".slider-container.search-container",openedStateClass:"open",hiddenClass:"hidden",overlayClass:"search-overlay",maxInputWidth:584},topNavigation:{},construct:function(t,i){this.topNavigation=t,this._super(i)},_init:function(){this.searchSlider=new i({selectors:{link:this.config.selectors.searchBox,sliderContainer:this.config.moduleSelector},aboveOverlay:!0}),this.searchOverlay=new s({additionalClass:this.config.overlayClass,onClick:this.closeOverlayEventHandler()}),this.searchButtonWidth=-1,this.searchInputOuter=this.$.searchInput.outerWidth(!0)-this.$.searchInput.width(),n.getInstance().isDesktopLayout()&&(this.searchButtonWidth=this.$.searchButton.outerWidth(!0)),this.config.maxInputWidth=this.config.maxInputWidth-this.searchInputOuter},resizeSearchInput:function(){if(n.getInstance().isMobileLayout())this.$.searchInput.css({width:"100%"});else{-1===this.searchButtonWidth&&(this.searchButtonWidth=this.$.searchButton.outerWidth(!0));var t=this.topNavigation.widths.window-this.topNavigation.widths.logo-this.searchButtonWidth;t-=this.searchInputOuter,this.$.searchInput.width(Math.min(t,this.config.maxInputWidth))}},showMainMenu:function(){this.topNavigation.$.mainMenu.css("visibility",""),this.topNavigation.$.more.css("visibility","")},hideMainMenu:function(){this.topNavigation.$.mainMenu.css("visibility","hidden"),this.topNavigation.$.more.css("visibility","hidden")},closeOverlayEventHandler:function(){return t.proxy(function(i){i.preventDefault(),this.searchSlider.close(),this.searchOverlay.close(),this.$.searchBox.toggleClass(this.config.openedStateClass),this.showMainMenu(),o.cssTransition()?this.module.one("transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd",t.proxy(function(){this.module.addClass(this.config.hiddenClass)},this)):this.module.addClass(this.config.hiddenClass)},this)},_bindEvents:function(){t(window).on("resize orientationchange",t.proxy(this.resizeSearchInput,this)),this.$.searchBox.click(t.proxy(function(t){t.preventDefault(),this.topNavigation.closeSlidingMenues(),this.resizeSearchInput(),this.module.removeClass(this.config.hiddenClass),this.$.searchBox.toggleClass(this.config.openedStateClass),this.$.searchInput.val(""),this.$.searchInput.focus(),this.searchOverlay.open(),this.hideMainMenu()},this)),this.$.searchCancel.click(this.closeOverlayEventHandler())}});return a});
define("rwd/user-menu",["jquery","rwd/common/base-ui-module","rwd/common/overlay","rwd/common/template","rwd/common/error-message-template","rwd/common/feature-detection"],function(t,o,e,i,r,s){var n="loading-indicator",a="error",d=".dashboard-load-error",h="user-menu-sliding",l="user-menu-expanded",u="fixed",c=99,b=o.extend({baseConfig:{selectors:{body:"body",userProfileButton:".header .profile",backButton:".user-menu .close-button",dashboard:".user-menu .dashboard",notificationWrapper:".header .notification-wrapper"},moduleSelector:".user-menu",errorTemplate:"#dashbord-error-template",ajaxUrl:"/user/dashboard"},construct:function(t,o){this.topNavigation=t,this._super(o)},_init:function(){this.overlay=new e({onClick:t.proxy(this.slideOut,this)}),this.ajaxErrorTemplate=new r({selectors:{template:this.config.errorTemplate}}),this.$.notificationWrapper.attr("data-new-to-dashboard")&&(this.newToDashboard=!0)},show:function(){this.$.body.scrollTop(0),this.$.body.addClass(l),this.overlay.open()},hide:function(){this.overlay.close(),this.$.body.removeClass(l),t(d).remove()},enableTransition:function(){this.$.body.addClass(h)},disableTransition:function(){s.cssTransition()?this.module.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",t.proxy(function(t){t.target===t.currentTarget&&this.transitionEnd()},this)):this.transitionEnd()},transitionEnd:function(){this.$.body.removeClass(h),this.$.body.hasClass(l)?this.$.body.addClass(u):this.$.body.removeClass(u),this.newToDashboard&&(this.$.notificationWrapper.remove(),this.newToDashboard=!1)},transition:function(o){this.enableTransition(),t.proxy(o,this)(),this.disableTransition()},slideIn:function(){this.transition(this.show)},slideOut:function(){this.transition(this.hide)},_loadContent:function(){logger.debug("Loading content of user dashboard");var o="";this.newToDashboard&&(logger.debug("First loading the content of dashboard for user"),o="?newtodashboard=true"),this.$.dashboard.trigger("loading"),t.get(this.config.ajaxUrl+o,t.proxy(function(t){t.getDisplayCount=function(){return function(t,o){var e=o(t);return e>c?">"+c:e}},this.$.dashboard.append(t),this.$.dashboard.trigger("restore"),this.$.dashboard.removeClass(n),this.$.errorMessage&&this.$.errorMessage.removeClass(a)},this)).fail(t.proxy(function(){logger.error("Failed to load content of user dashboard"),this.$.dashboard.trigger("restore"),this.ajaxErrorTemplate.render(this.$.dashboard.data("failure"),t.proxy(function(t){this.$.dashboard.append(t)},this))},this))},_bindEvents:function(){this.$.userProfileButton.on("click",t.proxy(function(t){t.preventDefault(),this.topNavigation.closeSlidingMenues(),this.slideIn(),this.$.dashboard.hasClass(n)&&this._loadContent()},this)),this.$.backButton.on("click",t.proxy(function(t){t.preventDefault(),this.slideOut()},this))}});return b});
define("rwd/common/upload/community-question-item",["jquery","rwd/common/upload/generic-item"],function(e,n){var o=n.extend({type:"COMMUNITY-QUESTION-ITEM",container:"questions"});return o});
define("rwd/common/manage-community-questions-factory",["jquery","rwd/common/base-ui-module","rwd/common/manage-community-questions"],function(e,n,o){var m=n.extend({baseConfig:{moduleSelector:".js-manage-community-questions"},_init:function(){this._super(),this.module.each(function(n,m){new o({moduleSelector:"#"+e(m).attr("id")})})}});return m});
define("rwd/common/manage-community-questions",["jquery","rwd/common/generic-orderable-container","rwd/common/upload/community-question-item"],function(e,t,i){var m=t.extend({baseConfig:{itemDetailsTemplateSelector:".community-question-item-details-template",itemEditorTemplateSelector:".community-question-item-editor-template",selectors:{}},_createItem:function(e,t,m){return new i({id:t,componentId:e,title:m,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.detailTemplate,itemEditorTemplate:this.editorTemplate})}});return m});
define("rwd/common/manage-missions-factory",["jquery","rwd/common/base-ui-module","rwd/common/manage-missions"],function(e,n,o){var i=n.extend({baseConfig:{moduleSelector:".js-manage-missions"},_init:function(){this._super(),this.module.each(function(n,i){new o({moduleSelector:"#"+e(i).attr("id")})})}});return i});
define("rwd/common/manage-missions",["jquery","rwd/common/generic-orderable-container","rwd/common/upload/mission-item"],function(e,t,i){var m=t.extend({baseConfig:{itemDetailsTemplateSelector:".mission-item-details-template",itemEditorTemplateSelector:".mission-item-editor-template",selectors:{}},_createItem:function(e,t,m){return new i({id:t,componentId:e,title:m,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.detailTemplate,itemEditorTemplate:this.editorTemplate})}});return m});
define("rwd/common/upload/mission-item",["jquery","rwd/common/upload/generic-item"],function(e,n){var i=n.extend({type:"MISSION-ITEM",container:"missions"});return i});
define("rwd/common/manage-reviewer-questions-factory",["jquery","rwd/common/base-ui-module","rwd/common/manage-reviewer-questions"],function(e,n,o){var r=n.extend({baseConfig:{moduleSelector:".js-manage-reviewer-questions"},_init:function(){this._super(),this.module.each(function(n,r){new o({moduleSelector:"#"+e(r).attr("id")})})}});return r});
define("rwd/common/manage-reviewer-questions",["jquery","rwd/common/generic-orderable-container","rwd/common/upload/reviewer-question-item"],function(e,t,i){var r=t.extend({baseConfig:{itemDetailsTemplateSelector:".reviewer-question-item-details-template",itemEditorTemplateSelector:".reviewer-question-item-editor-template",selectors:{}},_createItem:function(e,t,r){return new i({id:t,componentId:e,title:r,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.detailTemplate,itemEditorTemplate:this.editorTemplate})}});return r});
define("rwd/common/upload/reviewer-question-item",["jquery","rwd/common/upload/generic-item"],function(e,n){var o=n.extend({type:"REVIEWER-QUESTION-ITEM",container:"questions"});return o});
define("rwd/common/manage-sso-providers",["jquery","rwd/common/generic-orderable-container","rwd/common/upload/saml-item","rwd/common/upload/oauth2-item"],function(e,t,a,i){var o=t.extend({baseConfig:{itemDetailsTemplateSelector:".sso-item-details-template",samlItemEditorTemplateSelector:".saml-item-editor-template",oauth2ItemEditorTemplateSelector:".oauth2-item-editor-template",moduleSelector:".js-manage-sso",selectors:{}},_initTemplate:function(){this.detailTemplate=this._loadTemplate(this.config.moduleSelector+" "+this.config.itemDetailsTemplateSelector),this.samlEditorTemplate=this._loadTemplate(this.config.moduleSelector+" "+this.config.samlItemEditorTemplateSelector),this.oauth2EditorTemplate=this._loadTemplate(this.config.moduleSelector+" "+this.config.oauth2ItemEditorTemplateSelector),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t,a=e.data("id"),i=e.data("title"),o=e.data("alias"),m=e.data("type"),l=e.data("order");return"SAML"===m?t=this._createSamlItem(this._getNextComponentId(),a,i,o):"OAUTH2"===m?t=this._createOauth2Item(this._getNextComponentId(),a,i,o):logger.error("Unsupported SSO provider type: ",m),{order:l,item:t}},_createSamlItem:function(e,t,i,o){return new a({id:t,componentId:e,title:i,alias:o,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.detailTemplate,itemEditorTemplate:this.samlEditorTemplate})},_createOauth2Item:function(e,t,a,o){return new i({id:t,componentId:e,title:a,alias:o,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.detailTemplate,itemEditorTemplate:this.oauth2EditorTemplate})}});return o});
define("rwd/common/upload/oauth2-item",["jquery","rwd/common/upload/sso-item"],function(e,o){var n=o.extend({type:"OAUTH2"});return n});
define("rwd/common/upload/saml-item",["jquery","rwd/common/upload/sso-item"],function(e,o){var m=o.extend({type:"SAML"});return m});
define("rwd/common/upload/sso-item",["jquery","rwd/common/upload/generic-item"],function(e,n){var o=n.extend({container:"ssoProviders",getCommonIndex:function(){return this.order-1}});return o});
define("rwd/common/upload/featured-impact-contribution-search",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/video-resolver","rwd/common/abstract-item"],function(i,e,t,n,o){var s=o.extend({type:"FEATURED-IMPACT-CONTRIBUTION",container:"featuredImpactContributionList",construct:function(e){i.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_resolveThumbnailImage:function(e,t){this.uploading=!0,(new n).getThumbnailImage(e,t).then(i.proxy(function(i){this.uploading=!1,this.image=i.thumbnail,this._refreshDetailView()},this))},_setThumbnailImage:function(){this._isVideo()?this.image&&(new t).setImage(this._getImage(),this.image):this._super()},_isVideo:function(){return this.videoId&&this.videoProvider},getImagePath:function(){return(new e).buildFullMediaPage(this.image)},_bind:function(i,e){var t=this._super(i,e),n=this;return this._isVideo()&&this._resolveThumbnailImage(this.videoId,this.videoProvider),this._element.bind("click",function(i){i.stopPropagation(),n._container.addContribution(n)}),t}});return s});
define("rwd/common/upload/featured-impact-contribution",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/video-resolver","rwd/common/abstract-orderable-item"],function(i,e,t,n,r){var s=r.extend({type:"FEATURED-IMPACT-CONTRIBUTION",container:"featuredImpactContributionList",construct:function(e){i.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_bind:function(i,e){var t=this._super(i,e);return this._isVideo()&&this._resolveThumbnailImage(this.videoId,this.videoProvider),t},_resolveThumbnailImage:function(e,t){this.uploading=!0,(new n).getThumbnailImage(e,t).then(i.proxy(function(i){this.uploading=!1,this.image=i.thumbnail,this._refreshDetailView()},this))},_setThumbnailImage:function(){this._isVideo()?this.image&&(new t).setImage(this._getImage(),this.image):this._super()},getImagePath:function(){return(new e).buildFullMediaPage(this.image)},_isVideo:function(){return this.videoId&&this.videoProvider}});return s});
define("rwd/common/manage-featured-impact-contribution-list",["jquery","rwd/common/abtract-manage-contribution-list","rwd/common/upload/featured-impact-contribution","rwd/common/upload/featured-impact-contribution-search","rwd/common/smooth-scroll","rwd/common/i18n"],function(t,e,i,a,o,n){var r=e.extend({baseConfig:{moduleSelector:".js-featured-impact-contribution-manage",selectors:{manageContributionButton:".js-manage-contribution-button",manageContributionContainer:".js-manage-contribution-container"}},_initTemplate:function(){this.itemDetailTemplate=this._loadTemplate("#featured-impact-contribution-details-container-template"),this.itemAddTemplate=this._loadTemplate("#featured-impact-contribution-add-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(t){var e=t.data("id"),i=t.data("title"),a=t.data("order"),o=t.data("draft"),n=t.data("type");if(this.config.selectedItemIdList.push(e),"FEATURED-IMPACT-CONTRIBUTION"===n)return{order:a,item:this._createDetailedContribution(e,o,i)};if("FEATURED-IMPACT-CONTRIBUTION-VIDEO"===n){var r=t.data("image"),d=t.data("video-id"),m=t.data("video-provider");return{order:a,item:this._createDetailedContribution(e,o,i,r,d,m)}}if("FEATURED-IMPACT-CONTRIBUTION-IMAGE"===n){var r=t.data("image");return{order:a,item:this._createDetailedContribution(e,o,i,r)}}logger.warn("Type is not supported:",n)},_createItem:function(t){return new a({id:t.id,draft:t.draft,componentId:this._getNextComponentId(),title:t.title,image:t.media.relativPath,videoId:t.videoId,videoProvider:t.videoProvider,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_createContribution:function(t,e,a,o,n,r,d,m,c){return new i({id:t,draft:e,componentId:this._getNextComponentId(),title:a,image:o,videoId:n,videoProvider:r,itemContainerTemplate:d,itemDetailTemplate:m,itemEditorTemplate:c})},_getActiveEmptyMessage:function(){return n["manage-empty-results"]},_clearAndShowSearchForm:function(){this._super(),o.scrollTo(this.$.searchForm).then(t.proxy(function(){this.$.searchItemInputfield.focus()},this))},_init:function(){this._super(),this.searchMessage=n["manage-featured-impact-contribution-search"],this.searchFreeTextUrl=this.module.data("service-url")}});return r});
define("rwd/common/upload/contribution-search",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/video-resolver","rwd/common/abstract-item"],function(i,e,t,n,o){var s=o.extend({type:"CONTRIBUTION",container:"contributionList",construct:function(e){i.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_resolveThumbnailImage:function(e,t){this.uploading=!0,(new n).getThumbnailImage(e,t).then(i.proxy(function(i){this.uploading=!1,this.image=i.thumbnail,this._refreshDetailView()},this))},_setThumbnailImage:function(){this._isVideo()?this.image&&(new t).setImage(this._getImage(),this.image):this._super()},_isVideo:function(){return this.videoId&&this.videoProvider},getImagePath:function(){return(new e).buildFullMediaPage(this.image)},_bind:function(i,e){var t=this._super(i,e),n=this;return this._isVideo()&&this._resolveThumbnailImage(this.videoId,this.videoProvider),this._element.bind("click",function(i){i.stopPropagation(),n._container.addContribution(n)}),t}});return s});
define("rwd/common/upload/contribution",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/video-resolver","rwd/common/abstract-detail-item"],function(i,e,t,n,s){var o=s.extend({type:"CONTRIBUTION",container:"contributionList",construct:function(e){i.extend(!0,this.baseConfig,this.superConfig),this._super(e)},_resolveThumbnailImage:function(e,t){this.uploading=!0,(new n).getThumbnailImage(e,t).then(i.proxy(function(i){this.uploading=!1,this.image=i.thumbnail,this._refreshDetailView()},this))},_setThumbnailImage:function(){this._isVideo()?this.image&&(new t).setImage(this._getImage(),this.image):this._super()},getImagePath:function(){return(new e).buildFullMediaPage(this.image)},_isVideo:function(){return this.videoId&&this.videoProvider},_updateActiveState:function(i){this.active=!1,this.showRemoveButton=!0},_bind:function(i,e){var t=this._super(i,e);return this._isVideo()&&this._resolveThumbnailImage(this.videoId,this.videoProvider),t}});return o});
define("rwd/common/manage-inspired-contribution-list",["jquery","rwd/common/abtract-manage-contribution-list","rwd/common/upload/contribution","rwd/common/upload/contribution-search","rwd/common/i18n","rwd/common/smooth-scroll"],function(t,e,i,n,o,a){var r=e.extend({baseConfig:{moduleSelector:".js-inspired-contribution-manage",selectors:{manageContributionButton:".js-manage-contribution-button",manageContributionContainer:".js-manage-contribution-container",searchButtonForm:".js-search-button-form",searchFreeTextButton:".js-free-text-search-button",searchCommentedButton:".js-commented-search-button",searchApplaudedButton:".js-applauded-search-button"}},_initTemplate:function(){this.itemDetailTemplate=this._loadTemplate("#contribution-details-container-template"),this.itemAddTemplate=this._loadTemplate("#contribution-add-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(t){var e=t.data("id"),i=t.data("title"),n=t.data("order"),o=t.data("draft"),a=t.data("type");if(this.config.selectedItemIdList.push(e),"CONTRIBUTION"===a)return{order:n,item:this._createDetailedContribution(e,o,i)};if("CONTRIBUTION-VIDEO"===a){var r=t.data("image"),s=t.data("video-id"),d=t.data("video-provider");return{order:n,item:this._createDetailedContribution(e,o,i,r,s,d)}}if("CONTRIBUTION-IMAGE"===a){var r=t.data("image");return{order:n,item:this._createDetailedContribution(e,o,i,r)}}logger.warn("Type is not supported:",a)},_createItem:function(t){return new n({id:t.id,draft:t.draft,componentId:this._getNextComponentId(),title:t.title,image:t.media&&t.media.relativPath,videoId:t.videoId,videoProvider:t.videoProvider,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_createContribution:function(t,e,n,o,a,r,s,d,c){return new i({id:t,draft:e,componentId:this._getNextComponentId(),title:n,image:o,videoId:a,videoProvider:r,itemContainerTemplate:s,itemDetailTemplate:d,itemEditorTemplate:c})},_clearAndShowSearchForm:function(){this._super(),a.scrollTo(this.$.searchButtonForm).then(t.proxy(function(){this.$.searchItemInputfield.focus()},this))},_getActiveEmptyMessage:function(){return this.$.searchCommentedButton.is(".active")?o["manage-empty-commented"]:this.$.searchApplaudedButton.is(".active")?o["manage-empty-applauded"]:o["manage-empty-results"]},_showSearchButtonForm:function(){this.$.searchButtonForm.show(),this._addActiveMarker(this.$.searchFreeTextButton),this._super()},_showManageContributionButton:function(){this._super(),this.$.searchButtonForm.hide()},_addActiveMarker:function(t){this.$.searchButtonForm.find(".active").removeClass("active"),t.addClass("active")},_handleFilterOptionClick:function(e){e.preventDefault(),this._closeEditors(),this._clearAndHideSearchForm(),this.$.searchNotification.show(),this.$.searchNotification.trigger("loading");var i=t(e.currentTarget);return this._addActiveMarker(i),this._loadPage(1,i.attr("href")),!0},_bindEvents:function(){this._super(),this.$.searchFreeTextButton.on("click",t.proxy(function(e){e.preventDefault(),this._closeEditors(),this._clearAndShowSearchForm();var i=t(e.currentTarget);return this._addActiveMarker(i),!0},this)),this.$.searchCommentedButton.on("click",t.proxy(function(t){this._handleFilterOptionClick(t)},this)),this.$.searchApplaudedButton.on("click",t.proxy(function(t){this._handleFilterOptionClick(t)},this))},_init:function(){this._super(),this.searchMessage=o["manage-contribution-search"],this.searchFreeTextUrl=this.$.searchFreeTextButton.attr("href")}});return r});
define("rwd/common/upload/author-search",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/common/abstract-item"],function(t,e,n,i){var r=i.extend({type:"AUTHOR",container:"author",construct:function(n){t.extend(!0,this.baseConfig,this.superConfig),this._super(n),this.profileImage=(new e).getProfilePath(this.username)},_setThumbnailImage:function(){(new n).setImage(this._getImage(),this.profileImage)},_bind:function(t,e){var n=this._super(t,e),i=this;return this._element.bind("click",function(t){t.stopPropagation(),i._container.addNewUser(i)}),n},getItemName:function(){return this.firstname+(this.lastname?" "+this.lastname:"")}});return r});
define("rwd/common/upload/author",["jquery","rwd/common/upload/abstract-user"],function(t,e){var o=e.extend({type:"AUTHOR",container:"author",_updateActiveState:function(t){this.active=!1,this.showRemoveButton=!0}});return o});
define("rwd/common/manage-author",["jquery","rwd/common/abstract-user-list","rwd/common/upload/author","rwd/common/upload/author-search","rwd/common/i18n"],function(e,t,a,n,i){var r=t.extend({baseConfig:{moduleSelector:".js-author-manage",selectors:{manageUsersButton:".js-manage-author-button",manageUsersContainer:".js-manage-author-container",newAuthor:".js-new-author"}},_initTemplate:function(){this.itemDetailTemplate=this._loadTemplate("#author-details-container-template"),this.itemAddTemplate=this._loadTemplate("#author-add-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t=e.data("id"),a=e.data("username"),n=e.data("firstname"),i=e.data("lastname"),r=e.data("order"),o=e.data("type");return this.config.selectedItemIdList.push(t),"AUTHOR"===o?{order:r,item:this._createUser({id:t,username:a,firstname:n,lastname:i})}:void logger.warn("Type is not supported:",o)},_showItemContainer:function(){"false"!==this.$.newAuthor.val()&&this._super(),this.$.manageUsersButton.hide()},_hideItemContainer:function(){this._super(),this.$.manageUsersButton.show()},createAddUser:function(e,t,a,i){return new n({id:e,componentId:this._getNextComponentId(),username:t,firstname:a,lastname:i,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_createUser:function(e){return new a({id:e.id,componentId:this._getNextComponentId(),username:e.username,firstname:e.firstname,lastname:e.lastname,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},removeItem:function(e){this.$.newAuthor.val("true"),this._super(e),ParsleyUI.removeError(this.module.parsley())},_init:function(){this._super(),this.searchMessage=i[this.config.searchMessageKey]}});return r});
define("rwd/common/upload/challenge-admin-search",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/common/abstract-item"],function(e,t,n,i){var a=i.extend({type:"CHALLENGE-ADMIN",container:"challengeAdminList",construct:function(n){e.extend(!0,this.baseConfig,this.superConfig),this._super(n),this.profileImage=(new t).getProfilePath(this.username)},_setThumbnailImage:function(){(new n).setImage(this._getImage(),this.profileImage)},_bind:function(e,t){var n=this._super(e,t),i=this;return this._element.bind("click",function(e){e.stopPropagation(),i._container.addNewUser(i)}),n},getItemName:function(){return this.firstname+(this.lastname?" "+this.lastname:"")}});return a});
define("rwd/common/upload/challenge-admin-member",["jquery","rwd/common/upload/abstract-user"],function(e,n){var r=n.extend({type:"CHALLENGE-ADMIN",container:"challengeAdminList"});return r});
define("rwd/common/manage-challenge-admin-list",["rwd/common/abstract-user-list","rwd/common/upload/challenge-admin-member","rwd/common/upload/challenge-admin-search","rwd/common/i18n"],function(e,t,a,n){var i=e.extend({baseConfig:{moduleSelector:".js-challenge-admin-manage",selectors:{manageUsersButton:".js-manage-challenge-admin-button",manageUsersContainer:".js-manage-challenge-admin-container"}},_initTemplate:function(){this.itemDetailTemplate=this._loadTemplate("#challenge-admin-details-container-template"),this.itemAddTemplate=this._loadTemplate("#challenge-admin-add-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t=e.data("id"),a=e.data("username"),n=e.data("firstname"),i=e.data("lastname"),m=e.data("note-text"),l=e.data("order"),r=e.data("type");return this.config.selectedItemIdList.push(t),"CHALLENGE-ADMIN"===r?{order:l,item:this._createUser({id:t,username:a,firstname:n,lastname:i,noteText:m})}:void logger.warn("Type is not supported:",r)},createAddUser:function(e,t,n,i){return new a({id:e,componentId:this._getNextComponentId(),username:t,firstname:n,lastname:i,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_createUser:function(e){return new t({id:e.id,componentId:this._getNextComponentId(),username:e.username,firstname:e.firstname,lastname:e.lastname,description:e.noteText,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},_init:function(){this._super(),this.searchMessage=n["manage-challenge-admin-search"]}});return i});
define("rwd/common/manage-team-list",["jquery","rwd/common/abstract-user-list","rwd/common/upload/team-member","rwd/common/upload/team-member-search","rwd/common/i18n"],function(e,t,a,m,n){var i=t.extend({baseConfig:{moduleSelector:".js-team-manage",selectors:{manageUsersButton:".js-manage-team-button",manageUsersContainer:".js-manage-team-container"}},_initTemplate:function(){this.itemDetailTemplate=this._loadTemplate("#team-details-container-template"),this.itemAddTemplate=this._loadTemplate("#team-add-container-template"),this.itemEditorTemplate=this._loadTemplate("#item-editor-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t=e.data("id"),a=e.data("username"),m=e.data("firstname"),n=e.data("lastname"),i=e.data("note-text"),r=e.data("order"),o=e.data("type"),s=e.data("author");return this.config.selectedItemIdList.push(t),"TEAM-MEMBER"===o?{order:r,item:this._createUser({id:t,username:a,firstname:m,lastname:n,author:s,noteText:i})}:void logger.warn("Type is not supported:",o)},createAddUser:function(e,t,a,n){return new m({id:e,componentId:this._getNextComponentId(),username:t,firstname:a,lastname:n,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_createUser:function(e){return new a({id:e.id,componentId:this._getNextComponentId(),username:e.username,firstname:e.firstname,lastname:e.lastname,description:e.noteText,author:e.author,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemDetailTemplate,itemEditorTemplate:this.itemEditorTemplate})},_init:function(){this._super(),this.searchMessage=n["manage-team-member-search"]}});return i});
define("rwd/common/upload/team-member-search",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/common/abstract-item"],function(e,t,n,i){var r=i.extend({type:"TEAM-MEMBER",container:"teamMemeberList",construct:function(n){e.extend(!0,this.baseConfig,this.superConfig),this._super(n),this.profileImage=(new t).getProfilePath(this.username)},_setThumbnailImage:function(){(new n).setImage(this._getImage(),this.profileImage)},_bind:function(e,t){var n=this._super(e,t),i=this;return this._element.bind("click",function(e){e.stopPropagation(),i._container.addNewUser(i)}),n},getItemName:function(){return this.firstname+(this.lastname?" "+this.lastname:"")}});return r});
define("rwd/common/upload/team-member",["jquery","rwd/common/upload/abstract-user"],function(e,r){var t=r.extend({type:"TEAM-MEMBER",container:"teamMemeberList",isAuthor:function(){return this.author?!0:!1}});return t});
define("rwd/common/abstract-single-user-search",["jquery","rwd/common/abstract-user-list","rwd/common/i18n"],function(e,s,i){var n=s.extend({_showSearchForm:function(){this._super(),this.config.listeners&&this.config.listeners.openSearchBar&&this.config.listeners.openSearchBar()},_createUser:function(e){return e.id},_append:function(s,i,n){if(this.config.listeners&&this.config.listeners.selected){var t=e(s).get(0);t&&this.config.listeners.selected(t)}},_renderResultList:function(e,s,i,n){this._super(e,s,i,n),this.config.listeners&&this.config.listeners.resultsRendered&&this.config.listeners.resultsRendered()},_init:function(){this._super(),this.searchMessage=i[this.config.searchMessageKey]}});return n});
define("rwd/common/upload/abstract-single-user",["jquery","rwd/path-utils","rwd/centered-image-utils","rwd/common/abstract-item"],function(e,t,n,i){var s=i.extend({construct:function(n){e.extend(!0,this.baseConfig,this.superConfig),this._super(n),this.profileImage=(new t).getProfilePath(this.username)},_setThumbnailImage:function(){(new n).setImage(this._getImage(),this.profileImage)},_bind:function(e,t){var n=this._super(e,t),i=this;return this._element.bind("click",function(e){e.stopPropagation(),i._container.addNewUser(i)}),n},getItemName:function(){return this.firstname+(this.lastname?" "+this.lastname:"")}});return s});
define("rwd/common/toolbar-powered-sortable-table",["jquery","rwd/common/toolbar-powered-table","rwd/common/utils"],function(t,r,e){var o=r.extend({_init:function(){this._super(),this.sortBy=this.module.attr("data-sort-by"),this.sortOrder=this.module.attr("data-sort-order"),logger.debug("Init sortable toolbar powered table with sort options: ",this.sortBy,this.sortOrder)},_onSort:function(r){var o=t(r.currentTarget),s=o.attr("data-sort-by"),i=o.is(".desc")?"ASC":"DESC";logger.debug("Sorting table by "+s+", "+i),this._reload(!0,t.proxy(function(){e.setHashParameters([{name:"sort",value:s},{name:"order",value:i}]),this._loadViewWithState(this._getDataForPost())},this))},_getDataForPost:function(r){var e=this._super(r);return t.extend(!0,this._getSortConfig(),e)},_loadViewWithState:function(r){this.table.search(t.extend(this._getSortConfig(),r),this.initialActivePage||1),this.initialActivePage=void 0},_viewLoaded:function(t,r){this._super(t,r),this.sortOrder&&this.sortBy&&!this.table.getActiveSortable(this.sortBy,this.sortOrder).length&&(logger.info("Invalid sort state. Clearing sort: "+this.sortBy+", "+this.sortOrder),this.sortBy=void 0,this.sortOrder=void 0)},_getSortConfig:function(){var t=e.parseHashParameters(),r=t.order,o=t.sort;return r&&o?{sortOrder:r.toUpperCase(),sortBy:o.toUpperCase()}:{}},_bindEvents:function(){this._super(),this.module.on("click",this.table.config.sortable,t.proxy(this._onSort,this))}});return o});
define("rwd/common/profile-image-upload",["jquery","rwd/common/image-upload"],function(e,t){var a=t.extend({baseConfig:{moduleSelector:".profile-image-upload"},updatePhoto:function(e,t){this.centeredImageUtils.setImage(e,t)},getImagePath:function(e){return this.pathUtils.getSmallestImagePath(e)}});return a});
define("rwd/common/removable-image-upload",["jquery","rwd/common/image-upload"],function(e,t){var i=t.extend({baseConfig:{moduleSelector:".removable-image-upload",selectors:{removeImage:".js-remove-image"},emptyImageUrl:""},_init:function(){this._super(),this._updateRemoveElement(this.$.imageContainer.children().attr("src"))},updatePhoto:function(e,t){this._updateRemoveElement(t),e.children().attr("src",t),logger.debug("removable-image-upload update photo")},getImagePath:function(e,t){return this.pathUtils.getImagePath(t)},_updateRemoveElement:function(e){this._isEmptyImage(e)?this.$.removeImage.hide():this.$.removeImage.show()},_isEmptyImage:function(t){return!t||e.trim(t)===this.config.emptyImageUrl},_bindEvents:function(){this._super(),logger.debug("removable-image-upload bind events"),this.$.removeImage.click(e.proxy(function(e){e.preventDefault(),logger.debug("removable-image-upload remove clicked"),this.isUploading()||(this.updatePhoto(this.$.imageContainer,this.config.emptyImageUrl),this._updateHiddenField(this.$.hiddenField,"none"),this.module.trigger("img-removed"))},this))}});return i});
define("rwd/common/sponsor-image-upload",["jquery","rwd/common/image-upload"],function(e,o){var t=o.extend({baseConfig:{moduleSelector:".sponsor-image-upload"},updatePhoto:function(e,o){e.children().attr("src",o)},getImagePath:function(e){return this.pathUtils.getSmallestSponsorImagePath(e)}});return t});
define("rwd/common/add-challenge-user",["jquery","rwd/common/abstract-single-user-search","rwd/common/upload/challenge-user"],function(e,t,a){var n=t.extend({baseConfig:{moduleSelector:".js-add-challenge-user",selectors:{manageUsersButton:".js-add-challenge-user-button",manageUsersContainer:".js-add-challenge-user-container",searchTitle:".js-search-title"},searchMessageKey:"add-challenge-user-search"},_initTemplate:function(){this.itemAddTemplate=this._loadTemplate("#challenge-user-add-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t=e.data("id"),a=e.data("type");return this.config.selectedItemIdList.push(t),"CHALLENGE_USER"===a?{order:0,item:this._createUser({id:t})}:void logger.warn("Type is not supported:",a)},createAddUser:function(e,t,n,s){return new a({id:e,componentId:this._getNextComponentId(),username:t,firstname:n,lastname:s,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})},_showSearchForm:function(){this._super(),this.$.searchTitle.show()},_showManageUsersButton:function(){this._super(),this.$.searchTitle.hide()}});return n});
define("rwd/common/upload/challenge-user",["rwd/common/upload/abstract-single-user"],function(e){return e.extend({type:"CHALLENGE_USER",container:"challengeuser"})});
define("rwd/common/manage-reviewer",["jquery","rwd/common/abstract-single-user-search","rwd/common/upload/reviewer-search"],function(e,t,a){var n=t.extend({baseConfig:{moduleSelector:".js-reviewer-manage",selectors:{manageUsersButton:".js-manage-reviewer-button",manageUsersContainer:".js-manage-reviewer-container"},searchMessageKey:"manage-reviewer-search"},_initTemplate:function(){this.itemAddTemplate=this._loadTemplate("#reviewer-add-container-template"),this.itemContainerTemplate=this._loadTemplate("#item-upload-container-template")},_convertElementToObject:function(e){var t=e.data("id"),a=e.data("type");return this.config.selectedItemIdList.push(t),"REVIEWER"===a?{order:0,item:this._createUser({id:t})}:void logger.warn("Type is not supported:",a)},createAddUser:function(e,t,n,r){return new a({id:e,componentId:this._getNextComponentId(),username:t,firstname:n,lastname:r,itemContainerTemplate:this.itemContainerTemplate,itemDetailTemplate:this.itemAddTemplate})}});return n});
define("rwd/common/upload/reviewer-search",["rwd/common/upload/abstract-single-user"],function(e){var r=e.extend({type:"REVIEWER",container:"reviewer"});return r});
define("rwd/community-page",["jquery","rwd/common/base-ui-module"],function(e,n){var o=n.extend({baseConfig:{selectors:{challengeSelector:"select"},useModuleAsParent:!0,moduleSelector:".community-members"},_bindEvents:function(){this.$.challengeSelector.on("change",function(){window.location=this.value})}});return o});
define("rwd/contribution",["jquery","rwd/common/base-ui-module","rwd/gallery","rwd/report-contribution"],function(e,n,o,t){return n.extend({baseConfig:{selectors:{sectionGalleries:'[class^="section-gallery"]'},moduleSelector:".contribution",useModuleAsParent:!0},_init:function(){logger.debug("Init contribution"),new t,this.$.sectionGalleries.each(function(){new o({moduleSelector:"."+this.className})})}})});
define("rwd/edit-contribution",["jquery","rwd/common/base-ui-module","rwd/modal-notification","rwd/common/manage-author","rwd/common/rich-text","rwd/common/media-upload","rwd/common/utils"],function(i,n,o,t,e,s,a){var r=n.extend({baseConfig:{selectors:{deleteContribution:".delete",uploadComponents:".js-media-upload, .js-attachment-upload",manageTeamComponent:"#manage-team",missionInputs:'input[name="missionTextId"]',manageSectionMedia:'[id^="section-media"]'},notification:"#delete-notification",moduleSelector:".edit-contribution"},_init:function(){logger.debug("Init edit contribution"),this.$.deleteContribution.length&&this._initDeleteConfirmation(),new t({searchMessageKey:"manage-contribution-author-search"}),new s({moduleSelector:"#media-upload"}),this.$.manageSectionMedia.each(function(){new s({moduleSelector:"#"+this.id})}),this._initMissionDescription()},_initDeleteConfirmation:function(){var i=this;this.deleteConfirmation=new o({id:i.config.notification,onOk:function(n){logger.info("Delete contribution confirmed"),n.preventDefault(),this.close(),a.postLink(i.$.deleteContribution.attr("data-url"))}})},_handleScrollPosition:function(){var n=i("body").data("scrollPosition"),o=i(window).scrollTop();n&&o<parseInt(n)||(i("html, body").animate({scrollTop:this.$.manageTeamComponent.offset().top},0),i("body").data("scrollPosition",o))},_initMissionDescription:function(){var n=this;n.$.missionInputs.each(function(){return this.checked?(n._showMissionDescription(i(this)),!1):void 0})},_showMissionDescription:function(i){i.siblings(".mission-description").removeClass("js-rich-text").hide(),i.nextAll().eq(1).addClass("js-rich-text").show(),new e},_bindEvents:function(){if(this.$.deleteContribution.click(i.proxy(function(i){i.preventDefault(),this.deleteConfirmation.open()},this)),this.$.missionInputs.on("change",i.proxy(function(n){this._showMissionDescription(i(n.currentTarget))},this)),"#manage-team"===window.location.hash){var n=this;n.$.uploadComponents.parent().on("containerReady",function(){n._handleScrollPosition()}),require(["rwd/common/rich-text-editor"],function(o){var t=o.getInstance();t.onLoad("edit-contribution-page",i.proxy(n._handleScrollPosition,n))})}}});return r});
define("rwd/edit-profile",["jquery","rwd/common/base-ui-module","rwd/modal-notification","rwd/common/utils"],function(t,e,i,o){var n=e.extend({baseConfig:{selectors:{removeProfile:".delete-profile",twitterField:".twitter",changePassword:".changePasswordLink"},notification:"#delete-profile-notification",moduleSelector:".edit-profile"},_init:function(){logger.debug("Init edit profile");var e=this;this.$.changePassword.on("click",function(){o.postLink(e.$.changePassword.attr("data-url"))}),t.mask.definitions["~"]="[A-Za-z0-9_]",this.$.twitterField.mask("@?~~~~~~~~~~~~~~~",{placeholder:""}),this.deleteConfirmation=new i({id:e.config.notification,onOk:function(t){logger.info("Delete profile confirmed"),t.preventDefault(),this.close(),o.postLink(e.$.removeProfile.attr("data-url"))}})},removeTwitterMask:function(){var e=t(this);"@"===t.trim(e.val())&&e.val("")},_bindEvents:function(){t(".js-timezone").select2(),this.$.removeProfile.click(t.proxy(function(t){t.preventDefault(),this.deleteConfirmation.open()},this)),this.$.twitterField.focus(t.proxy(function(){""===t.trim(this.$.twitterField.val())&&this.$.twitterField.val("@"),this.$.twitterField.change()},this)),this.$.twitterField.blur(this.removeTwitterMask)}});return n});
define("rwd/profile",["jquery","rwd/common/base-ui-module","rwd/modal-notification"],function(r,e,o){return e.extend({baseConfig:{selectors:{reportProfile:".profile .report-profile",errorMessage:".profile .report-profile-error"},notification:"#report-user",moduleSelector:".profile"},_init:function(){if(logger.debug("Init profile"),this.$.reportProfile.length){var r=this;this.reportConfirmation=new o({id:r.config.notification,onOk:function(e){logger.info("Report profile confirmed"),r._reportProfile(),e.preventDefault(),this.close()},onCancel:function(e){r.$.reportProfile.trigger("restore"),e.preventDefault(),this.close()}})}},_reportProfile:function(){r.ajax({url:this.$.reportProfile.data("url"),type:"POST"}).done(r.proxy(function(){this.$.reportProfile.remove(),this.$.errorMessage.remove()},this)).fail(r.proxy(function(){logger.warn("AJAX request failed for report profile"),this.$.errorMessage.addClass("error")},this)).always(r.proxy(function(){this.$.reportProfile.trigger("restore")},this))},_bindEvents:function(){this.$.reportProfile.click(r.proxy(function(r){r.preventDefault(),this.reportConfirmation.open()},this))}})});
define("rwd/showcase/mentions",["jquery","rwd/common/base-ui-module","rwd/common/utils","rwd/mention-input"],function(n,t,e,o){var i=t.extend({baseConfig:{selectors:{form:"form",postDiv:"#post"},moduleSelector:".showcase-mentions"},_init:function(){this.mentionInput1=new o({moduleSelector:this.config.moduleSelector+" .mention-input.mention-1",dataUrl:"/dummy/mentions/data.json"}),this.mentionInput2=new o({moduleSelector:this.config.moduleSelector+" .mention-input.mention-2",dataUrl:"/dummy/mentions/data.json"})},_bindEvents:function(){var n=this;this.$.form.submit(function(t){t.preventDefault(),n.$.postDiv.html(e.htmlEscape(n.mentionInput1.getMentionText())+"<br><br>"+e.htmlEscape(n.mentionInput2.getMentionText()))})}});return i});
define("rwd/showcase/tables",["jquery","rwd/common/base-ui-module","rwd/common/paged-table","rwd/common/label"],function(e,t,n,o){var i=t.extend({baseConfig:{selectors:{},moduleSelector:".showcase-tables"},_init:function(){this.table=new n({moduleSelector:".showcase-paged-table",pageSize:10,listeners:{loaded:e.proxy(this._initLabels,this)}}),this.table.search({})},_initLabels:function(){this.module.find(".label").each(function(){var t="#"+e(this).attr("id");new o({moduleSelector:t})})},_bindEvents:function(){}});return i});
require(["jquery","rwd/top-navigation","rwd/search","rwd/user-menu","rwd/common/forms","rwd/common/validation","rwd/auth","rwd/common/paginator","rwd/video-thumbnail","rwd/applaud","rwd/applaud-box","rwd/contribution-list","rwd/team-membership-list","rwd/password-indicator","rwd/gallery","rwd/dropdown-filter","rwd/filter","rwd/common/rich-text","rwd/comment","rwd/stats","rwd/edit-profile","rwd/edit-contribution","rwd/profile","rwd/contribution","rwd/common/profile-image-upload","rwd/common/sponsor-image-upload","rwd/common/file-upload","rwd/common/centered-imager","rwd/common/breakpoint-imager","rwd/design-quotient","rwd/design-quotient-chart","rwd/common/form-change-notifier","rwd/common/loading-indicator","rwd/common/expandable-section","rwd/common/expandable-section-mobile-only","rwd/common/attachment-upload","rwd/common/manage-team-list","rwd/common/manage-challenge-admin-list","rwd/common/manage-inspired-contribution-list","rwd/common/manage-featured-impact-contribution-list","rwd/timeline","rwd/common/zoom","rwd/notifications-initializer","rwd/analytics","rwd/common/breakpointdetection","rwd/active-challenges","rwd/common/form-submit-warning","rwd/activity-feed","rwd/common/scroll-to-section","rwd/common/csrf","rwd/common/contribution-tag-autocomplete","rwd/common/contribution-group-selector","rwd/common/pickadate-initializer","rwd/common/ajax-request-config","rwd/community-page","rwd/accept-challenge-tnc-init","rwd/geolocation","rwd/timzone-checker"],function(e,n,o,i,r,t,w,a,d,m,c,l,s,g,u,p,b,f,h,z,v,x,k,y,I,q,W,S,j,B,F,G,P,T,$,A,C,D,E,H,J,K,L,M,N,O,Q,R,U,V,X,Y,Z,_,ee,ne,oe,ie){var re=N.getInstance().getBreakpointImageSizePairs(),te=N.getInstance().getGeneralThumbnailWidths();new Z;var we=new u,ae=new n;new o(ae),new i(ae),new r,new w,new a,new l,new s,new m,new c,new d,new g,new p,new b,new S({imageWidth:te}),new j({moduleSelector:".homepage-box",imageWidth:re}),new j({moduleSelector:".guest-banner",imageWidth:re}),new j({moduleSelector:".footer",imageWidth:re}),new f,new h,new z,new v,new x,new k,new y,new I,new q,new W,new B,new F,new T,new $,new A,new C,new D,new E,new H,new J,new O(we),new Q,new R,new U({exclude:[{pattern:/^#!admin-section$/,breakpoints:[4,5,6]}]}),new X,new Y,new ee,new ne,new oe,new ie,M.getInstance(),G.getInstance(),P.initialize(),t.initialize(),K.initialize(),L.initialize(),V.getInstance(),_.initialize()},function(e){logger.error("Failed to load definitions",e)});